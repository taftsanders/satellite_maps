{
  "total": 769,
  "subtotal": 769,
  "page": 1,
  "per_page": 2000000,
  "search": null,
  "sort": {
    "by": null,
    "order": null
  },
  "results": [{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":7,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.218","associated_name":null,"created_at":"2018-05-23 23:06:51 UTC","id":769,"auditable_id":14,"auditable_name":"batman.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"global_status":[0,2]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":28,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-05-23 22:47:49 UTC","id":768,"auditable_id":5,"auditable_name":"drone74.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"global_status":[1,2]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":27,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.58","associated_name":null,"created_at":"2018-05-23 22:47:43 UTC","id":767,"auditable_id":5,"auditable_name":"drone74.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"global_status":[2,1]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":18,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.127","associated_name":null,"created_at":"2018-05-22 14:40:37 UTC","id":766,"auditable_id":9,"auditable_name":"drone69.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"global_status":[1,2]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":2,"comment":null,"associated_id":21,"associated_type":"Role","remote_address":null,"associated_name":"Access Insights Admin","created_at":"2018-05-20 23:31:08 UTC","id":765,"auditable_id":411,"auditable_name":"view_hosts","auditable_type":"Filter","action":"destroy","audited_changes":{"search":null,"role_id":21,"taxonomy_search":null,"override":false}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":2,"comment":null,"associated_id":20,"associated_type":"Role","remote_address":null,"associated_name":"Access Insights Viewer","created_at":"2018-05-20 23:31:08 UTC","id":764,"auditable_id":412,"auditable_name":"view_hosts","auditable_type":"Filter","action":"destroy","audited_changes":{"search":null,"role_id":20,"taxonomy_search":null,"override":false}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":2,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-05-20 23:30:43 UTC","id":763,"auditable_id":163,"auditable_name":"Katello Kickstart Default User Data","auditable_type":"ProvisioningTemplate","action":"destroy","audited_changes":{"name":"Katello Kickstart Default User Data","template":"<%#\nkind: user_data\nname: Katello Kickstart default user data\noses:\n- CentOS 6\n- CentOS 7\n- Fedora 19\n- Fedora 20\n- Fedora 21\n- Fedora 22\n- Fedora 23\n-%>\n#cloud-config\nhostname: <%= @host.shortname %>\nfqdn: <%= @host %>\nmanage_etc_hosts: true\n\ngroups:\n - admin\n\nusers:\n - default\n - name: admin\n   primary-group: admin\n   groups: users\n   shell: /bin/bash\n   sudo: ['ALL=(ALL) ALL']\n   lock-passwd: false\n   passwd: <%= @host.root_pass %>\n\n<%# Allow user to specify additional SSH key as host paramter -%>\n<% if @host.params['sshkey'].present? || @host.params['remote_execution_ssh_keys'].present? -%>\nssh_authorized_keys:\n<% if @host.params['sshkey'].present? -%>\n  - <%= @host.params['sshkey'] %>\n<% end -%>\n<% if @host.params['remote_execution_ssh_keys'].present? -%>\n<% @host.params['remote_execution_ssh_keys'].each do |key| -%>\n  - <%= key %>\n<% end -%>\n<% end -%>\n<% end -%>\nwrite_files:\n- path: /tmp/foreman-userdata.sh\n  permissions: '0755'\n  content: |\n    #!/bin/bash\n<%= indent 4 do\n      snippet 'subscription_manager_registration'\n    end %>\n<% if @host.info['parameters']['realm'] && @host.realm && @host.realm.realm_type == 'FreeIPA' -%>\n<%= indent 4 do\n      snippet 'freeipa_register'\n    end %>\n<% end -%>\n  <% unless @host.operatingsystem.atomic? -%>\n    # update all the base packages from the updates repository\n    yum -t -y -e 0 update\n  <% end -%>\n<%\n  # safemode renderer does not support unary negation\n  non_atomic = @host.operatingsystem.atomic? ? false : true\n  pm_set = @host.puppetmaster.empty? ? false : true\n  puppet_enabled = non_atomic && (pm_set || @host.params['force-puppet'])\n  salt_enabled = non_atomic && (@host.params['salt_master'] ? true : false)\n  chef_enabled = @host.respond_to?(:chef_proxy) && @host.chef_proxy\n%>\n<% if chef_enabled %>\n<%= indent 4 do\n      snippet 'chef_client'\n    end  %>\n<% end -%>\n\n<% if puppet_enabled %>\n<%= indent 4 do\n      snippet 'puppet_setup'\n    end %>\n<% end -%>\n\n<% if salt_enabled %>\n<%= indent 4 do\n      snippet 'saltstack_setup'\n    end %>\n<% end -%>\nphone_home:\n url: <%= foreman_url('built') %>\n post: []\n tries: 10\nruncmd:\n - [ cloud-init-per, once, foreman-userdata, /tmp/foreman-userdata.sh ]\noutput: {all: '| tee -a /root/install.userdata.log'}\n\n","snippet":false,"template_kind_id":9,"locked":true,"default":true,"vendor":"Katello","os_family":null,"job_category":"Miscellaneous","provider_type":null,"description_format":null,"execution_timeout_interval":null}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":2,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-05-20 23:30:43 UTC","id":762,"auditable_id":164,"auditable_name":"Katello Kickstart Default Finish","auditable_type":"ProvisioningTemplate","action":"destroy","audited_changes":{"name":"Katello Kickstart Default Finish","template":"<%#\nkind: finish\nname: Katello Kickstart default finish\noses:\n- CentOS 5\n- CentOS 6\n- CentOS 7\n- RedHat 5\n- RedHat 6\n- RedHat 7\n- Fedora 19\n- Fedora 20\n%>\n<% if @host.subnet.respond_to?(:dhcp_boot_mode?) -%>\n<%= snippet 'kickstart_networking_setup' %>\nservice network restart\n<% end -%>\n\n<%\n  rhel_compatible = @host.operatingsystem.family == 'Redhat' && @host.operatingsystem.name != 'Fedora'\n  os_major = @host.operatingsystem.major.to_i\n  pm_set = @host.puppetmaster.empty? ? false : true\n  puppet_enabled = pm_set || @host.params['force-puppet']\n  salt_enabled = @host.params['salt_master'] ? true : false\n  chef_enabled = @host.respond_to?(:chef_proxy) && @host.chef_proxy\n%>\n\n<%= snippet \"subscription_manager_registration\" %>\n\n<% if @host.respond_to?(:realm) && @host.otp && @host.realm && @host.realm.realm_type == \"FreeIPA\" -%>\n<%= snippet \"freeipa_register\" %>\n<% end -%>\n\n# update local time\necho \"updating system time\"\n/usr/sbin/ntpdate -sub <%= @host.params['ntp-server'] || '0.fedora.pool.ntp.org' %>\n/usr/sbin/hwclock --systohc\n\n<% if @host.info['parameters']['realm'] && @host.realm && @host.realm.realm_type == 'FreeIPA' -%>\n<%= snippet \"freeipa_register\" %>\n<% end -%>\n\n# update all the base packages from the updates repository\nyum -t -y -e 0 update\n\n<%= snippet('remote_execution_ssh_keys') %>\n\n<% if chef_enabled %>\n<%= snippet 'chef_client' %>\n<% end -%>\n\n<% if puppet_enabled %>\n<%= snippet 'puppet_setup' %>\n<% end -%>\n\n<% if salt_enabled %>\n<%= snippet 'saltstack_setup' %>\n<% end -%>\n\nexit 0\n","snippet":false,"template_kind_id":7,"locked":true,"default":true,"vendor":"Katello","os_family":null,"job_category":"Miscellaneous","provider_type":null,"description_format":null,"execution_timeout_interval":null}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":2,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-05-20 23:30:43 UTC","id":761,"auditable_id":162,"auditable_name":"Katello Kickstart Default","auditable_type":"ProvisioningTemplate","action":"destroy","audited_changes":{"name":"Katello Kickstart Default","template":"<%#\nkind: provision\nname: Katello Kickstart default\noses:\n- CentOS 5\n- CentOS 6\n- CentOS 7\n- RedHat 5\n- RedHat 6\n- RedHat 7\n- Fedora 19\n- Fedora 20\n%>\n<%\n  rhel_compatible = @host.operatingsystem.family == 'Redhat' && @host.operatingsystem.name != 'Fedora'\n  os_major = @host.operatingsystem.major.to_i\n  # safemode renderer does not support unary negation\n  pm_set = @host.puppetmaster.empty? ? false : true\n  puppet_enabled = pm_set || @host.params['force-puppet']\n  salt_enabled = @host.params['salt_master'] ? true : false\n  chef_enabled = @host.respond_to?(:chef_proxy) && @host.chef_proxy\n  section_end = (rhel_compatible && os_major <= 5) ? '' : '%end'\n%>\ninstall\n<%= @mediapath %>\nlang en_US.UTF-8\nselinux --enforcing\nkeyboard us\nskipx\n\n<% subnet = @host.subnet -%>\n<% if subnet.respond_to?(:dhcp_boot_mode?) -%>\n<% dhcp = subnet.dhcp_boot_mode? && !@static -%>\n<% else -%>\n<% dhcp = !@static -%>\n<% end -%>\n\nnetwork --bootproto <%= dhcp ? 'dhcp' : \"static --ip=#{@host.ip} --netmask=#{subnet.mask} --gateway=#{subnet.gateway} --nameserver=#{[subnet.dns_primary, subnet.dns_secondary].select{ |item| item.present? }.join(',')}\" %> --hostname <%= @host %><%= os_major >= 6 ? \" --device=#{@host.mac}\" : '' -%>\n\nrootpw --iscrypted <%= root_pass %>\nfirewall --<%= os_major >= 6 ? 'service=' : '' %>ssh\nauthconfig --useshadow --passalgo=<%= @host.operatingsystem.password_hash || 'sha256' %> --kickstart\ntimezone --utc <%= @host.params['time-zone'] || 'UTC' %>\n\n<% if @host.operatingsystem.name == 'Fedora' and os_major <= 16 -%>\n# Bootloader exception for Fedora 16:\nbootloader --append=\"nofb quiet splash=quiet <%=ks_console%>\" <%= grub_pass %>\npart biosboot --fstype=biosboot --size=1\n<% else -%>\nbootloader --location=mbr --append=\"nofb quiet splash=quiet\" <%= grub_pass %>\n<% end -%>\n\n<% if os_major == 5 -%>\nkey --skip\n<% end -%>\n\n<% if @dynamic -%>\n%include /tmp/diskpart.cfg\n<% else -%>\n<%= @host.diskLayout %>\n<% end -%>\n\ntext\nreboot\n\n%packages --ignoremissing\nyum\ndhclient\nntp\nwget\n@Core\n<%= section_end -%>\n\n<% if @dynamic -%>\n%pre\n<%= @host.diskLayout %>\n<%= section_end -%>\n<% end -%>\n\n%post --nochroot\nexec < /dev/tty3 > /dev/tty3\n#changing to VT 3 so that we can see whats going on....\n/usr/bin/chvt 3\n(\ncp -va /etc/resolv.conf /mnt/sysimage/etc/resolv.conf\n/usr/bin/chvt 1\n) 2>&1 | tee /mnt/sysimage/root/install.postnochroot.log\n<%= section_end -%>\n\n\n%post\nlogger \"Starting anaconda <%= @host %> postinstall\"\nexec < /dev/tty3 > /dev/tty3\n#changing to VT 3 so that we can see whats going on....\n/usr/bin/chvt 3\n(\n<% if subnet.respond_to?(:dhcp_boot_mode?) -%>\n<%= snippet 'kickstart_networking_setup' %>\n<% end -%>\n\n#update local time\necho \"updating system time\"\n/usr/sbin/ntpdate -sub <%= @host.params['ntp-server'] || '0.fedora.pool.ntp.org' %>\n/usr/sbin/hwclock --systohc\n\n<%= snippet \"subscription_manager_registration\" %>\n\n<% if @host.info['parameters']['realm'] && @host.realm && @host.realm.realm_type == 'FreeIPA' -%>\n<%= snippet \"freeipa_register\" %>\n<% end -%>\n\n# update all the base packages from the updates repository\nyum -t -y -e 0 update\n\n<%= snippet('remote_execution_ssh_keys') %>\n\n<% if chef_enabled %>\n<%= snippet 'chef_client' %>\n<% end -%>\n\n<% if puppet_enabled %>\n<%= snippet 'puppet_setup' %>\n<% end -%>\n\n<% if salt_enabled %>\n<%= snippet 'saltstack_setup' %>\n<% end -%>\n\nsync\n\n<% if @provisioning_type == nil || @provisioning_type == 'host' -%>\n# Inform the build system that we are done.\necho \"Informing Foreman that we are built\"\nwget -q -O /dev/null --no-check-certificate <%= foreman_url('built') %>\n<% end -%>\n) 2>&1 | tee /root/install.post.log\nexit 0\n\n<%= section_end -%>\n","snippet":false,"template_kind_id":6,"locked":true,"default":true,"vendor":"Katello","os_family":null,"job_category":"Miscellaneous","provider_type":null,"description_format":null,"execution_timeout_interval":null}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":2,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-05-20 23:30:43 UTC","id":760,"auditable_id":165,"auditable_name":"Katello Atomic Kickstart Default","auditable_type":"ProvisioningTemplate","action":"destroy","audited_changes":{"name":"Katello Atomic Kickstart Default","template":"<%#\nkind: provision\nname: Katello Atomic Kickstart default\n%>\n\nlang <%= @host.params['lang'] || 'en_US.UTF-8' %>\nkeyboard <%= @host.params['keyboard'] || 'us' %>\ntimezone --utc <%= @host.params['time-zone'] || 'UTC' %>\n\n<% subnet = @host.subnet -%>\n<% if subnet.respond_to?(:dhcp_boot_mode?) -%>\n<% dhcp = subnet.dhcp_boot_mode? && !@static -%>\n<% else -%>\n<% dhcp = !@static -%>\n<% end -%>\n\nnetwork --bootproto <%= dhcp ? 'dhcp' : \"static --ip=#{@host.ip} --netmask=#{subnet.mask} --gateway=#{subnet.gateway} --nameserver=#{[subnet.dns_primary, subnet.dns_secondary].select{ |item| item.present? }.join(',')}\" %> --hostname <%= @host %><%= \" --device=#{@host.mac}\" -%>\n\n# Partition table should create /boot and a volume atomicos\n<% if @dynamic -%>\n%include /tmp/diskpart.cfg\n<% else -%>\n<%= @host.diskLayout %>\n<% end -%>\n\nbootloader --timeout=3\ntext\n\n<% if @host.os.name.match /.*fedora.*/i -%>\nostreesetup --nogpg --osname=fedora-atomic --remote=fedora-atomic --url=<%= @host.param_true?('atomic-upstream') ? \"https://dl.fedoraproject.org/pub/fedora/linux/atomic/#{@host.os.major}/\" : \"#{@host.operatingsystem.medium_uri(@host)}/content/repo/\" %> --ref=fedora-atomic/f<%= @host.os.major %>/<%= @host.architecture %>/docker-host\n<% elsif @host.os.name.match /.*centos.*/i -%>\nostreesetup --nogpg --osname=centos-atomic-host --remote=centos-atomic-host --url=<%= @host.param_true?('atomic-upstream') ? \"http://mirror.centos.org/centos/#{@host.os.major}/atomic/#{@host.architecture}/repo/\" : @host.operatingsystem.medium_uri(@host) %> --ref=centos-atomic-host/<%= @host.os.major %>/<%= @host.architecture %>/standard\n<% else -%>\nostreesetup --nogpg --osname=rhel-atomic-host --remote=rhel-atomic-host --url=file:///install/ostree --ref=rhel-atomic-host/<%= @host.os.major %>/<%= @host.architecture %>/standard\n<% end -%>\nservices --disabled cloud-init,cloud-config,cloud-final,cloud-init-local\nrootpw --iscrypted <%= root_pass %>\n\nreboot\n\n%post\n<%= snippet \"subscription_manager_registration\" %>\n<%= snippet('remote_execution_ssh_keys') %>\n(\n# Report success back to Foreman\ncurl -s -o /dev/null --insecure <%= foreman_url('built') %>\n) 2>&1 | tee /mnt/sysimage/root/install.post.log\n\nexit 0\n\n%end\n","snippet":false,"template_kind_id":6,"locked":true,"default":true,"vendor":"Katello","os_family":null,"job_category":"Miscellaneous","provider_type":null,"description_format":null,"execution_timeout_interval":null}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":11,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-05-20 23:30:42 UTC","id":759,"auditable_id":73,"auditable_name":"pxegrub2_discovery","auditable_type":"ProvisioningTemplate","action":"update","audited_changes":{"template":["<%#\nkind: snippet\nname: pxegrub2_discovery\n-%>\n<%#\ndiscovery image is based on CentOS/RHEL and therefor it is affected by https://bugzilla.redhat.com/show_bug.cgi?id=1259015.\nIn short, before RHEL 7.2 virtio driver didn't have the new persistent naming scheme, causing interfaces to be named eth0, eth1, etc..\nIf you want to enable the new persistent naming scheme and get inteface names like ens3, add net.ifnames=1 to the linuxefi line below.\n-%>\nmenuentry 'Foreman Discovery Image' {\n  linuxefi boot/fdi-image/vmlinuz0 rootflags=loop root=live:/fdi.iso rootfstype=auto ro rd.live.image acpi=force rd.luks=0 rd.md=0 rd.dm=0 rd.lvm=0 rd.bootif=0 rd.neednet=0 nomodeset proxy.url=<%= foreman_server_url %> proxy.type=foreman BOOTIF=01-$net_default_mac\n  initrdefi boot/fdi-image/initrd0.img\n}\n","<%#\nkind: snippet\nname: pxegrub2_discovery\n-%>\n<%#\nRHEL 7 virtio driver does not have persistent naming scheme, causing interfaces\nto be named eth0, eth1, etc.. If you want to enable the new persistent naming\nscheme and get inteface names like ens3, add net.ifnames=1 to the linuxefi line\nbelow. This will not be fixed until RHEL8 due to prevent breaking changes for\nexisting systems. See RHBZ#1259015 for more details.\n\nAnother bug in RHEL 7.4 is affecting $net_default_mac with a trailing slash, in\nthe global template we have a regexp module creating corrected variable $mac\nwhich is used here. See RHBZ#1487107 for more info.\n-%>\nmenuentry 'Foreman Discovery Image' {\n  linuxefi boot/fdi-image-rhel_7-vmlinuz rootflags=loop root=live:/fdi.iso rootfstype=auto ro rd.live.image acpi=force rd.luks=0 rd.md=0 rd.dm=0 rd.lvm=0 rd.bootif=0 rd.neednet=0 nomodeset proxy.url=<%= foreman_server_url %> proxy.type=foreman BOOTIF=01-$mac\n  initrdefi boot/fdi-image-rhel_7-img\n}\n"],"vendor":["Foreman","Satellite"]}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":11,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-05-20 23:30:42 UTC","id":758,"auditable_id":75,"auditable_name":"pxegrub_discovery","auditable_type":"ProvisioningTemplate","action":"update","audited_changes":{"template":["<%#\nkind: snippet\nname: pxegrub_discovery\n-%>\n<%#\ndiscovery image is based on CentOS/RHEL and therefor it is affected by https://bugzilla.redhat.com/show_bug.cgi?id=1259015.\nIn short, before RHEL 7.2 virtio driver didn't have the new persistent naming scheme, causing interfaces to be named eth0, eth1, etc..\nIf you want to enable the new persistent naming scheme and get inteface names like ens3, add net.ifnames=1 to the kernel line below.\n-%>\n# http://projects.theforeman.org/issues/15997\ntitle Foreman Discovery Image - not supported with Grub 1.x\n  kernel boot/fdi-image/vmlinuz0 rootflags=loop root=live:/fdi.iso rootfstype=auto ro rd.live.image acpi=force rd.luks=0 rd.md=0 rd.dm=0 rd.lvm=0 rd.bootif=0 rd.neednet=0 nomodeset proxy.url=<%= foreman_server_url %> proxy.type=foreman BOOTIF=01-$net_default_mac\n  initrd boot/fdi-image/initrd0.img\n","<%#\nkind: snippet\nname: pxegrub_discovery\n-%>\n<%#\ndiscovery image is based on CentOS/RHEL and therefor it is affected by https://bugzilla.redhat.com/show_bug.cgi?id=1259015.\nIn short, before RHEL 7.2 virtio driver didn't have the new persistent naming scheme, causing interfaces to be named eth0, eth1, etc..\nIf you want to enable the new persistent naming scheme and get inteface names like ens3, add net.ifnames=1 to the kernel line below.\n-%>\n# http://projects.theforeman.org/issues/15997\ntitle Foreman Discovery Image - not supported with Grub 1.x\n  kernel boot/fdi-image-rhel_7-vmlinuz rootflags=loop root=live:/fdi.iso rootfstype=auto ro rd.live.image acpi=force rd.luks=0 rd.md=0 rd.dm=0 rd.lvm=0 rd.bootif=0 rd.neednet=0 nomodeset proxy.url=<%= foreman_server_url %> proxy.type=foreman BOOTIF=01-$net_default_mac\n  initrd boot/fdi-image-rhel_7-img\n"],"vendor":["Foreman","Satellite"]}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":11,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-05-20 23:30:42 UTC","id":757,"auditable_id":77,"auditable_name":"pxelinux_discovery","auditable_type":"ProvisioningTemplate","action":"update","audited_changes":{"template":["<%#\nkind: snippet\nname: pxelinux_discovery\n-%>\n<%#\ndiscovery image is based on CentOS/RHEL and therefor it is affected by https://bugzilla.redhat.com/show_bug.cgi?id=1259015.\nIn short, before RHEL 7.2 virtio driver didn't have the new persistent naming scheme, causing interfaces to be named eth0, eth1, etc..\nIf you want to enable the new persistent naming scheme and get inteface names like ens3, add net.ifnames=1 to the APPEND line below.\n-%>\nLABEL discovery\n  MENU LABEL Foreman Discovery Image\n  KERNEL boot/fdi-image/vmlinuz0\n  APPEND initrd=boot/fdi-image/initrd0.img rootflags=loop root=live:/fdi.iso rootfstype=auto ro rd.live.image acpi=force rd.luks=0 rd.md=0 rd.dm=0 rd.lvm=0 rd.bootif=0 rd.neednet=0 nomodeset proxy.url=<%= foreman_server_url %> proxy.type=foreman\n  IPAPPEND 2\n","<%#\nkind: snippet\nname: pxelinux_discovery\n-%>\n<%#\ndiscovery image is based on CentOS/RHEL and therefor it is affected by https://bugzilla.redhat.com/show_bug.cgi?id=1259015.\nIn short, before RHEL 7.2 virtio driver didn't have the new persistent naming scheme, causing interfaces to be named eth0, eth1, etc..\nIf you want to enable the new persistent naming scheme and get inteface names like ens3, add net.ifnames=1 to the APPEND line below.\n-%>\nLABEL discovery\n  MENU LABEL Foreman Discovery Image\n  KERNEL boot/fdi-image-rhel_7-vmlinuz\n  APPEND initrd=boot/fdi-image-rhel_7-img rootflags=loop root=live:/fdi.iso rootfstype=auto ro rd.live.image acpi=force rd.luks=0 rd.md=0 rd.dm=0 rd.lvm=0 rd.bootif=0 rd.neednet=0 nomodeset proxy.url=<%= foreman_server_url %> proxy.type=foreman\n  IPAPPEND 2\n"],"vendor":["Foreman","Satellite"]}},{"user_id":null,"user_type":null,"user_name":null,"version":1,"comment":null,"associated_id":20,"associated_type":"Role","remote_address":null,"associated_name":"Access Insights Viewer","created_at":"2018-05-20 23:30:41 UTC","id":756,"auditable_id":412,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":20,"taxonomy_search":null,"override":false}},{"user_id":null,"user_type":null,"user_name":null,"version":1,"comment":null,"associated_id":21,"associated_type":"Role","remote_address":null,"associated_name":"Access Insights Admin","created_at":"2018-05-20 23:30:40 UTC","id":755,"auditable_id":411,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":21,"taxonomy_search":null,"override":false}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-05-20 23:30:39 UTC","id":754,"auditable_id":165,"auditable_name":null,"auditable_type":"ProvisioningTemplate","action":"create","audited_changes":{"name":"Katello Atomic Kickstart Default","template":"<%#\nkind: provision\nname: Katello Atomic Kickstart default\n%>\n\nlang <%= @host.params['lang'] || 'en_US.UTF-8' %>\nkeyboard <%= @host.params['keyboard'] || 'us' %>\ntimezone --utc <%= @host.params['time-zone'] || 'UTC' %>\n\n<% subnet = @host.subnet -%>\n<% if subnet.respond_to?(:dhcp_boot_mode?) -%>\n<% dhcp = subnet.dhcp_boot_mode? && !@static -%>\n<% else -%>\n<% dhcp = !@static -%>\n<% end -%>\n\nnetwork --bootproto <%= dhcp ? 'dhcp' : \"static --ip=#{@host.ip} --netmask=#{subnet.mask} --gateway=#{subnet.gateway} --nameserver=#{[subnet.dns_primary, subnet.dns_secondary].select{ |item| item.present? }.join(',')}\" %> --hostname <%= @host %><%= \" --device=#{@host.mac}\" -%>\n\n# Partition table should create /boot and a volume atomicos\n<% if @dynamic -%>\n%include /tmp/diskpart.cfg\n<% else -%>\n<%= @host.diskLayout %>\n<% end -%>\n\nbootloader --timeout=3\ntext\n\n<% if @host.os.name.match /.*fedora.*/i -%>\nostreesetup --nogpg --osname=fedora-atomic --remote=fedora-atomic --url=<%= @host.param_true?('atomic-upstream') ? \"https://dl.fedoraproject.org/pub/fedora/linux/atomic/#{@host.os.major}/\" : \"#{@host.operatingsystem.medium_uri(@host)}/content/repo/\" %> --ref=fedora-atomic/f<%= @host.os.major %>/<%= @host.architecture %>/docker-host\n<% elsif @host.os.name.match /.*centos.*/i -%>\nostreesetup --nogpg --osname=centos-atomic-host --remote=centos-atomic-host --url=<%= @host.param_true?('atomic-upstream') ? \"http://mirror.centos.org/centos/#{@host.os.major}/atomic/#{@host.architecture}/repo/\" : @host.operatingsystem.medium_uri(@host) %> --ref=centos-atomic-host/<%= @host.os.major %>/<%= @host.architecture %>/standard\n<% else -%>\nostreesetup --nogpg --osname=rhel-atomic-host --remote=rhel-atomic-host --url=file:///install/ostree --ref=rhel-atomic-host/<%= @host.os.major %>/<%= @host.architecture %>/standard\n<% end -%>\nservices --disabled cloud-init,cloud-config,cloud-final,cloud-init-local\nrootpw --iscrypted <%= root_pass %>\n\nreboot\n\n%post\n<%= snippet \"subscription_manager_registration\" %>\n<%= snippet('remote_execution_ssh_keys') %>\n(\n# Report success back to Foreman\ncurl -s -o /dev/null --insecure <%= foreman_url('built') %>\n) 2>&1 | tee /mnt/sysimage/root/install.post.log\n\nexit 0\n\n%end\n","snippet":false,"template_kind_id":6,"locked":true,"default":true,"vendor":"Katello","os_family":null,"job_category":"Miscellaneous","provider_type":null,"description_format":null,"execution_timeout_interval":null}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-05-20 23:30:39 UTC","id":753,"auditable_id":164,"auditable_name":null,"auditable_type":"ProvisioningTemplate","action":"create","audited_changes":{"name":"Katello Kickstart Default Finish","template":"<%#\nkind: finish\nname: Katello Kickstart default finish\noses:\n- CentOS 5\n- CentOS 6\n- CentOS 7\n- RedHat 5\n- RedHat 6\n- RedHat 7\n- Fedora 19\n- Fedora 20\n%>\n<% if @host.subnet.respond_to?(:dhcp_boot_mode?) -%>\n<%= snippet 'kickstart_networking_setup' %>\nservice network restart\n<% end -%>\n\n<%\n  rhel_compatible = @host.operatingsystem.family == 'Redhat' && @host.operatingsystem.name != 'Fedora'\n  os_major = @host.operatingsystem.major.to_i\n  pm_set = @host.puppetmaster.empty? ? false : true\n  puppet_enabled = pm_set || @host.params['force-puppet']\n  salt_enabled = @host.params['salt_master'] ? true : false\n  chef_enabled = @host.respond_to?(:chef_proxy) && @host.chef_proxy\n%>\n\n<%= snippet \"subscription_manager_registration\" %>\n\n<% if @host.respond_to?(:realm) && @host.otp && @host.realm && @host.realm.realm_type == \"FreeIPA\" -%>\n<%= snippet \"freeipa_register\" %>\n<% end -%>\n\n# update local time\necho \"updating system time\"\n/usr/sbin/ntpdate -sub <%= @host.params['ntp-server'] || '0.fedora.pool.ntp.org' %>\n/usr/sbin/hwclock --systohc\n\n<% if @host.info['parameters']['realm'] && @host.realm && @host.realm.realm_type == 'FreeIPA' -%>\n<%= snippet \"freeipa_register\" %>\n<% end -%>\n\n# update all the base packages from the updates repository\nyum -t -y -e 0 update\n\n<%= snippet('remote_execution_ssh_keys') %>\n\n<% if chef_enabled %>\n<%= snippet 'chef_client' %>\n<% end -%>\n\n<% if puppet_enabled %>\n<%= snippet 'puppet_setup' %>\n<% end -%>\n\n<% if salt_enabled %>\n<%= snippet 'saltstack_setup' %>\n<% end -%>\n\nexit 0\n","snippet":false,"template_kind_id":7,"locked":true,"default":true,"vendor":"Katello","os_family":null,"job_category":"Miscellaneous","provider_type":null,"description_format":null,"execution_timeout_interval":null}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-05-20 23:30:39 UTC","id":752,"auditable_id":163,"auditable_name":null,"auditable_type":"ProvisioningTemplate","action":"create","audited_changes":{"name":"Katello Kickstart Default User Data","template":"<%#\nkind: user_data\nname: Katello Kickstart default user data\noses:\n- CentOS 6\n- CentOS 7\n- Fedora 19\n- Fedora 20\n- Fedora 21\n- Fedora 22\n- Fedora 23\n-%>\n#cloud-config\nhostname: <%= @host.shortname %>\nfqdn: <%= @host %>\nmanage_etc_hosts: true\n\ngroups:\n - admin\n\nusers:\n - default\n - name: admin\n   primary-group: admin\n   groups: users\n   shell: /bin/bash\n   sudo: ['ALL=(ALL) ALL']\n   lock-passwd: false\n   passwd: <%= @host.root_pass %>\n\n<%# Allow user to specify additional SSH key as host paramter -%>\n<% if @host.params['sshkey'].present? || @host.params['remote_execution_ssh_keys'].present? -%>\nssh_authorized_keys:\n<% if @host.params['sshkey'].present? -%>\n  - <%= @host.params['sshkey'] %>\n<% end -%>\n<% if @host.params['remote_execution_ssh_keys'].present? -%>\n<% @host.params['remote_execution_ssh_keys'].each do |key| -%>\n  - <%= key %>\n<% end -%>\n<% end -%>\n<% end -%>\nwrite_files:\n- path: /tmp/foreman-userdata.sh\n  permissions: '0755'\n  content: |\n    #!/bin/bash\n<%= indent 4 do\n      snippet 'subscription_manager_registration'\n    end %>\n<% if @host.info['parameters']['realm'] && @host.realm && @host.realm.realm_type == 'FreeIPA' -%>\n<%= indent 4 do\n      snippet 'freeipa_register'\n    end %>\n<% end -%>\n  <% unless @host.operatingsystem.atomic? -%>\n    # update all the base packages from the updates repository\n    yum -t -y -e 0 update\n  <% end -%>\n<%\n  # safemode renderer does not support unary negation\n  non_atomic = @host.operatingsystem.atomic? ? false : true\n  pm_set = @host.puppetmaster.empty? ? false : true\n  puppet_enabled = non_atomic && (pm_set || @host.params['force-puppet'])\n  salt_enabled = non_atomic && (@host.params['salt_master'] ? true : false)\n  chef_enabled = @host.respond_to?(:chef_proxy) && @host.chef_proxy\n%>\n<% if chef_enabled %>\n<%= indent 4 do\n      snippet 'chef_client'\n    end  %>\n<% end -%>\n\n<% if puppet_enabled %>\n<%= indent 4 do\n      snippet 'puppet_setup'\n    end %>\n<% end -%>\n\n<% if salt_enabled %>\n<%= indent 4 do\n      snippet 'saltstack_setup'\n    end %>\n<% end -%>\nphone_home:\n url: <%= foreman_url('built') %>\n post: []\n tries: 10\nruncmd:\n - [ cloud-init-per, once, foreman-userdata, /tmp/foreman-userdata.sh ]\noutput: {all: '| tee -a /root/install.userdata.log'}\n\n","snippet":false,"template_kind_id":9,"locked":true,"default":true,"vendor":"Katello","os_family":null,"job_category":"Miscellaneous","provider_type":null,"description_format":null,"execution_timeout_interval":null}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-05-20 23:30:38 UTC","id":751,"auditable_id":162,"auditable_name":null,"auditable_type":"ProvisioningTemplate","action":"create","audited_changes":{"name":"Katello Kickstart Default","template":"<%#\nkind: provision\nname: Katello Kickstart default\noses:\n- CentOS 5\n- CentOS 6\n- CentOS 7\n- RedHat 5\n- RedHat 6\n- RedHat 7\n- Fedora 19\n- Fedora 20\n%>\n<%\n  rhel_compatible = @host.operatingsystem.family == 'Redhat' && @host.operatingsystem.name != 'Fedora'\n  os_major = @host.operatingsystem.major.to_i\n  # safemode renderer does not support unary negation\n  pm_set = @host.puppetmaster.empty? ? false : true\n  puppet_enabled = pm_set || @host.params['force-puppet']\n  salt_enabled = @host.params['salt_master'] ? true : false\n  chef_enabled = @host.respond_to?(:chef_proxy) && @host.chef_proxy\n  section_end = (rhel_compatible && os_major <= 5) ? '' : '%end'\n%>\ninstall\n<%= @mediapath %>\nlang en_US.UTF-8\nselinux --enforcing\nkeyboard us\nskipx\n\n<% subnet = @host.subnet -%>\n<% if subnet.respond_to?(:dhcp_boot_mode?) -%>\n<% dhcp = subnet.dhcp_boot_mode? && !@static -%>\n<% else -%>\n<% dhcp = !@static -%>\n<% end -%>\n\nnetwork --bootproto <%= dhcp ? 'dhcp' : \"static --ip=#{@host.ip} --netmask=#{subnet.mask} --gateway=#{subnet.gateway} --nameserver=#{[subnet.dns_primary, subnet.dns_secondary].select{ |item| item.present? }.join(',')}\" %> --hostname <%= @host %><%= os_major >= 6 ? \" --device=#{@host.mac}\" : '' -%>\n\nrootpw --iscrypted <%= root_pass %>\nfirewall --<%= os_major >= 6 ? 'service=' : '' %>ssh\nauthconfig --useshadow --passalgo=<%= @host.operatingsystem.password_hash || 'sha256' %> --kickstart\ntimezone --utc <%= @host.params['time-zone'] || 'UTC' %>\n\n<% if @host.operatingsystem.name == 'Fedora' and os_major <= 16 -%>\n# Bootloader exception for Fedora 16:\nbootloader --append=\"nofb quiet splash=quiet <%=ks_console%>\" <%= grub_pass %>\npart biosboot --fstype=biosboot --size=1\n<% else -%>\nbootloader --location=mbr --append=\"nofb quiet splash=quiet\" <%= grub_pass %>\n<% end -%>\n\n<% if os_major == 5 -%>\nkey --skip\n<% end -%>\n\n<% if @dynamic -%>\n%include /tmp/diskpart.cfg\n<% else -%>\n<%= @host.diskLayout %>\n<% end -%>\n\ntext\nreboot\n\n%packages --ignoremissing\nyum\ndhclient\nntp\nwget\n@Core\n<%= section_end -%>\n\n<% if @dynamic -%>\n%pre\n<%= @host.diskLayout %>\n<%= section_end -%>\n<% end -%>\n\n%post --nochroot\nexec < /dev/tty3 > /dev/tty3\n#changing to VT 3 so that we can see whats going on....\n/usr/bin/chvt 3\n(\ncp -va /etc/resolv.conf /mnt/sysimage/etc/resolv.conf\n/usr/bin/chvt 1\n) 2>&1 | tee /mnt/sysimage/root/install.postnochroot.log\n<%= section_end -%>\n\n\n%post\nlogger \"Starting anaconda <%= @host %> postinstall\"\nexec < /dev/tty3 > /dev/tty3\n#changing to VT 3 so that we can see whats going on....\n/usr/bin/chvt 3\n(\n<% if subnet.respond_to?(:dhcp_boot_mode?) -%>\n<%= snippet 'kickstart_networking_setup' %>\n<% end -%>\n\n#update local time\necho \"updating system time\"\n/usr/sbin/ntpdate -sub <%= @host.params['ntp-server'] || '0.fedora.pool.ntp.org' %>\n/usr/sbin/hwclock --systohc\n\n<%= snippet \"subscription_manager_registration\" %>\n\n<% if @host.info['parameters']['realm'] && @host.realm && @host.realm.realm_type == 'FreeIPA' -%>\n<%= snippet \"freeipa_register\" %>\n<% end -%>\n\n# update all the base packages from the updates repository\nyum -t -y -e 0 update\n\n<%= snippet('remote_execution_ssh_keys') %>\n\n<% if chef_enabled %>\n<%= snippet 'chef_client' %>\n<% end -%>\n\n<% if puppet_enabled %>\n<%= snippet 'puppet_setup' %>\n<% end -%>\n\n<% if salt_enabled %>\n<%= snippet 'saltstack_setup' %>\n<% end -%>\n\nsync\n\n<% if @provisioning_type == nil || @provisioning_type == 'host' -%>\n# Inform the build system that we are done.\necho \"Informing Foreman that we are built\"\nwget -q -O /dev/null --no-check-certificate <%= foreman_url('built') %>\n<% end -%>\n) 2>&1 | tee /root/install.post.log\nexit 0\n\n<%= section_end -%>\n","snippet":false,"template_kind_id":6,"locked":true,"default":true,"vendor":"Katello","os_family":null,"job_category":"Miscellaneous","provider_type":null,"description_format":null,"execution_timeout_interval":null}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":2,"comment":null,"associated_id":21,"associated_type":"Role","remote_address":null,"associated_name":"Access Insights Admin","created_at":"2018-05-20 23:18:36 UTC","id":750,"auditable_id":409,"auditable_name":"view_hosts","auditable_type":"Filter","action":"destroy","audited_changes":{"search":null,"role_id":21,"taxonomy_search":null,"override":false}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":2,"comment":null,"associated_id":20,"associated_type":"Role","remote_address":null,"associated_name":"Access Insights Viewer","created_at":"2018-05-20 23:18:36 UTC","id":749,"auditable_id":410,"auditable_name":"view_hosts","auditable_type":"Filter","action":"destroy","audited_changes":{"search":null,"role_id":20,"taxonomy_search":null,"override":false}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":2,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-05-20 23:18:09 UTC","id":748,"auditable_id":159,"auditable_name":"Katello Kickstart Default User Data","auditable_type":"ProvisioningTemplate","action":"destroy","audited_changes":{"name":"Katello Kickstart Default User Data","template":"<%#\nkind: user_data\nname: Katello Kickstart default user data\noses:\n- CentOS 6\n- CentOS 7\n- Fedora 19\n- Fedora 20\n- Fedora 21\n- Fedora 22\n- Fedora 23\n-%>\n#cloud-config\nhostname: <%= @host.shortname %>\nfqdn: <%= @host %>\nmanage_etc_hosts: true\n\ngroups:\n - admin\n\nusers:\n - default\n - name: admin\n   primary-group: admin\n   groups: users\n   shell: /bin/bash\n   sudo: ['ALL=(ALL) ALL']\n   lock-passwd: false\n   passwd: <%= @host.root_pass %>\n\n<%# Allow user to specify additional SSH key as host paramter -%>\n<% if @host.params['sshkey'].present? || @host.params['remote_execution_ssh_keys'].present? -%>\nssh_authorized_keys:\n<% if @host.params['sshkey'].present? -%>\n  - <%= @host.params['sshkey'] %>\n<% end -%>\n<% if @host.params['remote_execution_ssh_keys'].present? -%>\n<% @host.params['remote_execution_ssh_keys'].each do |key| -%>\n  - <%= key %>\n<% end -%>\n<% end -%>\n<% end -%>\nwrite_files:\n- path: /tmp/foreman-userdata.sh\n  permissions: '0755'\n  content: |\n    #!/bin/bash\n<%= indent 4 do\n      snippet 'subscription_manager_registration'\n    end %>\n<% if @host.info['parameters']['realm'] && @host.realm && @host.realm.realm_type == 'FreeIPA' -%>\n<%= indent 4 do\n      snippet 'freeipa_register'\n    end %>\n<% end -%>\n  <% unless @host.operatingsystem.atomic? -%>\n    # update all the base packages from the updates repository\n    yum -t -y -e 0 update\n  <% end -%>\n<%\n  # safemode renderer does not support unary negation\n  non_atomic = @host.operatingsystem.atomic? ? false : true\n  pm_set = @host.puppetmaster.empty? ? false : true\n  puppet_enabled = non_atomic && (pm_set || @host.params['force-puppet'])\n  salt_enabled = non_atomic && (@host.params['salt_master'] ? true : false)\n  chef_enabled = @host.respond_to?(:chef_proxy) && @host.chef_proxy\n%>\n<% if chef_enabled %>\n<%= indent 4 do\n      snippet 'chef_client'\n    end  %>\n<% end -%>\n\n<% if puppet_enabled %>\n<%= indent 4 do\n      snippet 'puppet_setup'\n    end %>\n<% end -%>\n\n<% if salt_enabled %>\n<%= indent 4 do\n      snippet 'saltstack_setup'\n    end %>\n<% end -%>\nphone_home:\n url: <%= foreman_url('built') %>\n post: []\n tries: 10\nruncmd:\n - [ cloud-init-per, once, foreman-userdata, /tmp/foreman-userdata.sh ]\noutput: {all: '| tee -a /root/install.userdata.log'}\n\n","snippet":false,"template_kind_id":9,"locked":true,"default":true,"vendor":"Katello","os_family":null,"job_category":"Miscellaneous","provider_type":null,"description_format":null,"execution_timeout_interval":null}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":2,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-05-20 23:18:09 UTC","id":747,"auditable_id":160,"auditable_name":"Katello Kickstart Default Finish","auditable_type":"ProvisioningTemplate","action":"destroy","audited_changes":{"name":"Katello Kickstart Default Finish","template":"<%#\nkind: finish\nname: Katello Kickstart default finish\noses:\n- CentOS 5\n- CentOS 6\n- CentOS 7\n- RedHat 5\n- RedHat 6\n- RedHat 7\n- Fedora 19\n- Fedora 20\n%>\n<% if @host.subnet.respond_to?(:dhcp_boot_mode?) -%>\n<%= snippet 'kickstart_networking_setup' %>\nservice network restart\n<% end -%>\n\n<%\n  rhel_compatible = @host.operatingsystem.family == 'Redhat' && @host.operatingsystem.name != 'Fedora'\n  os_major = @host.operatingsystem.major.to_i\n  pm_set = @host.puppetmaster.empty? ? false : true\n  puppet_enabled = pm_set || @host.params['force-puppet']\n  salt_enabled = @host.params['salt_master'] ? true : false\n  chef_enabled = @host.respond_to?(:chef_proxy) && @host.chef_proxy\n%>\n\n<%= snippet \"subscription_manager_registration\" %>\n\n<% if @host.respond_to?(:realm) && @host.otp && @host.realm && @host.realm.realm_type == \"FreeIPA\" -%>\n<%= snippet \"freeipa_register\" %>\n<% end -%>\n\n# update local time\necho \"updating system time\"\n/usr/sbin/ntpdate -sub <%= @host.params['ntp-server'] || '0.fedora.pool.ntp.org' %>\n/usr/sbin/hwclock --systohc\n\n<% if @host.info['parameters']['realm'] && @host.realm && @host.realm.realm_type == 'FreeIPA' -%>\n<%= snippet \"freeipa_register\" %>\n<% end -%>\n\n# update all the base packages from the updates repository\nyum -t -y -e 0 update\n\n<%= snippet('remote_execution_ssh_keys') %>\n\n<% if chef_enabled %>\n<%= snippet 'chef_client' %>\n<% end -%>\n\n<% if puppet_enabled %>\n<%= snippet 'puppet_setup' %>\n<% end -%>\n\n<% if salt_enabled %>\n<%= snippet 'saltstack_setup' %>\n<% end -%>\n\nexit 0\n","snippet":false,"template_kind_id":7,"locked":true,"default":true,"vendor":"Katello","os_family":null,"job_category":"Miscellaneous","provider_type":null,"description_format":null,"execution_timeout_interval":null}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":2,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-05-20 23:18:09 UTC","id":746,"auditable_id":158,"auditable_name":"Katello Kickstart Default","auditable_type":"ProvisioningTemplate","action":"destroy","audited_changes":{"name":"Katello Kickstart Default","template":"<%#\nkind: provision\nname: Katello Kickstart default\noses:\n- CentOS 5\n- CentOS 6\n- CentOS 7\n- RedHat 5\n- RedHat 6\n- RedHat 7\n- Fedora 19\n- Fedora 20\n%>\n<%\n  rhel_compatible = @host.operatingsystem.family == 'Redhat' && @host.operatingsystem.name != 'Fedora'\n  os_major = @host.operatingsystem.major.to_i\n  # safemode renderer does not support unary negation\n  pm_set = @host.puppetmaster.empty? ? false : true\n  puppet_enabled = pm_set || @host.params['force-puppet']\n  salt_enabled = @host.params['salt_master'] ? true : false\n  chef_enabled = @host.respond_to?(:chef_proxy) && @host.chef_proxy\n  section_end = (rhel_compatible && os_major <= 5) ? '' : '%end'\n%>\ninstall\n<%= @mediapath %>\nlang en_US.UTF-8\nselinux --enforcing\nkeyboard us\nskipx\n\n<% subnet = @host.subnet -%>\n<% if subnet.respond_to?(:dhcp_boot_mode?) -%>\n<% dhcp = subnet.dhcp_boot_mode? && !@static -%>\n<% else -%>\n<% dhcp = !@static -%>\n<% end -%>\n\nnetwork --bootproto <%= dhcp ? 'dhcp' : \"static --ip=#{@host.ip} --netmask=#{subnet.mask} --gateway=#{subnet.gateway} --nameserver=#{[subnet.dns_primary, subnet.dns_secondary].select{ |item| item.present? }.join(',')}\" %> --hostname <%= @host %><%= os_major >= 6 ? \" --device=#{@host.mac}\" : '' -%>\n\nrootpw --iscrypted <%= root_pass %>\nfirewall --<%= os_major >= 6 ? 'service=' : '' %>ssh\nauthconfig --useshadow --passalgo=<%= @host.operatingsystem.password_hash || 'sha256' %> --kickstart\ntimezone --utc <%= @host.params['time-zone'] || 'UTC' %>\n\n<% if @host.operatingsystem.name == 'Fedora' and os_major <= 16 -%>\n# Bootloader exception for Fedora 16:\nbootloader --append=\"nofb quiet splash=quiet <%=ks_console%>\" <%= grub_pass %>\npart biosboot --fstype=biosboot --size=1\n<% else -%>\nbootloader --location=mbr --append=\"nofb quiet splash=quiet\" <%= grub_pass %>\n<% end -%>\n\n<% if os_major == 5 -%>\nkey --skip\n<% end -%>\n\n<% if @dynamic -%>\n%include /tmp/diskpart.cfg\n<% else -%>\n<%= @host.diskLayout %>\n<% end -%>\n\ntext\nreboot\n\n%packages --ignoremissing\nyum\ndhclient\nntp\nwget\n@Core\n<%= section_end -%>\n\n<% if @dynamic -%>\n%pre\n<%= @host.diskLayout %>\n<%= section_end -%>\n<% end -%>\n\n%post --nochroot\nexec < /dev/tty3 > /dev/tty3\n#changing to VT 3 so that we can see whats going on....\n/usr/bin/chvt 3\n(\ncp -va /etc/resolv.conf /mnt/sysimage/etc/resolv.conf\n/usr/bin/chvt 1\n) 2>&1 | tee /mnt/sysimage/root/install.postnochroot.log\n<%= section_end -%>\n\n\n%post\nlogger \"Starting anaconda <%= @host %> postinstall\"\nexec < /dev/tty3 > /dev/tty3\n#changing to VT 3 so that we can see whats going on....\n/usr/bin/chvt 3\n(\n<% if subnet.respond_to?(:dhcp_boot_mode?) -%>\n<%= snippet 'kickstart_networking_setup' %>\n<% end -%>\n\n#update local time\necho \"updating system time\"\n/usr/sbin/ntpdate -sub <%= @host.params['ntp-server'] || '0.fedora.pool.ntp.org' %>\n/usr/sbin/hwclock --systohc\n\n<%= snippet \"subscription_manager_registration\" %>\n\n<% if @host.info['parameters']['realm'] && @host.realm && @host.realm.realm_type == 'FreeIPA' -%>\n<%= snippet \"freeipa_register\" %>\n<% end -%>\n\n# update all the base packages from the updates repository\nyum -t -y -e 0 update\n\n<%= snippet('remote_execution_ssh_keys') %>\n\n<% if chef_enabled %>\n<%= snippet 'chef_client' %>\n<% end -%>\n\n<% if puppet_enabled %>\n<%= snippet 'puppet_setup' %>\n<% end -%>\n\n<% if salt_enabled %>\n<%= snippet 'saltstack_setup' %>\n<% end -%>\n\nsync\n\n<% if @provisioning_type == nil || @provisioning_type == 'host' -%>\n# Inform the build system that we are done.\necho \"Informing Foreman that we are built\"\nwget -q -O /dev/null --no-check-certificate <%= foreman_url('built') %>\n<% end -%>\n) 2>&1 | tee /root/install.post.log\nexit 0\n\n<%= section_end -%>\n","snippet":false,"template_kind_id":6,"locked":true,"default":true,"vendor":"Katello","os_family":null,"job_category":"Miscellaneous","provider_type":null,"description_format":null,"execution_timeout_interval":null}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":2,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-05-20 23:18:08 UTC","id":745,"auditable_id":161,"auditable_name":"Katello Atomic Kickstart Default","auditable_type":"ProvisioningTemplate","action":"destroy","audited_changes":{"name":"Katello Atomic Kickstart Default","template":"<%#\nkind: provision\nname: Katello Atomic Kickstart default\n%>\n\nlang <%= @host.params['lang'] || 'en_US.UTF-8' %>\nkeyboard <%= @host.params['keyboard'] || 'us' %>\ntimezone --utc <%= @host.params['time-zone'] || 'UTC' %>\n\n<% subnet = @host.subnet -%>\n<% if subnet.respond_to?(:dhcp_boot_mode?) -%>\n<% dhcp = subnet.dhcp_boot_mode? && !@static -%>\n<% else -%>\n<% dhcp = !@static -%>\n<% end -%>\n\nnetwork --bootproto <%= dhcp ? 'dhcp' : \"static --ip=#{@host.ip} --netmask=#{subnet.mask} --gateway=#{subnet.gateway} --nameserver=#{[subnet.dns_primary, subnet.dns_secondary].select{ |item| item.present? }.join(',')}\" %> --hostname <%= @host %><%= \" --device=#{@host.mac}\" -%>\n\n# Partition table should create /boot and a volume atomicos\n<% if @dynamic -%>\n%include /tmp/diskpart.cfg\n<% else -%>\n<%= @host.diskLayout %>\n<% end -%>\n\nbootloader --timeout=3\ntext\n\n<% if @host.os.name.match /.*fedora.*/i -%>\nostreesetup --nogpg --osname=fedora-atomic --remote=fedora-atomic --url=<%= @host.param_true?('atomic-upstream') ? \"https://dl.fedoraproject.org/pub/fedora/linux/atomic/#{@host.os.major}/\" : \"#{@host.operatingsystem.medium_uri(@host)}/content/repo/\" %> --ref=fedora-atomic/f<%= @host.os.major %>/<%= @host.architecture %>/docker-host\n<% elsif @host.os.name.match /.*centos.*/i -%>\nostreesetup --nogpg --osname=centos-atomic-host --remote=centos-atomic-host --url=<%= @host.param_true?('atomic-upstream') ? \"http://mirror.centos.org/centos/#{@host.os.major}/atomic/#{@host.architecture}/repo/\" : @host.operatingsystem.medium_uri(@host) %> --ref=centos-atomic-host/<%= @host.os.major %>/<%= @host.architecture %>/standard\n<% else -%>\nostreesetup --nogpg --osname=rhel-atomic-host --remote=rhel-atomic-host --url=file:///install/ostree --ref=rhel-atomic-host/<%= @host.os.major %>/<%= @host.architecture %>/standard\n<% end -%>\nservices --disabled cloud-init,cloud-config,cloud-final,cloud-init-local\nrootpw --iscrypted <%= root_pass %>\n\nreboot\n\n%post\n<%= snippet \"subscription_manager_registration\" %>\n<%= snippet('remote_execution_ssh_keys') %>\n(\n# Report success back to Foreman\ncurl -s -o /dev/null --insecure <%= foreman_url('built') %>\n) 2>&1 | tee /mnt/sysimage/root/install.post.log\n\nexit 0\n\n%end\n","snippet":false,"template_kind_id":6,"locked":true,"default":true,"vendor":"Katello","os_family":null,"job_category":"Miscellaneous","provider_type":null,"description_format":null,"execution_timeout_interval":null}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":10,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-05-20 23:18:06 UTC","id":744,"auditable_id":73,"auditable_name":"pxegrub2_discovery","auditable_type":"ProvisioningTemplate","action":"update","audited_changes":{"template":["<%#\nkind: snippet\nname: pxegrub2_discovery\n-%>\n<%#\ndiscovery image is based on CentOS/RHEL and therefor it is affected by https://bugzilla.redhat.com/show_bug.cgi?id=1259015.\nIn short, before RHEL 7.2 virtio driver didn't have the new persistent naming scheme, causing interfaces to be named eth0, eth1, etc..\nIf you want to enable the new persistent naming scheme and get inteface names like ens3, add net.ifnames=1 to the linuxefi line below.\n-%>\nmenuentry 'Foreman Discovery Image' {\n  linuxefi boot/fdi-image/vmlinuz0 rootflags=loop root=live:/fdi.iso rootfstype=auto ro rd.live.image acpi=force rd.luks=0 rd.md=0 rd.dm=0 rd.lvm=0 rd.bootif=0 rd.neednet=0 nomodeset proxy.url=<%= foreman_server_url %> proxy.type=foreman BOOTIF=01-$net_default_mac\n  initrdefi boot/fdi-image/initrd0.img\n}\n","<%#\nkind: snippet\nname: pxegrub2_discovery\n-%>\n<%#\nRHEL 7 virtio driver does not have persistent naming scheme, causing interfaces\nto be named eth0, eth1, etc.. If you want to enable the new persistent naming\nscheme and get inteface names like ens3, add net.ifnames=1 to the linuxefi line\nbelow. This will not be fixed until RHEL8 due to prevent breaking changes for\nexisting systems. See RHBZ#1259015 for more details.\n\nAnother bug in RHEL 7.4 is affecting $net_default_mac with a trailing slash, in\nthe global template we have a regexp module creating corrected variable $mac\nwhich is used here. See RHBZ#1487107 for more info.\n-%>\nmenuentry 'Foreman Discovery Image' {\n  linuxefi boot/fdi-image-rhel_7-vmlinuz rootflags=loop root=live:/fdi.iso rootfstype=auto ro rd.live.image acpi=force rd.luks=0 rd.md=0 rd.dm=0 rd.lvm=0 rd.bootif=0 rd.neednet=0 nomodeset proxy.url=<%= foreman_server_url %> proxy.type=foreman BOOTIF=01-$mac\n  initrdefi boot/fdi-image-rhel_7-img\n}\n"],"vendor":["Foreman","Satellite"]}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":10,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-05-20 23:18:06 UTC","id":743,"auditable_id":75,"auditable_name":"pxegrub_discovery","auditable_type":"ProvisioningTemplate","action":"update","audited_changes":{"template":["<%#\nkind: snippet\nname: pxegrub_discovery\n-%>\n<%#\ndiscovery image is based on CentOS/RHEL and therefor it is affected by https://bugzilla.redhat.com/show_bug.cgi?id=1259015.\nIn short, before RHEL 7.2 virtio driver didn't have the new persistent naming scheme, causing interfaces to be named eth0, eth1, etc..\nIf you want to enable the new persistent naming scheme and get inteface names like ens3, add net.ifnames=1 to the kernel line below.\n-%>\n# http://projects.theforeman.org/issues/15997\ntitle Foreman Discovery Image - not supported with Grub 1.x\n  kernel boot/fdi-image/vmlinuz0 rootflags=loop root=live:/fdi.iso rootfstype=auto ro rd.live.image acpi=force rd.luks=0 rd.md=0 rd.dm=0 rd.lvm=0 rd.bootif=0 rd.neednet=0 nomodeset proxy.url=<%= foreman_server_url %> proxy.type=foreman BOOTIF=01-$net_default_mac\n  initrd boot/fdi-image/initrd0.img\n","<%#\nkind: snippet\nname: pxegrub_discovery\n-%>\n<%#\ndiscovery image is based on CentOS/RHEL and therefor it is affected by https://bugzilla.redhat.com/show_bug.cgi?id=1259015.\nIn short, before RHEL 7.2 virtio driver didn't have the new persistent naming scheme, causing interfaces to be named eth0, eth1, etc..\nIf you want to enable the new persistent naming scheme and get inteface names like ens3, add net.ifnames=1 to the kernel line below.\n-%>\n# http://projects.theforeman.org/issues/15997\ntitle Foreman Discovery Image - not supported with Grub 1.x\n  kernel boot/fdi-image-rhel_7-vmlinuz rootflags=loop root=live:/fdi.iso rootfstype=auto ro rd.live.image acpi=force rd.luks=0 rd.md=0 rd.dm=0 rd.lvm=0 rd.bootif=0 rd.neednet=0 nomodeset proxy.url=<%= foreman_server_url %> proxy.type=foreman BOOTIF=01-$net_default_mac\n  initrd boot/fdi-image-rhel_7-img\n"],"vendor":["Foreman","Satellite"]}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":10,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-05-20 23:18:06 UTC","id":742,"auditable_id":77,"auditable_name":"pxelinux_discovery","auditable_type":"ProvisioningTemplate","action":"update","audited_changes":{"template":["<%#\nkind: snippet\nname: pxelinux_discovery\n-%>\n<%#\ndiscovery image is based on CentOS/RHEL and therefor it is affected by https://bugzilla.redhat.com/show_bug.cgi?id=1259015.\nIn short, before RHEL 7.2 virtio driver didn't have the new persistent naming scheme, causing interfaces to be named eth0, eth1, etc..\nIf you want to enable the new persistent naming scheme and get inteface names like ens3, add net.ifnames=1 to the APPEND line below.\n-%>\nLABEL discovery\n  MENU LABEL Foreman Discovery Image\n  KERNEL boot/fdi-image/vmlinuz0\n  APPEND initrd=boot/fdi-image/initrd0.img rootflags=loop root=live:/fdi.iso rootfstype=auto ro rd.live.image acpi=force rd.luks=0 rd.md=0 rd.dm=0 rd.lvm=0 rd.bootif=0 rd.neednet=0 nomodeset proxy.url=<%= foreman_server_url %> proxy.type=foreman\n  IPAPPEND 2\n","<%#\nkind: snippet\nname: pxelinux_discovery\n-%>\n<%#\ndiscovery image is based on CentOS/RHEL and therefor it is affected by https://bugzilla.redhat.com/show_bug.cgi?id=1259015.\nIn short, before RHEL 7.2 virtio driver didn't have the new persistent naming scheme, causing interfaces to be named eth0, eth1, etc..\nIf you want to enable the new persistent naming scheme and get inteface names like ens3, add net.ifnames=1 to the APPEND line below.\n-%>\nLABEL discovery\n  MENU LABEL Foreman Discovery Image\n  KERNEL boot/fdi-image-rhel_7-vmlinuz\n  APPEND initrd=boot/fdi-image-rhel_7-img rootflags=loop root=live:/fdi.iso rootfstype=auto ro rd.live.image acpi=force rd.luks=0 rd.md=0 rd.dm=0 rd.lvm=0 rd.bootif=0 rd.neednet=0 nomodeset proxy.url=<%= foreman_server_url %> proxy.type=foreman\n  IPAPPEND 2\n"],"vendor":["Foreman","Satellite"]}},{"user_id":null,"user_type":null,"user_name":null,"version":1,"comment":null,"associated_id":20,"associated_type":"Role","remote_address":null,"associated_name":"Access Insights Viewer","created_at":"2018-05-20 23:18:05 UTC","id":741,"auditable_id":410,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":20,"taxonomy_search":null,"override":false}},{"user_id":null,"user_type":null,"user_name":null,"version":1,"comment":null,"associated_id":21,"associated_type":"Role","remote_address":null,"associated_name":"Access Insights Admin","created_at":"2018-05-20 23:18:05 UTC","id":740,"auditable_id":409,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":21,"taxonomy_search":null,"override":false}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-05-20 23:18:03 UTC","id":739,"auditable_id":161,"auditable_name":null,"auditable_type":"ProvisioningTemplate","action":"create","audited_changes":{"name":"Katello Atomic Kickstart Default","template":"<%#\nkind: provision\nname: Katello Atomic Kickstart default\n%>\n\nlang <%= @host.params['lang'] || 'en_US.UTF-8' %>\nkeyboard <%= @host.params['keyboard'] || 'us' %>\ntimezone --utc <%= @host.params['time-zone'] || 'UTC' %>\n\n<% subnet = @host.subnet -%>\n<% if subnet.respond_to?(:dhcp_boot_mode?) -%>\n<% dhcp = subnet.dhcp_boot_mode? && !@static -%>\n<% else -%>\n<% dhcp = !@static -%>\n<% end -%>\n\nnetwork --bootproto <%= dhcp ? 'dhcp' : \"static --ip=#{@host.ip} --netmask=#{subnet.mask} --gateway=#{subnet.gateway} --nameserver=#{[subnet.dns_primary, subnet.dns_secondary].select{ |item| item.present? }.join(',')}\" %> --hostname <%= @host %><%= \" --device=#{@host.mac}\" -%>\n\n# Partition table should create /boot and a volume atomicos\n<% if @dynamic -%>\n%include /tmp/diskpart.cfg\n<% else -%>\n<%= @host.diskLayout %>\n<% end -%>\n\nbootloader --timeout=3\ntext\n\n<% if @host.os.name.match /.*fedora.*/i -%>\nostreesetup --nogpg --osname=fedora-atomic --remote=fedora-atomic --url=<%= @host.param_true?('atomic-upstream') ? \"https://dl.fedoraproject.org/pub/fedora/linux/atomic/#{@host.os.major}/\" : \"#{@host.operatingsystem.medium_uri(@host)}/content/repo/\" %> --ref=fedora-atomic/f<%= @host.os.major %>/<%= @host.architecture %>/docker-host\n<% elsif @host.os.name.match /.*centos.*/i -%>\nostreesetup --nogpg --osname=centos-atomic-host --remote=centos-atomic-host --url=<%= @host.param_true?('atomic-upstream') ? \"http://mirror.centos.org/centos/#{@host.os.major}/atomic/#{@host.architecture}/repo/\" : @host.operatingsystem.medium_uri(@host) %> --ref=centos-atomic-host/<%= @host.os.major %>/<%= @host.architecture %>/standard\n<% else -%>\nostreesetup --nogpg --osname=rhel-atomic-host --remote=rhel-atomic-host --url=file:///install/ostree --ref=rhel-atomic-host/<%= @host.os.major %>/<%= @host.architecture %>/standard\n<% end -%>\nservices --disabled cloud-init,cloud-config,cloud-final,cloud-init-local\nrootpw --iscrypted <%= root_pass %>\n\nreboot\n\n%post\n<%= snippet \"subscription_manager_registration\" %>\n<%= snippet('remote_execution_ssh_keys') %>\n(\n# Report success back to Foreman\ncurl -s -o /dev/null --insecure <%= foreman_url('built') %>\n) 2>&1 | tee /mnt/sysimage/root/install.post.log\n\nexit 0\n\n%end\n","snippet":false,"template_kind_id":6,"locked":true,"default":true,"vendor":"Katello","os_family":null,"job_category":"Miscellaneous","provider_type":null,"description_format":null,"execution_timeout_interval":null}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-05-20 23:18:03 UTC","id":738,"auditable_id":160,"auditable_name":null,"auditable_type":"ProvisioningTemplate","action":"create","audited_changes":{"name":"Katello Kickstart Default Finish","template":"<%#\nkind: finish\nname: Katello Kickstart default finish\noses:\n- CentOS 5\n- CentOS 6\n- CentOS 7\n- RedHat 5\n- RedHat 6\n- RedHat 7\n- Fedora 19\n- Fedora 20\n%>\n<% if @host.subnet.respond_to?(:dhcp_boot_mode?) -%>\n<%= snippet 'kickstart_networking_setup' %>\nservice network restart\n<% end -%>\n\n<%\n  rhel_compatible = @host.operatingsystem.family == 'Redhat' && @host.operatingsystem.name != 'Fedora'\n  os_major = @host.operatingsystem.major.to_i\n  pm_set = @host.puppetmaster.empty? ? false : true\n  puppet_enabled = pm_set || @host.params['force-puppet']\n  salt_enabled = @host.params['salt_master'] ? true : false\n  chef_enabled = @host.respond_to?(:chef_proxy) && @host.chef_proxy\n%>\n\n<%= snippet \"subscription_manager_registration\" %>\n\n<% if @host.respond_to?(:realm) && @host.otp && @host.realm && @host.realm.realm_type == \"FreeIPA\" -%>\n<%= snippet \"freeipa_register\" %>\n<% end -%>\n\n# update local time\necho \"updating system time\"\n/usr/sbin/ntpdate -sub <%= @host.params['ntp-server'] || '0.fedora.pool.ntp.org' %>\n/usr/sbin/hwclock --systohc\n\n<% if @host.info['parameters']['realm'] && @host.realm && @host.realm.realm_type == 'FreeIPA' -%>\n<%= snippet \"freeipa_register\" %>\n<% end -%>\n\n# update all the base packages from the updates repository\nyum -t -y -e 0 update\n\n<%= snippet('remote_execution_ssh_keys') %>\n\n<% if chef_enabled %>\n<%= snippet 'chef_client' %>\n<% end -%>\n\n<% if puppet_enabled %>\n<%= snippet 'puppet_setup' %>\n<% end -%>\n\n<% if salt_enabled %>\n<%= snippet 'saltstack_setup' %>\n<% end -%>\n\nexit 0\n","snippet":false,"template_kind_id":7,"locked":true,"default":true,"vendor":"Katello","os_family":null,"job_category":"Miscellaneous","provider_type":null,"description_format":null,"execution_timeout_interval":null}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-05-20 23:18:03 UTC","id":737,"auditable_id":159,"auditable_name":null,"auditable_type":"ProvisioningTemplate","action":"create","audited_changes":{"name":"Katello Kickstart Default User Data","template":"<%#\nkind: user_data\nname: Katello Kickstart default user data\noses:\n- CentOS 6\n- CentOS 7\n- Fedora 19\n- Fedora 20\n- Fedora 21\n- Fedora 22\n- Fedora 23\n-%>\n#cloud-config\nhostname: <%= @host.shortname %>\nfqdn: <%= @host %>\nmanage_etc_hosts: true\n\ngroups:\n - admin\n\nusers:\n - default\n - name: admin\n   primary-group: admin\n   groups: users\n   shell: /bin/bash\n   sudo: ['ALL=(ALL) ALL']\n   lock-passwd: false\n   passwd: <%= @host.root_pass %>\n\n<%# Allow user to specify additional SSH key as host paramter -%>\n<% if @host.params['sshkey'].present? || @host.params['remote_execution_ssh_keys'].present? -%>\nssh_authorized_keys:\n<% if @host.params['sshkey'].present? -%>\n  - <%= @host.params['sshkey'] %>\n<% end -%>\n<% if @host.params['remote_execution_ssh_keys'].present? -%>\n<% @host.params['remote_execution_ssh_keys'].each do |key| -%>\n  - <%= key %>\n<% end -%>\n<% end -%>\n<% end -%>\nwrite_files:\n- path: /tmp/foreman-userdata.sh\n  permissions: '0755'\n  content: |\n    #!/bin/bash\n<%= indent 4 do\n      snippet 'subscription_manager_registration'\n    end %>\n<% if @host.info['parameters']['realm'] && @host.realm && @host.realm.realm_type == 'FreeIPA' -%>\n<%= indent 4 do\n      snippet 'freeipa_register'\n    end %>\n<% end -%>\n  <% unless @host.operatingsystem.atomic? -%>\n    # update all the base packages from the updates repository\n    yum -t -y -e 0 update\n  <% end -%>\n<%\n  # safemode renderer does not support unary negation\n  non_atomic = @host.operatingsystem.atomic? ? false : true\n  pm_set = @host.puppetmaster.empty? ? false : true\n  puppet_enabled = non_atomic && (pm_set || @host.params['force-puppet'])\n  salt_enabled = non_atomic && (@host.params['salt_master'] ? true : false)\n  chef_enabled = @host.respond_to?(:chef_proxy) && @host.chef_proxy\n%>\n<% if chef_enabled %>\n<%= indent 4 do\n      snippet 'chef_client'\n    end  %>\n<% end -%>\n\n<% if puppet_enabled %>\n<%= indent 4 do\n      snippet 'puppet_setup'\n    end %>\n<% end -%>\n\n<% if salt_enabled %>\n<%= indent 4 do\n      snippet 'saltstack_setup'\n    end %>\n<% end -%>\nphone_home:\n url: <%= foreman_url('built') %>\n post: []\n tries: 10\nruncmd:\n - [ cloud-init-per, once, foreman-userdata, /tmp/foreman-userdata.sh ]\noutput: {all: '| tee -a /root/install.userdata.log'}\n\n","snippet":false,"template_kind_id":9,"locked":true,"default":true,"vendor":"Katello","os_family":null,"job_category":"Miscellaneous","provider_type":null,"description_format":null,"execution_timeout_interval":null}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-05-20 23:18:03 UTC","id":736,"auditable_id":158,"auditable_name":null,"auditable_type":"ProvisioningTemplate","action":"create","audited_changes":{"name":"Katello Kickstart Default","template":"<%#\nkind: provision\nname: Katello Kickstart default\noses:\n- CentOS 5\n- CentOS 6\n- CentOS 7\n- RedHat 5\n- RedHat 6\n- RedHat 7\n- Fedora 19\n- Fedora 20\n%>\n<%\n  rhel_compatible = @host.operatingsystem.family == 'Redhat' && @host.operatingsystem.name != 'Fedora'\n  os_major = @host.operatingsystem.major.to_i\n  # safemode renderer does not support unary negation\n  pm_set = @host.puppetmaster.empty? ? false : true\n  puppet_enabled = pm_set || @host.params['force-puppet']\n  salt_enabled = @host.params['salt_master'] ? true : false\n  chef_enabled = @host.respond_to?(:chef_proxy) && @host.chef_proxy\n  section_end = (rhel_compatible && os_major <= 5) ? '' : '%end'\n%>\ninstall\n<%= @mediapath %>\nlang en_US.UTF-8\nselinux --enforcing\nkeyboard us\nskipx\n\n<% subnet = @host.subnet -%>\n<% if subnet.respond_to?(:dhcp_boot_mode?) -%>\n<% dhcp = subnet.dhcp_boot_mode? && !@static -%>\n<% else -%>\n<% dhcp = !@static -%>\n<% end -%>\n\nnetwork --bootproto <%= dhcp ? 'dhcp' : \"static --ip=#{@host.ip} --netmask=#{subnet.mask} --gateway=#{subnet.gateway} --nameserver=#{[subnet.dns_primary, subnet.dns_secondary].select{ |item| item.present? }.join(',')}\" %> --hostname <%= @host %><%= os_major >= 6 ? \" --device=#{@host.mac}\" : '' -%>\n\nrootpw --iscrypted <%= root_pass %>\nfirewall --<%= os_major >= 6 ? 'service=' : '' %>ssh\nauthconfig --useshadow --passalgo=<%= @host.operatingsystem.password_hash || 'sha256' %> --kickstart\ntimezone --utc <%= @host.params['time-zone'] || 'UTC' %>\n\n<% if @host.operatingsystem.name == 'Fedora' and os_major <= 16 -%>\n# Bootloader exception for Fedora 16:\nbootloader --append=\"nofb quiet splash=quiet <%=ks_console%>\" <%= grub_pass %>\npart biosboot --fstype=biosboot --size=1\n<% else -%>\nbootloader --location=mbr --append=\"nofb quiet splash=quiet\" <%= grub_pass %>\n<% end -%>\n\n<% if os_major == 5 -%>\nkey --skip\n<% end -%>\n\n<% if @dynamic -%>\n%include /tmp/diskpart.cfg\n<% else -%>\n<%= @host.diskLayout %>\n<% end -%>\n\ntext\nreboot\n\n%packages --ignoremissing\nyum\ndhclient\nntp\nwget\n@Core\n<%= section_end -%>\n\n<% if @dynamic -%>\n%pre\n<%= @host.diskLayout %>\n<%= section_end -%>\n<% end -%>\n\n%post --nochroot\nexec < /dev/tty3 > /dev/tty3\n#changing to VT 3 so that we can see whats going on....\n/usr/bin/chvt 3\n(\ncp -va /etc/resolv.conf /mnt/sysimage/etc/resolv.conf\n/usr/bin/chvt 1\n) 2>&1 | tee /mnt/sysimage/root/install.postnochroot.log\n<%= section_end -%>\n\n\n%post\nlogger \"Starting anaconda <%= @host %> postinstall\"\nexec < /dev/tty3 > /dev/tty3\n#changing to VT 3 so that we can see whats going on....\n/usr/bin/chvt 3\n(\n<% if subnet.respond_to?(:dhcp_boot_mode?) -%>\n<%= snippet 'kickstart_networking_setup' %>\n<% end -%>\n\n#update local time\necho \"updating system time\"\n/usr/sbin/ntpdate -sub <%= @host.params['ntp-server'] || '0.fedora.pool.ntp.org' %>\n/usr/sbin/hwclock --systohc\n\n<%= snippet \"subscription_manager_registration\" %>\n\n<% if @host.info['parameters']['realm'] && @host.realm && @host.realm.realm_type == 'FreeIPA' -%>\n<%= snippet \"freeipa_register\" %>\n<% end -%>\n\n# update all the base packages from the updates repository\nyum -t -y -e 0 update\n\n<%= snippet('remote_execution_ssh_keys') %>\n\n<% if chef_enabled %>\n<%= snippet 'chef_client' %>\n<% end -%>\n\n<% if puppet_enabled %>\n<%= snippet 'puppet_setup' %>\n<% end -%>\n\n<% if salt_enabled %>\n<%= snippet 'saltstack_setup' %>\n<% end -%>\n\nsync\n\n<% if @provisioning_type == nil || @provisioning_type == 'host' -%>\n# Inform the build system that we are done.\necho \"Informing Foreman that we are built\"\nwget -q -O /dev/null --no-check-certificate <%= foreman_url('built') %>\n<% end -%>\n) 2>&1 | tee /root/install.post.log\nexit 0\n\n<%= section_end -%>\n","snippet":false,"template_kind_id":6,"locked":true,"default":true,"vendor":"Katello","os_family":null,"job_category":"Miscellaneous","provider_type":null,"description_format":null,"execution_timeout_interval":null}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":17,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-05-20 17:46:47 UTC","id":735,"auditable_id":9,"auditable_name":"drone69.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"global_status":[2,1]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":5,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-05-19 22:24:10 UTC","id":734,"auditable_id":22,"auditable_name":"rhuiclient511.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"global_status":[2,1]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":4,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.14","associated_name":null,"created_at":"2018-05-19 22:23:57 UTC","id":733,"auditable_id":22,"auditable_name":"rhuiclient511.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"global_status":[0,2]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":3,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.14","associated_name":null,"created_at":"2018-05-19 22:23:56 UTC","id":732,"auditable_id":22,"auditable_name":"rhuiclient511.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"model_id":[null,1],"architecture_id":[null,1],"operatingsystem_id":[null,8]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.14","associated_name":null,"created_at":"2018-05-19 22:23:55 UTC","id":731,"auditable_id":8,"auditable_name":"RedHat 5.11","auditable_type":"Operatingsystem","action":"create","audited_changes":{"major":"5","name":"RedHat","minor":"11","nameindicator":null,"release_name":null,"description":null,"password_hash":"SHA256","title":"RedHat 5.11"}},{"user_id":3,"user_type":null,"user_name":"admin","version":2,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.14","associated_name":null,"created_at":"2018-05-19 22:23:54 UTC","id":730,"auditable_id":22,"auditable_name":"rhuiclient511.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"grub_pass":["$1$c0ODO8/q$3/HJSwN69ElT6ki3G2XKw/","$5$Ts+MRkHG$UjMpSBeabo8n6bl9.ofr9aNRx2ZQuUnVlmMJFxIwiF."]}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.14","associated_name":null,"created_at":"2018-05-19 22:23:53 UTC","id":729,"auditable_id":22,"auditable_name":"rhuiclient511.usersys.redhat.com","auditable_type":"Host","action":"create","audited_changes":{"name":"rhuiclient511.usersys.redhat.com","root_pass":"$5$Ts+MRkHG$UjMpSBeabo8n6bl9.ofr9aNRx2ZQuUnVlmMJFxIwiF.","architecture_id":null,"operatingsystem_id":null,"environment_id":null,"ptable_id":null,"medium_id":null,"build":false,"comment":null,"disk":null,"installed_at":null,"model_id":null,"hostgroup_id":null,"owner_id":3,"owner_type":"User","enabled":true,"puppet_ca_proxy_id":null,"managed":false,"use_image":null,"image_file":null,"uuid":null,"compute_resource_id":null,"puppet_proxy_id":null,"certname":null,"image_id":null,"organization_id":1,"location_id":2,"otp":null,"realm_id":null,"compute_profile_id":null,"provision_method":null,"grub_pass":"$1$c0ODO8/q$3/HJSwN69ElT6ki3G2XKw/","discovery_rule_id":null,"content_view_id":null,"lifecycle_environment_id":null,"global_status":0,"pxe_loader":null,"openscap_proxy_id":null}},{"user_id":3,"user_type":null,"user_name":"admin","version":2,"comment":null,"associated_id":26,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"testt","created_at":"2018-05-18 12:33:56 UTC","id":728,"auditable_id":396,"auditable_name":"view_activation_keys, create_activation_keys, edit_activation_keys, and destroy_activation_keys","auditable_type":"Filter","action":"destroy","audited_changes":{"search":null,"role_id":26,"taxonomy_search":"(organization_id = 1)","override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":26,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"testt","created_at":"2018-05-18 12:33:34 UTC","id":727,"auditable_id":408,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":26,"taxonomy_search":"(organization_id = 1) and (location_id = 2)","override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":26,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"testt","created_at":"2018-05-18 12:33:34 UTC","id":726,"auditable_id":407,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":26,"taxonomy_search":"(organization_id = 1) and (location_id = 2)","override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":26,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"testt","created_at":"2018-05-18 12:33:34 UTC","id":725,"auditable_id":406,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":26,"taxonomy_search":"(organization_id = 1) and (location_id = 2)","override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":26,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"testt","created_at":"2018-05-18 12:33:34 UTC","id":724,"auditable_id":405,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":26,"taxonomy_search":"(organization_id = 1) and (location_id = 2)","override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":26,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"testt","created_at":"2018-05-18 12:33:34 UTC","id":723,"auditable_id":404,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":26,"taxonomy_search":null,"override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":26,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"testt","created_at":"2018-05-18 12:33:34 UTC","id":722,"auditable_id":403,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":26,"taxonomy_search":"(organization_id = 1)","override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":26,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"testt","created_at":"2018-05-18 12:33:34 UTC","id":721,"auditable_id":402,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":26,"taxonomy_search":null,"override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":26,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"testt","created_at":"2018-05-18 12:33:34 UTC","id":720,"auditable_id":401,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":26,"taxonomy_search":"(organization_id = 1)","override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":26,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"testt","created_at":"2018-05-18 12:33:34 UTC","id":719,"auditable_id":400,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":26,"taxonomy_search":"(organization_id = 1)","override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":26,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"testt","created_at":"2018-05-18 12:33:34 UTC","id":718,"auditable_id":399,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":26,"taxonomy_search":"(organization_id = 1)","override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":26,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"testt","created_at":"2018-05-18 12:33:34 UTC","id":717,"auditable_id":398,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":26,"taxonomy_search":"(organization_id = 1)","override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":26,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"testt","created_at":"2018-05-18 12:33:34 UTC","id":716,"auditable_id":397,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":26,"taxonomy_search":"(organization_id = 1)","override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":26,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"testt","created_at":"2018-05-18 12:33:34 UTC","id":715,"auditable_id":396,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":26,"taxonomy_search":"(organization_id = 1)","override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":26,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"testt","created_at":"2018-05-18 12:33:33 UTC","id":714,"auditable_id":395,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":26,"taxonomy_search":"(organization_id = 1) and (location_id = 2)","override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":26,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"testt","created_at":"2018-05-18 12:33:33 UTC","id":713,"auditable_id":394,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":26,"taxonomy_search":null,"override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":26,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"testt","created_at":"2018-05-18 12:33:33 UTC","id":712,"auditable_id":393,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":26,"taxonomy_search":null,"override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":26,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"testt","created_at":"2018-05-18 12:33:33 UTC","id":711,"auditable_id":392,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":26,"taxonomy_search":null,"override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":26,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"testt","created_at":"2018-05-18 12:33:33 UTC","id":710,"auditable_id":391,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":26,"taxonomy_search":"(organization_id = 1) and (location_id = 2)","override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":26,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"testt","created_at":"2018-05-18 12:33:33 UTC","id":709,"auditable_id":390,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":26,"taxonomy_search":null,"override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":26,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"testt","created_at":"2018-05-18 12:33:33 UTC","id":708,"auditable_id":389,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":26,"taxonomy_search":"(organization_id = 1) and (location_id = 2)","override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":26,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"testt","created_at":"2018-05-18 12:33:33 UTC","id":707,"auditable_id":388,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":26,"taxonomy_search":"(organization_id = 1) and (location_id = 2)","override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":26,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"testt","created_at":"2018-05-18 12:33:33 UTC","id":706,"auditable_id":387,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":26,"taxonomy_search":null,"override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":26,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"testt","created_at":"2018-05-18 12:33:33 UTC","id":705,"auditable_id":386,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":26,"taxonomy_search":null,"override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":26,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"testt","created_at":"2018-05-18 12:33:33 UTC","id":704,"auditable_id":385,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":26,"taxonomy_search":null,"override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":26,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"testt","created_at":"2018-05-18 12:33:33 UTC","id":703,"auditable_id":384,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":26,"taxonomy_search":"(organization_id = 1) and (location_id = 2)","override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":26,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"testt","created_at":"2018-05-18 12:33:33 UTC","id":702,"auditable_id":383,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":26,"taxonomy_search":null,"override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":26,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"testt","created_at":"2018-05-18 12:33:33 UTC","id":701,"auditable_id":382,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":26,"taxonomy_search":null,"override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":26,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"testt","created_at":"2018-05-18 12:33:33 UTC","id":700,"auditable_id":381,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":26,"taxonomy_search":"(organization_id = 1) and (location_id = 2)","override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":26,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"testt","created_at":"2018-05-18 12:33:33 UTC","id":699,"auditable_id":380,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":26,"taxonomy_search":null,"override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":26,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"testt","created_at":"2018-05-18 12:33:33 UTC","id":698,"auditable_id":379,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":26,"taxonomy_search":"(organization_id = 1) and (location_id = 2)","override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":26,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"testt","created_at":"2018-05-18 12:33:33 UTC","id":697,"auditable_id":378,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":26,"taxonomy_search":null,"override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":26,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"testt","created_at":"2018-05-18 12:33:33 UTC","id":696,"auditable_id":377,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":26,"taxonomy_search":"(organization_id = 1) and (location_id = 2)","override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":26,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"testt","created_at":"2018-05-18 12:33:33 UTC","id":695,"auditable_id":376,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":26,"taxonomy_search":null,"override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":26,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"testt","created_at":"2018-05-18 12:33:33 UTC","id":694,"auditable_id":375,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":26,"taxonomy_search":"(organization_id = 1) and (location_id = 2)","override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":26,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"testt","created_at":"2018-05-18 12:33:33 UTC","id":693,"auditable_id":374,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":26,"taxonomy_search":"(organization_id = 1) and (location_id = 2)","override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":26,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"testt","created_at":"2018-05-18 12:33:33 UTC","id":692,"auditable_id":373,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":26,"taxonomy_search":null,"override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":26,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"testt","created_at":"2018-05-18 12:33:33 UTC","id":691,"auditable_id":372,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":26,"taxonomy_search":"(organization_id = 1)","override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":26,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"testt","created_at":"2018-05-18 12:33:33 UTC","id":690,"auditable_id":371,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":26,"taxonomy_search":null,"override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":26,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"testt","created_at":"2018-05-18 12:33:33 UTC","id":689,"auditable_id":370,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":26,"taxonomy_search":null,"override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":26,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"testt","created_at":"2018-05-18 12:33:33 UTC","id":688,"auditable_id":369,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":26,"taxonomy_search":null,"override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":26,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"testt","created_at":"2018-05-18 12:33:33 UTC","id":687,"auditable_id":368,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":26,"taxonomy_search":"(organization_id = 1) and (location_id = 2)","override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":26,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"testt","created_at":"2018-05-18 12:33:33 UTC","id":686,"auditable_id":367,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":26,"taxonomy_search":null,"override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":26,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"testt","created_at":"2018-05-18 12:33:33 UTC","id":685,"auditable_id":366,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":26,"taxonomy_search":null,"override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":26,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"testt","created_at":"2018-05-18 12:33:33 UTC","id":684,"auditable_id":365,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":26,"taxonomy_search":"(location_id = 2)","override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":26,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"testt","created_at":"2018-05-18 12:33:33 UTC","id":683,"auditable_id":364,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":26,"taxonomy_search":null,"override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":26,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"testt","created_at":"2018-05-18 12:33:32 UTC","id":682,"auditable_id":363,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":26,"taxonomy_search":null,"override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":26,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"testt","created_at":"2018-05-18 12:33:32 UTC","id":681,"auditable_id":362,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":26,"taxonomy_search":"(organization_id = 1) and (location_id = 2)","override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":26,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"testt","created_at":"2018-05-18 12:33:32 UTC","id":680,"auditable_id":361,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":26,"taxonomy_search":"(organization_id = 1) and (location_id = 2)","override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":26,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"testt","created_at":"2018-05-18 12:33:32 UTC","id":679,"auditable_id":360,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":26,"taxonomy_search":null,"override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":26,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"testt","created_at":"2018-05-18 12:33:32 UTC","id":678,"auditable_id":359,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":26,"taxonomy_search":"(organization_id = 1) and (location_id = 2)","override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":26,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"testt","created_at":"2018-05-18 12:33:32 UTC","id":677,"auditable_id":358,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":26,"taxonomy_search":null,"override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":26,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"testt","created_at":"2018-05-18 12:33:32 UTC","id":676,"auditable_id":357,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":26,"taxonomy_search":null,"override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":26,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"testt","created_at":"2018-05-18 12:33:32 UTC","id":675,"auditable_id":356,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":26,"taxonomy_search":"(organization_id = 1) and (location_id = 2)","override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":26,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"testt","created_at":"2018-05-18 12:33:32 UTC","id":674,"auditable_id":355,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":26,"taxonomy_search":"(organization_id = 1) and (location_id = 2)","override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":26,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"testt","created_at":"2018-05-18 12:33:32 UTC","id":673,"auditable_id":354,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":26,"taxonomy_search":null,"override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":26,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"testt","created_at":"2018-05-18 12:33:32 UTC","id":672,"auditable_id":353,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":26,"taxonomy_search":null,"override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":26,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"testt","created_at":"2018-05-18 12:33:32 UTC","id":671,"auditable_id":352,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":26,"taxonomy_search":"(organization_id = 1) and (location_id = 2)","override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":26,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"testt","created_at":"2018-05-18 12:33:32 UTC","id":670,"auditable_id":351,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":26,"taxonomy_search":null,"override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":26,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"testt","created_at":"2018-05-18 12:33:32 UTC","id":669,"auditable_id":350,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":26,"taxonomy_search":null,"override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":26,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"testt","created_at":"2018-05-18 12:33:32 UTC","id":668,"auditable_id":349,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":26,"taxonomy_search":"(organization_id = 1) and (location_id = 2)","override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":26,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"testt","created_at":"2018-05-18 12:33:32 UTC","id":667,"auditable_id":348,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":26,"taxonomy_search":null,"override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":26,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"testt","created_at":"2018-05-18 12:33:32 UTC","id":666,"auditable_id":347,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":26,"taxonomy_search":null,"override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.228","associated_name":null,"created_at":"2018-05-18 12:33:32 UTC","id":665,"auditable_id":26,"auditable_name":"testt","auditable_type":"Role","action":"create","audited_changes":{"name":"testt","builtin":0,"description":null,"origin":null,"cloned_from_id":1}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":25,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"test","created_at":"2018-05-18 12:33:18 UTC","id":664,"auditable_id":346,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":25,"taxonomy_search":"(organization_id = 1) and (location_id = 2)","override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":25,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"test","created_at":"2018-05-18 12:33:18 UTC","id":663,"auditable_id":345,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":25,"taxonomy_search":"(organization_id = 1) and (location_id = 2)","override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":25,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"test","created_at":"2018-05-18 12:33:18 UTC","id":662,"auditable_id":344,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":25,"taxonomy_search":"(organization_id = 1) and (location_id = 2)","override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":25,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"test","created_at":"2018-05-18 12:33:18 UTC","id":661,"auditable_id":343,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":25,"taxonomy_search":"(organization_id = 1) and (location_id = 2)","override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":25,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"test","created_at":"2018-05-18 12:33:18 UTC","id":660,"auditable_id":342,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":25,"taxonomy_search":null,"override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":25,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"test","created_at":"2018-05-18 12:33:18 UTC","id":659,"auditable_id":341,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":25,"taxonomy_search":"(organization_id = 1)","override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":25,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"test","created_at":"2018-05-18 12:33:18 UTC","id":658,"auditable_id":340,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":25,"taxonomy_search":null,"override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":25,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"test","created_at":"2018-05-18 12:33:18 UTC","id":657,"auditable_id":339,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":25,"taxonomy_search":"(organization_id = 1)","override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":25,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"test","created_at":"2018-05-18 12:33:18 UTC","id":656,"auditable_id":338,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":25,"taxonomy_search":"(organization_id = 1)","override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":25,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"test","created_at":"2018-05-18 12:33:18 UTC","id":655,"auditable_id":337,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":25,"taxonomy_search":"(organization_id = 1)","override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":25,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"test","created_at":"2018-05-18 12:33:18 UTC","id":654,"auditable_id":336,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":25,"taxonomy_search":"(organization_id = 1)","override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":25,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"test","created_at":"2018-05-18 12:33:18 UTC","id":653,"auditable_id":335,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":25,"taxonomy_search":"(organization_id = 1)","override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":25,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"test","created_at":"2018-05-18 12:33:18 UTC","id":652,"auditable_id":334,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":25,"taxonomy_search":"(organization_id = 1)","override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":25,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"test","created_at":"2018-05-18 12:33:18 UTC","id":651,"auditable_id":333,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":25,"taxonomy_search":"(organization_id = 1) and (location_id = 2)","override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":25,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"test","created_at":"2018-05-18 12:33:18 UTC","id":650,"auditable_id":332,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":25,"taxonomy_search":null,"override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":25,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"test","created_at":"2018-05-18 12:33:18 UTC","id":649,"auditable_id":331,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":25,"taxonomy_search":null,"override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":25,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"test","created_at":"2018-05-18 12:33:18 UTC","id":648,"auditable_id":330,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":25,"taxonomy_search":null,"override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":25,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"test","created_at":"2018-05-18 12:33:18 UTC","id":647,"auditable_id":329,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":25,"taxonomy_search":"(organization_id = 1) and (location_id = 2)","override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":25,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"test","created_at":"2018-05-18 12:33:18 UTC","id":646,"auditable_id":328,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":25,"taxonomy_search":null,"override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":25,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"test","created_at":"2018-05-18 12:33:18 UTC","id":645,"auditable_id":327,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":25,"taxonomy_search":"(organization_id = 1) and (location_id = 2)","override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":25,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"test","created_at":"2018-05-18 12:33:18 UTC","id":644,"auditable_id":326,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":25,"taxonomy_search":"(organization_id = 1) and (location_id = 2)","override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":25,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"test","created_at":"2018-05-18 12:33:17 UTC","id":643,"auditable_id":325,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":25,"taxonomy_search":null,"override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":25,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"test","created_at":"2018-05-18 12:33:17 UTC","id":642,"auditable_id":324,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":25,"taxonomy_search":null,"override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":25,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"test","created_at":"2018-05-18 12:33:17 UTC","id":641,"auditable_id":323,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":25,"taxonomy_search":null,"override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":25,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"test","created_at":"2018-05-18 12:33:17 UTC","id":640,"auditable_id":322,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":25,"taxonomy_search":"(organization_id = 1) and (location_id = 2)","override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":25,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"test","created_at":"2018-05-18 12:33:17 UTC","id":639,"auditable_id":321,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":25,"taxonomy_search":null,"override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":25,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"test","created_at":"2018-05-18 12:33:17 UTC","id":638,"auditable_id":320,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":25,"taxonomy_search":null,"override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":25,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"test","created_at":"2018-05-18 12:33:17 UTC","id":637,"auditable_id":319,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":25,"taxonomy_search":"(organization_id = 1) and (location_id = 2)","override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":25,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"test","created_at":"2018-05-18 12:33:17 UTC","id":636,"auditable_id":318,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":25,"taxonomy_search":null,"override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":25,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"test","created_at":"2018-05-18 12:33:17 UTC","id":635,"auditable_id":317,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":25,"taxonomy_search":"(organization_id = 1) and (location_id = 2)","override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":25,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"test","created_at":"2018-05-18 12:33:17 UTC","id":634,"auditable_id":316,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":25,"taxonomy_search":null,"override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":25,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"test","created_at":"2018-05-18 12:33:17 UTC","id":633,"auditable_id":315,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":25,"taxonomy_search":"(organization_id = 1) and (location_id = 2)","override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":25,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"test","created_at":"2018-05-18 12:33:17 UTC","id":632,"auditable_id":314,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":25,"taxonomy_search":null,"override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":25,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"test","created_at":"2018-05-18 12:33:17 UTC","id":631,"auditable_id":313,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":25,"taxonomy_search":"(organization_id = 1) and (location_id = 2)","override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":25,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"test","created_at":"2018-05-18 12:33:17 UTC","id":630,"auditable_id":312,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":25,"taxonomy_search":"(organization_id = 1) and (location_id = 2)","override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":25,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"test","created_at":"2018-05-18 12:33:17 UTC","id":629,"auditable_id":311,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":25,"taxonomy_search":null,"override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":25,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"test","created_at":"2018-05-18 12:33:17 UTC","id":628,"auditable_id":310,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":25,"taxonomy_search":"(organization_id = 1)","override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":25,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"test","created_at":"2018-05-18 12:33:17 UTC","id":627,"auditable_id":309,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":25,"taxonomy_search":null,"override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":25,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"test","created_at":"2018-05-18 12:33:17 UTC","id":626,"auditable_id":308,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":25,"taxonomy_search":null,"override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":25,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"test","created_at":"2018-05-18 12:33:17 UTC","id":625,"auditable_id":307,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":25,"taxonomy_search":null,"override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":25,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"test","created_at":"2018-05-18 12:33:17 UTC","id":624,"auditable_id":306,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":25,"taxonomy_search":"(organization_id = 1) and (location_id = 2)","override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":25,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"test","created_at":"2018-05-18 12:33:17 UTC","id":623,"auditable_id":305,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":25,"taxonomy_search":null,"override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":25,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"test","created_at":"2018-05-18 12:33:17 UTC","id":622,"auditable_id":304,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":25,"taxonomy_search":null,"override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":25,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"test","created_at":"2018-05-18 12:33:17 UTC","id":621,"auditable_id":303,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":25,"taxonomy_search":"(location_id = 2)","override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":25,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"test","created_at":"2018-05-18 12:33:17 UTC","id":620,"auditable_id":302,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":25,"taxonomy_search":null,"override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":25,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"test","created_at":"2018-05-18 12:33:17 UTC","id":619,"auditable_id":301,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":25,"taxonomy_search":null,"override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":25,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"test","created_at":"2018-05-18 12:33:17 UTC","id":618,"auditable_id":300,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":25,"taxonomy_search":"(organization_id = 1) and (location_id = 2)","override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":25,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"test","created_at":"2018-05-18 12:33:17 UTC","id":617,"auditable_id":299,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":25,"taxonomy_search":"(organization_id = 1) and (location_id = 2)","override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":25,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"test","created_at":"2018-05-18 12:33:17 UTC","id":616,"auditable_id":298,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":25,"taxonomy_search":null,"override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":25,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"test","created_at":"2018-05-18 12:33:17 UTC","id":615,"auditable_id":297,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":25,"taxonomy_search":"(organization_id = 1) and (location_id = 2)","override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":25,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"test","created_at":"2018-05-18 12:33:16 UTC","id":614,"auditable_id":296,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":25,"taxonomy_search":null,"override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":25,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"test","created_at":"2018-05-18 12:33:16 UTC","id":613,"auditable_id":295,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":25,"taxonomy_search":null,"override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":25,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"test","created_at":"2018-05-18 12:33:16 UTC","id":612,"auditable_id":294,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":25,"taxonomy_search":"(organization_id = 1) and (location_id = 2)","override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":25,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"test","created_at":"2018-05-18 12:33:16 UTC","id":611,"auditable_id":293,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":25,"taxonomy_search":"(organization_id = 1) and (location_id = 2)","override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":25,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"test","created_at":"2018-05-18 12:33:16 UTC","id":610,"auditable_id":292,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":25,"taxonomy_search":null,"override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":25,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"test","created_at":"2018-05-18 12:33:16 UTC","id":609,"auditable_id":291,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":25,"taxonomy_search":null,"override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":25,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"test","created_at":"2018-05-18 12:33:16 UTC","id":608,"auditable_id":290,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":25,"taxonomy_search":"(organization_id = 1) and (location_id = 2)","override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":25,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"test","created_at":"2018-05-18 12:33:16 UTC","id":607,"auditable_id":289,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":25,"taxonomy_search":null,"override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":25,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"test","created_at":"2018-05-18 12:33:16 UTC","id":606,"auditable_id":288,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":25,"taxonomy_search":null,"override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":25,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"test","created_at":"2018-05-18 12:33:16 UTC","id":605,"auditable_id":287,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":25,"taxonomy_search":"(organization_id = 1) and (location_id = 2)","override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":25,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"test","created_at":"2018-05-18 12:33:16 UTC","id":604,"auditable_id":286,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":25,"taxonomy_search":null,"override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":25,"associated_type":"Role","remote_address":"10.13.153.228","associated_name":"test","created_at":"2018-05-18 12:33:16 UTC","id":603,"auditable_id":285,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":25,"taxonomy_search":null,"override":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.228","associated_name":null,"created_at":"2018-05-18 12:33:16 UTC","id":602,"auditable_id":25,"auditable_name":"test","auditable_type":"Role","action":"create","audited_changes":{"name":"test","builtin":0,"description":null,"origin":null,"cloned_from_id":1}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.228","associated_name":null,"created_at":"2018-05-18 12:31:20 UTC","id":601,"auditable_id":4,"auditable_name":"guy guy","auditable_type":"User","action":"create","audited_changes":{"login":"guy","firstname":"guy","lastname":"guy","mail":"guy@balls.com","admin":false,"auth_source_id":1,"locale":null,"avatar_hash":null,"default_organization_id":null,"default_location_id":null,"lower_login":"guy","mail_enabled":true,"timezone":"","description":""}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":2,"comment":null,"associated_id":21,"associated_type":"Role","remote_address":null,"associated_name":"Access Insights Admin","created_at":"2018-05-16 16:03:43 UTC","id":600,"auditable_id":283,"auditable_name":"view_hosts","auditable_type":"Filter","action":"destroy","audited_changes":{"search":null,"role_id":21,"taxonomy_search":null,"override":false}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":2,"comment":null,"associated_id":20,"associated_type":"Role","remote_address":null,"associated_name":"Access Insights Viewer","created_at":"2018-05-16 16:03:43 UTC","id":599,"auditable_id":284,"auditable_name":"view_hosts","auditable_type":"Filter","action":"destroy","audited_changes":{"search":null,"role_id":20,"taxonomy_search":null,"override":false}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":2,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-05-16 16:03:17 UTC","id":598,"auditable_id":155,"auditable_name":"Katello Kickstart Default User Data","auditable_type":"ProvisioningTemplate","action":"destroy","audited_changes":{"name":"Katello Kickstart Default User Data","template":"<%#\nkind: user_data\nname: Katello Kickstart default user data\noses:\n- CentOS 6\n- CentOS 7\n- Fedora 19\n- Fedora 20\n- Fedora 21\n- Fedora 22\n- Fedora 23\n-%>\n#cloud-config\nhostname: <%= @host.shortname %>\nfqdn: <%= @host %>\nmanage_etc_hosts: true\n\ngroups:\n - admin\n\nusers:\n - default\n - name: admin\n   primary-group: admin\n   groups: users\n   shell: /bin/bash\n   sudo: ['ALL=(ALL) ALL']\n   lock-passwd: false\n   passwd: <%= @host.root_pass %>\n\n<%# Allow user to specify additional SSH key as host paramter -%>\n<% if @host.params['sshkey'].present? || @host.params['remote_execution_ssh_keys'].present? -%>\nssh_authorized_keys:\n<% if @host.params['sshkey'].present? -%>\n  - <%= @host.params['sshkey'] %>\n<% end -%>\n<% if @host.params['remote_execution_ssh_keys'].present? -%>\n<% @host.params['remote_execution_ssh_keys'].each do |key| -%>\n  - <%= key %>\n<% end -%>\n<% end -%>\n<% end -%>\nwrite_files:\n- path: /tmp/foreman-userdata.sh\n  permissions: '0755'\n  content: |\n    #!/bin/bash\n<%= indent 4 do\n      snippet 'subscription_manager_registration'\n    end %>\n<% if @host.info['parameters']['realm'] && @host.realm && @host.realm.realm_type == 'FreeIPA' -%>\n<%= indent 4 do\n      snippet 'freeipa_register'\n    end %>\n<% end -%>\n  <% unless @host.operatingsystem.atomic? -%>\n    # update all the base packages from the updates repository\n    yum -t -y -e 0 update\n  <% end -%>\n<%\n  # safemode renderer does not support unary negation\n  non_atomic = @host.operatingsystem.atomic? ? false : true\n  pm_set = @host.puppetmaster.empty? ? false : true\n  puppet_enabled = non_atomic && (pm_set || @host.params['force-puppet'])\n  salt_enabled = non_atomic && (@host.params['salt_master'] ? true : false)\n  chef_enabled = @host.respond_to?(:chef_proxy) && @host.chef_proxy\n%>\n<% if chef_enabled %>\n<%= indent 4 do\n      snippet 'chef_client'\n    end  %>\n<% end -%>\n\n<% if puppet_enabled %>\n<%= indent 4 do\n      snippet 'puppet_setup'\n    end %>\n<% end -%>\n\n<% if salt_enabled %>\n<%= indent 4 do\n      snippet 'saltstack_setup'\n    end %>\n<% end -%>\nphone_home:\n url: <%= foreman_url('built') %>\n post: []\n tries: 10\nruncmd:\n - [ cloud-init-per, once, foreman-userdata, /tmp/foreman-userdata.sh ]\noutput: {all: '| tee -a /root/install.userdata.log'}\n\n","snippet":false,"template_kind_id":9,"locked":true,"default":true,"vendor":"Katello","os_family":null,"job_category":"Miscellaneous","provider_type":null,"description_format":null,"execution_timeout_interval":null}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":2,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-05-16 16:03:17 UTC","id":597,"auditable_id":156,"auditable_name":"Katello Kickstart Default Finish","auditable_type":"ProvisioningTemplate","action":"destroy","audited_changes":{"name":"Katello Kickstart Default Finish","template":"<%#\nkind: finish\nname: Katello Kickstart default finish\noses:\n- CentOS 5\n- CentOS 6\n- CentOS 7\n- RedHat 5\n- RedHat 6\n- RedHat 7\n- Fedora 19\n- Fedora 20\n%>\n<% if @host.subnet.respond_to?(:dhcp_boot_mode?) -%>\n<%= snippet 'kickstart_networking_setup' %>\nservice network restart\n<% end -%>\n\n<%\n  rhel_compatible = @host.operatingsystem.family == 'Redhat' && @host.operatingsystem.name != 'Fedora'\n  os_major = @host.operatingsystem.major.to_i\n  pm_set = @host.puppetmaster.empty? ? false : true\n  puppet_enabled = pm_set || @host.params['force-puppet']\n  salt_enabled = @host.params['salt_master'] ? true : false\n  chef_enabled = @host.respond_to?(:chef_proxy) && @host.chef_proxy\n%>\n\n<%= snippet \"subscription_manager_registration\" %>\n\n<% if @host.respond_to?(:realm) && @host.otp && @host.realm && @host.realm.realm_type == \"FreeIPA\" -%>\n<%= snippet \"freeipa_register\" %>\n<% end -%>\n\n# update local time\necho \"updating system time\"\n/usr/sbin/ntpdate -sub <%= @host.params['ntp-server'] || '0.fedora.pool.ntp.org' %>\n/usr/sbin/hwclock --systohc\n\n<% if @host.info['parameters']['realm'] && @host.realm && @host.realm.realm_type == 'FreeIPA' -%>\n<%= snippet \"freeipa_register\" %>\n<% end -%>\n\n# update all the base packages from the updates repository\nyum -t -y -e 0 update\n\n<%= snippet('remote_execution_ssh_keys') %>\n\n<% if chef_enabled %>\n<%= snippet 'chef_client' %>\n<% end -%>\n\n<% if puppet_enabled %>\n<%= snippet 'puppet_setup' %>\n<% end -%>\n\n<% if salt_enabled %>\n<%= snippet 'saltstack_setup' %>\n<% end -%>\n\nexit 0\n","snippet":false,"template_kind_id":7,"locked":true,"default":true,"vendor":"Katello","os_family":null,"job_category":"Miscellaneous","provider_type":null,"description_format":null,"execution_timeout_interval":null}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":2,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-05-16 16:03:17 UTC","id":596,"auditable_id":154,"auditable_name":"Katello Kickstart Default","auditable_type":"ProvisioningTemplate","action":"destroy","audited_changes":{"name":"Katello Kickstart Default","template":"<%#\nkind: provision\nname: Katello Kickstart default\noses:\n- CentOS 5\n- CentOS 6\n- CentOS 7\n- RedHat 5\n- RedHat 6\n- RedHat 7\n- Fedora 19\n- Fedora 20\n%>\n<%\n  rhel_compatible = @host.operatingsystem.family == 'Redhat' && @host.operatingsystem.name != 'Fedora'\n  os_major = @host.operatingsystem.major.to_i\n  # safemode renderer does not support unary negation\n  pm_set = @host.puppetmaster.empty? ? false : true\n  puppet_enabled = pm_set || @host.params['force-puppet']\n  salt_enabled = @host.params['salt_master'] ? true : false\n  chef_enabled = @host.respond_to?(:chef_proxy) && @host.chef_proxy\n  section_end = (rhel_compatible && os_major <= 5) ? '' : '%end'\n%>\ninstall\n<%= @mediapath %>\nlang en_US.UTF-8\nselinux --enforcing\nkeyboard us\nskipx\n\n<% subnet = @host.subnet -%>\n<% if subnet.respond_to?(:dhcp_boot_mode?) -%>\n<% dhcp = subnet.dhcp_boot_mode? && !@static -%>\n<% else -%>\n<% dhcp = !@static -%>\n<% end -%>\n\nnetwork --bootproto <%= dhcp ? 'dhcp' : \"static --ip=#{@host.ip} --netmask=#{subnet.mask} --gateway=#{subnet.gateway} --nameserver=#{[subnet.dns_primary, subnet.dns_secondary].select{ |item| item.present? }.join(',')}\" %> --hostname <%= @host %><%= os_major >= 6 ? \" --device=#{@host.mac}\" : '' -%>\n\nrootpw --iscrypted <%= root_pass %>\nfirewall --<%= os_major >= 6 ? 'service=' : '' %>ssh\nauthconfig --useshadow --passalgo=<%= @host.operatingsystem.password_hash || 'sha256' %> --kickstart\ntimezone --utc <%= @host.params['time-zone'] || 'UTC' %>\n\n<% if @host.operatingsystem.name == 'Fedora' and os_major <= 16 -%>\n# Bootloader exception for Fedora 16:\nbootloader --append=\"nofb quiet splash=quiet <%=ks_console%>\" <%= grub_pass %>\npart biosboot --fstype=biosboot --size=1\n<% else -%>\nbootloader --location=mbr --append=\"nofb quiet splash=quiet\" <%= grub_pass %>\n<% end -%>\n\n<% if os_major == 5 -%>\nkey --skip\n<% end -%>\n\n<% if @dynamic -%>\n%include /tmp/diskpart.cfg\n<% else -%>\n<%= @host.diskLayout %>\n<% end -%>\n\ntext\nreboot\n\n%packages --ignoremissing\nyum\ndhclient\nntp\nwget\n@Core\n<%= section_end -%>\n\n<% if @dynamic -%>\n%pre\n<%= @host.diskLayout %>\n<%= section_end -%>\n<% end -%>\n\n%post --nochroot\nexec < /dev/tty3 > /dev/tty3\n#changing to VT 3 so that we can see whats going on....\n/usr/bin/chvt 3\n(\ncp -va /etc/resolv.conf /mnt/sysimage/etc/resolv.conf\n/usr/bin/chvt 1\n) 2>&1 | tee /mnt/sysimage/root/install.postnochroot.log\n<%= section_end -%>\n\n\n%post\nlogger \"Starting anaconda <%= @host %> postinstall\"\nexec < /dev/tty3 > /dev/tty3\n#changing to VT 3 so that we can see whats going on....\n/usr/bin/chvt 3\n(\n<% if subnet.respond_to?(:dhcp_boot_mode?) -%>\n<%= snippet 'kickstart_networking_setup' %>\n<% end -%>\n\n#update local time\necho \"updating system time\"\n/usr/sbin/ntpdate -sub <%= @host.params['ntp-server'] || '0.fedora.pool.ntp.org' %>\n/usr/sbin/hwclock --systohc\n\n<%= snippet \"subscription_manager_registration\" %>\n\n<% if @host.info['parameters']['realm'] && @host.realm && @host.realm.realm_type == 'FreeIPA' -%>\n<%= snippet \"freeipa_register\" %>\n<% end -%>\n\n# update all the base packages from the updates repository\nyum -t -y -e 0 update\n\n<%= snippet('remote_execution_ssh_keys') %>\n\n<% if chef_enabled %>\n<%= snippet 'chef_client' %>\n<% end -%>\n\n<% if puppet_enabled %>\n<%= snippet 'puppet_setup' %>\n<% end -%>\n\n<% if salt_enabled %>\n<%= snippet 'saltstack_setup' %>\n<% end -%>\n\nsync\n\n<% if @provisioning_type == nil || @provisioning_type == 'host' -%>\n# Inform the build system that we are done.\necho \"Informing Foreman that we are built\"\nwget -q -O /dev/null --no-check-certificate <%= foreman_url('built') %>\n<% end -%>\n) 2>&1 | tee /root/install.post.log\nexit 0\n\n<%= section_end -%>\n","snippet":false,"template_kind_id":6,"locked":true,"default":true,"vendor":"Katello","os_family":null,"job_category":"Miscellaneous","provider_type":null,"description_format":null,"execution_timeout_interval":null}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":2,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-05-16 16:03:17 UTC","id":595,"auditable_id":157,"auditable_name":"Katello Atomic Kickstart Default","auditable_type":"ProvisioningTemplate","action":"destroy","audited_changes":{"name":"Katello Atomic Kickstart Default","template":"<%#\nkind: provision\nname: Katello Atomic Kickstart default\n%>\n\nlang <%= @host.params['lang'] || 'en_US.UTF-8' %>\nkeyboard <%= @host.params['keyboard'] || 'us' %>\ntimezone --utc <%= @host.params['time-zone'] || 'UTC' %>\n\n<% subnet = @host.subnet -%>\n<% if subnet.respond_to?(:dhcp_boot_mode?) -%>\n<% dhcp = subnet.dhcp_boot_mode? && !@static -%>\n<% else -%>\n<% dhcp = !@static -%>\n<% end -%>\n\nnetwork --bootproto <%= dhcp ? 'dhcp' : \"static --ip=#{@host.ip} --netmask=#{subnet.mask} --gateway=#{subnet.gateway} --nameserver=#{[subnet.dns_primary, subnet.dns_secondary].select{ |item| item.present? }.join(',')}\" %> --hostname <%= @host %><%= \" --device=#{@host.mac}\" -%>\n\n# Partition table should create /boot and a volume atomicos\n<% if @dynamic -%>\n%include /tmp/diskpart.cfg\n<% else -%>\n<%= @host.diskLayout %>\n<% end -%>\n\nbootloader --timeout=3\ntext\n\n<% if @host.os.name.match /.*fedora.*/i -%>\nostreesetup --nogpg --osname=fedora-atomic --remote=fedora-atomic --url=<%= @host.param_true?('atomic-upstream') ? \"https://dl.fedoraproject.org/pub/fedora/linux/atomic/#{@host.os.major}/\" : \"#{@host.operatingsystem.medium_uri(@host)}/content/repo/\" %> --ref=fedora-atomic/f<%= @host.os.major %>/<%= @host.architecture %>/docker-host\n<% elsif @host.os.name.match /.*centos.*/i -%>\nostreesetup --nogpg --osname=centos-atomic-host --remote=centos-atomic-host --url=<%= @host.param_true?('atomic-upstream') ? \"http://mirror.centos.org/centos/#{@host.os.major}/atomic/#{@host.architecture}/repo/\" : @host.operatingsystem.medium_uri(@host) %> --ref=centos-atomic-host/<%= @host.os.major %>/<%= @host.architecture %>/standard\n<% else -%>\nostreesetup --nogpg --osname=rhel-atomic-host --remote=rhel-atomic-host --url=file:///install/ostree --ref=rhel-atomic-host/<%= @host.os.major %>/<%= @host.architecture %>/standard\n<% end -%>\nservices --disabled cloud-init,cloud-config,cloud-final,cloud-init-local\nrootpw --iscrypted <%= root_pass %>\n\nreboot\n\n%post\n<%= snippet \"subscription_manager_registration\" %>\n<%= snippet('remote_execution_ssh_keys') %>\n(\n# Report success back to Foreman\ncurl -s -o /dev/null --insecure <%= foreman_url('built') %>\n) 2>&1 | tee /mnt/sysimage/root/install.post.log\n\nexit 0\n\n%end\n","snippet":false,"template_kind_id":6,"locked":true,"default":true,"vendor":"Katello","os_family":null,"job_category":"Miscellaneous","provider_type":null,"description_format":null,"execution_timeout_interval":null}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":9,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-05-16 16:03:15 UTC","id":594,"auditable_id":73,"auditable_name":"pxegrub2_discovery","auditable_type":"ProvisioningTemplate","action":"update","audited_changes":{"template":["<%#\nkind: snippet\nname: pxegrub2_discovery\n-%>\n<%#\ndiscovery image is based on CentOS/RHEL and therefor it is affected by https://bugzilla.redhat.com/show_bug.cgi?id=1259015.\nIn short, before RHEL 7.2 virtio driver didn't have the new persistent naming scheme, causing interfaces to be named eth0, eth1, etc..\nIf you want to enable the new persistent naming scheme and get inteface names like ens3, add net.ifnames=1 to the linuxefi line below.\n-%>\nmenuentry 'Foreman Discovery Image' {\n  linuxefi boot/fdi-image/vmlinuz0 rootflags=loop root=live:/fdi.iso rootfstype=auto ro rd.live.image acpi=force rd.luks=0 rd.md=0 rd.dm=0 rd.lvm=0 rd.bootif=0 rd.neednet=0 nomodeset proxy.url=<%= foreman_server_url %> proxy.type=foreman BOOTIF=01-$net_default_mac\n  initrdefi boot/fdi-image/initrd0.img\n}\n","<%#\nkind: snippet\nname: pxegrub2_discovery\n-%>\n<%#\nRHEL 7 virtio driver does not have persistent naming scheme, causing interfaces\nto be named eth0, eth1, etc.. If you want to enable the new persistent naming\nscheme and get inteface names like ens3, add net.ifnames=1 to the linuxefi line\nbelow. This will not be fixed until RHEL8 due to prevent breaking changes for\nexisting systems. See RHBZ#1259015 for more details.\n\nAnother bug in RHEL 7.4 is affecting $net_default_mac with a trailing slash, in\nthe global template we have a regexp module creating corrected variable $mac\nwhich is used here. See RHBZ#1487107 for more info.\n-%>\nmenuentry 'Foreman Discovery Image' {\n  linuxefi boot/fdi-image-rhel_7-vmlinuz rootflags=loop root=live:/fdi.iso rootfstype=auto ro rd.live.image acpi=force rd.luks=0 rd.md=0 rd.dm=0 rd.lvm=0 rd.bootif=0 rd.neednet=0 nomodeset proxy.url=<%= foreman_server_url %> proxy.type=foreman BOOTIF=01-$mac\n  initrdefi boot/fdi-image-rhel_7-img\n}\n"],"vendor":["Foreman","Satellite"]}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":9,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-05-16 16:03:15 UTC","id":593,"auditable_id":75,"auditable_name":"pxegrub_discovery","auditable_type":"ProvisioningTemplate","action":"update","audited_changes":{"template":["<%#\nkind: snippet\nname: pxegrub_discovery\n-%>\n<%#\ndiscovery image is based on CentOS/RHEL and therefor it is affected by https://bugzilla.redhat.com/show_bug.cgi?id=1259015.\nIn short, before RHEL 7.2 virtio driver didn't have the new persistent naming scheme, causing interfaces to be named eth0, eth1, etc..\nIf you want to enable the new persistent naming scheme and get inteface names like ens3, add net.ifnames=1 to the kernel line below.\n-%>\n# http://projects.theforeman.org/issues/15997\ntitle Foreman Discovery Image - not supported with Grub 1.x\n  kernel boot/fdi-image/vmlinuz0 rootflags=loop root=live:/fdi.iso rootfstype=auto ro rd.live.image acpi=force rd.luks=0 rd.md=0 rd.dm=0 rd.lvm=0 rd.bootif=0 rd.neednet=0 nomodeset proxy.url=<%= foreman_server_url %> proxy.type=foreman BOOTIF=01-$net_default_mac\n  initrd boot/fdi-image/initrd0.img\n","<%#\nkind: snippet\nname: pxegrub_discovery\n-%>\n<%#\ndiscovery image is based on CentOS/RHEL and therefor it is affected by https://bugzilla.redhat.com/show_bug.cgi?id=1259015.\nIn short, before RHEL 7.2 virtio driver didn't have the new persistent naming scheme, causing interfaces to be named eth0, eth1, etc..\nIf you want to enable the new persistent naming scheme and get inteface names like ens3, add net.ifnames=1 to the kernel line below.\n-%>\n# http://projects.theforeman.org/issues/15997\ntitle Foreman Discovery Image - not supported with Grub 1.x\n  kernel boot/fdi-image-rhel_7-vmlinuz rootflags=loop root=live:/fdi.iso rootfstype=auto ro rd.live.image acpi=force rd.luks=0 rd.md=0 rd.dm=0 rd.lvm=0 rd.bootif=0 rd.neednet=0 nomodeset proxy.url=<%= foreman_server_url %> proxy.type=foreman BOOTIF=01-$net_default_mac\n  initrd boot/fdi-image-rhel_7-img\n"],"vendor":["Foreman","Satellite"]}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":9,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-05-16 16:03:15 UTC","id":592,"auditable_id":77,"auditable_name":"pxelinux_discovery","auditable_type":"ProvisioningTemplate","action":"update","audited_changes":{"template":["<%#\nkind: snippet\nname: pxelinux_discovery\n-%>\n<%#\ndiscovery image is based on CentOS/RHEL and therefor it is affected by https://bugzilla.redhat.com/show_bug.cgi?id=1259015.\nIn short, before RHEL 7.2 virtio driver didn't have the new persistent naming scheme, causing interfaces to be named eth0, eth1, etc..\nIf you want to enable the new persistent naming scheme and get inteface names like ens3, add net.ifnames=1 to the APPEND line below.\n-%>\nLABEL discovery\n  MENU LABEL Foreman Discovery Image\n  KERNEL boot/fdi-image/vmlinuz0\n  APPEND initrd=boot/fdi-image/initrd0.img rootflags=loop root=live:/fdi.iso rootfstype=auto ro rd.live.image acpi=force rd.luks=0 rd.md=0 rd.dm=0 rd.lvm=0 rd.bootif=0 rd.neednet=0 nomodeset proxy.url=<%= foreman_server_url %> proxy.type=foreman\n  IPAPPEND 2\n","<%#\nkind: snippet\nname: pxelinux_discovery\n-%>\n<%#\ndiscovery image is based on CentOS/RHEL and therefor it is affected by https://bugzilla.redhat.com/show_bug.cgi?id=1259015.\nIn short, before RHEL 7.2 virtio driver didn't have the new persistent naming scheme, causing interfaces to be named eth0, eth1, etc..\nIf you want to enable the new persistent naming scheme and get inteface names like ens3, add net.ifnames=1 to the APPEND line below.\n-%>\nLABEL discovery\n  MENU LABEL Foreman Discovery Image\n  KERNEL boot/fdi-image-rhel_7-vmlinuz\n  APPEND initrd=boot/fdi-image-rhel_7-img rootflags=loop root=live:/fdi.iso rootfstype=auto ro rd.live.image acpi=force rd.luks=0 rd.md=0 rd.dm=0 rd.lvm=0 rd.bootif=0 rd.neednet=0 nomodeset proxy.url=<%= foreman_server_url %> proxy.type=foreman\n  IPAPPEND 2\n"],"vendor":["Foreman","Satellite"]}},{"user_id":null,"user_type":null,"user_name":null,"version":1,"comment":null,"associated_id":20,"associated_type":"Role","remote_address":null,"associated_name":"Access Insights Viewer","created_at":"2018-05-16 16:03:14 UTC","id":591,"auditable_id":284,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":20,"taxonomy_search":null,"override":false}},{"user_id":null,"user_type":null,"user_name":null,"version":1,"comment":null,"associated_id":21,"associated_type":"Role","remote_address":null,"associated_name":"Access Insights Admin","created_at":"2018-05-16 16:03:14 UTC","id":590,"auditable_id":283,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":21,"taxonomy_search":null,"override":false}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-05-16 16:03:12 UTC","id":589,"auditable_id":157,"auditable_name":null,"auditable_type":"ProvisioningTemplate","action":"create","audited_changes":{"name":"Katello Atomic Kickstart Default","template":"<%#\nkind: provision\nname: Katello Atomic Kickstart default\n%>\n\nlang <%= @host.params['lang'] || 'en_US.UTF-8' %>\nkeyboard <%= @host.params['keyboard'] || 'us' %>\ntimezone --utc <%= @host.params['time-zone'] || 'UTC' %>\n\n<% subnet = @host.subnet -%>\n<% if subnet.respond_to?(:dhcp_boot_mode?) -%>\n<% dhcp = subnet.dhcp_boot_mode? && !@static -%>\n<% else -%>\n<% dhcp = !@static -%>\n<% end -%>\n\nnetwork --bootproto <%= dhcp ? 'dhcp' : \"static --ip=#{@host.ip} --netmask=#{subnet.mask} --gateway=#{subnet.gateway} --nameserver=#{[subnet.dns_primary, subnet.dns_secondary].select{ |item| item.present? }.join(',')}\" %> --hostname <%= @host %><%= \" --device=#{@host.mac}\" -%>\n\n# Partition table should create /boot and a volume atomicos\n<% if @dynamic -%>\n%include /tmp/diskpart.cfg\n<% else -%>\n<%= @host.diskLayout %>\n<% end -%>\n\nbootloader --timeout=3\ntext\n\n<% if @host.os.name.match /.*fedora.*/i -%>\nostreesetup --nogpg --osname=fedora-atomic --remote=fedora-atomic --url=<%= @host.param_true?('atomic-upstream') ? \"https://dl.fedoraproject.org/pub/fedora/linux/atomic/#{@host.os.major}/\" : \"#{@host.operatingsystem.medium_uri(@host)}/content/repo/\" %> --ref=fedora-atomic/f<%= @host.os.major %>/<%= @host.architecture %>/docker-host\n<% elsif @host.os.name.match /.*centos.*/i -%>\nostreesetup --nogpg --osname=centos-atomic-host --remote=centos-atomic-host --url=<%= @host.param_true?('atomic-upstream') ? \"http://mirror.centos.org/centos/#{@host.os.major}/atomic/#{@host.architecture}/repo/\" : @host.operatingsystem.medium_uri(@host) %> --ref=centos-atomic-host/<%= @host.os.major %>/<%= @host.architecture %>/standard\n<% else -%>\nostreesetup --nogpg --osname=rhel-atomic-host --remote=rhel-atomic-host --url=file:///install/ostree --ref=rhel-atomic-host/<%= @host.os.major %>/<%= @host.architecture %>/standard\n<% end -%>\nservices --disabled cloud-init,cloud-config,cloud-final,cloud-init-local\nrootpw --iscrypted <%= root_pass %>\n\nreboot\n\n%post\n<%= snippet \"subscription_manager_registration\" %>\n<%= snippet('remote_execution_ssh_keys') %>\n(\n# Report success back to Foreman\ncurl -s -o /dev/null --insecure <%= foreman_url('built') %>\n) 2>&1 | tee /mnt/sysimage/root/install.post.log\n\nexit 0\n\n%end\n","snippet":false,"template_kind_id":6,"locked":true,"default":true,"vendor":"Katello","os_family":null,"job_category":"Miscellaneous","provider_type":null,"description_format":null,"execution_timeout_interval":null}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-05-16 16:03:12 UTC","id":588,"auditable_id":156,"auditable_name":null,"auditable_type":"ProvisioningTemplate","action":"create","audited_changes":{"name":"Katello Kickstart Default Finish","template":"<%#\nkind: finish\nname: Katello Kickstart default finish\noses:\n- CentOS 5\n- CentOS 6\n- CentOS 7\n- RedHat 5\n- RedHat 6\n- RedHat 7\n- Fedora 19\n- Fedora 20\n%>\n<% if @host.subnet.respond_to?(:dhcp_boot_mode?) -%>\n<%= snippet 'kickstart_networking_setup' %>\nservice network restart\n<% end -%>\n\n<%\n  rhel_compatible = @host.operatingsystem.family == 'Redhat' && @host.operatingsystem.name != 'Fedora'\n  os_major = @host.operatingsystem.major.to_i\n  pm_set = @host.puppetmaster.empty? ? false : true\n  puppet_enabled = pm_set || @host.params['force-puppet']\n  salt_enabled = @host.params['salt_master'] ? true : false\n  chef_enabled = @host.respond_to?(:chef_proxy) && @host.chef_proxy\n%>\n\n<%= snippet \"subscription_manager_registration\" %>\n\n<% if @host.respond_to?(:realm) && @host.otp && @host.realm && @host.realm.realm_type == \"FreeIPA\" -%>\n<%= snippet \"freeipa_register\" %>\n<% end -%>\n\n# update local time\necho \"updating system time\"\n/usr/sbin/ntpdate -sub <%= @host.params['ntp-server'] || '0.fedora.pool.ntp.org' %>\n/usr/sbin/hwclock --systohc\n\n<% if @host.info['parameters']['realm'] && @host.realm && @host.realm.realm_type == 'FreeIPA' -%>\n<%= snippet \"freeipa_register\" %>\n<% end -%>\n\n# update all the base packages from the updates repository\nyum -t -y -e 0 update\n\n<%= snippet('remote_execution_ssh_keys') %>\n\n<% if chef_enabled %>\n<%= snippet 'chef_client' %>\n<% end -%>\n\n<% if puppet_enabled %>\n<%= snippet 'puppet_setup' %>\n<% end -%>\n\n<% if salt_enabled %>\n<%= snippet 'saltstack_setup' %>\n<% end -%>\n\nexit 0\n","snippet":false,"template_kind_id":7,"locked":true,"default":true,"vendor":"Katello","os_family":null,"job_category":"Miscellaneous","provider_type":null,"description_format":null,"execution_timeout_interval":null}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-05-16 16:03:12 UTC","id":587,"auditable_id":155,"auditable_name":null,"auditable_type":"ProvisioningTemplate","action":"create","audited_changes":{"name":"Katello Kickstart Default User Data","template":"<%#\nkind: user_data\nname: Katello Kickstart default user data\noses:\n- CentOS 6\n- CentOS 7\n- Fedora 19\n- Fedora 20\n- Fedora 21\n- Fedora 22\n- Fedora 23\n-%>\n#cloud-config\nhostname: <%= @host.shortname %>\nfqdn: <%= @host %>\nmanage_etc_hosts: true\n\ngroups:\n - admin\n\nusers:\n - default\n - name: admin\n   primary-group: admin\n   groups: users\n   shell: /bin/bash\n   sudo: ['ALL=(ALL) ALL']\n   lock-passwd: false\n   passwd: <%= @host.root_pass %>\n\n<%# Allow user to specify additional SSH key as host paramter -%>\n<% if @host.params['sshkey'].present? || @host.params['remote_execution_ssh_keys'].present? -%>\nssh_authorized_keys:\n<% if @host.params['sshkey'].present? -%>\n  - <%= @host.params['sshkey'] %>\n<% end -%>\n<% if @host.params['remote_execution_ssh_keys'].present? -%>\n<% @host.params['remote_execution_ssh_keys'].each do |key| -%>\n  - <%= key %>\n<% end -%>\n<% end -%>\n<% end -%>\nwrite_files:\n- path: /tmp/foreman-userdata.sh\n  permissions: '0755'\n  content: |\n    #!/bin/bash\n<%= indent 4 do\n      snippet 'subscription_manager_registration'\n    end %>\n<% if @host.info['parameters']['realm'] && @host.realm && @host.realm.realm_type == 'FreeIPA' -%>\n<%= indent 4 do\n      snippet 'freeipa_register'\n    end %>\n<% end -%>\n  <% unless @host.operatingsystem.atomic? -%>\n    # update all the base packages from the updates repository\n    yum -t -y -e 0 update\n  <% end -%>\n<%\n  # safemode renderer does not support unary negation\n  non_atomic = @host.operatingsystem.atomic? ? false : true\n  pm_set = @host.puppetmaster.empty? ? false : true\n  puppet_enabled = non_atomic && (pm_set || @host.params['force-puppet'])\n  salt_enabled = non_atomic && (@host.params['salt_master'] ? true : false)\n  chef_enabled = @host.respond_to?(:chef_proxy) && @host.chef_proxy\n%>\n<% if chef_enabled %>\n<%= indent 4 do\n      snippet 'chef_client'\n    end  %>\n<% end -%>\n\n<% if puppet_enabled %>\n<%= indent 4 do\n      snippet 'puppet_setup'\n    end %>\n<% end -%>\n\n<% if salt_enabled %>\n<%= indent 4 do\n      snippet 'saltstack_setup'\n    end %>\n<% end -%>\nphone_home:\n url: <%= foreman_url('built') %>\n post: []\n tries: 10\nruncmd:\n - [ cloud-init-per, once, foreman-userdata, /tmp/foreman-userdata.sh ]\noutput: {all: '| tee -a /root/install.userdata.log'}\n\n","snippet":false,"template_kind_id":9,"locked":true,"default":true,"vendor":"Katello","os_family":null,"job_category":"Miscellaneous","provider_type":null,"description_format":null,"execution_timeout_interval":null}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-05-16 16:03:12 UTC","id":586,"auditable_id":154,"auditable_name":null,"auditable_type":"ProvisioningTemplate","action":"create","audited_changes":{"name":"Katello Kickstart Default","template":"<%#\nkind: provision\nname: Katello Kickstart default\noses:\n- CentOS 5\n- CentOS 6\n- CentOS 7\n- RedHat 5\n- RedHat 6\n- RedHat 7\n- Fedora 19\n- Fedora 20\n%>\n<%\n  rhel_compatible = @host.operatingsystem.family == 'Redhat' && @host.operatingsystem.name != 'Fedora'\n  os_major = @host.operatingsystem.major.to_i\n  # safemode renderer does not support unary negation\n  pm_set = @host.puppetmaster.empty? ? false : true\n  puppet_enabled = pm_set || @host.params['force-puppet']\n  salt_enabled = @host.params['salt_master'] ? true : false\n  chef_enabled = @host.respond_to?(:chef_proxy) && @host.chef_proxy\n  section_end = (rhel_compatible && os_major <= 5) ? '' : '%end'\n%>\ninstall\n<%= @mediapath %>\nlang en_US.UTF-8\nselinux --enforcing\nkeyboard us\nskipx\n\n<% subnet = @host.subnet -%>\n<% if subnet.respond_to?(:dhcp_boot_mode?) -%>\n<% dhcp = subnet.dhcp_boot_mode? && !@static -%>\n<% else -%>\n<% dhcp = !@static -%>\n<% end -%>\n\nnetwork --bootproto <%= dhcp ? 'dhcp' : \"static --ip=#{@host.ip} --netmask=#{subnet.mask} --gateway=#{subnet.gateway} --nameserver=#{[subnet.dns_primary, subnet.dns_secondary].select{ |item| item.present? }.join(',')}\" %> --hostname <%= @host %><%= os_major >= 6 ? \" --device=#{@host.mac}\" : '' -%>\n\nrootpw --iscrypted <%= root_pass %>\nfirewall --<%= os_major >= 6 ? 'service=' : '' %>ssh\nauthconfig --useshadow --passalgo=<%= @host.operatingsystem.password_hash || 'sha256' %> --kickstart\ntimezone --utc <%= @host.params['time-zone'] || 'UTC' %>\n\n<% if @host.operatingsystem.name == 'Fedora' and os_major <= 16 -%>\n# Bootloader exception for Fedora 16:\nbootloader --append=\"nofb quiet splash=quiet <%=ks_console%>\" <%= grub_pass %>\npart biosboot --fstype=biosboot --size=1\n<% else -%>\nbootloader --location=mbr --append=\"nofb quiet splash=quiet\" <%= grub_pass %>\n<% end -%>\n\n<% if os_major == 5 -%>\nkey --skip\n<% end -%>\n\n<% if @dynamic -%>\n%include /tmp/diskpart.cfg\n<% else -%>\n<%= @host.diskLayout %>\n<% end -%>\n\ntext\nreboot\n\n%packages --ignoremissing\nyum\ndhclient\nntp\nwget\n@Core\n<%= section_end -%>\n\n<% if @dynamic -%>\n%pre\n<%= @host.diskLayout %>\n<%= section_end -%>\n<% end -%>\n\n%post --nochroot\nexec < /dev/tty3 > /dev/tty3\n#changing to VT 3 so that we can see whats going on....\n/usr/bin/chvt 3\n(\ncp -va /etc/resolv.conf /mnt/sysimage/etc/resolv.conf\n/usr/bin/chvt 1\n) 2>&1 | tee /mnt/sysimage/root/install.postnochroot.log\n<%= section_end -%>\n\n\n%post\nlogger \"Starting anaconda <%= @host %> postinstall\"\nexec < /dev/tty3 > /dev/tty3\n#changing to VT 3 so that we can see whats going on....\n/usr/bin/chvt 3\n(\n<% if subnet.respond_to?(:dhcp_boot_mode?) -%>\n<%= snippet 'kickstart_networking_setup' %>\n<% end -%>\n\n#update local time\necho \"updating system time\"\n/usr/sbin/ntpdate -sub <%= @host.params['ntp-server'] || '0.fedora.pool.ntp.org' %>\n/usr/sbin/hwclock --systohc\n\n<%= snippet \"subscription_manager_registration\" %>\n\n<% if @host.info['parameters']['realm'] && @host.realm && @host.realm.realm_type == 'FreeIPA' -%>\n<%= snippet \"freeipa_register\" %>\n<% end -%>\n\n# update all the base packages from the updates repository\nyum -t -y -e 0 update\n\n<%= snippet('remote_execution_ssh_keys') %>\n\n<% if chef_enabled %>\n<%= snippet 'chef_client' %>\n<% end -%>\n\n<% if puppet_enabled %>\n<%= snippet 'puppet_setup' %>\n<% end -%>\n\n<% if salt_enabled %>\n<%= snippet 'saltstack_setup' %>\n<% end -%>\n\nsync\n\n<% if @provisioning_type == nil || @provisioning_type == 'host' -%>\n# Inform the build system that we are done.\necho \"Informing Foreman that we are built\"\nwget -q -O /dev/null --no-check-certificate <%= foreman_url('built') %>\n<% end -%>\n) 2>&1 | tee /root/install.post.log\nexit 0\n\n<%= section_end -%>\n","snippet":false,"template_kind_id":6,"locked":true,"default":true,"vendor":"Katello","os_family":null,"job_category":"Miscellaneous","provider_type":null,"description_format":null,"execution_timeout_interval":null}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":2,"comment":null,"associated_id":21,"associated_type":"Role","remote_address":null,"associated_name":"Access Insights Admin","created_at":"2018-05-16 15:30:28 UTC","id":585,"auditable_id":281,"auditable_name":"view_hosts","auditable_type":"Filter","action":"destroy","audited_changes":{"search":null,"role_id":21,"taxonomy_search":null,"override":false}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":2,"comment":null,"associated_id":20,"associated_type":"Role","remote_address":null,"associated_name":"Access Insights Viewer","created_at":"2018-05-16 15:30:27 UTC","id":584,"auditable_id":282,"auditable_name":"view_hosts","auditable_type":"Filter","action":"destroy","audited_changes":{"search":null,"role_id":20,"taxonomy_search":null,"override":false}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":2,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-05-16 15:30:13 UTC","id":583,"auditable_id":151,"auditable_name":"Katello Kickstart Default User Data","auditable_type":"ProvisioningTemplate","action":"destroy","audited_changes":{"name":"Katello Kickstart Default User Data","template":"<%#\nkind: user_data\nname: Katello Kickstart default user data\noses:\n- CentOS 6\n- CentOS 7\n- Fedora 19\n- Fedora 20\n- Fedora 21\n- Fedora 22\n- Fedora 23\n-%>\n#cloud-config\nhostname: <%= @host.shortname %>\nfqdn: <%= @host %>\nmanage_etc_hosts: true\n\ngroups:\n - admin\n\nusers:\n - default\n - name: admin\n   primary-group: admin\n   groups: users\n   shell: /bin/bash\n   sudo: ['ALL=(ALL) ALL']\n   lock-passwd: false\n   passwd: <%= @host.root_pass %>\n\n<%# Allow user to specify additional SSH key as host paramter -%>\n<% if @host.params['sshkey'].present? || @host.params['remote_execution_ssh_keys'].present? -%>\nssh_authorized_keys:\n<% if @host.params['sshkey'].present? -%>\n  - <%= @host.params['sshkey'] %>\n<% end -%>\n<% if @host.params['remote_execution_ssh_keys'].present? -%>\n<% @host.params['remote_execution_ssh_keys'].each do |key| -%>\n  - <%= key %>\n<% end -%>\n<% end -%>\n<% end -%>\nwrite_files:\n- path: /tmp/foreman-userdata.sh\n  permissions: '0755'\n  content: |\n    #!/bin/bash\n<%= indent 4 do\n      snippet 'subscription_manager_registration'\n    end %>\n<% if @host.info['parameters']['realm'] && @host.realm && @host.realm.realm_type == 'FreeIPA' -%>\n<%= indent 4 do\n      snippet 'freeipa_register'\n    end %>\n<% end -%>\n  <% unless @host.operatingsystem.atomic? -%>\n    # update all the base packages from the updates repository\n    yum -t -y -e 0 update\n  <% end -%>\n<%\n  # safemode renderer does not support unary negation\n  non_atomic = @host.operatingsystem.atomic? ? false : true\n  pm_set = @host.puppetmaster.empty? ? false : true\n  puppet_enabled = non_atomic && (pm_set || @host.params['force-puppet'])\n  salt_enabled = non_atomic && (@host.params['salt_master'] ? true : false)\n  chef_enabled = @host.respond_to?(:chef_proxy) && @host.chef_proxy\n%>\n<% if chef_enabled %>\n<%= indent 4 do\n      snippet 'chef_client'\n    end  %>\n<% end -%>\n\n<% if puppet_enabled %>\n<%= indent 4 do\n      snippet 'puppet_setup'\n    end %>\n<% end -%>\n\n<% if salt_enabled %>\n<%= indent 4 do\n      snippet 'saltstack_setup'\n    end %>\n<% end -%>\nphone_home:\n url: <%= foreman_url('built') %>\n post: []\n tries: 10\nruncmd:\n - [ cloud-init-per, once, foreman-userdata, /tmp/foreman-userdata.sh ]\noutput: {all: '| tee -a /root/install.userdata.log'}\n\n","snippet":false,"template_kind_id":9,"locked":true,"default":true,"vendor":"Katello","os_family":null,"job_category":"Miscellaneous","provider_type":null,"description_format":null,"execution_timeout_interval":null}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":2,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-05-16 15:30:13 UTC","id":582,"auditable_id":152,"auditable_name":"Katello Kickstart Default Finish","auditable_type":"ProvisioningTemplate","action":"destroy","audited_changes":{"name":"Katello Kickstart Default Finish","template":"<%#\nkind: finish\nname: Katello Kickstart default finish\noses:\n- CentOS 5\n- CentOS 6\n- CentOS 7\n- RedHat 5\n- RedHat 6\n- RedHat 7\n- Fedora 19\n- Fedora 20\n%>\n<% if @host.subnet.respond_to?(:dhcp_boot_mode?) -%>\n<%= snippet 'kickstart_networking_setup' %>\nservice network restart\n<% end -%>\n\n<%\n  rhel_compatible = @host.operatingsystem.family == 'Redhat' && @host.operatingsystem.name != 'Fedora'\n  os_major = @host.operatingsystem.major.to_i\n  pm_set = @host.puppetmaster.empty? ? false : true\n  puppet_enabled = pm_set || @host.params['force-puppet']\n  salt_enabled = @host.params['salt_master'] ? true : false\n  chef_enabled = @host.respond_to?(:chef_proxy) && @host.chef_proxy\n%>\n\n<%= snippet \"subscription_manager_registration\" %>\n\n<% if @host.respond_to?(:realm) && @host.otp && @host.realm && @host.realm.realm_type == \"FreeIPA\" -%>\n<%= snippet \"freeipa_register\" %>\n<% end -%>\n\n# update local time\necho \"updating system time\"\n/usr/sbin/ntpdate -sub <%= @host.params['ntp-server'] || '0.fedora.pool.ntp.org' %>\n/usr/sbin/hwclock --systohc\n\n<% if @host.info['parameters']['realm'] && @host.realm && @host.realm.realm_type == 'FreeIPA' -%>\n<%= snippet \"freeipa_register\" %>\n<% end -%>\n\n# update all the base packages from the updates repository\nyum -t -y -e 0 update\n\n<%= snippet('remote_execution_ssh_keys') %>\n\n<% if chef_enabled %>\n<%= snippet 'chef_client' %>\n<% end -%>\n\n<% if puppet_enabled %>\n<%= snippet 'puppet_setup' %>\n<% end -%>\n\n<% if salt_enabled %>\n<%= snippet 'saltstack_setup' %>\n<% end -%>\n\nexit 0\n","snippet":false,"template_kind_id":7,"locked":true,"default":true,"vendor":"Katello","os_family":null,"job_category":"Miscellaneous","provider_type":null,"description_format":null,"execution_timeout_interval":null}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":2,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-05-16 15:30:13 UTC","id":581,"auditable_id":150,"auditable_name":"Katello Kickstart Default","auditable_type":"ProvisioningTemplate","action":"destroy","audited_changes":{"name":"Katello Kickstart Default","template":"<%#\nkind: provision\nname: Katello Kickstart default\noses:\n- CentOS 5\n- CentOS 6\n- CentOS 7\n- RedHat 5\n- RedHat 6\n- RedHat 7\n- Fedora 19\n- Fedora 20\n%>\n<%\n  rhel_compatible = @host.operatingsystem.family == 'Redhat' && @host.operatingsystem.name != 'Fedora'\n  os_major = @host.operatingsystem.major.to_i\n  # safemode renderer does not support unary negation\n  pm_set = @host.puppetmaster.empty? ? false : true\n  puppet_enabled = pm_set || @host.params['force-puppet']\n  salt_enabled = @host.params['salt_master'] ? true : false\n  chef_enabled = @host.respond_to?(:chef_proxy) && @host.chef_proxy\n  section_end = (rhel_compatible && os_major <= 5) ? '' : '%end'\n%>\ninstall\n<%= @mediapath %>\nlang en_US.UTF-8\nselinux --enforcing\nkeyboard us\nskipx\n\n<% subnet = @host.subnet -%>\n<% if subnet.respond_to?(:dhcp_boot_mode?) -%>\n<% dhcp = subnet.dhcp_boot_mode? && !@static -%>\n<% else -%>\n<% dhcp = !@static -%>\n<% end -%>\n\nnetwork --bootproto <%= dhcp ? 'dhcp' : \"static --ip=#{@host.ip} --netmask=#{subnet.mask} --gateway=#{subnet.gateway} --nameserver=#{[subnet.dns_primary, subnet.dns_secondary].select{ |item| item.present? }.join(',')}\" %> --hostname <%= @host %><%= os_major >= 6 ? \" --device=#{@host.mac}\" : '' -%>\n\nrootpw --iscrypted <%= root_pass %>\nfirewall --<%= os_major >= 6 ? 'service=' : '' %>ssh\nauthconfig --useshadow --passalgo=<%= @host.operatingsystem.password_hash || 'sha256' %> --kickstart\ntimezone --utc <%= @host.params['time-zone'] || 'UTC' %>\n\n<% if @host.operatingsystem.name == 'Fedora' and os_major <= 16 -%>\n# Bootloader exception for Fedora 16:\nbootloader --append=\"nofb quiet splash=quiet <%=ks_console%>\" <%= grub_pass %>\npart biosboot --fstype=biosboot --size=1\n<% else -%>\nbootloader --location=mbr --append=\"nofb quiet splash=quiet\" <%= grub_pass %>\n<% end -%>\n\n<% if os_major == 5 -%>\nkey --skip\n<% end -%>\n\n<% if @dynamic -%>\n%include /tmp/diskpart.cfg\n<% else -%>\n<%= @host.diskLayout %>\n<% end -%>\n\ntext\nreboot\n\n%packages --ignoremissing\nyum\ndhclient\nntp\nwget\n@Core\n<%= section_end -%>\n\n<% if @dynamic -%>\n%pre\n<%= @host.diskLayout %>\n<%= section_end -%>\n<% end -%>\n\n%post --nochroot\nexec < /dev/tty3 > /dev/tty3\n#changing to VT 3 so that we can see whats going on....\n/usr/bin/chvt 3\n(\ncp -va /etc/resolv.conf /mnt/sysimage/etc/resolv.conf\n/usr/bin/chvt 1\n) 2>&1 | tee /mnt/sysimage/root/install.postnochroot.log\n<%= section_end -%>\n\n\n%post\nlogger \"Starting anaconda <%= @host %> postinstall\"\nexec < /dev/tty3 > /dev/tty3\n#changing to VT 3 so that we can see whats going on....\n/usr/bin/chvt 3\n(\n<% if subnet.respond_to?(:dhcp_boot_mode?) -%>\n<%= snippet 'kickstart_networking_setup' %>\n<% end -%>\n\n#update local time\necho \"updating system time\"\n/usr/sbin/ntpdate -sub <%= @host.params['ntp-server'] || '0.fedora.pool.ntp.org' %>\n/usr/sbin/hwclock --systohc\n\n<%= snippet \"subscription_manager_registration\" %>\n\n<% if @host.info['parameters']['realm'] && @host.realm && @host.realm.realm_type == 'FreeIPA' -%>\n<%= snippet \"freeipa_register\" %>\n<% end -%>\n\n# update all the base packages from the updates repository\nyum -t -y -e 0 update\n\n<%= snippet('remote_execution_ssh_keys') %>\n\n<% if chef_enabled %>\n<%= snippet 'chef_client' %>\n<% end -%>\n\n<% if puppet_enabled %>\n<%= snippet 'puppet_setup' %>\n<% end -%>\n\n<% if salt_enabled %>\n<%= snippet 'saltstack_setup' %>\n<% end -%>\n\nsync\n\n<% if @provisioning_type == nil || @provisioning_type == 'host' -%>\n# Inform the build system that we are done.\necho \"Informing Foreman that we are built\"\nwget -q -O /dev/null --no-check-certificate <%= foreman_url('built') %>\n<% end -%>\n) 2>&1 | tee /root/install.post.log\nexit 0\n\n<%= section_end -%>\n","snippet":false,"template_kind_id":6,"locked":true,"default":true,"vendor":"Katello","os_family":null,"job_category":"Miscellaneous","provider_type":null,"description_format":null,"execution_timeout_interval":null}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":2,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-05-16 15:30:13 UTC","id":580,"auditable_id":153,"auditable_name":"Katello Atomic Kickstart Default","auditable_type":"ProvisioningTemplate","action":"destroy","audited_changes":{"name":"Katello Atomic Kickstart Default","template":"<%#\nkind: provision\nname: Katello Atomic Kickstart default\n%>\n\nlang <%= @host.params['lang'] || 'en_US.UTF-8' %>\nkeyboard <%= @host.params['keyboard'] || 'us' %>\ntimezone --utc <%= @host.params['time-zone'] || 'UTC' %>\n\n<% subnet = @host.subnet -%>\n<% if subnet.respond_to?(:dhcp_boot_mode?) -%>\n<% dhcp = subnet.dhcp_boot_mode? && !@static -%>\n<% else -%>\n<% dhcp = !@static -%>\n<% end -%>\n\nnetwork --bootproto <%= dhcp ? 'dhcp' : \"static --ip=#{@host.ip} --netmask=#{subnet.mask} --gateway=#{subnet.gateway} --nameserver=#{[subnet.dns_primary, subnet.dns_secondary].select{ |item| item.present? }.join(',')}\" %> --hostname <%= @host %><%= \" --device=#{@host.mac}\" -%>\n\n# Partition table should create /boot and a volume atomicos\n<% if @dynamic -%>\n%include /tmp/diskpart.cfg\n<% else -%>\n<%= @host.diskLayout %>\n<% end -%>\n\nbootloader --timeout=3\ntext\n\n<% if @host.os.name.match /.*fedora.*/i -%>\nostreesetup --nogpg --osname=fedora-atomic --remote=fedora-atomic --url=<%= @host.param_true?('atomic-upstream') ? \"https://dl.fedoraproject.org/pub/fedora/linux/atomic/#{@host.os.major}/\" : \"#{@host.operatingsystem.medium_uri(@host)}/content/repo/\" %> --ref=fedora-atomic/f<%= @host.os.major %>/<%= @host.architecture %>/docker-host\n<% elsif @host.os.name.match /.*centos.*/i -%>\nostreesetup --nogpg --osname=centos-atomic-host --remote=centos-atomic-host --url=<%= @host.param_true?('atomic-upstream') ? \"http://mirror.centos.org/centos/#{@host.os.major}/atomic/#{@host.architecture}/repo/\" : @host.operatingsystem.medium_uri(@host) %> --ref=centos-atomic-host/<%= @host.os.major %>/<%= @host.architecture %>/standard\n<% else -%>\nostreesetup --nogpg --osname=rhel-atomic-host --remote=rhel-atomic-host --url=file:///install/ostree --ref=rhel-atomic-host/<%= @host.os.major %>/<%= @host.architecture %>/standard\n<% end -%>\nservices --disabled cloud-init,cloud-config,cloud-final,cloud-init-local\nrootpw --iscrypted <%= root_pass %>\n\nreboot\n\n%post\n<%= snippet \"subscription_manager_registration\" %>\n<%= snippet('remote_execution_ssh_keys') %>\n(\n# Report success back to Foreman\ncurl -s -o /dev/null --insecure <%= foreman_url('built') %>\n) 2>&1 | tee /mnt/sysimage/root/install.post.log\n\nexit 0\n\n%end\n","snippet":false,"template_kind_id":6,"locked":true,"default":true,"vendor":"Katello","os_family":null,"job_category":"Miscellaneous","provider_type":null,"description_format":null,"execution_timeout_interval":null}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":8,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-05-16 15:30:11 UTC","id":579,"auditable_id":73,"auditable_name":"pxegrub2_discovery","auditable_type":"ProvisioningTemplate","action":"update","audited_changes":{"template":["<%#\nkind: snippet\nname: pxegrub2_discovery\n-%>\n<%#\ndiscovery image is based on CentOS/RHEL and therefor it is affected by https://bugzilla.redhat.com/show_bug.cgi?id=1259015.\nIn short, before RHEL 7.2 virtio driver didn't have the new persistent naming scheme, causing interfaces to be named eth0, eth1, etc..\nIf you want to enable the new persistent naming scheme and get inteface names like ens3, add net.ifnames=1 to the linuxefi line below.\n-%>\nmenuentry 'Foreman Discovery Image' {\n  linuxefi boot/fdi-image/vmlinuz0 rootflags=loop root=live:/fdi.iso rootfstype=auto ro rd.live.image acpi=force rd.luks=0 rd.md=0 rd.dm=0 rd.lvm=0 rd.bootif=0 rd.neednet=0 nomodeset proxy.url=<%= foreman_server_url %> proxy.type=foreman BOOTIF=01-$net_default_mac\n  initrdefi boot/fdi-image/initrd0.img\n}\n","<%#\nkind: snippet\nname: pxegrub2_discovery\n-%>\n<%#\nRHEL 7 virtio driver does not have persistent naming scheme, causing interfaces\nto be named eth0, eth1, etc.. If you want to enable the new persistent naming\nscheme and get inteface names like ens3, add net.ifnames=1 to the linuxefi line\nbelow. This will not be fixed until RHEL8 due to prevent breaking changes for\nexisting systems. See RHBZ#1259015 for more details.\n\nAnother bug in RHEL 7.4 is affecting $net_default_mac with a trailing slash, in\nthe global template we have a regexp module creating corrected variable $mac\nwhich is used here. See RHBZ#1487107 for more info.\n-%>\nmenuentry 'Foreman Discovery Image' {\n  linuxefi boot/fdi-image-rhel_7-vmlinuz rootflags=loop root=live:/fdi.iso rootfstype=auto ro rd.live.image acpi=force rd.luks=0 rd.md=0 rd.dm=0 rd.lvm=0 rd.bootif=0 rd.neednet=0 nomodeset proxy.url=<%= foreman_server_url %> proxy.type=foreman BOOTIF=01-$mac\n  initrdefi boot/fdi-image-rhel_7-img\n}\n"],"vendor":["Foreman","Satellite"]}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":8,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-05-16 15:30:11 UTC","id":578,"auditable_id":75,"auditable_name":"pxegrub_discovery","auditable_type":"ProvisioningTemplate","action":"update","audited_changes":{"template":["<%#\nkind: snippet\nname: pxegrub_discovery\n-%>\n<%#\ndiscovery image is based on CentOS/RHEL and therefor it is affected by https://bugzilla.redhat.com/show_bug.cgi?id=1259015.\nIn short, before RHEL 7.2 virtio driver didn't have the new persistent naming scheme, causing interfaces to be named eth0, eth1, etc..\nIf you want to enable the new persistent naming scheme and get inteface names like ens3, add net.ifnames=1 to the kernel line below.\n-%>\n# http://projects.theforeman.org/issues/15997\ntitle Foreman Discovery Image - not supported with Grub 1.x\n  kernel boot/fdi-image/vmlinuz0 rootflags=loop root=live:/fdi.iso rootfstype=auto ro rd.live.image acpi=force rd.luks=0 rd.md=0 rd.dm=0 rd.lvm=0 rd.bootif=0 rd.neednet=0 nomodeset proxy.url=<%= foreman_server_url %> proxy.type=foreman BOOTIF=01-$net_default_mac\n  initrd boot/fdi-image/initrd0.img\n","<%#\nkind: snippet\nname: pxegrub_discovery\n-%>\n<%#\ndiscovery image is based on CentOS/RHEL and therefor it is affected by https://bugzilla.redhat.com/show_bug.cgi?id=1259015.\nIn short, before RHEL 7.2 virtio driver didn't have the new persistent naming scheme, causing interfaces to be named eth0, eth1, etc..\nIf you want to enable the new persistent naming scheme and get inteface names like ens3, add net.ifnames=1 to the kernel line below.\n-%>\n# http://projects.theforeman.org/issues/15997\ntitle Foreman Discovery Image - not supported with Grub 1.x\n  kernel boot/fdi-image-rhel_7-vmlinuz rootflags=loop root=live:/fdi.iso rootfstype=auto ro rd.live.image acpi=force rd.luks=0 rd.md=0 rd.dm=0 rd.lvm=0 rd.bootif=0 rd.neednet=0 nomodeset proxy.url=<%= foreman_server_url %> proxy.type=foreman BOOTIF=01-$net_default_mac\n  initrd boot/fdi-image-rhel_7-img\n"],"vendor":["Foreman","Satellite"]}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":8,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-05-16 15:30:11 UTC","id":577,"auditable_id":77,"auditable_name":"pxelinux_discovery","auditable_type":"ProvisioningTemplate","action":"update","audited_changes":{"template":["<%#\nkind: snippet\nname: pxelinux_discovery\n-%>\n<%#\ndiscovery image is based on CentOS/RHEL and therefor it is affected by https://bugzilla.redhat.com/show_bug.cgi?id=1259015.\nIn short, before RHEL 7.2 virtio driver didn't have the new persistent naming scheme, causing interfaces to be named eth0, eth1, etc..\nIf you want to enable the new persistent naming scheme and get inteface names like ens3, add net.ifnames=1 to the APPEND line below.\n-%>\nLABEL discovery\n  MENU LABEL Foreman Discovery Image\n  KERNEL boot/fdi-image/vmlinuz0\n  APPEND initrd=boot/fdi-image/initrd0.img rootflags=loop root=live:/fdi.iso rootfstype=auto ro rd.live.image acpi=force rd.luks=0 rd.md=0 rd.dm=0 rd.lvm=0 rd.bootif=0 rd.neednet=0 nomodeset proxy.url=<%= foreman_server_url %> proxy.type=foreman\n  IPAPPEND 2\n","<%#\nkind: snippet\nname: pxelinux_discovery\n-%>\n<%#\ndiscovery image is based on CentOS/RHEL and therefor it is affected by https://bugzilla.redhat.com/show_bug.cgi?id=1259015.\nIn short, before RHEL 7.2 virtio driver didn't have the new persistent naming scheme, causing interfaces to be named eth0, eth1, etc..\nIf you want to enable the new persistent naming scheme and get inteface names like ens3, add net.ifnames=1 to the APPEND line below.\n-%>\nLABEL discovery\n  MENU LABEL Foreman Discovery Image\n  KERNEL boot/fdi-image-rhel_7-vmlinuz\n  APPEND initrd=boot/fdi-image-rhel_7-img rootflags=loop root=live:/fdi.iso rootfstype=auto ro rd.live.image acpi=force rd.luks=0 rd.md=0 rd.dm=0 rd.lvm=0 rd.bootif=0 rd.neednet=0 nomodeset proxy.url=<%= foreman_server_url %> proxy.type=foreman\n  IPAPPEND 2\n"],"vendor":["Foreman","Satellite"]}},{"user_id":null,"user_type":null,"user_name":null,"version":1,"comment":null,"associated_id":20,"associated_type":"Role","remote_address":null,"associated_name":"Access Insights Viewer","created_at":"2018-05-16 15:30:10 UTC","id":576,"auditable_id":282,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":20,"taxonomy_search":null,"override":false}},{"user_id":null,"user_type":null,"user_name":null,"version":1,"comment":null,"associated_id":21,"associated_type":"Role","remote_address":null,"associated_name":"Access Insights Admin","created_at":"2018-05-16 15:30:10 UTC","id":575,"auditable_id":281,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":21,"taxonomy_search":null,"override":false}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-05-16 15:30:08 UTC","id":574,"auditable_id":153,"auditable_name":null,"auditable_type":"ProvisioningTemplate","action":"create","audited_changes":{"name":"Katello Atomic Kickstart Default","template":"<%#\nkind: provision\nname: Katello Atomic Kickstart default\n%>\n\nlang <%= @host.params['lang'] || 'en_US.UTF-8' %>\nkeyboard <%= @host.params['keyboard'] || 'us' %>\ntimezone --utc <%= @host.params['time-zone'] || 'UTC' %>\n\n<% subnet = @host.subnet -%>\n<% if subnet.respond_to?(:dhcp_boot_mode?) -%>\n<% dhcp = subnet.dhcp_boot_mode? && !@static -%>\n<% else -%>\n<% dhcp = !@static -%>\n<% end -%>\n\nnetwork --bootproto <%= dhcp ? 'dhcp' : \"static --ip=#{@host.ip} --netmask=#{subnet.mask} --gateway=#{subnet.gateway} --nameserver=#{[subnet.dns_primary, subnet.dns_secondary].select{ |item| item.present? }.join(',')}\" %> --hostname <%= @host %><%= \" --device=#{@host.mac}\" -%>\n\n# Partition table should create /boot and a volume atomicos\n<% if @dynamic -%>\n%include /tmp/diskpart.cfg\n<% else -%>\n<%= @host.diskLayout %>\n<% end -%>\n\nbootloader --timeout=3\ntext\n\n<% if @host.os.name.match /.*fedora.*/i -%>\nostreesetup --nogpg --osname=fedora-atomic --remote=fedora-atomic --url=<%= @host.param_true?('atomic-upstream') ? \"https://dl.fedoraproject.org/pub/fedora/linux/atomic/#{@host.os.major}/\" : \"#{@host.operatingsystem.medium_uri(@host)}/content/repo/\" %> --ref=fedora-atomic/f<%= @host.os.major %>/<%= @host.architecture %>/docker-host\n<% elsif @host.os.name.match /.*centos.*/i -%>\nostreesetup --nogpg --osname=centos-atomic-host --remote=centos-atomic-host --url=<%= @host.param_true?('atomic-upstream') ? \"http://mirror.centos.org/centos/#{@host.os.major}/atomic/#{@host.architecture}/repo/\" : @host.operatingsystem.medium_uri(@host) %> --ref=centos-atomic-host/<%= @host.os.major %>/<%= @host.architecture %>/standard\n<% else -%>\nostreesetup --nogpg --osname=rhel-atomic-host --remote=rhel-atomic-host --url=file:///install/ostree --ref=rhel-atomic-host/<%= @host.os.major %>/<%= @host.architecture %>/standard\n<% end -%>\nservices --disabled cloud-init,cloud-config,cloud-final,cloud-init-local\nrootpw --iscrypted <%= root_pass %>\n\nreboot\n\n%post\n<%= snippet \"subscription_manager_registration\" %>\n<%= snippet('remote_execution_ssh_keys') %>\n(\n# Report success back to Foreman\ncurl -s -o /dev/null --insecure <%= foreman_url('built') %>\n) 2>&1 | tee /mnt/sysimage/root/install.post.log\n\nexit 0\n\n%end\n","snippet":false,"template_kind_id":6,"locked":true,"default":true,"vendor":"Katello","os_family":null,"job_category":"Miscellaneous","provider_type":null,"description_format":null,"execution_timeout_interval":null}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-05-16 15:30:08 UTC","id":573,"auditable_id":152,"auditable_name":null,"auditable_type":"ProvisioningTemplate","action":"create","audited_changes":{"name":"Katello Kickstart Default Finish","template":"<%#\nkind: finish\nname: Katello Kickstart default finish\noses:\n- CentOS 5\n- CentOS 6\n- CentOS 7\n- RedHat 5\n- RedHat 6\n- RedHat 7\n- Fedora 19\n- Fedora 20\n%>\n<% if @host.subnet.respond_to?(:dhcp_boot_mode?) -%>\n<%= snippet 'kickstart_networking_setup' %>\nservice network restart\n<% end -%>\n\n<%\n  rhel_compatible = @host.operatingsystem.family == 'Redhat' && @host.operatingsystem.name != 'Fedora'\n  os_major = @host.operatingsystem.major.to_i\n  pm_set = @host.puppetmaster.empty? ? false : true\n  puppet_enabled = pm_set || @host.params['force-puppet']\n  salt_enabled = @host.params['salt_master'] ? true : false\n  chef_enabled = @host.respond_to?(:chef_proxy) && @host.chef_proxy\n%>\n\n<%= snippet \"subscription_manager_registration\" %>\n\n<% if @host.respond_to?(:realm) && @host.otp && @host.realm && @host.realm.realm_type == \"FreeIPA\" -%>\n<%= snippet \"freeipa_register\" %>\n<% end -%>\n\n# update local time\necho \"updating system time\"\n/usr/sbin/ntpdate -sub <%= @host.params['ntp-server'] || '0.fedora.pool.ntp.org' %>\n/usr/sbin/hwclock --systohc\n\n<% if @host.info['parameters']['realm'] && @host.realm && @host.realm.realm_type == 'FreeIPA' -%>\n<%= snippet \"freeipa_register\" %>\n<% end -%>\n\n# update all the base packages from the updates repository\nyum -t -y -e 0 update\n\n<%= snippet('remote_execution_ssh_keys') %>\n\n<% if chef_enabled %>\n<%= snippet 'chef_client' %>\n<% end -%>\n\n<% if puppet_enabled %>\n<%= snippet 'puppet_setup' %>\n<% end -%>\n\n<% if salt_enabled %>\n<%= snippet 'saltstack_setup' %>\n<% end -%>\n\nexit 0\n","snippet":false,"template_kind_id":7,"locked":true,"default":true,"vendor":"Katello","os_family":null,"job_category":"Miscellaneous","provider_type":null,"description_format":null,"execution_timeout_interval":null}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-05-16 15:30:08 UTC","id":572,"auditable_id":151,"auditable_name":null,"auditable_type":"ProvisioningTemplate","action":"create","audited_changes":{"name":"Katello Kickstart Default User Data","template":"<%#\nkind: user_data\nname: Katello Kickstart default user data\noses:\n- CentOS 6\n- CentOS 7\n- Fedora 19\n- Fedora 20\n- Fedora 21\n- Fedora 22\n- Fedora 23\n-%>\n#cloud-config\nhostname: <%= @host.shortname %>\nfqdn: <%= @host %>\nmanage_etc_hosts: true\n\ngroups:\n - admin\n\nusers:\n - default\n - name: admin\n   primary-group: admin\n   groups: users\n   shell: /bin/bash\n   sudo: ['ALL=(ALL) ALL']\n   lock-passwd: false\n   passwd: <%= @host.root_pass %>\n\n<%# Allow user to specify additional SSH key as host paramter -%>\n<% if @host.params['sshkey'].present? || @host.params['remote_execution_ssh_keys'].present? -%>\nssh_authorized_keys:\n<% if @host.params['sshkey'].present? -%>\n  - <%= @host.params['sshkey'] %>\n<% end -%>\n<% if @host.params['remote_execution_ssh_keys'].present? -%>\n<% @host.params['remote_execution_ssh_keys'].each do |key| -%>\n  - <%= key %>\n<% end -%>\n<% end -%>\n<% end -%>\nwrite_files:\n- path: /tmp/foreman-userdata.sh\n  permissions: '0755'\n  content: |\n    #!/bin/bash\n<%= indent 4 do\n      snippet 'subscription_manager_registration'\n    end %>\n<% if @host.info['parameters']['realm'] && @host.realm && @host.realm.realm_type == 'FreeIPA' -%>\n<%= indent 4 do\n      snippet 'freeipa_register'\n    end %>\n<% end -%>\n  <% unless @host.operatingsystem.atomic? -%>\n    # update all the base packages from the updates repository\n    yum -t -y -e 0 update\n  <% end -%>\n<%\n  # safemode renderer does not support unary negation\n  non_atomic = @host.operatingsystem.atomic? ? false : true\n  pm_set = @host.puppetmaster.empty? ? false : true\n  puppet_enabled = non_atomic && (pm_set || @host.params['force-puppet'])\n  salt_enabled = non_atomic && (@host.params['salt_master'] ? true : false)\n  chef_enabled = @host.respond_to?(:chef_proxy) && @host.chef_proxy\n%>\n<% if chef_enabled %>\n<%= indent 4 do\n      snippet 'chef_client'\n    end  %>\n<% end -%>\n\n<% if puppet_enabled %>\n<%= indent 4 do\n      snippet 'puppet_setup'\n    end %>\n<% end -%>\n\n<% if salt_enabled %>\n<%= indent 4 do\n      snippet 'saltstack_setup'\n    end %>\n<% end -%>\nphone_home:\n url: <%= foreman_url('built') %>\n post: []\n tries: 10\nruncmd:\n - [ cloud-init-per, once, foreman-userdata, /tmp/foreman-userdata.sh ]\noutput: {all: '| tee -a /root/install.userdata.log'}\n\n","snippet":false,"template_kind_id":9,"locked":true,"default":true,"vendor":"Katello","os_family":null,"job_category":"Miscellaneous","provider_type":null,"description_format":null,"execution_timeout_interval":null}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-05-16 15:30:08 UTC","id":571,"auditable_id":150,"auditable_name":null,"auditable_type":"ProvisioningTemplate","action":"create","audited_changes":{"name":"Katello Kickstart Default","template":"<%#\nkind: provision\nname: Katello Kickstart default\noses:\n- CentOS 5\n- CentOS 6\n- CentOS 7\n- RedHat 5\n- RedHat 6\n- RedHat 7\n- Fedora 19\n- Fedora 20\n%>\n<%\n  rhel_compatible = @host.operatingsystem.family == 'Redhat' && @host.operatingsystem.name != 'Fedora'\n  os_major = @host.operatingsystem.major.to_i\n  # safemode renderer does not support unary negation\n  pm_set = @host.puppetmaster.empty? ? false : true\n  puppet_enabled = pm_set || @host.params['force-puppet']\n  salt_enabled = @host.params['salt_master'] ? true : false\n  chef_enabled = @host.respond_to?(:chef_proxy) && @host.chef_proxy\n  section_end = (rhel_compatible && os_major <= 5) ? '' : '%end'\n%>\ninstall\n<%= @mediapath %>\nlang en_US.UTF-8\nselinux --enforcing\nkeyboard us\nskipx\n\n<% subnet = @host.subnet -%>\n<% if subnet.respond_to?(:dhcp_boot_mode?) -%>\n<% dhcp = subnet.dhcp_boot_mode? && !@static -%>\n<% else -%>\n<% dhcp = !@static -%>\n<% end -%>\n\nnetwork --bootproto <%= dhcp ? 'dhcp' : \"static --ip=#{@host.ip} --netmask=#{subnet.mask} --gateway=#{subnet.gateway} --nameserver=#{[subnet.dns_primary, subnet.dns_secondary].select{ |item| item.present? }.join(',')}\" %> --hostname <%= @host %><%= os_major >= 6 ? \" --device=#{@host.mac}\" : '' -%>\n\nrootpw --iscrypted <%= root_pass %>\nfirewall --<%= os_major >= 6 ? 'service=' : '' %>ssh\nauthconfig --useshadow --passalgo=<%= @host.operatingsystem.password_hash || 'sha256' %> --kickstart\ntimezone --utc <%= @host.params['time-zone'] || 'UTC' %>\n\n<% if @host.operatingsystem.name == 'Fedora' and os_major <= 16 -%>\n# Bootloader exception for Fedora 16:\nbootloader --append=\"nofb quiet splash=quiet <%=ks_console%>\" <%= grub_pass %>\npart biosboot --fstype=biosboot --size=1\n<% else -%>\nbootloader --location=mbr --append=\"nofb quiet splash=quiet\" <%= grub_pass %>\n<% end -%>\n\n<% if os_major == 5 -%>\nkey --skip\n<% end -%>\n\n<% if @dynamic -%>\n%include /tmp/diskpart.cfg\n<% else -%>\n<%= @host.diskLayout %>\n<% end -%>\n\ntext\nreboot\n\n%packages --ignoremissing\nyum\ndhclient\nntp\nwget\n@Core\n<%= section_end -%>\n\n<% if @dynamic -%>\n%pre\n<%= @host.diskLayout %>\n<%= section_end -%>\n<% end -%>\n\n%post --nochroot\nexec < /dev/tty3 > /dev/tty3\n#changing to VT 3 so that we can see whats going on....\n/usr/bin/chvt 3\n(\ncp -va /etc/resolv.conf /mnt/sysimage/etc/resolv.conf\n/usr/bin/chvt 1\n) 2>&1 | tee /mnt/sysimage/root/install.postnochroot.log\n<%= section_end -%>\n\n\n%post\nlogger \"Starting anaconda <%= @host %> postinstall\"\nexec < /dev/tty3 > /dev/tty3\n#changing to VT 3 so that we can see whats going on....\n/usr/bin/chvt 3\n(\n<% if subnet.respond_to?(:dhcp_boot_mode?) -%>\n<%= snippet 'kickstart_networking_setup' %>\n<% end -%>\n\n#update local time\necho \"updating system time\"\n/usr/sbin/ntpdate -sub <%= @host.params['ntp-server'] || '0.fedora.pool.ntp.org' %>\n/usr/sbin/hwclock --systohc\n\n<%= snippet \"subscription_manager_registration\" %>\n\n<% if @host.info['parameters']['realm'] && @host.realm && @host.realm.realm_type == 'FreeIPA' -%>\n<%= snippet \"freeipa_register\" %>\n<% end -%>\n\n# update all the base packages from the updates repository\nyum -t -y -e 0 update\n\n<%= snippet('remote_execution_ssh_keys') %>\n\n<% if chef_enabled %>\n<%= snippet 'chef_client' %>\n<% end -%>\n\n<% if puppet_enabled %>\n<%= snippet 'puppet_setup' %>\n<% end -%>\n\n<% if salt_enabled %>\n<%= snippet 'saltstack_setup' %>\n<% end -%>\n\nsync\n\n<% if @provisioning_type == nil || @provisioning_type == 'host' -%>\n# Inform the build system that we are done.\necho \"Informing Foreman that we are built\"\nwget -q -O /dev/null --no-check-certificate <%= foreman_url('built') %>\n<% end -%>\n) 2>&1 | tee /root/install.post.log\nexit 0\n\n<%= section_end -%>\n","snippet":false,"template_kind_id":6,"locked":true,"default":true,"vendor":"Katello","os_family":null,"job_category":"Miscellaneous","provider_type":null,"description_format":null,"execution_timeout_interval":null}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":9,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-05-15 19:00:02 UTC","id":570,"auditable_id":21,"auditable_name":"rhel75.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"global_status":[1,2]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":8,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-05-10 13:31:59 UTC","id":569,"auditable_id":7,"auditable_name":"virt-who-brigadebox.usersys.redhat.com-1","auditable_type":"Host","action":"update","audited_changes":{"global_status":[1,0]}},{"user_id":3,"user_type":null,"user_name":"admin","version":7,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-05-10 13:31:58 UTC","id":568,"auditable_id":7,"auditable_name":"virt-who-brigadebox.usersys.redhat.com-1","auditable_type":"Host","action":"update","audited_changes":{"global_status":[1,0]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":9,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-05-09 05:11:09 UTC","id":567,"auditable_id":17,"auditable_name":"brigadebox.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"global_status":[0,2]}},{"user_id":3,"user_type":null,"user_name":"admin","version":26,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.228","associated_name":null,"created_at":"2018-05-08 22:01:38 UTC","id":566,"auditable_id":5,"auditable_name":"drone74.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"environment_id":[9,7]}},{"user_id":3,"user_type":null,"user_name":"admin","version":4,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.228","associated_name":null,"created_at":"2018-05-08 22:00:32 UTC","id":565,"auditable_id":1,"auditable_name":"puppet-test","auditable_type":"Hostgroup","action":"update","audited_changes":{"environment_id":[6,null]}},{"user_id":3,"user_type":null,"user_name":"admin","version":3,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.228","associated_name":null,"created_at":"2018-05-08 21:53:26 UTC","id":564,"auditable_id":1,"auditable_name":"puppet-test","auditable_type":"Hostgroup","action":"update","audited_changes":{"content_view_id":[null,13],"environment_id":[9,6]}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":1,"associated_type":"Hostgroup","remote_address":"10.13.153.228","associated_name":"puppet-test","created_at":"2018-05-08 21:49:51 UTC","id":563,"auditable_id":3,"auditable_name":"3","auditable_type":"HostgroupClass","action":"create","audited_changes":{"hostgroup_id":1,"puppetclass_id":1}},{"user_id":3,"user_type":null,"user_name":"admin","version":2,"comment":null,"associated_id":1,"associated_type":"Hostgroup","remote_address":"10.13.153.228","associated_name":"puppet-test","created_at":"2018-05-08 21:49:37 UTC","id":562,"auditable_id":2,"auditable_name":"2","auditable_type":"HostgroupClass","action":"destroy","audited_changes":{"hostgroup_id":1,"puppetclass_id":1}},{"user_id":3,"user_type":null,"user_name":"admin","version":3,"comment":null,"associated_id":1,"associated_type":"Puppetclass","remote_address":"10.13.153.228","associated_name":"motd","created_at":"2018-05-08 21:47:54 UTC","id":561,"auditable_id":2,"auditable_name":"motd::template","auditable_type":"LookupKey","action":"update","audited_changes":{"description":[null,""]}},{"user_id":3,"user_type":null,"user_name":"admin","version":3,"comment":null,"associated_id":1,"associated_type":"Puppetclass","remote_address":"10.13.153.228","associated_name":"motd","created_at":"2018-05-08 21:47:54 UTC","id":560,"auditable_id":4,"auditable_name":"motd::issue_template","auditable_type":"LookupKey","action":"update","audited_changes":{"description":[null,""]}},{"user_id":3,"user_type":null,"user_name":"admin","version":3,"comment":null,"associated_id":1,"associated_type":"Puppetclass","remote_address":"10.13.153.228","associated_name":"motd","created_at":"2018-05-08 21:47:54 UTC","id":559,"auditable_id":6,"auditable_name":"motd::issue_net_template","auditable_type":"LookupKey","action":"update","audited_changes":{"description":[null,""]}},{"user_id":3,"user_type":null,"user_name":"admin","version":3,"comment":null,"associated_id":1,"associated_type":"Puppetclass","remote_address":"10.13.153.228","associated_name":"motd","created_at":"2018-05-08 21:47:54 UTC","id":558,"auditable_id":7,"auditable_name":"motd::issue_net_content","auditable_type":"LookupKey","action":"update","audited_changes":{"description":[null,""]}},{"user_id":3,"user_type":null,"user_name":"admin","version":3,"comment":null,"associated_id":1,"associated_type":"Puppetclass","remote_address":"10.13.153.228","associated_name":"motd","created_at":"2018-05-08 21:47:54 UTC","id":557,"auditable_id":5,"auditable_name":"motd::issue_content","auditable_type":"LookupKey","action":"update","audited_changes":{"description":[null,""]}},{"user_id":3,"user_type":null,"user_name":"admin","version":2,"comment":null,"associated_id":1,"associated_type":"Puppetclass","remote_address":"10.13.153.228","associated_name":"motd","created_at":"2018-05-08 21:47:54 UTC","id":556,"auditable_id":1,"auditable_name":"motd::dynamic_motd","auditable_type":"LookupKey","action":"update","audited_changes":{"description":[null,""]}},{"user_id":3,"user_type":null,"user_name":"admin","version":3,"comment":null,"associated_id":1,"associated_type":"Puppetclass","remote_address":"10.13.153.228","associated_name":"motd","created_at":"2018-05-08 21:47:54 UTC","id":555,"auditable_id":3,"auditable_name":"motd::content","auditable_type":"LookupKey","action":"update","audited_changes":{"description":[null,""]}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":1,"associated_type":"Hostgroup","remote_address":"10.13.153.228","associated_name":"puppet-test","created_at":"2018-05-08 21:47:54 UTC","id":554,"auditable_id":2,"auditable_name":"2","auditable_type":"HostgroupClass","action":"create","audited_changes":{"hostgroup_id":1,"puppetclass_id":1}},{"user_id":3,"user_type":null,"user_name":"admin","version":25,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.228","associated_name":null,"created_at":"2018-05-08 21:35:38 UTC","id":553,"auditable_id":5,"auditable_name":"drone74.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"environment_id":[6,9]}},{"user_id":3,"user_type":null,"user_name":"admin","version":2,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.228","associated_name":null,"created_at":"2018-05-08 21:35:05 UTC","id":552,"auditable_id":1,"auditable_name":"puppet-test","auditable_type":"Hostgroup","action":"update","audited_changes":{"environment_id":[3,9],"grub_pass":["$1$t7j3VTst$MitMWCODmLJY6afCOO/M7/","$5$rwD7wKv/$bCvHDuEIETBzgiMK8xzpU9ouSbCPfIhGVix/r7bvQm."]}},{"user_id":3,"user_type":null,"user_name":"admin","version":2,"comment":null,"associated_id":1,"associated_type":"Hostgroup","remote_address":"10.13.153.228","associated_name":"puppet-test","created_at":"2018-05-08 21:35:05 UTC","id":551,"auditable_id":1,"auditable_name":"1","auditable_type":"HostgroupClass","action":"destroy","audited_changes":{"hostgroup_id":1,"puppetclass_id":1}},{"user_id":3,"user_type":null,"user_name":"admin","version":24,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.228","associated_name":null,"created_at":"2018-05-08 21:34:33 UTC","id":550,"auditable_id":5,"auditable_name":"drone74.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"environment_id":[9,6]}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":9,"associated_type":"LookupKey","remote_address":"10.13.153.228","associated_name":"foreman_scap_client::port","created_at":"2018-05-08 21:32:53 UTC","id":549,"auditable_id":10,"auditable_name":"fqdn=drone74.usersys.redhat.com","auditable_type":"LookupValue","action":"create","audited_changes":{"match":"fqdn=drone74.usersys.redhat.com","value":"9090","lookup_key_id":9,"omit":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":8,"associated_type":"LookupKey","remote_address":"10.13.153.228","associated_name":"foreman_scap_client::server","created_at":"2018-05-08 21:32:53 UTC","id":548,"auditable_id":9,"auditable_name":"fqdn=drone74.usersys.redhat.com","auditable_type":"LookupValue","action":"create","audited_changes":{"match":"fqdn=drone74.usersys.redhat.com","value":"batman.usersys.redhat.com","lookup_key_id":8,"omit":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":23,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.228","associated_name":null,"created_at":"2018-05-08 21:32:52 UTC","id":547,"auditable_id":5,"auditable_name":"drone74.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"openscap_proxy_id":[null,1],"environment_id":[3,9]}},{"user_id":3,"user_type":null,"user_name":"admin","version":2,"comment":null,"associated_id":1,"associated_type":"Puppetclass","remote_address":"10.13.153.228","associated_name":"motd","created_at":"2018-05-08 21:28:57 UTC","id":546,"auditable_id":7,"auditable_name":"motd::issue_net_content","auditable_type":"LookupKey","action":"update","audited_changes":{"default_value":["","undef"],"key_type":["string",null]}},{"user_id":3,"user_type":null,"user_name":"admin","version":2,"comment":null,"associated_id":1,"associated_type":"Puppetclass","remote_address":"10.13.153.228","associated_name":"motd","created_at":"2018-05-08 21:28:57 UTC","id":545,"auditable_id":6,"auditable_name":"motd::issue_net_template","auditable_type":"LookupKey","action":"update","audited_changes":{"default_value":["","undef"],"key_type":["string",null]}},{"user_id":3,"user_type":null,"user_name":"admin","version":2,"comment":null,"associated_id":1,"associated_type":"Puppetclass","remote_address":"10.13.153.228","associated_name":"motd","created_at":"2018-05-08 21:28:57 UTC","id":544,"auditable_id":5,"auditable_name":"motd::issue_content","auditable_type":"LookupKey","action":"update","audited_changes":{"default_value":["","undef"],"key_type":["string",null]}},{"user_id":3,"user_type":null,"user_name":"admin","version":2,"comment":null,"associated_id":1,"associated_type":"Puppetclass","remote_address":"10.13.153.228","associated_name":"motd","created_at":"2018-05-08 21:28:57 UTC","id":543,"auditable_id":4,"auditable_name":"motd::issue_template","auditable_type":"LookupKey","action":"update","audited_changes":{"default_value":["","undef"],"key_type":["string",null]}},{"user_id":3,"user_type":null,"user_name":"admin","version":2,"comment":null,"associated_id":1,"associated_type":"Puppetclass","remote_address":"10.13.153.228","associated_name":"motd","created_at":"2018-05-08 21:28:57 UTC","id":542,"auditable_id":3,"auditable_name":"motd::content","auditable_type":"LookupKey","action":"update","audited_changes":{"default_value":["","undef"],"key_type":["string",null]}},{"user_id":3,"user_type":null,"user_name":"admin","version":2,"comment":null,"associated_id":1,"associated_type":"Puppetclass","remote_address":"10.13.153.228","associated_name":"motd","created_at":"2018-05-08 21:28:57 UTC","id":541,"auditable_id":2,"auditable_name":"motd::template","auditable_type":"LookupKey","action":"update","audited_changes":{"default_value":["","undef"],"key_type":["string",null]}},{"user_id":3,"user_type":null,"user_name":"admin","version":2,"comment":null,"associated_id":4,"associated_type":"Puppetclass","remote_address":"10.13.153.228","associated_name":"foreman_scap_client","created_at":"2018-05-08 21:28:57 UTC","id":540,"auditable_id":18,"auditable_name":"foreman_scap_client::foreman_repo_gpg_chk","auditable_type":"LookupKey","action":"update","audited_changes":{"default_value":[false,"false"],"key_type":["boolean",null]}},{"user_id":3,"user_type":null,"user_name":"admin","version":2,"comment":null,"associated_id":4,"associated_type":"Puppetclass","remote_address":"10.13.153.228","associated_name":"foreman_scap_client","created_at":"2018-05-08 21:28:57 UTC","id":539,"auditable_id":17,"auditable_name":"foreman_scap_client::foreman_repo_src","auditable_type":"LookupKey","action":"update","audited_changes":{"default_value":["","undef"],"key_type":["string",null]}},{"user_id":3,"user_type":null,"user_name":"admin","version":2,"comment":null,"associated_id":4,"associated_type":"Puppetclass","remote_address":"10.13.153.228","associated_name":"foreman_scap_client","created_at":"2018-05-08 21:28:57 UTC","id":538,"auditable_id":15,"auditable_name":"foreman_scap_client::foreman_repo_rel","auditable_type":"LookupKey","action":"update","audited_changes":{"default_value":["","undef"],"key_type":["string",null]}},{"user_id":3,"user_type":null,"user_name":"admin","version":2,"comment":null,"associated_id":4,"associated_type":"Puppetclass","remote_address":"10.13.153.228","associated_name":"foreman_scap_client","created_at":"2018-05-08 21:28:56 UTC","id":537,"auditable_id":14,"auditable_name":"foreman_scap_client::host_private_key","auditable_type":"LookupKey","action":"update","audited_changes":{"default_value":["${$::foreman_scap_client::params::host_private_key}","${::foreman_scap_client::params::host_private_key}"],"key_type":["string",null]}},{"user_id":3,"user_type":null,"user_name":"admin","version":2,"comment":null,"associated_id":4,"associated_type":"Puppetclass","remote_address":"10.13.153.228","associated_name":"foreman_scap_client","created_at":"2018-05-08 21:28:56 UTC","id":536,"auditable_id":13,"auditable_name":"foreman_scap_client::host_certificate","auditable_type":"LookupKey","action":"update","audited_changes":{"default_value":["${$::foreman_scap_client::params::host_certificate}","${::foreman_scap_client::params::host_certificate}"],"key_type":["string",null]}},{"user_id":3,"user_type":null,"user_name":"admin","version":2,"comment":null,"associated_id":4,"associated_type":"Puppetclass","remote_address":"10.13.153.228","associated_name":"foreman_scap_client","created_at":"2018-05-08 21:28:56 UTC","id":535,"auditable_id":12,"auditable_name":"foreman_scap_client::ca_file","auditable_type":"LookupKey","action":"update","audited_changes":{"default_value":["${$::foreman_scap_client::params::ca_file}","${::foreman_scap_client::params::ca_file}"],"key_type":["string",null]}},{"user_id":3,"user_type":null,"user_name":"admin","version":2,"comment":null,"associated_id":6,"associated_type":"Puppetclass","remote_address":"10.13.153.228","associated_name":"access_insights_client","created_at":"2018-05-08 21:28:56 UTC","id":534,"auditable_id":31,"auditable_name":"access_insights_client::upload_schedule","auditable_type":"LookupKey","action":"update","audited_changes":{"default_value":["","undef"],"key_type":["string",null]}},{"user_id":3,"user_type":null,"user_name":"admin","version":2,"comment":null,"associated_id":6,"associated_type":"Puppetclass","remote_address":"10.13.153.228","associated_name":"access_insights_client","created_at":"2018-05-08 21:28:56 UTC","id":533,"auditable_id":30,"auditable_name":"access_insights_client::obfuscate_hostname","auditable_type":"LookupKey","action":"update","audited_changes":{"default_value":["","undef"],"key_type":["string",null]}},{"user_id":3,"user_type":null,"user_name":"admin","version":2,"comment":null,"associated_id":6,"associated_type":"Puppetclass","remote_address":"10.13.153.228","associated_name":"access_insights_client","created_at":"2018-05-08 21:28:56 UTC","id":532,"auditable_id":29,"auditable_name":"access_insights_client::obfuscate","auditable_type":"LookupKey","action":"update","audited_changes":{"default_value":["","undef"],"key_type":["string",null]}},{"user_id":3,"user_type":null,"user_name":"admin","version":2,"comment":null,"associated_id":6,"associated_type":"Puppetclass","remote_address":"10.13.153.228","associated_name":"access_insights_client","created_at":"2018-05-08 21:28:56 UTC","id":531,"auditable_id":28,"auditable_name":"access_insights_client::auto_update","auditable_type":"LookupKey","action":"update","audited_changes":{"default_value":["","undef"],"key_type":["string",null]}},{"user_id":3,"user_type":null,"user_name":"admin","version":2,"comment":null,"associated_id":6,"associated_type":"Puppetclass","remote_address":"10.13.153.228","associated_name":"access_insights_client","created_at":"2018-05-08 21:28:56 UTC","id":530,"auditable_id":27,"auditable_name":"access_insights_client::gpg","auditable_type":"LookupKey","action":"update","audited_changes":{"default_value":["","undef"],"key_type":["string",null]}},{"user_id":3,"user_type":null,"user_name":"admin","version":2,"comment":null,"associated_id":6,"associated_type":"Puppetclass","remote_address":"10.13.153.228","associated_name":"access_insights_client","created_at":"2018-05-08 21:28:56 UTC","id":529,"auditable_id":26,"auditable_name":"access_insights_client::cert_verify","auditable_type":"LookupKey","action":"update","audited_changes":{"default_value":["","undef"],"key_type":["string",null]}},{"user_id":3,"user_type":null,"user_name":"admin","version":2,"comment":null,"associated_id":6,"associated_type":"Puppetclass","remote_address":"10.13.153.228","associated_name":"access_insights_client","created_at":"2018-05-08 21:28:56 UTC","id":528,"auditable_id":25,"auditable_name":"access_insights_client::proxy","auditable_type":"LookupKey","action":"update","audited_changes":{"default_value":["","undef"],"key_type":["string",null]}},{"user_id":3,"user_type":null,"user_name":"admin","version":2,"comment":null,"associated_id":6,"associated_type":"Puppetclass","remote_address":"10.13.153.228","associated_name":"access_insights_client","created_at":"2018-05-08 21:28:56 UTC","id":527,"auditable_id":24,"auditable_name":"access_insights_client::base_url","auditable_type":"LookupKey","action":"update","audited_changes":{"default_value":["","undef"],"key_type":["string",null]}},{"user_id":3,"user_type":null,"user_name":"admin","version":2,"comment":null,"associated_id":6,"associated_type":"Puppetclass","remote_address":"10.13.153.228","associated_name":"access_insights_client","created_at":"2018-05-08 21:28:56 UTC","id":526,"auditable_id":23,"auditable_name":"access_insights_client::password","auditable_type":"LookupKey","action":"update","audited_changes":{"default_value":["","undef"],"key_type":["string",null]}},{"user_id":3,"user_type":null,"user_name":"admin","version":2,"comment":null,"associated_id":6,"associated_type":"Puppetclass","remote_address":"10.13.153.228","associated_name":"access_insights_client","created_at":"2018-05-08 21:28:56 UTC","id":525,"auditable_id":22,"auditable_name":"access_insights_client::username","auditable_type":"LookupKey","action":"update","audited_changes":{"default_value":["","undef"],"key_type":["string",null]}},{"user_id":3,"user_type":null,"user_name":"admin","version":2,"comment":null,"associated_id":6,"associated_type":"Puppetclass","remote_address":"10.13.153.228","associated_name":"access_insights_client","created_at":"2018-05-08 21:28:56 UTC","id":524,"auditable_id":21,"auditable_name":"access_insights_client::authmethod","auditable_type":"LookupKey","action":"update","audited_changes":{"default_value":["","undef"],"key_type":["string",null]}},{"user_id":3,"user_type":null,"user_name":"admin","version":2,"comment":null,"associated_id":6,"associated_type":"Puppetclass","remote_address":"10.13.153.228","associated_name":"access_insights_client","created_at":"2018-05-08 21:28:55 UTC","id":523,"auditable_id":19,"auditable_name":"access_insights_client::log_level","auditable_type":"LookupKey","action":"update","audited_changes":{"default_value":["","undef"],"key_type":["string",null]}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":14,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.133","associated_name":null,"created_at":"2018-05-08 19:37:26 UTC","id":522,"auditable_id":15,"auditable_name":"joker.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"global_status":[2,1]}},{"user_id":3,"user_type":null,"user_name":"admin","version":13,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.228","associated_name":null,"created_at":"2018-05-08 19:37:09 UTC","id":521,"auditable_id":15,"auditable_name":"joker.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"environment_id":[3,6]}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":9,"associated_type":"LookupKey","remote_address":"10.13.153.228","associated_name":"foreman_scap_client::port","created_at":"2018-05-08 19:09:42 UTC","id":520,"auditable_id":8,"auditable_name":"fqdn=rhel75.usersys.redhat.com","auditable_type":"LookupValue","action":"create","audited_changes":{"match":"fqdn=rhel75.usersys.redhat.com","value":"9090","lookup_key_id":9,"omit":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":8,"associated_type":"LookupKey","remote_address":"10.13.153.228","associated_name":"foreman_scap_client::server","created_at":"2018-05-08 19:09:42 UTC","id":519,"auditable_id":7,"auditable_name":"fqdn=rhel75.usersys.redhat.com","auditable_type":"LookupValue","action":"create","audited_changes":{"match":"fqdn=rhel75.usersys.redhat.com","value":"batman.usersys.redhat.com","lookup_key_id":8,"omit":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":8,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.228","associated_name":null,"created_at":"2018-05-08 19:09:42 UTC","id":518,"auditable_id":21,"auditable_name":"rhel75.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"comment":[null,""],"environment_id":[1,3],"hostgroup_id":[null,1],"openscap_proxy_id":[null,1]}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":7,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.218","associated_name":null,"created_at":"2018-05-08 19:08:26 UTC","id":517,"auditable_id":21,"auditable_name":"rhel75.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"model_id":[null,3],"environment_id":[null,1]}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":6,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.218","associated_name":null,"created_at":"2018-05-08 19:08:26 UTC","id":516,"auditable_id":21,"auditable_name":"rhel75.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"certname":[null,"rhel75.usersys.redhat.com"],"puppet_proxy_id":[null,1],"puppet_ca_proxy_id":[null,1]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":5,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-05-08 18:10:14 UTC","id":515,"auditable_id":21,"auditable_name":"rhel75.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"global_status":[2,1]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":4,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.228","associated_name":null,"created_at":"2018-05-08 18:09:45 UTC","id":514,"auditable_id":21,"auditable_name":"rhel75.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"global_status":[0,2]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":4,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-05-08 18:09:45 UTC","id":513,"auditable_id":21,"auditable_name":"rhel75.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"global_status":[0,2]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":3,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.228","associated_name":null,"created_at":"2018-05-08 18:09:45 UTC","id":512,"auditable_id":21,"auditable_name":"rhel75.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"architecture_id":[null,1],"operatingsystem_id":[null,7]}},{"user_id":3,"user_type":null,"user_name":"admin","version":2,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.228","associated_name":null,"created_at":"2018-05-08 18:09:44 UTC","id":511,"auditable_id":21,"auditable_name":"rhel75.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"grub_pass":["$1$/BayI7P3$TA0XkPhu5W2CYkIw6Vosa1","$5$PpReUuPe$97zzBLv0qLOnpK9G/pgCaJQhENslGFDZKW7sQBUDQb/"]}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.228","associated_name":null,"created_at":"2018-05-08 18:09:43 UTC","id":510,"auditable_id":21,"auditable_name":"rhel75.usersys.redhat.com","auditable_type":"Host","action":"create","audited_changes":{"name":"rhel75.usersys.redhat.com","root_pass":"$5$PpReUuPe$97zzBLv0qLOnpK9G/pgCaJQhENslGFDZKW7sQBUDQb/","architecture_id":null,"operatingsystem_id":null,"environment_id":null,"ptable_id":null,"medium_id":null,"build":false,"comment":null,"disk":null,"installed_at":null,"model_id":null,"hostgroup_id":null,"owner_id":3,"owner_type":"User","enabled":true,"puppet_ca_proxy_id":null,"managed":false,"use_image":null,"image_file":null,"uuid":null,"compute_resource_id":null,"puppet_proxy_id":null,"certname":null,"image_id":null,"organization_id":1,"location_id":2,"otp":null,"realm_id":null,"compute_profile_id":null,"provision_method":null,"grub_pass":"$1$/BayI7P3$TA0XkPhu5W2CYkIw6Vosa1","discovery_rule_id":null,"content_view_id":null,"lifecycle_environment_id":null,"global_status":0,"pxe_loader":null,"openscap_proxy_id":null}},{"user_id":3,"user_type":null,"user_name":"admin","version":12,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.228","associated_name":null,"created_at":"2018-05-08 16:54:03 UTC","id":509,"auditable_id":15,"auditable_name":"joker.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"puppet_proxy_id":[2,1],"puppet_ca_proxy_id":[2,1]}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":11,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.133","associated_name":null,"created_at":"2018-05-08 16:49:13 UTC","id":508,"auditable_id":15,"auditable_name":"joker.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"global_status":[1,2]}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":9,"associated_type":"LookupKey","remote_address":"10.13.153.228","associated_name":"foreman_scap_client::port","created_at":"2018-05-08 16:49:00 UTC","id":507,"auditable_id":6,"auditable_name":"fqdn=joker.usersys.redhat.com","auditable_type":"LookupValue","action":"create","audited_changes":{"match":"fqdn=joker.usersys.redhat.com","value":"9090","lookup_key_id":9,"omit":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":8,"associated_type":"LookupKey","remote_address":"10.13.153.228","associated_name":"foreman_scap_client::server","created_at":"2018-05-08 16:49:00 UTC","id":506,"auditable_id":5,"auditable_name":"fqdn=joker.usersys.redhat.com","auditable_type":"LookupValue","action":"create","audited_changes":{"match":"fqdn=joker.usersys.redhat.com","value":"batman.usersys.redhat.com","lookup_key_id":8,"omit":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":10,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.228","associated_name":null,"created_at":"2018-05-08 16:49:00 UTC","id":505,"auditable_id":15,"auditable_name":"joker.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"openscap_proxy_id":[null,1],"environment_id":[1,3],"hostgroup_id":[null,1]}},{"user_id":3,"user_type":null,"user_name":"admin","version":22,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.228","associated_name":null,"created_at":"2018-05-08 15:07:53 UTC","id":504,"auditable_id":5,"auditable_name":"drone74.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"hostgroup_id":[null,1]}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":9,"associated_type":"LookupKey","remote_address":"10.13.153.228","associated_name":"foreman_scap_client::port","created_at":"2018-05-08 15:07:33 UTC","id":503,"auditable_id":4,"auditable_name":"hostgroup=puppet-test","auditable_type":"LookupValue","action":"create","audited_changes":{"match":"hostgroup=puppet-test","value":"9090","lookup_key_id":9,"omit":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":8,"associated_type":"LookupKey","remote_address":"10.13.153.228","associated_name":"foreman_scap_client::server","created_at":"2018-05-08 15:07:32 UTC","id":502,"auditable_id":3,"auditable_name":"hostgroup=puppet-test","auditable_type":"LookupValue","action":"create","audited_changes":{"match":"hostgroup=puppet-test","value":"batman.usersys.redhat.com","lookup_key_id":8,"omit":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":1,"associated_type":"Hostgroup","remote_address":"10.13.153.228","associated_name":"puppet-test","created_at":"2018-05-08 15:07:32 UTC","id":501,"auditable_id":1,"auditable_name":"1","auditable_type":"HostgroupClass","action":"create","audited_changes":{"hostgroup_id":1,"puppetclass_id":1}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.228","associated_name":null,"created_at":"2018-05-08 15:07:32 UTC","id":500,"auditable_id":1,"auditable_name":"puppet-test","auditable_type":"Hostgroup","action":"create","audited_changes":{"name":"puppet-test","environment_id":3,"operatingsystem_id":null,"architecture_id":null,"medium_id":null,"ptable_id":null,"root_pass":"$5$rwD7wKv/$bCvHDuEIETBzgiMK8xzpU9ouSbCPfIhGVix/r7bvQm.","puppet_ca_proxy_id":1,"use_image":null,"image_file":null,"ancestry":null,"vm_defaults":null,"subnet_id":null,"domain_id":null,"puppet_proxy_id":1,"realm_id":null,"compute_profile_id":null,"content_source_id":1,"grub_pass":"$1$t7j3VTst$MitMWCODmLJY6afCOO/M7/","content_view_id":null,"lifecycle_environment_id":1,"lookup_value_matcher":"hostgroup=puppet-test","kickstart_repository_id":null,"subnet6_id":null,"pxe_loader":null,"openscap_proxy_id":1}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":9,"associated_type":"LookupKey","remote_address":"10.13.153.228","associated_name":"foreman_scap_client::port","created_at":"2018-05-08 15:02:01 UTC","id":499,"auditable_id":2,"auditable_name":"fqdn=rhel74.usersys.redhat.com","auditable_type":"LookupValue","action":"create","audited_changes":{"match":"fqdn=rhel74.usersys.redhat.com","value":"9090","lookup_key_id":9,"omit":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":8,"associated_type":"LookupKey","remote_address":"10.13.153.228","associated_name":"foreman_scap_client::server","created_at":"2018-05-08 15:02:01 UTC","id":498,"auditable_id":1,"auditable_name":"fqdn=rhel74.usersys.redhat.com","auditable_type":"LookupValue","action":"create","audited_changes":{"match":"fqdn=rhel74.usersys.redhat.com","value":"batman.usersys.redhat.com","lookup_key_id":8,"omit":false}},{"user_id":3,"user_type":null,"user_name":"admin","version":8,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.228","associated_name":null,"created_at":"2018-05-08 15:02:01 UTC","id":497,"auditable_id":20,"auditable_name":"rhel74.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"openscap_proxy_id":[null,1]}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":3,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.133","associated_name":null,"created_at":"2018-05-08 14:37:47 UTC","id":496,"auditable_id":2,"auditable_name":"joker.usersys.redhat.com","auditable_type":"SmartProxy","action":"update","audited_changes":{"puppet_path":["/etc/puppet/environments","/etc/puppetlabs/code/environments"]}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":4,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.218","associated_name":null,"created_at":"2018-05-08 14:26:54 UTC","id":495,"auditable_id":1,"auditable_name":"batman.usersys.redhat.com","auditable_type":"SmartProxy","action":"update","audited_changes":{"puppet_path":["/etc/puppet/environments","/etc/puppetlabs/code/environments"]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":2,"comment":null,"associated_id":21,"associated_type":"Role","remote_address":null,"associated_name":"Access Insights Admin","created_at":"2018-05-08 14:21:28 UTC","id":494,"auditable_id":279,"auditable_name":"view_hosts","auditable_type":"Filter","action":"destroy","audited_changes":{"search":null,"role_id":21,"taxonomy_search":null,"override":false}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":2,"comment":null,"associated_id":20,"associated_type":"Role","remote_address":null,"associated_name":"Access Insights Viewer","created_at":"2018-05-08 14:21:28 UTC","id":493,"auditable_id":280,"auditable_name":"view_hosts","auditable_type":"Filter","action":"destroy","audited_changes":{"search":null,"role_id":20,"taxonomy_search":null,"override":false}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":2,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-05-08 14:21:01 UTC","id":492,"auditable_id":144,"auditable_name":"Katello Kickstart Default User Data","auditable_type":"ProvisioningTemplate","action":"destroy","audited_changes":{"name":"Katello Kickstart Default User Data","template":"<%#\nkind: user_data\nname: Katello Kickstart default user data\noses:\n- CentOS 6\n- CentOS 7\n- Fedora 19\n- Fedora 20\n- Fedora 21\n- Fedora 22\n- Fedora 23\n-%>\n#cloud-config\nhostname: <%= @host.shortname %>\nfqdn: <%= @host %>\nmanage_etc_hosts: true\n\ngroups:\n - admin\n\nusers:\n - default\n - name: admin\n   primary-group: admin\n   groups: users\n   shell: /bin/bash\n   sudo: ['ALL=(ALL) ALL']\n   lock-passwd: false\n   passwd: <%= @host.root_pass %>\n\n<%# Allow user to specify additional SSH key as host paramter -%>\n<% if @host.params['sshkey'].present? || @host.params['remote_execution_ssh_keys'].present? -%>\nssh_authorized_keys:\n<% if @host.params['sshkey'].present? -%>\n  - <%= @host.params['sshkey'] %>\n<% end -%>\n<% if @host.params['remote_execution_ssh_keys'].present? -%>\n<% @host.params['remote_execution_ssh_keys'].each do |key| -%>\n  - <%= key %>\n<% end -%>\n<% end -%>\n<% end -%>\nwrite_files:\n- path: /tmp/foreman-userdata.sh\n  permissions: '0755'\n  content: |\n    #!/bin/bash\n<%= indent 4 do\n      snippet 'subscription_manager_registration'\n    end %>\n<% if @host.info['parameters']['realm'] && @host.realm && @host.realm.realm_type == 'FreeIPA' -%>\n<%= indent 4 do\n      snippet 'freeipa_register'\n    end %>\n<% end -%>\n  <% unless @host.operatingsystem.atomic? -%>\n    # update all the base packages from the updates repository\n    yum -t -y -e 0 update\n  <% end -%>\n<%\n  # safemode renderer does not support unary negation\n  non_atomic = @host.operatingsystem.atomic? ? false : true\n  pm_set = @host.puppetmaster.empty? ? false : true\n  puppet_enabled = non_atomic && (pm_set || @host.params['force-puppet'])\n  salt_enabled = non_atomic && (@host.params['salt_master'] ? true : false)\n  chef_enabled = @host.respond_to?(:chef_proxy) && @host.chef_proxy\n%>\n<% if chef_enabled %>\n<%= indent 4 do\n      snippet 'chef_client'\n    end  %>\n<% end -%>\n\n<% if puppet_enabled %>\n<%= indent 4 do\n      snippet 'puppet_setup'\n    end %>\n<% end -%>\n\n<% if salt_enabled %>\n<%= indent 4 do\n      snippet 'saltstack_setup'\n    end %>\n<% end -%>\nphone_home:\n url: <%= foreman_url('built') %>\n post: []\n tries: 10\nruncmd:\n - [ cloud-init-per, once, foreman-userdata, /tmp/foreman-userdata.sh ]\noutput: {all: '| tee -a /root/install.userdata.log'}\n\n","snippet":false,"template_kind_id":9,"locked":true,"default":true,"vendor":"Katello","os_family":null,"job_category":"Miscellaneous","provider_type":null,"description_format":null,"execution_timeout_interval":null}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":2,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-05-08 14:21:01 UTC","id":491,"auditable_id":145,"auditable_name":"Katello Kickstart Default Finish","auditable_type":"ProvisioningTemplate","action":"destroy","audited_changes":{"name":"Katello Kickstart Default Finish","template":"<%#\nkind: finish\nname: Katello Kickstart default finish\noses:\n- CentOS 5\n- CentOS 6\n- CentOS 7\n- RedHat 5\n- RedHat 6\n- RedHat 7\n- Fedora 19\n- Fedora 20\n%>\n<% if @host.subnet.respond_to?(:dhcp_boot_mode?) -%>\n<%= snippet 'kickstart_networking_setup' %>\nservice network restart\n<% end -%>\n\n<%\n  rhel_compatible = @host.operatingsystem.family == 'Redhat' && @host.operatingsystem.name != 'Fedora'\n  os_major = @host.operatingsystem.major.to_i\n  pm_set = @host.puppetmaster.empty? ? false : true\n  puppet_enabled = pm_set || @host.params['force-puppet']\n  salt_enabled = @host.params['salt_master'] ? true : false\n  chef_enabled = @host.respond_to?(:chef_proxy) && @host.chef_proxy\n%>\n\n<%= snippet \"subscription_manager_registration\" %>\n\n<% if @host.respond_to?(:realm) && @host.otp && @host.realm && @host.realm.realm_type == \"FreeIPA\" -%>\n<%= snippet \"freeipa_register\" %>\n<% end -%>\n\n# update local time\necho \"updating system time\"\n/usr/sbin/ntpdate -sub <%= @host.params['ntp-server'] || '0.fedora.pool.ntp.org' %>\n/usr/sbin/hwclock --systohc\n\n<% if @host.info['parameters']['realm'] && @host.realm && @host.realm.realm_type == 'FreeIPA' -%>\n<%= snippet \"freeipa_register\" %>\n<% end -%>\n\n# update all the base packages from the updates repository\nyum -t -y -e 0 update\n\n<%= snippet('remote_execution_ssh_keys') %>\n\n<% if chef_enabled %>\n<%= snippet 'chef_client' %>\n<% end -%>\n\n<% if puppet_enabled %>\n<%= snippet 'puppet_setup' %>\n<% end -%>\n\n<% if salt_enabled %>\n<%= snippet 'saltstack_setup' %>\n<% end -%>\n\nexit 0\n","snippet":false,"template_kind_id":7,"locked":true,"default":true,"vendor":"Katello","os_family":null,"job_category":"Miscellaneous","provider_type":null,"description_format":null,"execution_timeout_interval":null}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":2,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-05-08 14:21:01 UTC","id":490,"auditable_id":143,"auditable_name":"Katello Kickstart Default","auditable_type":"ProvisioningTemplate","action":"destroy","audited_changes":{"name":"Katello Kickstart Default","template":"<%#\nkind: provision\nname: Katello Kickstart default\noses:\n- CentOS 5\n- CentOS 6\n- CentOS 7\n- RedHat 5\n- RedHat 6\n- RedHat 7\n- Fedora 19\n- Fedora 20\n%>\n<%\n  rhel_compatible = @host.operatingsystem.family == 'Redhat' && @host.operatingsystem.name != 'Fedora'\n  os_major = @host.operatingsystem.major.to_i\n  # safemode renderer does not support unary negation\n  pm_set = @host.puppetmaster.empty? ? false : true\n  puppet_enabled = pm_set || @host.params['force-puppet']\n  salt_enabled = @host.params['salt_master'] ? true : false\n  chef_enabled = @host.respond_to?(:chef_proxy) && @host.chef_proxy\n  section_end = (rhel_compatible && os_major <= 5) ? '' : '%end'\n%>\ninstall\n<%= @mediapath %>\nlang en_US.UTF-8\nselinux --enforcing\nkeyboard us\nskipx\n\n<% subnet = @host.subnet -%>\n<% if subnet.respond_to?(:dhcp_boot_mode?) -%>\n<% dhcp = subnet.dhcp_boot_mode? && !@static -%>\n<% else -%>\n<% dhcp = !@static -%>\n<% end -%>\n\nnetwork --bootproto <%= dhcp ? 'dhcp' : \"static --ip=#{@host.ip} --netmask=#{subnet.mask} --gateway=#{subnet.gateway} --nameserver=#{[subnet.dns_primary, subnet.dns_secondary].select{ |item| item.present? }.join(',')}\" %> --hostname <%= @host %><%= os_major >= 6 ? \" --device=#{@host.mac}\" : '' -%>\n\nrootpw --iscrypted <%= root_pass %>\nfirewall --<%= os_major >= 6 ? 'service=' : '' %>ssh\nauthconfig --useshadow --passalgo=<%= @host.operatingsystem.password_hash || 'sha256' %> --kickstart\ntimezone --utc <%= @host.params['time-zone'] || 'UTC' %>\n\n<% if @host.operatingsystem.name == 'Fedora' and os_major <= 16 -%>\n# Bootloader exception for Fedora 16:\nbootloader --append=\"nofb quiet splash=quiet <%=ks_console%>\" <%= grub_pass %>\npart biosboot --fstype=biosboot --size=1\n<% else -%>\nbootloader --location=mbr --append=\"nofb quiet splash=quiet\" <%= grub_pass %>\n<% end -%>\n\n<% if os_major == 5 -%>\nkey --skip\n<% end -%>\n\n<% if @dynamic -%>\n%include /tmp/diskpart.cfg\n<% else -%>\n<%= @host.diskLayout %>\n<% end -%>\n\ntext\nreboot\n\n%packages --ignoremissing\nyum\ndhclient\nntp\nwget\n@Core\n<%= section_end -%>\n\n<% if @dynamic -%>\n%pre\n<%= @host.diskLayout %>\n<%= section_end -%>\n<% end -%>\n\n%post --nochroot\nexec < /dev/tty3 > /dev/tty3\n#changing to VT 3 so that we can see whats going on....\n/usr/bin/chvt 3\n(\ncp -va /etc/resolv.conf /mnt/sysimage/etc/resolv.conf\n/usr/bin/chvt 1\n) 2>&1 | tee /mnt/sysimage/root/install.postnochroot.log\n<%= section_end -%>\n\n\n%post\nlogger \"Starting anaconda <%= @host %> postinstall\"\nexec < /dev/tty3 > /dev/tty3\n#changing to VT 3 so that we can see whats going on....\n/usr/bin/chvt 3\n(\n<% if subnet.respond_to?(:dhcp_boot_mode?) -%>\n<%= snippet 'kickstart_networking_setup' %>\n<% end -%>\n\n#update local time\necho \"updating system time\"\n/usr/sbin/ntpdate -sub <%= @host.params['ntp-server'] || '0.fedora.pool.ntp.org' %>\n/usr/sbin/hwclock --systohc\n\n<%= snippet \"subscription_manager_registration\" %>\n\n<% if @host.info['parameters']['realm'] && @host.realm && @host.realm.realm_type == 'FreeIPA' -%>\n<%= snippet \"freeipa_register\" %>\n<% end -%>\n\n# update all the base packages from the updates repository\nyum -t -y -e 0 update\n\n<%= snippet('remote_execution_ssh_keys') %>\n\n<% if chef_enabled %>\n<%= snippet 'chef_client' %>\n<% end -%>\n\n<% if puppet_enabled %>\n<%= snippet 'puppet_setup' %>\n<% end -%>\n\n<% if salt_enabled %>\n<%= snippet 'saltstack_setup' %>\n<% end -%>\n\nsync\n\n<% if @provisioning_type == nil || @provisioning_type == 'host' -%>\n# Inform the build system that we are done.\necho \"Informing Foreman that we are built\"\nwget -q -O /dev/null --no-check-certificate <%= foreman_url('built') %>\n<% end -%>\n) 2>&1 | tee /root/install.post.log\nexit 0\n\n<%= section_end -%>\n","snippet":false,"template_kind_id":6,"locked":true,"default":true,"vendor":"Katello","os_family":null,"job_category":"Miscellaneous","provider_type":null,"description_format":null,"execution_timeout_interval":null}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":2,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-05-08 14:21:01 UTC","id":489,"auditable_id":146,"auditable_name":"Katello Atomic Kickstart Default","auditable_type":"ProvisioningTemplate","action":"destroy","audited_changes":{"name":"Katello Atomic Kickstart Default","template":"<%#\nkind: provision\nname: Katello Atomic Kickstart default\n%>\n\nlang <%= @host.params['lang'] || 'en_US.UTF-8' %>\nkeyboard <%= @host.params['keyboard'] || 'us' %>\ntimezone --utc <%= @host.params['time-zone'] || 'UTC' %>\n\n<% subnet = @host.subnet -%>\n<% if subnet.respond_to?(:dhcp_boot_mode?) -%>\n<% dhcp = subnet.dhcp_boot_mode? && !@static -%>\n<% else -%>\n<% dhcp = !@static -%>\n<% end -%>\n\nnetwork --bootproto <%= dhcp ? 'dhcp' : \"static --ip=#{@host.ip} --netmask=#{subnet.mask} --gateway=#{subnet.gateway} --nameserver=#{[subnet.dns_primary, subnet.dns_secondary].select{ |item| item.present? }.join(',')}\" %> --hostname <%= @host %><%= \" --device=#{@host.mac}\" -%>\n\n# Partition table should create /boot and a volume atomicos\n<% if @dynamic -%>\n%include /tmp/diskpart.cfg\n<% else -%>\n<%= @host.diskLayout %>\n<% end -%>\n\nbootloader --timeout=3\ntext\n\n<% if @host.os.name.match /.*fedora.*/i -%>\nostreesetup --nogpg --osname=fedora-atomic --remote=fedora-atomic --url=<%= @host.param_true?('atomic-upstream') ? \"https://dl.fedoraproject.org/pub/fedora/linux/atomic/#{@host.os.major}/\" : \"#{@host.operatingsystem.medium_uri(@host)}/content/repo/\" %> --ref=fedora-atomic/f<%= @host.os.major %>/<%= @host.architecture %>/docker-host\n<% elsif @host.os.name.match /.*centos.*/i -%>\nostreesetup --nogpg --osname=centos-atomic-host --remote=centos-atomic-host --url=<%= @host.param_true?('atomic-upstream') ? \"http://mirror.centos.org/centos/#{@host.os.major}/atomic/#{@host.architecture}/repo/\" : @host.operatingsystem.medium_uri(@host) %> --ref=centos-atomic-host/<%= @host.os.major %>/<%= @host.architecture %>/standard\n<% else -%>\nostreesetup --nogpg --osname=rhel-atomic-host --remote=rhel-atomic-host --url=file:///install/ostree --ref=rhel-atomic-host/<%= @host.os.major %>/<%= @host.architecture %>/standard\n<% end -%>\nservices --disabled cloud-init,cloud-config,cloud-final,cloud-init-local\nrootpw --iscrypted <%= root_pass %>\n\nreboot\n\n%post\n<%= snippet \"subscription_manager_registration\" %>\n<%= snippet('remote_execution_ssh_keys') %>\n(\n# Report success back to Foreman\ncurl -s -o /dev/null --insecure <%= foreman_url('built') %>\n) 2>&1 | tee /mnt/sysimage/root/install.post.log\n\nexit 0\n\n%end\n","snippet":false,"template_kind_id":6,"locked":true,"default":true,"vendor":"Katello","os_family":null,"job_category":"Miscellaneous","provider_type":null,"description_format":null,"execution_timeout_interval":null}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":7,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-05-08 14:20:59 UTC","id":488,"auditable_id":73,"auditable_name":"pxegrub2_discovery","auditable_type":"ProvisioningTemplate","action":"update","audited_changes":{"template":["<%#\nkind: snippet\nname: pxegrub2_discovery\n-%>\n<%#\ndiscovery image is based on CentOS/RHEL and therefor it is affected by https://bugzilla.redhat.com/show_bug.cgi?id=1259015.\nIn short, before RHEL 7.2 virtio driver didn't have the new persistent naming scheme, causing interfaces to be named eth0, eth1, etc..\nIf you want to enable the new persistent naming scheme and get inteface names like ens3, add net.ifnames=1 to the linuxefi line below.\n-%>\nmenuentry 'Foreman Discovery Image' {\n  linuxefi boot/fdi-image/vmlinuz0 rootflags=loop root=live:/fdi.iso rootfstype=auto ro rd.live.image acpi=force rd.luks=0 rd.md=0 rd.dm=0 rd.lvm=0 rd.bootif=0 rd.neednet=0 nomodeset proxy.url=<%= foreman_server_url %> proxy.type=foreman BOOTIF=01-$net_default_mac\n  initrdefi boot/fdi-image/initrd0.img\n}\n","<%#\nkind: snippet\nname: pxegrub2_discovery\n-%>\n<%#\nRHEL 7 virtio driver does not have persistent naming scheme, causing interfaces\nto be named eth0, eth1, etc.. If you want to enable the new persistent naming\nscheme and get inteface names like ens3, add net.ifnames=1 to the linuxefi line\nbelow. This will not be fixed until RHEL8 due to prevent breaking changes for\nexisting systems. See RHBZ#1259015 for more details.\n\nAnother bug in RHEL 7.4 is affecting $net_default_mac with a trailing slash, in\nthe global template we have a regexp module creating corrected variable $mac\nwhich is used here. See RHBZ#1487107 for more info.\n-%>\nmenuentry 'Foreman Discovery Image' {\n  linuxefi boot/fdi-image-rhel_7-vmlinuz rootflags=loop root=live:/fdi.iso rootfstype=auto ro rd.live.image acpi=force rd.luks=0 rd.md=0 rd.dm=0 rd.lvm=0 rd.bootif=0 rd.neednet=0 nomodeset proxy.url=<%= foreman_server_url %> proxy.type=foreman BOOTIF=01-$mac\n  initrdefi boot/fdi-image-rhel_7-img\n}\n"],"vendor":["Foreman","Satellite"]}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":7,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-05-08 14:20:59 UTC","id":487,"auditable_id":75,"auditable_name":"pxegrub_discovery","auditable_type":"ProvisioningTemplate","action":"update","audited_changes":{"template":["<%#\nkind: snippet\nname: pxegrub_discovery\n-%>\n<%#\ndiscovery image is based on CentOS/RHEL and therefor it is affected by https://bugzilla.redhat.com/show_bug.cgi?id=1259015.\nIn short, before RHEL 7.2 virtio driver didn't have the new persistent naming scheme, causing interfaces to be named eth0, eth1, etc..\nIf you want to enable the new persistent naming scheme and get inteface names like ens3, add net.ifnames=1 to the kernel line below.\n-%>\n# http://projects.theforeman.org/issues/15997\ntitle Foreman Discovery Image - not supported with Grub 1.x\n  kernel boot/fdi-image/vmlinuz0 rootflags=loop root=live:/fdi.iso rootfstype=auto ro rd.live.image acpi=force rd.luks=0 rd.md=0 rd.dm=0 rd.lvm=0 rd.bootif=0 rd.neednet=0 nomodeset proxy.url=<%= foreman_server_url %> proxy.type=foreman BOOTIF=01-$net_default_mac\n  initrd boot/fdi-image/initrd0.img\n","<%#\nkind: snippet\nname: pxegrub_discovery\n-%>\n<%#\ndiscovery image is based on CentOS/RHEL and therefor it is affected by https://bugzilla.redhat.com/show_bug.cgi?id=1259015.\nIn short, before RHEL 7.2 virtio driver didn't have the new persistent naming scheme, causing interfaces to be named eth0, eth1, etc..\nIf you want to enable the new persistent naming scheme and get inteface names like ens3, add net.ifnames=1 to the kernel line below.\n-%>\n# http://projects.theforeman.org/issues/15997\ntitle Foreman Discovery Image - not supported with Grub 1.x\n  kernel boot/fdi-image-rhel_7-vmlinuz rootflags=loop root=live:/fdi.iso rootfstype=auto ro rd.live.image acpi=force rd.luks=0 rd.md=0 rd.dm=0 rd.lvm=0 rd.bootif=0 rd.neednet=0 nomodeset proxy.url=<%= foreman_server_url %> proxy.type=foreman BOOTIF=01-$net_default_mac\n  initrd boot/fdi-image-rhel_7-img\n"],"vendor":["Foreman","Satellite"]}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":7,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-05-08 14:20:59 UTC","id":486,"auditable_id":77,"auditable_name":"pxelinux_discovery","auditable_type":"ProvisioningTemplate","action":"update","audited_changes":{"template":["<%#\nkind: snippet\nname: pxelinux_discovery\n-%>\n<%#\ndiscovery image is based on CentOS/RHEL and therefor it is affected by https://bugzilla.redhat.com/show_bug.cgi?id=1259015.\nIn short, before RHEL 7.2 virtio driver didn't have the new persistent naming scheme, causing interfaces to be named eth0, eth1, etc..\nIf you want to enable the new persistent naming scheme and get inteface names like ens3, add net.ifnames=1 to the APPEND line below.\n-%>\nLABEL discovery\n  MENU LABEL Foreman Discovery Image\n  KERNEL boot/fdi-image/vmlinuz0\n  APPEND initrd=boot/fdi-image/initrd0.img rootflags=loop root=live:/fdi.iso rootfstype=auto ro rd.live.image acpi=force rd.luks=0 rd.md=0 rd.dm=0 rd.lvm=0 rd.bootif=0 rd.neednet=0 nomodeset proxy.url=<%= foreman_server_url %> proxy.type=foreman\n  IPAPPEND 2\n","<%#\nkind: snippet\nname: pxelinux_discovery\n-%>\n<%#\ndiscovery image is based on CentOS/RHEL and therefor it is affected by https://bugzilla.redhat.com/show_bug.cgi?id=1259015.\nIn short, before RHEL 7.2 virtio driver didn't have the new persistent naming scheme, causing interfaces to be named eth0, eth1, etc..\nIf you want to enable the new persistent naming scheme and get inteface names like ens3, add net.ifnames=1 to the APPEND line below.\n-%>\nLABEL discovery\n  MENU LABEL Foreman Discovery Image\n  KERNEL boot/fdi-image-rhel_7-vmlinuz\n  APPEND initrd=boot/fdi-image-rhel_7-img rootflags=loop root=live:/fdi.iso rootfstype=auto ro rd.live.image acpi=force rd.luks=0 rd.md=0 rd.dm=0 rd.lvm=0 rd.bootif=0 rd.neednet=0 nomodeset proxy.url=<%= foreman_server_url %> proxy.type=foreman\n  IPAPPEND 2\n"],"vendor":["Foreman","Satellite"]}},{"user_id":null,"user_type":null,"user_name":null,"version":1,"comment":null,"associated_id":20,"associated_type":"Role","remote_address":null,"associated_name":"Access Insights Viewer","created_at":"2018-05-08 14:20:58 UTC","id":485,"auditable_id":280,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":20,"taxonomy_search":null,"override":false}},{"user_id":null,"user_type":null,"user_name":null,"version":1,"comment":null,"associated_id":21,"associated_type":"Role","remote_address":null,"associated_name":"Access Insights Admin","created_at":"2018-05-08 14:20:57 UTC","id":484,"auditable_id":279,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":21,"taxonomy_search":null,"override":false}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-05-08 14:20:56 UTC","id":483,"auditable_id":146,"auditable_name":null,"auditable_type":"ProvisioningTemplate","action":"create","audited_changes":{"name":"Katello Atomic Kickstart Default","template":"<%#\nkind: provision\nname: Katello Atomic Kickstart default\n%>\n\nlang <%= @host.params['lang'] || 'en_US.UTF-8' %>\nkeyboard <%= @host.params['keyboard'] || 'us' %>\ntimezone --utc <%= @host.params['time-zone'] || 'UTC' %>\n\n<% subnet = @host.subnet -%>\n<% if subnet.respond_to?(:dhcp_boot_mode?) -%>\n<% dhcp = subnet.dhcp_boot_mode? && !@static -%>\n<% else -%>\n<% dhcp = !@static -%>\n<% end -%>\n\nnetwork --bootproto <%= dhcp ? 'dhcp' : \"static --ip=#{@host.ip} --netmask=#{subnet.mask} --gateway=#{subnet.gateway} --nameserver=#{[subnet.dns_primary, subnet.dns_secondary].select{ |item| item.present? }.join(',')}\" %> --hostname <%= @host %><%= \" --device=#{@host.mac}\" -%>\n\n# Partition table should create /boot and a volume atomicos\n<% if @dynamic -%>\n%include /tmp/diskpart.cfg\n<% else -%>\n<%= @host.diskLayout %>\n<% end -%>\n\nbootloader --timeout=3\ntext\n\n<% if @host.os.name.match /.*fedora.*/i -%>\nostreesetup --nogpg --osname=fedora-atomic --remote=fedora-atomic --url=<%= @host.param_true?('atomic-upstream') ? \"https://dl.fedoraproject.org/pub/fedora/linux/atomic/#{@host.os.major}/\" : \"#{@host.operatingsystem.medium_uri(@host)}/content/repo/\" %> --ref=fedora-atomic/f<%= @host.os.major %>/<%= @host.architecture %>/docker-host\n<% elsif @host.os.name.match /.*centos.*/i -%>\nostreesetup --nogpg --osname=centos-atomic-host --remote=centos-atomic-host --url=<%= @host.param_true?('atomic-upstream') ? \"http://mirror.centos.org/centos/#{@host.os.major}/atomic/#{@host.architecture}/repo/\" : @host.operatingsystem.medium_uri(@host) %> --ref=centos-atomic-host/<%= @host.os.major %>/<%= @host.architecture %>/standard\n<% else -%>\nostreesetup --nogpg --osname=rhel-atomic-host --remote=rhel-atomic-host --url=file:///install/ostree --ref=rhel-atomic-host/<%= @host.os.major %>/<%= @host.architecture %>/standard\n<% end -%>\nservices --disabled cloud-init,cloud-config,cloud-final,cloud-init-local\nrootpw --iscrypted <%= root_pass %>\n\nreboot\n\n%post\n<%= snippet \"subscription_manager_registration\" %>\n<%= snippet('remote_execution_ssh_keys') %>\n(\n# Report success back to Foreman\ncurl -s -o /dev/null --insecure <%= foreman_url('built') %>\n) 2>&1 | tee /mnt/sysimage/root/install.post.log\n\nexit 0\n\n%end\n","snippet":false,"template_kind_id":6,"locked":true,"default":true,"vendor":"Katello","os_family":null,"job_category":"Miscellaneous","provider_type":null,"description_format":null,"execution_timeout_interval":null}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-05-08 14:20:56 UTC","id":482,"auditable_id":145,"auditable_name":null,"auditable_type":"ProvisioningTemplate","action":"create","audited_changes":{"name":"Katello Kickstart Default Finish","template":"<%#\nkind: finish\nname: Katello Kickstart default finish\noses:\n- CentOS 5\n- CentOS 6\n- CentOS 7\n- RedHat 5\n- RedHat 6\n- RedHat 7\n- Fedora 19\n- Fedora 20\n%>\n<% if @host.subnet.respond_to?(:dhcp_boot_mode?) -%>\n<%= snippet 'kickstart_networking_setup' %>\nservice network restart\n<% end -%>\n\n<%\n  rhel_compatible = @host.operatingsystem.family == 'Redhat' && @host.operatingsystem.name != 'Fedora'\n  os_major = @host.operatingsystem.major.to_i\n  pm_set = @host.puppetmaster.empty? ? false : true\n  puppet_enabled = pm_set || @host.params['force-puppet']\n  salt_enabled = @host.params['salt_master'] ? true : false\n  chef_enabled = @host.respond_to?(:chef_proxy) && @host.chef_proxy\n%>\n\n<%= snippet \"subscription_manager_registration\" %>\n\n<% if @host.respond_to?(:realm) && @host.otp && @host.realm && @host.realm.realm_type == \"FreeIPA\" -%>\n<%= snippet \"freeipa_register\" %>\n<% end -%>\n\n# update local time\necho \"updating system time\"\n/usr/sbin/ntpdate -sub <%= @host.params['ntp-server'] || '0.fedora.pool.ntp.org' %>\n/usr/sbin/hwclock --systohc\n\n<% if @host.info['parameters']['realm'] && @host.realm && @host.realm.realm_type == 'FreeIPA' -%>\n<%= snippet \"freeipa_register\" %>\n<% end -%>\n\n# update all the base packages from the updates repository\nyum -t -y -e 0 update\n\n<%= snippet('remote_execution_ssh_keys') %>\n\n<% if chef_enabled %>\n<%= snippet 'chef_client' %>\n<% end -%>\n\n<% if puppet_enabled %>\n<%= snippet 'puppet_setup' %>\n<% end -%>\n\n<% if salt_enabled %>\n<%= snippet 'saltstack_setup' %>\n<% end -%>\n\nexit 0\n","snippet":false,"template_kind_id":7,"locked":true,"default":true,"vendor":"Katello","os_family":null,"job_category":"Miscellaneous","provider_type":null,"description_format":null,"execution_timeout_interval":null}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-05-08 14:20:56 UTC","id":481,"auditable_id":144,"auditable_name":null,"auditable_type":"ProvisioningTemplate","action":"create","audited_changes":{"name":"Katello Kickstart Default User Data","template":"<%#\nkind: user_data\nname: Katello Kickstart default user data\noses:\n- CentOS 6\n- CentOS 7\n- Fedora 19\n- Fedora 20\n- Fedora 21\n- Fedora 22\n- Fedora 23\n-%>\n#cloud-config\nhostname: <%= @host.shortname %>\nfqdn: <%= @host %>\nmanage_etc_hosts: true\n\ngroups:\n - admin\n\nusers:\n - default\n - name: admin\n   primary-group: admin\n   groups: users\n   shell: /bin/bash\n   sudo: ['ALL=(ALL) ALL']\n   lock-passwd: false\n   passwd: <%= @host.root_pass %>\n\n<%# Allow user to specify additional SSH key as host paramter -%>\n<% if @host.params['sshkey'].present? || @host.params['remote_execution_ssh_keys'].present? -%>\nssh_authorized_keys:\n<% if @host.params['sshkey'].present? -%>\n  - <%= @host.params['sshkey'] %>\n<% end -%>\n<% if @host.params['remote_execution_ssh_keys'].present? -%>\n<% @host.params['remote_execution_ssh_keys'].each do |key| -%>\n  - <%= key %>\n<% end -%>\n<% end -%>\n<% end -%>\nwrite_files:\n- path: /tmp/foreman-userdata.sh\n  permissions: '0755'\n  content: |\n    #!/bin/bash\n<%= indent 4 do\n      snippet 'subscription_manager_registration'\n    end %>\n<% if @host.info['parameters']['realm'] && @host.realm && @host.realm.realm_type == 'FreeIPA' -%>\n<%= indent 4 do\n      snippet 'freeipa_register'\n    end %>\n<% end -%>\n  <% unless @host.operatingsystem.atomic? -%>\n    # update all the base packages from the updates repository\n    yum -t -y -e 0 update\n  <% end -%>\n<%\n  # safemode renderer does not support unary negation\n  non_atomic = @host.operatingsystem.atomic? ? false : true\n  pm_set = @host.puppetmaster.empty? ? false : true\n  puppet_enabled = non_atomic && (pm_set || @host.params['force-puppet'])\n  salt_enabled = non_atomic && (@host.params['salt_master'] ? true : false)\n  chef_enabled = @host.respond_to?(:chef_proxy) && @host.chef_proxy\n%>\n<% if chef_enabled %>\n<%= indent 4 do\n      snippet 'chef_client'\n    end  %>\n<% end -%>\n\n<% if puppet_enabled %>\n<%= indent 4 do\n      snippet 'puppet_setup'\n    end %>\n<% end -%>\n\n<% if salt_enabled %>\n<%= indent 4 do\n      snippet 'saltstack_setup'\n    end %>\n<% end -%>\nphone_home:\n url: <%= foreman_url('built') %>\n post: []\n tries: 10\nruncmd:\n - [ cloud-init-per, once, foreman-userdata, /tmp/foreman-userdata.sh ]\noutput: {all: '| tee -a /root/install.userdata.log'}\n\n","snippet":false,"template_kind_id":9,"locked":true,"default":true,"vendor":"Katello","os_family":null,"job_category":"Miscellaneous","provider_type":null,"description_format":null,"execution_timeout_interval":null}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-05-08 14:20:55 UTC","id":480,"auditable_id":143,"auditable_name":null,"auditable_type":"ProvisioningTemplate","action":"create","audited_changes":{"name":"Katello Kickstart Default","template":"<%#\nkind: provision\nname: Katello Kickstart default\noses:\n- CentOS 5\n- CentOS 6\n- CentOS 7\n- RedHat 5\n- RedHat 6\n- RedHat 7\n- Fedora 19\n- Fedora 20\n%>\n<%\n  rhel_compatible = @host.operatingsystem.family == 'Redhat' && @host.operatingsystem.name != 'Fedora'\n  os_major = @host.operatingsystem.major.to_i\n  # safemode renderer does not support unary negation\n  pm_set = @host.puppetmaster.empty? ? false : true\n  puppet_enabled = pm_set || @host.params['force-puppet']\n  salt_enabled = @host.params['salt_master'] ? true : false\n  chef_enabled = @host.respond_to?(:chef_proxy) && @host.chef_proxy\n  section_end = (rhel_compatible && os_major <= 5) ? '' : '%end'\n%>\ninstall\n<%= @mediapath %>\nlang en_US.UTF-8\nselinux --enforcing\nkeyboard us\nskipx\n\n<% subnet = @host.subnet -%>\n<% if subnet.respond_to?(:dhcp_boot_mode?) -%>\n<% dhcp = subnet.dhcp_boot_mode? && !@static -%>\n<% else -%>\n<% dhcp = !@static -%>\n<% end -%>\n\nnetwork --bootproto <%= dhcp ? 'dhcp' : \"static --ip=#{@host.ip} --netmask=#{subnet.mask} --gateway=#{subnet.gateway} --nameserver=#{[subnet.dns_primary, subnet.dns_secondary].select{ |item| item.present? }.join(',')}\" %> --hostname <%= @host %><%= os_major >= 6 ? \" --device=#{@host.mac}\" : '' -%>\n\nrootpw --iscrypted <%= root_pass %>\nfirewall --<%= os_major >= 6 ? 'service=' : '' %>ssh\nauthconfig --useshadow --passalgo=<%= @host.operatingsystem.password_hash || 'sha256' %> --kickstart\ntimezone --utc <%= @host.params['time-zone'] || 'UTC' %>\n\n<% if @host.operatingsystem.name == 'Fedora' and os_major <= 16 -%>\n# Bootloader exception for Fedora 16:\nbootloader --append=\"nofb quiet splash=quiet <%=ks_console%>\" <%= grub_pass %>\npart biosboot --fstype=biosboot --size=1\n<% else -%>\nbootloader --location=mbr --append=\"nofb quiet splash=quiet\" <%= grub_pass %>\n<% end -%>\n\n<% if os_major == 5 -%>\nkey --skip\n<% end -%>\n\n<% if @dynamic -%>\n%include /tmp/diskpart.cfg\n<% else -%>\n<%= @host.diskLayout %>\n<% end -%>\n\ntext\nreboot\n\n%packages --ignoremissing\nyum\ndhclient\nntp\nwget\n@Core\n<%= section_end -%>\n\n<% if @dynamic -%>\n%pre\n<%= @host.diskLayout %>\n<%= section_end -%>\n<% end -%>\n\n%post --nochroot\nexec < /dev/tty3 > /dev/tty3\n#changing to VT 3 so that we can see whats going on....\n/usr/bin/chvt 3\n(\ncp -va /etc/resolv.conf /mnt/sysimage/etc/resolv.conf\n/usr/bin/chvt 1\n) 2>&1 | tee /mnt/sysimage/root/install.postnochroot.log\n<%= section_end -%>\n\n\n%post\nlogger \"Starting anaconda <%= @host %> postinstall\"\nexec < /dev/tty3 > /dev/tty3\n#changing to VT 3 so that we can see whats going on....\n/usr/bin/chvt 3\n(\n<% if subnet.respond_to?(:dhcp_boot_mode?) -%>\n<%= snippet 'kickstart_networking_setup' %>\n<% end -%>\n\n#update local time\necho \"updating system time\"\n/usr/sbin/ntpdate -sub <%= @host.params['ntp-server'] || '0.fedora.pool.ntp.org' %>\n/usr/sbin/hwclock --systohc\n\n<%= snippet \"subscription_manager_registration\" %>\n\n<% if @host.info['parameters']['realm'] && @host.realm && @host.realm.realm_type == 'FreeIPA' -%>\n<%= snippet \"freeipa_register\" %>\n<% end -%>\n\n# update all the base packages from the updates repository\nyum -t -y -e 0 update\n\n<%= snippet('remote_execution_ssh_keys') %>\n\n<% if chef_enabled %>\n<%= snippet 'chef_client' %>\n<% end -%>\n\n<% if puppet_enabled %>\n<%= snippet 'puppet_setup' %>\n<% end -%>\n\n<% if salt_enabled %>\n<%= snippet 'saltstack_setup' %>\n<% end -%>\n\nsync\n\n<% if @provisioning_type == nil || @provisioning_type == 'host' -%>\n# Inform the build system that we are done.\necho \"Informing Foreman that we are built\"\nwget -q -O /dev/null --no-check-certificate <%= foreman_url('built') %>\n<% end -%>\n) 2>&1 | tee /root/install.post.log\nexit 0\n\n<%= section_end -%>\n","snippet":false,"template_kind_id":6,"locked":true,"default":true,"vendor":"Katello","os_family":null,"job_category":"Miscellaneous","provider_type":null,"description_format":null,"execution_timeout_interval":null}},{"user_id":null,"user_type":null,"user_name":null,"version":4,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-05-08 14:19:34 UTC","id":479,"auditable_id":97,"auditable_name":"websockets_encrypt","auditable_type":"Setting","action":"update","audited_changes":{"value":["--- false\n...",null]}},{"user_id":null,"user_type":null,"user_name":null,"version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-05-08 14:19:34 UTC","id":478,"auditable_id":91,"auditable_name":"ssl_priv_key","auditable_type":"Setting","action":"update","audited_changes":{"default":["--- \"/var/lib/puppet/ssl/private_keys/batman.usersys.redhat.com.pem\"","--- \"/etc/puppetlabs/puppet/ssl/private_keys/batman.usersys.redhat.com.pem\""]}},{"user_id":null,"user_type":null,"user_name":null,"version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-05-08 14:19:34 UTC","id":477,"auditable_id":90,"auditable_name":"ssl_ca_file","auditable_type":"Setting","action":"update","audited_changes":{"default":["--- \"/var/lib/puppet/ssl/certs/ca.pem\"","--- \"/etc/puppetlabs/puppet/ssl/certs/ca.pem\""]}},{"user_id":null,"user_type":null,"user_name":null,"version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-05-08 14:19:34 UTC","id":476,"auditable_id":89,"auditable_name":"ssl_certificate","auditable_type":"Setting","action":"update","audited_changes":{"default":["--- \"/var/lib/puppet/ssl/certs/batman.usersys.redhat.com.pem\"","--- \"/etc/puppetlabs/puppet/ssl/certs/batman.usersys.redhat.com.pem\""]}},{"user_id":3,"user_type":null,"user_name":"admin","version":7,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.228","associated_name":null,"created_at":"2018-05-08 14:00:28 UTC","id":475,"auditable_id":20,"auditable_name":"rhel74.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"comment":[null,""],"environment_id":[null,5],"puppet_proxy_id":[null,1],"puppet_ca_proxy_id":[null,1]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":21,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-05-08 13:59:50 UTC","id":474,"auditable_id":5,"auditable_name":"drone74.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"global_status":[1,2]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":20,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-05-08 13:58:44 UTC","id":473,"auditable_id":5,"auditable_name":"drone74.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"global_status":[2,1]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":19,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.58","associated_name":null,"created_at":"2018-05-08 13:58:33 UTC","id":472,"auditable_id":5,"auditable_name":"drone74.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"global_status":[1,2]}},{"user_id":3,"user_type":null,"user_name":"admin","version":2,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.10.125.85","associated_name":null,"created_at":"2018-05-04 12:14:43 UTC","id":471,"auditable_id":106,"auditable_name":"send_welcome_email","auditable_type":"Setting","action":"update","audited_changes":{"value":["--- true\n...",null]}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.10.125.85","associated_name":null,"created_at":"2018-05-04 12:14:36 UTC","id":470,"auditable_id":106,"auditable_name":"send_welcome_email","auditable_type":"Setting","action":"update","audited_changes":{"value":[null,"--- true\n..."]}},{"user_id":3,"user_type":null,"user_name":"admin","version":2,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.10.125.85","associated_name":null,"created_at":"2018-05-04 12:00:44 UTC","id":469,"auditable_id":80,"auditable_name":"login_text","auditable_type":"Setting","action":"update","audited_changes":{"value":["--- Git jiggy wid it!\n...","--- I like pizza\n..."]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":6,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-05-03 22:16:59 UTC","id":468,"auditable_id":20,"auditable_name":"rhel74.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"global_status":[2,1]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":5,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.228","associated_name":null,"created_at":"2018-05-03 22:16:49 UTC","id":467,"auditable_id":20,"auditable_name":"rhel74.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"global_status":[0,2]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":4,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-05-03 22:16:49 UTC","id":466,"auditable_id":20,"auditable_name":"rhel74.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"global_status":[0,2]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":3,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.228","associated_name":null,"created_at":"2018-05-03 22:16:48 UTC","id":465,"auditable_id":20,"auditable_name":"rhel74.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"architecture_id":[null,1],"operatingsystem_id":[null,1]}},{"user_id":3,"user_type":null,"user_name":"admin","version":2,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.228","associated_name":null,"created_at":"2018-05-03 22:16:46 UTC","id":464,"auditable_id":20,"auditable_name":"rhel74.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"grub_pass":["$1$P+njt71R$aJ7SCkdSEFTNAyj0PcVpN0","$5$I1zNJqWv$ia4vDk/KXYPD6bucCSMMxh2uFgclCvElVcRYzTT89H9"]}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.228","associated_name":null,"created_at":"2018-05-03 22:16:46 UTC","id":463,"auditable_id":20,"auditable_name":"rhel74.usersys.redhat.com","auditable_type":"Host","action":"create","audited_changes":{"name":"rhel74.usersys.redhat.com","root_pass":"$5$I1zNJqWv$ia4vDk/KXYPD6bucCSMMxh2uFgclCvElVcRYzTT89H9","architecture_id":null,"operatingsystem_id":null,"environment_id":null,"ptable_id":null,"medium_id":null,"build":false,"comment":null,"disk":null,"installed_at":null,"model_id":null,"hostgroup_id":null,"owner_id":3,"owner_type":"User","enabled":true,"puppet_ca_proxy_id":null,"managed":false,"use_image":null,"image_file":null,"uuid":null,"compute_resource_id":null,"puppet_proxy_id":null,"certname":null,"image_id":null,"organization_id":1,"location_id":2,"otp":null,"realm_id":null,"compute_profile_id":null,"provision_method":null,"grub_pass":"$1$P+njt71R$aJ7SCkdSEFTNAyj0PcVpN0","discovery_rule_id":null,"content_view_id":null,"lifecycle_environment_id":null,"global_status":0,"pxe_loader":null,"openscap_proxy_id":null}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":14,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-05-01 04:21:42 UTC","id":462,"auditable_id":11,"auditable_name":"drone68.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"global_status":[2,1]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":16,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-05-01 04:21:42 UTC","id":461,"auditable_id":9,"auditable_name":"drone69.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"global_status":[1,2]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":8,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-29 18:16:03 UTC","id":460,"auditable_id":19,"auditable_name":"batsquid.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"global_status":[1,2]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":7,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-29 18:14:59 UTC","id":459,"auditable_id":19,"auditable_name":"batsquid.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"global_status":[2,1]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":6,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-29 18:13:20 UTC","id":458,"auditable_id":19,"auditable_name":"batsquid.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"global_status":[1,2]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":5,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-29 18:12:20 UTC","id":457,"auditable_id":19,"auditable_name":"batsquid.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"global_status":[2,1]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":4,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.159","associated_name":null,"created_at":"2018-04-29 18:12:01 UTC","id":456,"auditable_id":19,"auditable_name":"batsquid.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"global_status":[0,2]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":4,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-29 18:12:01 UTC","id":455,"auditable_id":19,"auditable_name":"batsquid.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"global_status":[0,2]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":3,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.159","associated_name":null,"created_at":"2018-04-29 18:12:00 UTC","id":454,"auditable_id":19,"auditable_name":"batsquid.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"model_id":[null,1],"architecture_id":[null,1],"operatingsystem_id":[null,1]}},{"user_id":3,"user_type":null,"user_name":"admin","version":2,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.159","associated_name":null,"created_at":"2018-04-29 18:11:57 UTC","id":453,"auditable_id":19,"auditable_name":"batsquid.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"grub_pass":["$1$t4bQtX4c$jHJzgnqxfdLE5E7HkWghT0","$5$QAWSu2WX$z4yaFXW..eIuHWL/wDt.sYrsmvrjOakhamBhQRa3/kD"]}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.159","associated_name":null,"created_at":"2018-04-29 18:11:57 UTC","id":452,"auditable_id":19,"auditable_name":"batsquid.usersys.redhat.com","auditable_type":"Host","action":"create","audited_changes":{"name":"batsquid.usersys.redhat.com","root_pass":"$5$QAWSu2WX$z4yaFXW..eIuHWL/wDt.sYrsmvrjOakhamBhQRa3/kD","architecture_id":null,"operatingsystem_id":null,"environment_id":null,"ptable_id":null,"medium_id":null,"build":false,"comment":null,"disk":null,"installed_at":null,"model_id":null,"hostgroup_id":null,"owner_id":3,"owner_type":"User","enabled":true,"puppet_ca_proxy_id":null,"managed":false,"use_image":null,"image_file":null,"uuid":null,"compute_resource_id":null,"puppet_proxy_id":null,"certname":null,"image_id":null,"organization_id":1,"location_id":2,"otp":null,"realm_id":null,"compute_profile_id":null,"provision_method":null,"grub_pass":"$1$t4bQtX4c$jHJzgnqxfdLE5E7HkWghT0","discovery_rule_id":null,"content_view_id":null,"lifecycle_environment_id":null,"global_status":0,"pxe_loader":null,"openscap_proxy_id":null}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.228","associated_name":null,"created_at":"2018-04-27 17:32:42 UTC","id":451,"auditable_id":100,"auditable_name":"authorize_login_delegation","auditable_type":"Setting","action":"update","audited_changes":{"value":[null,"--- true\n..."]}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.228","associated_name":null,"created_at":"2018-04-27 17:32:35 UTC","id":450,"auditable_id":98,"auditable_name":"login_delegation_logout_url","auditable_type":"Setting","action":"update","audited_changes":{"value":[null,"--- https://giphy.com/gifs/hells-kitchen-hells-kitchen-gordon-ramsay-xT0BKBOzy7ASIA82ZO\n..."]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":11,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-26 23:39:03 UTC","id":449,"auditable_id":13,"auditable_name":"drone73.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"global_status":[1,2]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":13,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-26 21:48:38 UTC","id":448,"auditable_id":11,"auditable_name":"drone68.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"global_status":[1,2]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":15,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-26 20:30:05 UTC","id":447,"auditable_id":9,"auditable_name":"drone69.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"global_status":[2,1]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":18,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-26 20:30:04 UTC","id":446,"auditable_id":5,"auditable_name":"drone74.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"global_status":[2,1]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":12,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-26 20:29:56 UTC","id":445,"auditable_id":12,"auditable_name":"drone72.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"global_status":[2,1]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":12,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-26 20:29:55 UTC","id":444,"auditable_id":10,"auditable_name":"drone67.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"global_status":[2,1]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":10,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-26 20:29:53 UTC","id":443,"auditable_id":13,"auditable_name":"drone73.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"global_status":[2,1]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":12,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-26 20:29:41 UTC","id":442,"auditable_id":11,"auditable_name":"drone68.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"global_status":[2,1]}},{"user_id":3,"user_type":null,"user_name":"admin","version":5,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-26 17:14:39 UTC","id":441,"auditable_id":18,"auditable_name":"regtest.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"global_status":[2,1]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":4,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.175","associated_name":null,"created_at":"2018-04-26 17:12:54 UTC","id":440,"auditable_id":18,"auditable_name":"regtest.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"global_status":[0,2]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":3,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.175","associated_name":null,"created_at":"2018-04-26 17:12:54 UTC","id":439,"auditable_id":18,"auditable_name":"regtest.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"model_id":[null,1],"architecture_id":[null,1],"operatingsystem_id":[null,1]}},{"user_id":3,"user_type":null,"user_name":"admin","version":2,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.175","associated_name":null,"created_at":"2018-04-26 17:12:51 UTC","id":438,"auditable_id":18,"auditable_name":"regtest.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"grub_pass":["$1$d6kbIpkU$lEo6eTTh9rOY.H.isIPWa1","$5$iK1yR6IV$GbQSE6TaQYc/QE85pwUHL.ayZx477iX36je0aMM.579"]}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.175","associated_name":null,"created_at":"2018-04-26 17:12:51 UTC","id":437,"auditable_id":18,"auditable_name":"regtest.usersys.redhat.com","auditable_type":"Host","action":"create","audited_changes":{"name":"regtest.usersys.redhat.com","root_pass":"$5$iK1yR6IV$GbQSE6TaQYc/QE85pwUHL.ayZx477iX36je0aMM.579","architecture_id":null,"operatingsystem_id":null,"environment_id":null,"ptable_id":null,"medium_id":null,"build":false,"comment":null,"disk":null,"installed_at":null,"model_id":null,"hostgroup_id":null,"owner_id":3,"owner_type":"User","enabled":true,"puppet_ca_proxy_id":null,"managed":false,"use_image":null,"image_file":null,"uuid":null,"compute_resource_id":null,"puppet_proxy_id":null,"certname":null,"image_id":null,"organization_id":1,"location_id":2,"otp":null,"realm_id":null,"compute_profile_id":null,"provision_method":null,"grub_pass":"$1$d6kbIpkU$lEo6eTTh9rOY.H.isIPWa1","discovery_rule_id":null,"content_view_id":null,"lifecycle_environment_id":null,"global_status":0,"pxe_loader":null,"openscap_proxy_id":null}},{"user_id":null,"user_type":null,"user_name":null,"version":3,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-26 13:24:24 UTC","id":436,"auditable_id":97,"auditable_name":"websockets_encrypt","auditable_type":"Setting","action":"update","audited_changes":{"value":[null,"--- false\n..."]}},{"user_id":null,"user_type":null,"user_name":null,"version":2,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-26 12:40:46 UTC","id":435,"auditable_id":97,"auditable_name":"websockets_encrypt","auditable_type":"Setting","action":"update","audited_changes":{"value":["--- false\n...",null]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":8,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-26 12:38:01 UTC","id":434,"auditable_id":17,"auditable_name":"brigadebox.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"global_status":[1,0]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":17,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-26 12:37:57 UTC","id":433,"auditable_id":5,"auditable_name":"drone74.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"global_status":[1,2]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":11,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-26 12:37:54 UTC","id":432,"auditable_id":11,"auditable_name":"drone68.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"global_status":[1,2]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":11,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-26 12:37:52 UTC","id":431,"auditable_id":10,"auditable_name":"drone67.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"global_status":[1,2]}},{"user_id":null,"user_type":null,"user_name":null,"version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-26 12:35:51 UTC","id":430,"auditable_id":97,"auditable_name":"websockets_encrypt","auditable_type":"Setting","action":"update","audited_changes":{"value":[null,"--- false\n..."]}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.228","associated_name":null,"created_at":"2018-04-26 12:18:00 UTC","id":429,"auditable_id":80,"auditable_name":"login_text","auditable_type":"Setting","action":"update","audited_changes":{"value":[null,"--- Git jiggy wid it!\n..."]}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.228","associated_name":null,"created_at":"2018-04-26 12:17:11 UTC","id":428,"auditable_id":74,"auditable_name":"entries_per_page","auditable_type":"Setting","action":"update","audited_changes":{"value":[null,"--- 40\n..."]}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.228","associated_name":null,"created_at":"2018-04-23 21:20:38 UTC","id":427,"auditable_id":2,"auditable_name":"brigadebox.usersys.redhat.com (Libvirt)","auditable_type":"ComputeResource","action":"create","audited_changes":{"name":"brigadebox.usersys.redhat.com","description":"","url":"qemu+ssh://root@brigadebox.usersys.redhat.com/system","user":null,"uuid":"C2C09E88-4838-E211-A7EA-00247E06F60E","email":null,"caching_enabled":true,"domain":null}},{"user_id":3,"user_type":null,"user_name":"admin","version":6,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.228","associated_name":null,"created_at":"2018-04-23 21:13:27 UTC","id":426,"auditable_id":14,"auditable_name":"batman.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"uuid":[null,"70faf365-0fef-4a81-ac49-090b95dd4616"],"compute_resource_id":[null,1]}},{"user_id":3,"user_type":null,"user_name":"admin","version":10,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.228","associated_name":null,"created_at":"2018-04-23 21:13:27 UTC","id":425,"auditable_id":10,"auditable_name":"drone67.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"uuid":[null,"e0fd24bc-eb48-4587-b2b7-5097a4618738"],"compute_resource_id":[null,1]}},{"user_id":3,"user_type":null,"user_name":"admin","version":10,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.228","associated_name":null,"created_at":"2018-04-23 21:13:27 UTC","id":424,"auditable_id":11,"auditable_name":"drone68.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"uuid":[null,"d98417f1-f547-43ec-ac71-c9994111cc31"],"compute_resource_id":[null,1]}},{"user_id":3,"user_type":null,"user_name":"admin","version":9,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.228","associated_name":null,"created_at":"2018-04-23 21:13:27 UTC","id":423,"auditable_id":13,"auditable_name":"drone73.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"uuid":[null,"566a52cc-f7b2-4bda-941a-651ce954605c"],"compute_resource_id":[null,1]}},{"user_id":3,"user_type":null,"user_name":"admin","version":11,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.228","associated_name":null,"created_at":"2018-04-23 21:13:27 UTC","id":422,"auditable_id":12,"auditable_name":"drone72.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"uuid":[null,"8e022ad9-4e58-4f27-8b06-86e56f5e3d03"],"compute_resource_id":[null,1]}},{"user_id":3,"user_type":null,"user_name":"admin","version":14,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.228","associated_name":null,"created_at":"2018-04-23 21:13:27 UTC","id":421,"auditable_id":9,"auditable_name":"drone69.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"uuid":[null,"99965f0f-a020-44c8-b2c7-ec05c7c23fa4"],"compute_resource_id":[null,1]}},{"user_id":3,"user_type":null,"user_name":"admin","version":16,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.228","associated_name":null,"created_at":"2018-04-23 21:13:27 UTC","id":420,"auditable_id":5,"auditable_name":"drone74.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"uuid":[null,"3abd79e1-761c-46b3-8a47-2c345e7deb7b"],"compute_resource_id":[null,1]}},{"user_id":3,"user_type":null,"user_name":"admin","version":8,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.228","associated_name":null,"created_at":"2018-04-23 21:13:27 UTC","id":419,"auditable_id":16,"auditable_name":"splinter.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"uuid":[null,"9ef09eda-9825-4200-8e65-984d94b213b8"],"compute_resource_id":[null,1]}},{"user_id":3,"user_type":null,"user_name":"admin","version":9,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.228","associated_name":null,"created_at":"2018-04-23 21:13:27 UTC","id":418,"auditable_id":15,"auditable_name":"joker.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"uuid":[null,"e5920cd9-e23c-4f99-b0a0-d64cbc6a07fc"],"compute_resource_id":[null,1]}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.228","associated_name":null,"created_at":"2018-04-23 21:13:21 UTC","id":417,"auditable_id":1,"auditable_name":"battalionbox.usersys.redhat.com (Libvirt)","auditable_type":"ComputeResource","action":"create","audited_changes":{"name":"battalionbox.usersys.redhat.com","description":"","url":"qemu+ssh://root@battalionbox.usersys.redhat.com/system","user":null,"uuid":"7A2906DC-91F0-E111-A8BD-CC52AF3EEB50","email":null,"caching_enabled":true,"domain":null}},{"user_id":3,"user_type":null,"user_name":"admin","version":13,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.228","associated_name":null,"created_at":"2018-04-23 20:54:08 UTC","id":416,"auditable_id":9,"auditable_name":"drone69.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"managed":[true,false],"grub_pass":["$1$o3rGjKc1$8amg.lq4IU3iYayXCjeF.1","$5$J4t71N8W$zu7YuTZWfTSerOlUOwpn5VXso2m6oK1TRozkAouZ1U1"]}},{"user_id":3,"user_type":null,"user_name":"admin","version":12,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.228","associated_name":null,"created_at":"2018-04-23 20:52:02 UTC","id":415,"auditable_id":9,"auditable_name":"drone69.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"disk":[null,""],"comment":[null,""],"root_pass":["$5$EGk1j1kP$URrylC9yXfpgg3awuvl8vKrzzaJItWkgGy6u4F4BUAC","$5$J4t71N8W$zu7YuTZWfTSerOlUOwpn5VXso2m6oK1TRozkAouZ1U1"],"pxe_loader":[null,""],"environment_id":[1,2],"grub_pass":["$5$EGk1j1kP$URrylC9yXfpgg3awuvl8vKrzzaJItWkgGy6u4F4BUAC","$1$o3rGjKc1$8amg.lq4IU3iYayXCjeF.1"]}},{"user_id":3,"user_type":null,"user_name":"admin","version":11,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.228","associated_name":null,"created_at":"2018-04-23 20:51:51 UTC","id":414,"auditable_id":9,"auditable_name":"drone69.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"managed":[false,true]}},{"user_id":3,"user_type":null,"user_name":"admin","version":5,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.228","associated_name":null,"created_at":"2018-04-23 20:51:23 UTC","id":413,"auditable_id":14,"auditable_name":"batman.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"managed":[false,true]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":7,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-20 17:30:15 UTC","id":412,"auditable_id":17,"auditable_name":"brigadebox.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"operatingsystem_id":[1,7]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":6,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-20 12:13:11 UTC","id":411,"auditable_id":17,"auditable_name":"brigadebox.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"global_status":[2,1]}},{"user_id":3,"user_type":null,"user_name":"admin","version":5,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-20 12:13:11 UTC","id":410,"auditable_id":17,"auditable_name":"brigadebox.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"global_status":[2,1]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":4,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.10","associated_name":null,"created_at":"2018-04-20 12:12:16 UTC","id":409,"auditable_id":17,"auditable_name":"brigadebox.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"model_id":[null,2],"architecture_id":[null,1],"operatingsystem_id":[null,1]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":3,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-20 12:12:14 UTC","id":408,"auditable_id":17,"auditable_name":"brigadebox.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"global_status":[0,2]}},{"user_id":3,"user_type":null,"user_name":"admin","version":2,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.10","associated_name":null,"created_at":"2018-04-20 12:12:10 UTC","id":407,"auditable_id":17,"auditable_name":"brigadebox.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"grub_pass":["$1$+jpxSmRS$90iIejIzAmdidJaEDSbj3/","$5$7AFL3vuq$ZOqrNPgIZR5Hy9YK9NIGSVZezeHxZOY5TxsjqHjHIU8"]}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.10","associated_name":null,"created_at":"2018-04-20 12:12:10 UTC","id":406,"auditable_id":17,"auditable_name":"brigadebox.usersys.redhat.com","auditable_type":"Host","action":"create","audited_changes":{"name":"brigadebox.usersys.redhat.com","root_pass":"$5$7AFL3vuq$ZOqrNPgIZR5Hy9YK9NIGSVZezeHxZOY5TxsjqHjHIU8","architecture_id":null,"operatingsystem_id":null,"environment_id":null,"ptable_id":null,"medium_id":null,"build":false,"comment":null,"disk":null,"installed_at":null,"model_id":null,"hostgroup_id":null,"owner_id":3,"owner_type":"User","enabled":true,"puppet_ca_proxy_id":null,"managed":false,"use_image":null,"image_file":null,"uuid":null,"compute_resource_id":null,"puppet_proxy_id":null,"certname":null,"image_id":null,"organization_id":1,"location_id":2,"otp":null,"realm_id":null,"compute_profile_id":null,"provision_method":null,"grub_pass":"$1$+jpxSmRS$90iIejIzAmdidJaEDSbj3/","discovery_rule_id":null,"content_view_id":null,"lifecycle_environment_id":null,"global_status":0,"pxe_loader":null,"openscap_proxy_id":null}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":8,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.133","associated_name":null,"created_at":"2018-04-15 19:40:09 UTC","id":405,"auditable_id":15,"auditable_name":"joker.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"operatingsystem_id":[1,7]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":7,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-14 08:28:04 UTC","id":404,"auditable_id":15,"auditable_name":"joker.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"global_status":[2,1]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":15,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-14 06:39:55 UTC","id":403,"auditable_id":5,"auditable_name":"drone74.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"global_status":[2,1]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":7,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-14 05:28:47 UTC","id":402,"auditable_id":16,"auditable_name":"splinter.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"global_status":[2,1]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":9,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-13 17:49:21 UTC","id":401,"auditable_id":11,"auditable_name":"drone68.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"global_status":[2,1]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":9,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-13 17:49:19 UTC","id":400,"auditable_id":10,"auditable_name":"drone67.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"global_status":[2,1]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":2,"comment":null,"associated_id":21,"associated_type":"Role","remote_address":null,"associated_name":"Access Insights Admin","created_at":"2018-04-13 17:49:04 UTC","id":399,"auditable_id":277,"auditable_name":"view_hosts","auditable_type":"Filter","action":"destroy","audited_changes":{"search":null,"role_id":21,"taxonomy_search":null,"override":false}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":2,"comment":null,"associated_id":20,"associated_type":"Role","remote_address":null,"associated_name":"Access Insights Viewer","created_at":"2018-04-13 17:49:04 UTC","id":398,"auditable_id":278,"auditable_name":"view_hosts","auditable_type":"Filter","action":"destroy","audited_changes":{"search":null,"role_id":20,"taxonomy_search":null,"override":false}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":2,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-13 17:48:39 UTC","id":397,"auditable_id":140,"auditable_name":"Katello Kickstart Default User Data","auditable_type":"ProvisioningTemplate","action":"destroy","audited_changes":{"name":"Katello Kickstart Default User Data","template":"<%#\nkind: user_data\nname: Katello Kickstart default user data\noses:\n- CentOS 6\n- CentOS 7\n- Fedora 19\n- Fedora 20\n- Fedora 21\n- Fedora 22\n- Fedora 23\n-%>\n#cloud-config\nhostname: <%= @host.shortname %>\nfqdn: <%= @host %>\nmanage_etc_hosts: true\n\ngroups:\n - admin\n\nusers:\n - default\n - name: admin\n   primary-group: admin\n   groups: users\n   shell: /bin/bash\n   sudo: ['ALL=(ALL) ALL']\n   lock-passwd: false\n   passwd: <%= @host.root_pass %>\n\n<%# Allow user to specify additional SSH key as host paramter -%>\n<% if @host.params['sshkey'].present? || @host.params['remote_execution_ssh_keys'].present? -%>\nssh_authorized_keys:\n<% if @host.params['sshkey'].present? -%>\n  - <%= @host.params['sshkey'] %>\n<% end -%>\n<% if @host.params['remote_execution_ssh_keys'].present? -%>\n<% @host.params['remote_execution_ssh_keys'].each do |key| -%>\n  - <%= key %>\n<% end -%>\n<% end -%>\n<% end -%>\nwrite_files:\n- path: /tmp/foreman-userdata.sh\n  permissions: '0755'\n  content: |\n    #!/bin/bash\n<%= indent 4 do\n      snippet 'subscription_manager_registration'\n    end %>\n<% if @host.info['parameters']['realm'] && @host.realm && @host.realm.realm_type == 'FreeIPA' -%>\n<%= indent 4 do\n      snippet 'freeipa_register'\n    end %>\n<% end -%>\n  <% unless @host.operatingsystem.atomic? -%>\n    # update all the base packages from the updates repository\n    yum -t -y -e 0 update\n  <% end -%>\n<%\n  # safemode renderer does not support unary negation\n  non_atomic = @host.operatingsystem.atomic? ? false : true\n  pm_set = @host.puppetmaster.empty? ? false : true\n  puppet_enabled = non_atomic && (pm_set || @host.params['force-puppet'])\n  salt_enabled = non_atomic && (@host.params['salt_master'] ? true : false)\n  chef_enabled = @host.respond_to?(:chef_proxy) && @host.chef_proxy\n%>\n<% if chef_enabled %>\n<%= indent 4 do\n      snippet 'chef_client'\n    end  %>\n<% end -%>\n\n<% if puppet_enabled %>\n<%= indent 4 do\n      snippet 'puppet_setup'\n    end %>\n<% end -%>\n\n<% if salt_enabled %>\n<%= indent 4 do\n      snippet 'saltstack_setup'\n    end %>\n<% end -%>\nphone_home:\n url: <%= foreman_url('built') %>\n post: []\n tries: 10\nruncmd:\n - [ cloud-init-per, once, foreman-userdata, /tmp/foreman-userdata.sh ]\noutput: {all: '| tee -a /root/install.userdata.log'}\n\n","snippet":false,"template_kind_id":9,"locked":true,"default":true,"vendor":"Katello","os_family":null,"job_category":"Miscellaneous","provider_type":null,"description_format":null,"execution_timeout_interval":null}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":2,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-13 17:48:39 UTC","id":396,"auditable_id":141,"auditable_name":"Katello Kickstart Default Finish","auditable_type":"ProvisioningTemplate","action":"destroy","audited_changes":{"name":"Katello Kickstart Default Finish","template":"<%#\nkind: finish\nname: Katello Kickstart default finish\noses:\n- CentOS 5\n- CentOS 6\n- CentOS 7\n- RedHat 5\n- RedHat 6\n- RedHat 7\n- Fedora 19\n- Fedora 20\n%>\n<% if @host.subnet.respond_to?(:dhcp_boot_mode?) -%>\n<%= snippet 'kickstart_networking_setup' %>\nservice network restart\n<% end -%>\n\n<%\n  rhel_compatible = @host.operatingsystem.family == 'Redhat' && @host.operatingsystem.name != 'Fedora'\n  os_major = @host.operatingsystem.major.to_i\n  pm_set = @host.puppetmaster.empty? ? false : true\n  puppet_enabled = pm_set || @host.params['force-puppet']\n  salt_enabled = @host.params['salt_master'] ? true : false\n  chef_enabled = @host.respond_to?(:chef_proxy) && @host.chef_proxy\n%>\n\n<%= snippet \"subscription_manager_registration\" %>\n\n<% if @host.respond_to?(:realm) && @host.otp && @host.realm && @host.realm.realm_type == \"FreeIPA\" -%>\n<%= snippet \"freeipa_register\" %>\n<% end -%>\n\n# update local time\necho \"updating system time\"\n/usr/sbin/ntpdate -sub <%= @host.params['ntp-server'] || '0.fedora.pool.ntp.org' %>\n/usr/sbin/hwclock --systohc\n\n<% if @host.info['parameters']['realm'] && @host.realm && @host.realm.realm_type == 'FreeIPA' -%>\n<%= snippet \"freeipa_register\" %>\n<% end -%>\n\n# update all the base packages from the updates repository\nyum -t -y -e 0 update\n\n<%= snippet('remote_execution_ssh_keys') %>\n\n<% if chef_enabled %>\n<%= snippet 'chef_client' %>\n<% end -%>\n\n<% if puppet_enabled %>\n<%= snippet 'puppet_setup' %>\n<% end -%>\n\n<% if salt_enabled %>\n<%= snippet 'saltstack_setup' %>\n<% end -%>\n\nexit 0\n","snippet":false,"template_kind_id":7,"locked":true,"default":true,"vendor":"Katello","os_family":null,"job_category":"Miscellaneous","provider_type":null,"description_format":null,"execution_timeout_interval":null}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":2,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-13 17:48:39 UTC","id":395,"auditable_id":139,"auditable_name":"Katello Kickstart Default","auditable_type":"ProvisioningTemplate","action":"destroy","audited_changes":{"name":"Katello Kickstart Default","template":"<%#\nkind: provision\nname: Katello Kickstart default\noses:\n- CentOS 5\n- CentOS 6\n- CentOS 7\n- RedHat 5\n- RedHat 6\n- RedHat 7\n- Fedora 19\n- Fedora 20\n%>\n<%\n  rhel_compatible = @host.operatingsystem.family == 'Redhat' && @host.operatingsystem.name != 'Fedora'\n  os_major = @host.operatingsystem.major.to_i\n  # safemode renderer does not support unary negation\n  pm_set = @host.puppetmaster.empty? ? false : true\n  puppet_enabled = pm_set || @host.params['force-puppet']\n  salt_enabled = @host.params['salt_master'] ? true : false\n  chef_enabled = @host.respond_to?(:chef_proxy) && @host.chef_proxy\n  section_end = (rhel_compatible && os_major <= 5) ? '' : '%end'\n%>\ninstall\n<%= @mediapath %>\nlang en_US.UTF-8\nselinux --enforcing\nkeyboard us\nskipx\n\n<% subnet = @host.subnet -%>\n<% if subnet.respond_to?(:dhcp_boot_mode?) -%>\n<% dhcp = subnet.dhcp_boot_mode? && !@static -%>\n<% else -%>\n<% dhcp = !@static -%>\n<% end -%>\n\nnetwork --bootproto <%= dhcp ? 'dhcp' : \"static --ip=#{@host.ip} --netmask=#{subnet.mask} --gateway=#{subnet.gateway} --nameserver=#{[subnet.dns_primary, subnet.dns_secondary].select{ |item| item.present? }.join(',')}\" %> --hostname <%= @host %><%= os_major >= 6 ? \" --device=#{@host.mac}\" : '' -%>\n\nrootpw --iscrypted <%= root_pass %>\nfirewall --<%= os_major >= 6 ? 'service=' : '' %>ssh\nauthconfig --useshadow --passalgo=<%= @host.operatingsystem.password_hash || 'sha256' %> --kickstart\ntimezone --utc <%= @host.params['time-zone'] || 'UTC' %>\n\n<% if @host.operatingsystem.name == 'Fedora' and os_major <= 16 -%>\n# Bootloader exception for Fedora 16:\nbootloader --append=\"nofb quiet splash=quiet <%=ks_console%>\" <%= grub_pass %>\npart biosboot --fstype=biosboot --size=1\n<% else -%>\nbootloader --location=mbr --append=\"nofb quiet splash=quiet\" <%= grub_pass %>\n<% end -%>\n\n<% if os_major == 5 -%>\nkey --skip\n<% end -%>\n\n<% if @dynamic -%>\n%include /tmp/diskpart.cfg\n<% else -%>\n<%= @host.diskLayout %>\n<% end -%>\n\ntext\nreboot\n\n%packages --ignoremissing\nyum\ndhclient\nntp\nwget\n@Core\n<%= section_end -%>\n\n<% if @dynamic -%>\n%pre\n<%= @host.diskLayout %>\n<%= section_end -%>\n<% end -%>\n\n%post --nochroot\nexec < /dev/tty3 > /dev/tty3\n#changing to VT 3 so that we can see whats going on....\n/usr/bin/chvt 3\n(\ncp -va /etc/resolv.conf /mnt/sysimage/etc/resolv.conf\n/usr/bin/chvt 1\n) 2>&1 | tee /mnt/sysimage/root/install.postnochroot.log\n<%= section_end -%>\n\n\n%post\nlogger \"Starting anaconda <%= @host %> postinstall\"\nexec < /dev/tty3 > /dev/tty3\n#changing to VT 3 so that we can see whats going on....\n/usr/bin/chvt 3\n(\n<% if subnet.respond_to?(:dhcp_boot_mode?) -%>\n<%= snippet 'kickstart_networking_setup' %>\n<% end -%>\n\n#update local time\necho \"updating system time\"\n/usr/sbin/ntpdate -sub <%= @host.params['ntp-server'] || '0.fedora.pool.ntp.org' %>\n/usr/sbin/hwclock --systohc\n\n<%= snippet \"subscription_manager_registration\" %>\n\n<% if @host.info['parameters']['realm'] && @host.realm && @host.realm.realm_type == 'FreeIPA' -%>\n<%= snippet \"freeipa_register\" %>\n<% end -%>\n\n# update all the base packages from the updates repository\nyum -t -y -e 0 update\n\n<%= snippet('remote_execution_ssh_keys') %>\n\n<% if chef_enabled %>\n<%= snippet 'chef_client' %>\n<% end -%>\n\n<% if puppet_enabled %>\n<%= snippet 'puppet_setup' %>\n<% end -%>\n\n<% if salt_enabled %>\n<%= snippet 'saltstack_setup' %>\n<% end -%>\n\nsync\n\n<% if @provisioning_type == nil || @provisioning_type == 'host' -%>\n# Inform the build system that we are done.\necho \"Informing Foreman that we are built\"\nwget -q -O /dev/null --no-check-certificate <%= foreman_url('built') %>\n<% end -%>\n) 2>&1 | tee /root/install.post.log\nexit 0\n\n<%= section_end -%>\n","snippet":false,"template_kind_id":6,"locked":true,"default":true,"vendor":"Katello","os_family":null,"job_category":"Miscellaneous","provider_type":null,"description_format":null,"execution_timeout_interval":null}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":2,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-13 17:48:39 UTC","id":394,"auditable_id":142,"auditable_name":"Katello Atomic Kickstart Default","auditable_type":"ProvisioningTemplate","action":"destroy","audited_changes":{"name":"Katello Atomic Kickstart Default","template":"<%#\nkind: provision\nname: Katello Atomic Kickstart default\n%>\n\nlang <%= @host.params['lang'] || 'en_US.UTF-8' %>\nkeyboard <%= @host.params['keyboard'] || 'us' %>\ntimezone --utc <%= @host.params['time-zone'] || 'UTC' %>\n\n<% subnet = @host.subnet -%>\n<% if subnet.respond_to?(:dhcp_boot_mode?) -%>\n<% dhcp = subnet.dhcp_boot_mode? && !@static -%>\n<% else -%>\n<% dhcp = !@static -%>\n<% end -%>\n\nnetwork --bootproto <%= dhcp ? 'dhcp' : \"static --ip=#{@host.ip} --netmask=#{subnet.mask} --gateway=#{subnet.gateway} --nameserver=#{[subnet.dns_primary, subnet.dns_secondary].select{ |item| item.present? }.join(',')}\" %> --hostname <%= @host %><%= \" --device=#{@host.mac}\" -%>\n\n# Partition table should create /boot and a volume atomicos\n<% if @dynamic -%>\n%include /tmp/diskpart.cfg\n<% else -%>\n<%= @host.diskLayout %>\n<% end -%>\n\nbootloader --timeout=3\ntext\n\n<% if @host.os.name.match /.*fedora.*/i -%>\nostreesetup --nogpg --osname=fedora-atomic --remote=fedora-atomic --url=<%= @host.param_true?('atomic-upstream') ? \"https://dl.fedoraproject.org/pub/fedora/linux/atomic/#{@host.os.major}/\" : \"#{@host.operatingsystem.medium_uri(@host)}/content/repo/\" %> --ref=fedora-atomic/f<%= @host.os.major %>/<%= @host.architecture %>/docker-host\n<% elsif @host.os.name.match /.*centos.*/i -%>\nostreesetup --nogpg --osname=centos-atomic-host --remote=centos-atomic-host --url=<%= @host.param_true?('atomic-upstream') ? \"http://mirror.centos.org/centos/#{@host.os.major}/atomic/#{@host.architecture}/repo/\" : @host.operatingsystem.medium_uri(@host) %> --ref=centos-atomic-host/<%= @host.os.major %>/<%= @host.architecture %>/standard\n<% else -%>\nostreesetup --nogpg --osname=rhel-atomic-host --remote=rhel-atomic-host --url=file:///install/ostree --ref=rhel-atomic-host/<%= @host.os.major %>/<%= @host.architecture %>/standard\n<% end -%>\nservices --disabled cloud-init,cloud-config,cloud-final,cloud-init-local\nrootpw --iscrypted <%= root_pass %>\n\nreboot\n\n%post\n<%= snippet \"subscription_manager_registration\" %>\n<%= snippet('remote_execution_ssh_keys') %>\n(\n# Report success back to Foreman\ncurl -s -o /dev/null --insecure <%= foreman_url('built') %>\n) 2>&1 | tee /mnt/sysimage/root/install.post.log\n\nexit 0\n\n%end\n","snippet":false,"template_kind_id":6,"locked":true,"default":true,"vendor":"Katello","os_family":null,"job_category":"Miscellaneous","provider_type":null,"description_format":null,"execution_timeout_interval":null}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":6,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-13 17:48:37 UTC","id":393,"auditable_id":73,"auditable_name":"pxegrub2_discovery","auditable_type":"ProvisioningTemplate","action":"update","audited_changes":{"template":["<%#\nkind: snippet\nname: pxegrub2_discovery\n-%>\n<%#\ndiscovery image is based on CentOS/RHEL and therefor it is affected by https://bugzilla.redhat.com/show_bug.cgi?id=1259015.\nIn short, before RHEL 7.2 virtio driver didn't have the new persistent naming scheme, causing interfaces to be named eth0, eth1, etc..\nIf you want to enable the new persistent naming scheme and get inteface names like ens3, add net.ifnames=1 to the linuxefi line below.\n-%>\nmenuentry 'Foreman Discovery Image' {\n  linuxefi boot/fdi-image/vmlinuz0 rootflags=loop root=live:/fdi.iso rootfstype=auto ro rd.live.image acpi=force rd.luks=0 rd.md=0 rd.dm=0 rd.lvm=0 rd.bootif=0 rd.neednet=0 nomodeset proxy.url=<%= foreman_server_url %> proxy.type=foreman BOOTIF=01-$net_default_mac\n  initrdefi boot/fdi-image/initrd0.img\n}\n","<%#\nkind: snippet\nname: pxegrub2_discovery\n-%>\n<%#\nRHEL 7 virtio driver does not have persistent naming scheme, causing interfaces\nto be named eth0, eth1, etc.. If you want to enable the new persistent naming\nscheme and get inteface names like ens3, add net.ifnames=1 to the linuxefi line\nbelow. This will not be fixed until RHEL8 due to prevent breaking changes for\nexisting systems. See RHBZ#1259015 for more details.\n\nAnother bug in RHEL 7.4 is affecting $net_default_mac with a trailing slash, in\nthe global template we have a regexp module creating corrected variable $mac\nwhich is used here. See RHBZ#1487107 for more info.\n-%>\nmenuentry 'Foreman Discovery Image' {\n  linuxefi boot/fdi-image-rhel_7-vmlinuz rootflags=loop root=live:/fdi.iso rootfstype=auto ro rd.live.image acpi=force rd.luks=0 rd.md=0 rd.dm=0 rd.lvm=0 rd.bootif=0 rd.neednet=0 nomodeset proxy.url=<%= foreman_server_url %> proxy.type=foreman BOOTIF=01-$mac\n  initrdefi boot/fdi-image-rhel_7-img\n}\n"],"vendor":["Foreman","Satellite"]}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":6,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-13 17:48:37 UTC","id":392,"auditable_id":75,"auditable_name":"pxegrub_discovery","auditable_type":"ProvisioningTemplate","action":"update","audited_changes":{"template":["<%#\nkind: snippet\nname: pxegrub_discovery\n-%>\n<%#\ndiscovery image is based on CentOS/RHEL and therefor it is affected by https://bugzilla.redhat.com/show_bug.cgi?id=1259015.\nIn short, before RHEL 7.2 virtio driver didn't have the new persistent naming scheme, causing interfaces to be named eth0, eth1, etc..\nIf you want to enable the new persistent naming scheme and get inteface names like ens3, add net.ifnames=1 to the kernel line below.\n-%>\n# http://projects.theforeman.org/issues/15997\ntitle Foreman Discovery Image - not supported with Grub 1.x\n  kernel boot/fdi-image/vmlinuz0 rootflags=loop root=live:/fdi.iso rootfstype=auto ro rd.live.image acpi=force rd.luks=0 rd.md=0 rd.dm=0 rd.lvm=0 rd.bootif=0 rd.neednet=0 nomodeset proxy.url=<%= foreman_server_url %> proxy.type=foreman BOOTIF=01-$net_default_mac\n  initrd boot/fdi-image/initrd0.img\n","<%#\nkind: snippet\nname: pxegrub_discovery\n-%>\n<%#\ndiscovery image is based on CentOS/RHEL and therefor it is affected by https://bugzilla.redhat.com/show_bug.cgi?id=1259015.\nIn short, before RHEL 7.2 virtio driver didn't have the new persistent naming scheme, causing interfaces to be named eth0, eth1, etc..\nIf you want to enable the new persistent naming scheme and get inteface names like ens3, add net.ifnames=1 to the kernel line below.\n-%>\n# http://projects.theforeman.org/issues/15997\ntitle Foreman Discovery Image - not supported with Grub 1.x\n  kernel boot/fdi-image-rhel_7-vmlinuz rootflags=loop root=live:/fdi.iso rootfstype=auto ro rd.live.image acpi=force rd.luks=0 rd.md=0 rd.dm=0 rd.lvm=0 rd.bootif=0 rd.neednet=0 nomodeset proxy.url=<%= foreman_server_url %> proxy.type=foreman BOOTIF=01-$net_default_mac\n  initrd boot/fdi-image-rhel_7-img\n"],"vendor":["Foreman","Satellite"]}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":6,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-13 17:48:37 UTC","id":391,"auditable_id":77,"auditable_name":"pxelinux_discovery","auditable_type":"ProvisioningTemplate","action":"update","audited_changes":{"template":["<%#\nkind: snippet\nname: pxelinux_discovery\n-%>\n<%#\ndiscovery image is based on CentOS/RHEL and therefor it is affected by https://bugzilla.redhat.com/show_bug.cgi?id=1259015.\nIn short, before RHEL 7.2 virtio driver didn't have the new persistent naming scheme, causing interfaces to be named eth0, eth1, etc..\nIf you want to enable the new persistent naming scheme and get inteface names like ens3, add net.ifnames=1 to the APPEND line below.\n-%>\nLABEL discovery\n  MENU LABEL Foreman Discovery Image\n  KERNEL boot/fdi-image/vmlinuz0\n  APPEND initrd=boot/fdi-image/initrd0.img rootflags=loop root=live:/fdi.iso rootfstype=auto ro rd.live.image acpi=force rd.luks=0 rd.md=0 rd.dm=0 rd.lvm=0 rd.bootif=0 rd.neednet=0 nomodeset proxy.url=<%= foreman_server_url %> proxy.type=foreman\n  IPAPPEND 2\n","<%#\nkind: snippet\nname: pxelinux_discovery\n-%>\n<%#\ndiscovery image is based on CentOS/RHEL and therefor it is affected by https://bugzilla.redhat.com/show_bug.cgi?id=1259015.\nIn short, before RHEL 7.2 virtio driver didn't have the new persistent naming scheme, causing interfaces to be named eth0, eth1, etc..\nIf you want to enable the new persistent naming scheme and get inteface names like ens3, add net.ifnames=1 to the APPEND line below.\n-%>\nLABEL discovery\n  MENU LABEL Foreman Discovery Image\n  KERNEL boot/fdi-image-rhel_7-vmlinuz\n  APPEND initrd=boot/fdi-image-rhel_7-img rootflags=loop root=live:/fdi.iso rootfstype=auto ro rd.live.image acpi=force rd.luks=0 rd.md=0 rd.dm=0 rd.lvm=0 rd.bootif=0 rd.neednet=0 nomodeset proxy.url=<%= foreman_server_url %> proxy.type=foreman\n  IPAPPEND 2\n"],"vendor":["Foreman","Satellite"]}},{"user_id":null,"user_type":null,"user_name":null,"version":1,"comment":null,"associated_id":20,"associated_type":"Role","remote_address":null,"associated_name":"Access Insights Viewer","created_at":"2018-04-13 17:48:36 UTC","id":390,"auditable_id":278,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":20,"taxonomy_search":null,"override":false}},{"user_id":null,"user_type":null,"user_name":null,"version":1,"comment":null,"associated_id":21,"associated_type":"Role","remote_address":null,"associated_name":"Access Insights Admin","created_at":"2018-04-13 17:48:36 UTC","id":389,"auditable_id":277,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":21,"taxonomy_search":null,"override":false}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-13 17:48:34 UTC","id":388,"auditable_id":142,"auditable_name":null,"auditable_type":"ProvisioningTemplate","action":"create","audited_changes":{"name":"Katello Atomic Kickstart Default","template":"<%#\nkind: provision\nname: Katello Atomic Kickstart default\n%>\n\nlang <%= @host.params['lang'] || 'en_US.UTF-8' %>\nkeyboard <%= @host.params['keyboard'] || 'us' %>\ntimezone --utc <%= @host.params['time-zone'] || 'UTC' %>\n\n<% subnet = @host.subnet -%>\n<% if subnet.respond_to?(:dhcp_boot_mode?) -%>\n<% dhcp = subnet.dhcp_boot_mode? && !@static -%>\n<% else -%>\n<% dhcp = !@static -%>\n<% end -%>\n\nnetwork --bootproto <%= dhcp ? 'dhcp' : \"static --ip=#{@host.ip} --netmask=#{subnet.mask} --gateway=#{subnet.gateway} --nameserver=#{[subnet.dns_primary, subnet.dns_secondary].select{ |item| item.present? }.join(',')}\" %> --hostname <%= @host %><%= \" --device=#{@host.mac}\" -%>\n\n# Partition table should create /boot and a volume atomicos\n<% if @dynamic -%>\n%include /tmp/diskpart.cfg\n<% else -%>\n<%= @host.diskLayout %>\n<% end -%>\n\nbootloader --timeout=3\ntext\n\n<% if @host.os.name.match /.*fedora.*/i -%>\nostreesetup --nogpg --osname=fedora-atomic --remote=fedora-atomic --url=<%= @host.param_true?('atomic-upstream') ? \"https://dl.fedoraproject.org/pub/fedora/linux/atomic/#{@host.os.major}/\" : \"#{@host.operatingsystem.medium_uri(@host)}/content/repo/\" %> --ref=fedora-atomic/f<%= @host.os.major %>/<%= @host.architecture %>/docker-host\n<% elsif @host.os.name.match /.*centos.*/i -%>\nostreesetup --nogpg --osname=centos-atomic-host --remote=centos-atomic-host --url=<%= @host.param_true?('atomic-upstream') ? \"http://mirror.centos.org/centos/#{@host.os.major}/atomic/#{@host.architecture}/repo/\" : @host.operatingsystem.medium_uri(@host) %> --ref=centos-atomic-host/<%= @host.os.major %>/<%= @host.architecture %>/standard\n<% else -%>\nostreesetup --nogpg --osname=rhel-atomic-host --remote=rhel-atomic-host --url=file:///install/ostree --ref=rhel-atomic-host/<%= @host.os.major %>/<%= @host.architecture %>/standard\n<% end -%>\nservices --disabled cloud-init,cloud-config,cloud-final,cloud-init-local\nrootpw --iscrypted <%= root_pass %>\n\nreboot\n\n%post\n<%= snippet \"subscription_manager_registration\" %>\n<%= snippet('remote_execution_ssh_keys') %>\n(\n# Report success back to Foreman\ncurl -s -o /dev/null --insecure <%= foreman_url('built') %>\n) 2>&1 | tee /mnt/sysimage/root/install.post.log\n\nexit 0\n\n%end\n","snippet":false,"template_kind_id":6,"locked":true,"default":true,"vendor":"Katello","os_family":null,"job_category":"Miscellaneous","provider_type":null,"description_format":null,"execution_timeout_interval":null}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-13 17:48:34 UTC","id":387,"auditable_id":141,"auditable_name":null,"auditable_type":"ProvisioningTemplate","action":"create","audited_changes":{"name":"Katello Kickstart Default Finish","template":"<%#\nkind: finish\nname: Katello Kickstart default finish\noses:\n- CentOS 5\n- CentOS 6\n- CentOS 7\n- RedHat 5\n- RedHat 6\n- RedHat 7\n- Fedora 19\n- Fedora 20\n%>\n<% if @host.subnet.respond_to?(:dhcp_boot_mode?) -%>\n<%= snippet 'kickstart_networking_setup' %>\nservice network restart\n<% end -%>\n\n<%\n  rhel_compatible = @host.operatingsystem.family == 'Redhat' && @host.operatingsystem.name != 'Fedora'\n  os_major = @host.operatingsystem.major.to_i\n  pm_set = @host.puppetmaster.empty? ? false : true\n  puppet_enabled = pm_set || @host.params['force-puppet']\n  salt_enabled = @host.params['salt_master'] ? true : false\n  chef_enabled = @host.respond_to?(:chef_proxy) && @host.chef_proxy\n%>\n\n<%= snippet \"subscription_manager_registration\" %>\n\n<% if @host.respond_to?(:realm) && @host.otp && @host.realm && @host.realm.realm_type == \"FreeIPA\" -%>\n<%= snippet \"freeipa_register\" %>\n<% end -%>\n\n# update local time\necho \"updating system time\"\n/usr/sbin/ntpdate -sub <%= @host.params['ntp-server'] || '0.fedora.pool.ntp.org' %>\n/usr/sbin/hwclock --systohc\n\n<% if @host.info['parameters']['realm'] && @host.realm && @host.realm.realm_type == 'FreeIPA' -%>\n<%= snippet \"freeipa_register\" %>\n<% end -%>\n\n# update all the base packages from the updates repository\nyum -t -y -e 0 update\n\n<%= snippet('remote_execution_ssh_keys') %>\n\n<% if chef_enabled %>\n<%= snippet 'chef_client' %>\n<% end -%>\n\n<% if puppet_enabled %>\n<%= snippet 'puppet_setup' %>\n<% end -%>\n\n<% if salt_enabled %>\n<%= snippet 'saltstack_setup' %>\n<% end -%>\n\nexit 0\n","snippet":false,"template_kind_id":7,"locked":true,"default":true,"vendor":"Katello","os_family":null,"job_category":"Miscellaneous","provider_type":null,"description_format":null,"execution_timeout_interval":null}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-13 17:48:34 UTC","id":386,"auditable_id":140,"auditable_name":null,"auditable_type":"ProvisioningTemplate","action":"create","audited_changes":{"name":"Katello Kickstart Default User Data","template":"<%#\nkind: user_data\nname: Katello Kickstart default user data\noses:\n- CentOS 6\n- CentOS 7\n- Fedora 19\n- Fedora 20\n- Fedora 21\n- Fedora 22\n- Fedora 23\n-%>\n#cloud-config\nhostname: <%= @host.shortname %>\nfqdn: <%= @host %>\nmanage_etc_hosts: true\n\ngroups:\n - admin\n\nusers:\n - default\n - name: admin\n   primary-group: admin\n   groups: users\n   shell: /bin/bash\n   sudo: ['ALL=(ALL) ALL']\n   lock-passwd: false\n   passwd: <%= @host.root_pass %>\n\n<%# Allow user to specify additional SSH key as host paramter -%>\n<% if @host.params['sshkey'].present? || @host.params['remote_execution_ssh_keys'].present? -%>\nssh_authorized_keys:\n<% if @host.params['sshkey'].present? -%>\n  - <%= @host.params['sshkey'] %>\n<% end -%>\n<% if @host.params['remote_execution_ssh_keys'].present? -%>\n<% @host.params['remote_execution_ssh_keys'].each do |key| -%>\n  - <%= key %>\n<% end -%>\n<% end -%>\n<% end -%>\nwrite_files:\n- path: /tmp/foreman-userdata.sh\n  permissions: '0755'\n  content: |\n    #!/bin/bash\n<%= indent 4 do\n      snippet 'subscription_manager_registration'\n    end %>\n<% if @host.info['parameters']['realm'] && @host.realm && @host.realm.realm_type == 'FreeIPA' -%>\n<%= indent 4 do\n      snippet 'freeipa_register'\n    end %>\n<% end -%>\n  <% unless @host.operatingsystem.atomic? -%>\n    # update all the base packages from the updates repository\n    yum -t -y -e 0 update\n  <% end -%>\n<%\n  # safemode renderer does not support unary negation\n  non_atomic = @host.operatingsystem.atomic? ? false : true\n  pm_set = @host.puppetmaster.empty? ? false : true\n  puppet_enabled = non_atomic && (pm_set || @host.params['force-puppet'])\n  salt_enabled = non_atomic && (@host.params['salt_master'] ? true : false)\n  chef_enabled = @host.respond_to?(:chef_proxy) && @host.chef_proxy\n%>\n<% if chef_enabled %>\n<%= indent 4 do\n      snippet 'chef_client'\n    end  %>\n<% end -%>\n\n<% if puppet_enabled %>\n<%= indent 4 do\n      snippet 'puppet_setup'\n    end %>\n<% end -%>\n\n<% if salt_enabled %>\n<%= indent 4 do\n      snippet 'saltstack_setup'\n    end %>\n<% end -%>\nphone_home:\n url: <%= foreman_url('built') %>\n post: []\n tries: 10\nruncmd:\n - [ cloud-init-per, once, foreman-userdata, /tmp/foreman-userdata.sh ]\noutput: {all: '| tee -a /root/install.userdata.log'}\n\n","snippet":false,"template_kind_id":9,"locked":true,"default":true,"vendor":"Katello","os_family":null,"job_category":"Miscellaneous","provider_type":null,"description_format":null,"execution_timeout_interval":null}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-13 17:48:34 UTC","id":385,"auditable_id":139,"auditable_name":null,"auditable_type":"ProvisioningTemplate","action":"create","audited_changes":{"name":"Katello Kickstart Default","template":"<%#\nkind: provision\nname: Katello Kickstart default\noses:\n- CentOS 5\n- CentOS 6\n- CentOS 7\n- RedHat 5\n- RedHat 6\n- RedHat 7\n- Fedora 19\n- Fedora 20\n%>\n<%\n  rhel_compatible = @host.operatingsystem.family == 'Redhat' && @host.operatingsystem.name != 'Fedora'\n  os_major = @host.operatingsystem.major.to_i\n  # safemode renderer does not support unary negation\n  pm_set = @host.puppetmaster.empty? ? false : true\n  puppet_enabled = pm_set || @host.params['force-puppet']\n  salt_enabled = @host.params['salt_master'] ? true : false\n  chef_enabled = @host.respond_to?(:chef_proxy) && @host.chef_proxy\n  section_end = (rhel_compatible && os_major <= 5) ? '' : '%end'\n%>\ninstall\n<%= @mediapath %>\nlang en_US.UTF-8\nselinux --enforcing\nkeyboard us\nskipx\n\n<% subnet = @host.subnet -%>\n<% if subnet.respond_to?(:dhcp_boot_mode?) -%>\n<% dhcp = subnet.dhcp_boot_mode? && !@static -%>\n<% else -%>\n<% dhcp = !@static -%>\n<% end -%>\n\nnetwork --bootproto <%= dhcp ? 'dhcp' : \"static --ip=#{@host.ip} --netmask=#{subnet.mask} --gateway=#{subnet.gateway} --nameserver=#{[subnet.dns_primary, subnet.dns_secondary].select{ |item| item.present? }.join(',')}\" %> --hostname <%= @host %><%= os_major >= 6 ? \" --device=#{@host.mac}\" : '' -%>\n\nrootpw --iscrypted <%= root_pass %>\nfirewall --<%= os_major >= 6 ? 'service=' : '' %>ssh\nauthconfig --useshadow --passalgo=<%= @host.operatingsystem.password_hash || 'sha256' %> --kickstart\ntimezone --utc <%= @host.params['time-zone'] || 'UTC' %>\n\n<% if @host.operatingsystem.name == 'Fedora' and os_major <= 16 -%>\n# Bootloader exception for Fedora 16:\nbootloader --append=\"nofb quiet splash=quiet <%=ks_console%>\" <%= grub_pass %>\npart biosboot --fstype=biosboot --size=1\n<% else -%>\nbootloader --location=mbr --append=\"nofb quiet splash=quiet\" <%= grub_pass %>\n<% end -%>\n\n<% if os_major == 5 -%>\nkey --skip\n<% end -%>\n\n<% if @dynamic -%>\n%include /tmp/diskpart.cfg\n<% else -%>\n<%= @host.diskLayout %>\n<% end -%>\n\ntext\nreboot\n\n%packages --ignoremissing\nyum\ndhclient\nntp\nwget\n@Core\n<%= section_end -%>\n\n<% if @dynamic -%>\n%pre\n<%= @host.diskLayout %>\n<%= section_end -%>\n<% end -%>\n\n%post --nochroot\nexec < /dev/tty3 > /dev/tty3\n#changing to VT 3 so that we can see whats going on....\n/usr/bin/chvt 3\n(\ncp -va /etc/resolv.conf /mnt/sysimage/etc/resolv.conf\n/usr/bin/chvt 1\n) 2>&1 | tee /mnt/sysimage/root/install.postnochroot.log\n<%= section_end -%>\n\n\n%post\nlogger \"Starting anaconda <%= @host %> postinstall\"\nexec < /dev/tty3 > /dev/tty3\n#changing to VT 3 so that we can see whats going on....\n/usr/bin/chvt 3\n(\n<% if subnet.respond_to?(:dhcp_boot_mode?) -%>\n<%= snippet 'kickstart_networking_setup' %>\n<% end -%>\n\n#update local time\necho \"updating system time\"\n/usr/sbin/ntpdate -sub <%= @host.params['ntp-server'] || '0.fedora.pool.ntp.org' %>\n/usr/sbin/hwclock --systohc\n\n<%= snippet \"subscription_manager_registration\" %>\n\n<% if @host.info['parameters']['realm'] && @host.realm && @host.realm.realm_type == 'FreeIPA' -%>\n<%= snippet \"freeipa_register\" %>\n<% end -%>\n\n# update all the base packages from the updates repository\nyum -t -y -e 0 update\n\n<%= snippet('remote_execution_ssh_keys') %>\n\n<% if chef_enabled %>\n<%= snippet 'chef_client' %>\n<% end -%>\n\n<% if puppet_enabled %>\n<%= snippet 'puppet_setup' %>\n<% end -%>\n\n<% if salt_enabled %>\n<%= snippet 'saltstack_setup' %>\n<% end -%>\n\nsync\n\n<% if @provisioning_type == nil || @provisioning_type == 'host' -%>\n# Inform the build system that we are done.\necho \"Informing Foreman that we are built\"\nwget -q -O /dev/null --no-check-certificate <%= foreman_url('built') %>\n<% end -%>\n) 2>&1 | tee /root/install.post.log\nexit 0\n\n<%= section_end -%>\n","snippet":false,"template_kind_id":6,"locked":true,"default":true,"vendor":"Katello","os_family":null,"job_category":"Miscellaneous","provider_type":null,"description_format":null,"execution_timeout_interval":null}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":4,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.218","associated_name":null,"created_at":"2018-04-13 16:09:46 UTC","id":384,"auditable_id":14,"auditable_name":"batman.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"operatingsystem_id":[1,7]}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.218","associated_name":null,"created_at":"2018-04-13 16:09:46 UTC","id":383,"auditable_id":7,"auditable_name":"RedHat 7.5","auditable_type":"Operatingsystem","action":"create","audited_changes":{"major":"7","name":"RedHat","minor":"5","nameindicator":null,"release_name":null,"description":null,"password_hash":"SHA256","title":"RedHat 7.5"}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":2,"comment":null,"associated_id":21,"associated_type":"Role","remote_address":null,"associated_name":"Access Insights Admin","created_at":"2018-04-13 16:07:49 UTC","id":382,"auditable_id":275,"auditable_name":"view_hosts","auditable_type":"Filter","action":"destroy","audited_changes":{"search":null,"role_id":21,"taxonomy_search":null,"override":false}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":2,"comment":null,"associated_id":20,"associated_type":"Role","remote_address":null,"associated_name":"Access Insights Viewer","created_at":"2018-04-13 16:07:49 UTC","id":381,"auditable_id":276,"auditable_name":"view_hosts","auditable_type":"Filter","action":"destroy","audited_changes":{"search":null,"role_id":20,"taxonomy_search":null,"override":false}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":2,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-13 16:07:26 UTC","id":380,"auditable_id":136,"auditable_name":"Katello Kickstart Default User Data","auditable_type":"ProvisioningTemplate","action":"destroy","audited_changes":{"name":"Katello Kickstart Default User Data","template":"<%#\nkind: user_data\nname: Katello Kickstart default user data\noses:\n- CentOS 6\n- CentOS 7\n- Fedora 19\n- Fedora 20\n- Fedora 21\n- Fedora 22\n- Fedora 23\n-%>\n#cloud-config\nhostname: <%= @host.shortname %>\nfqdn: <%= @host %>\nmanage_etc_hosts: true\n\ngroups:\n - admin\n\nusers:\n - default\n - name: admin\n   primary-group: admin\n   groups: users\n   shell: /bin/bash\n   sudo: ['ALL=(ALL) ALL']\n   lock-passwd: false\n   passwd: <%= @host.root_pass %>\n\n<%# Allow user to specify additional SSH key as host paramter -%>\n<% if @host.params['sshkey'].present? || @host.params['remote_execution_ssh_keys'].present? -%>\nssh_authorized_keys:\n<% if @host.params['sshkey'].present? -%>\n  - <%= @host.params['sshkey'] %>\n<% end -%>\n<% if @host.params['remote_execution_ssh_keys'].present? -%>\n<% @host.params['remote_execution_ssh_keys'].each do |key| -%>\n  - <%= key %>\n<% end -%>\n<% end -%>\n<% end -%>\nwrite_files:\n- path: /tmp/foreman-userdata.sh\n  permissions: '0755'\n  content: |\n    #!/bin/bash\n<%= indent 4 do\n      snippet 'subscription_manager_registration'\n    end %>\n<% if @host.info['parameters']['realm'] && @host.realm && @host.realm.realm_type == 'FreeIPA' -%>\n<%= indent 4 do\n      snippet 'freeipa_register'\n    end %>\n<% end -%>\n  <% unless @host.operatingsystem.atomic? -%>\n    # update all the base packages from the updates repository\n    yum -t -y -e 0 update\n  <% end -%>\n<%\n  # safemode renderer does not support unary negation\n  non_atomic = @host.operatingsystem.atomic? ? false : true\n  pm_set = @host.puppetmaster.empty? ? false : true\n  puppet_enabled = non_atomic && (pm_set || @host.params['force-puppet'])\n  salt_enabled = non_atomic && (@host.params['salt_master'] ? true : false)\n  chef_enabled = @host.respond_to?(:chef_proxy) && @host.chef_proxy\n%>\n<% if chef_enabled %>\n<%= indent 4 do\n      snippet 'chef_client'\n    end  %>\n<% end -%>\n\n<% if puppet_enabled %>\n<%= indent 4 do\n      snippet 'puppet_setup'\n    end %>\n<% end -%>\n\n<% if salt_enabled %>\n<%= indent 4 do\n      snippet 'saltstack_setup'\n    end %>\n<% end -%>\nphone_home:\n url: <%= foreman_url('built') %>\n post: []\n tries: 10\nruncmd:\n - [ cloud-init-per, once, foreman-userdata, /tmp/foreman-userdata.sh ]\noutput: {all: '| tee -a /root/install.userdata.log'}\n\n","snippet":false,"template_kind_id":9,"locked":true,"default":true,"vendor":"Katello","os_family":null,"job_category":"Miscellaneous","provider_type":null,"description_format":null,"execution_timeout_interval":null}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":2,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-13 16:07:26 UTC","id":379,"auditable_id":137,"auditable_name":"Katello Kickstart Default Finish","auditable_type":"ProvisioningTemplate","action":"destroy","audited_changes":{"name":"Katello Kickstart Default Finish","template":"<%#\nkind: finish\nname: Katello Kickstart default finish\noses:\n- CentOS 5\n- CentOS 6\n- CentOS 7\n- RedHat 5\n- RedHat 6\n- RedHat 7\n- Fedora 19\n- Fedora 20\n%>\n<% if @host.subnet.respond_to?(:dhcp_boot_mode?) -%>\n<%= snippet 'kickstart_networking_setup' %>\nservice network restart\n<% end -%>\n\n<%\n  rhel_compatible = @host.operatingsystem.family == 'Redhat' && @host.operatingsystem.name != 'Fedora'\n  os_major = @host.operatingsystem.major.to_i\n  pm_set = @host.puppetmaster.empty? ? false : true\n  puppet_enabled = pm_set || @host.params['force-puppet']\n  salt_enabled = @host.params['salt_master'] ? true : false\n  chef_enabled = @host.respond_to?(:chef_proxy) && @host.chef_proxy\n%>\n\n<%= snippet \"subscription_manager_registration\" %>\n\n<% if @host.respond_to?(:realm) && @host.otp && @host.realm && @host.realm.realm_type == \"FreeIPA\" -%>\n<%= snippet \"freeipa_register\" %>\n<% end -%>\n\n# update local time\necho \"updating system time\"\n/usr/sbin/ntpdate -sub <%= @host.params['ntp-server'] || '0.fedora.pool.ntp.org' %>\n/usr/sbin/hwclock --systohc\n\n<% if @host.info['parameters']['realm'] && @host.realm && @host.realm.realm_type == 'FreeIPA' -%>\n<%= snippet \"freeipa_register\" %>\n<% end -%>\n\n# update all the base packages from the updates repository\nyum -t -y -e 0 update\n\n<%= snippet('remote_execution_ssh_keys') %>\n\n<% if chef_enabled %>\n<%= snippet 'chef_client' %>\n<% end -%>\n\n<% if puppet_enabled %>\n<%= snippet 'puppet_setup' %>\n<% end -%>\n\n<% if salt_enabled %>\n<%= snippet 'saltstack_setup' %>\n<% end -%>\n\nexit 0\n","snippet":false,"template_kind_id":7,"locked":true,"default":true,"vendor":"Katello","os_family":null,"job_category":"Miscellaneous","provider_type":null,"description_format":null,"execution_timeout_interval":null}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":2,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-13 16:07:26 UTC","id":378,"auditable_id":135,"auditable_name":"Katello Kickstart Default","auditable_type":"ProvisioningTemplate","action":"destroy","audited_changes":{"name":"Katello Kickstart Default","template":"<%#\nkind: provision\nname: Katello Kickstart default\noses:\n- CentOS 5\n- CentOS 6\n- CentOS 7\n- RedHat 5\n- RedHat 6\n- RedHat 7\n- Fedora 19\n- Fedora 20\n%>\n<%\n  rhel_compatible = @host.operatingsystem.family == 'Redhat' && @host.operatingsystem.name != 'Fedora'\n  os_major = @host.operatingsystem.major.to_i\n  # safemode renderer does not support unary negation\n  pm_set = @host.puppetmaster.empty? ? false : true\n  puppet_enabled = pm_set || @host.params['force-puppet']\n  salt_enabled = @host.params['salt_master'] ? true : false\n  chef_enabled = @host.respond_to?(:chef_proxy) && @host.chef_proxy\n  section_end = (rhel_compatible && os_major <= 5) ? '' : '%end'\n%>\ninstall\n<%= @mediapath %>\nlang en_US.UTF-8\nselinux --enforcing\nkeyboard us\nskipx\n\n<% subnet = @host.subnet -%>\n<% if subnet.respond_to?(:dhcp_boot_mode?) -%>\n<% dhcp = subnet.dhcp_boot_mode? && !@static -%>\n<% else -%>\n<% dhcp = !@static -%>\n<% end -%>\n\nnetwork --bootproto <%= dhcp ? 'dhcp' : \"static --ip=#{@host.ip} --netmask=#{subnet.mask} --gateway=#{subnet.gateway} --nameserver=#{[subnet.dns_primary, subnet.dns_secondary].select{ |item| item.present? }.join(',')}\" %> --hostname <%= @host %><%= os_major >= 6 ? \" --device=#{@host.mac}\" : '' -%>\n\nrootpw --iscrypted <%= root_pass %>\nfirewall --<%= os_major >= 6 ? 'service=' : '' %>ssh\nauthconfig --useshadow --passalgo=<%= @host.operatingsystem.password_hash || 'sha256' %> --kickstart\ntimezone --utc <%= @host.params['time-zone'] || 'UTC' %>\n\n<% if @host.operatingsystem.name == 'Fedora' and os_major <= 16 -%>\n# Bootloader exception for Fedora 16:\nbootloader --append=\"nofb quiet splash=quiet <%=ks_console%>\" <%= grub_pass %>\npart biosboot --fstype=biosboot --size=1\n<% else -%>\nbootloader --location=mbr --append=\"nofb quiet splash=quiet\" <%= grub_pass %>\n<% end -%>\n\n<% if os_major == 5 -%>\nkey --skip\n<% end -%>\n\n<% if @dynamic -%>\n%include /tmp/diskpart.cfg\n<% else -%>\n<%= @host.diskLayout %>\n<% end -%>\n\ntext\nreboot\n\n%packages --ignoremissing\nyum\ndhclient\nntp\nwget\n@Core\n<%= section_end -%>\n\n<% if @dynamic -%>\n%pre\n<%= @host.diskLayout %>\n<%= section_end -%>\n<% end -%>\n\n%post --nochroot\nexec < /dev/tty3 > /dev/tty3\n#changing to VT 3 so that we can see whats going on....\n/usr/bin/chvt 3\n(\ncp -va /etc/resolv.conf /mnt/sysimage/etc/resolv.conf\n/usr/bin/chvt 1\n) 2>&1 | tee /mnt/sysimage/root/install.postnochroot.log\n<%= section_end -%>\n\n\n%post\nlogger \"Starting anaconda <%= @host %> postinstall\"\nexec < /dev/tty3 > /dev/tty3\n#changing to VT 3 so that we can see whats going on....\n/usr/bin/chvt 3\n(\n<% if subnet.respond_to?(:dhcp_boot_mode?) -%>\n<%= snippet 'kickstart_networking_setup' %>\n<% end -%>\n\n#update local time\necho \"updating system time\"\n/usr/sbin/ntpdate -sub <%= @host.params['ntp-server'] || '0.fedora.pool.ntp.org' %>\n/usr/sbin/hwclock --systohc\n\n<%= snippet \"subscription_manager_registration\" %>\n\n<% if @host.info['parameters']['realm'] && @host.realm && @host.realm.realm_type == 'FreeIPA' -%>\n<%= snippet \"freeipa_register\" %>\n<% end -%>\n\n# update all the base packages from the updates repository\nyum -t -y -e 0 update\n\n<%= snippet('remote_execution_ssh_keys') %>\n\n<% if chef_enabled %>\n<%= snippet 'chef_client' %>\n<% end -%>\n\n<% if puppet_enabled %>\n<%= snippet 'puppet_setup' %>\n<% end -%>\n\n<% if salt_enabled %>\n<%= snippet 'saltstack_setup' %>\n<% end -%>\n\nsync\n\n<% if @provisioning_type == nil || @provisioning_type == 'host' -%>\n# Inform the build system that we are done.\necho \"Informing Foreman that we are built\"\nwget -q -O /dev/null --no-check-certificate <%= foreman_url('built') %>\n<% end -%>\n) 2>&1 | tee /root/install.post.log\nexit 0\n\n<%= section_end -%>\n","snippet":false,"template_kind_id":6,"locked":true,"default":true,"vendor":"Katello","os_family":null,"job_category":"Miscellaneous","provider_type":null,"description_format":null,"execution_timeout_interval":null}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":2,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-13 16:07:26 UTC","id":377,"auditable_id":138,"auditable_name":"Katello Atomic Kickstart Default","auditable_type":"ProvisioningTemplate","action":"destroy","audited_changes":{"name":"Katello Atomic Kickstart Default","template":"<%#\nkind: provision\nname: Katello Atomic Kickstart default\n%>\n\nlang <%= @host.params['lang'] || 'en_US.UTF-8' %>\nkeyboard <%= @host.params['keyboard'] || 'us' %>\ntimezone --utc <%= @host.params['time-zone'] || 'UTC' %>\n\n<% subnet = @host.subnet -%>\n<% if subnet.respond_to?(:dhcp_boot_mode?) -%>\n<% dhcp = subnet.dhcp_boot_mode? && !@static -%>\n<% else -%>\n<% dhcp = !@static -%>\n<% end -%>\n\nnetwork --bootproto <%= dhcp ? 'dhcp' : \"static --ip=#{@host.ip} --netmask=#{subnet.mask} --gateway=#{subnet.gateway} --nameserver=#{[subnet.dns_primary, subnet.dns_secondary].select{ |item| item.present? }.join(',')}\" %> --hostname <%= @host %><%= \" --device=#{@host.mac}\" -%>\n\n# Partition table should create /boot and a volume atomicos\n<% if @dynamic -%>\n%include /tmp/diskpart.cfg\n<% else -%>\n<%= @host.diskLayout %>\n<% end -%>\n\nbootloader --timeout=3\ntext\n\n<% if @host.os.name.match /.*fedora.*/i -%>\nostreesetup --nogpg --osname=fedora-atomic --remote=fedora-atomic --url=<%= @host.param_true?('atomic-upstream') ? \"https://dl.fedoraproject.org/pub/fedora/linux/atomic/#{@host.os.major}/\" : \"#{@host.operatingsystem.medium_uri(@host)}/content/repo/\" %> --ref=fedora-atomic/f<%= @host.os.major %>/<%= @host.architecture %>/docker-host\n<% elsif @host.os.name.match /.*centos.*/i -%>\nostreesetup --nogpg --osname=centos-atomic-host --remote=centos-atomic-host --url=<%= @host.param_true?('atomic-upstream') ? \"http://mirror.centos.org/centos/#{@host.os.major}/atomic/#{@host.architecture}/repo/\" : @host.operatingsystem.medium_uri(@host) %> --ref=centos-atomic-host/<%= @host.os.major %>/<%= @host.architecture %>/standard\n<% else -%>\nostreesetup --nogpg --osname=rhel-atomic-host --remote=rhel-atomic-host --url=file:///install/ostree --ref=rhel-atomic-host/<%= @host.os.major %>/<%= @host.architecture %>/standard\n<% end -%>\nservices --disabled cloud-init,cloud-config,cloud-final,cloud-init-local\nrootpw --iscrypted <%= root_pass %>\n\nreboot\n\n%post\n<%= snippet \"subscription_manager_registration\" %>\n<%= snippet('remote_execution_ssh_keys') %>\n(\n# Report success back to Foreman\ncurl -s -o /dev/null --insecure <%= foreman_url('built') %>\n) 2>&1 | tee /mnt/sysimage/root/install.post.log\n\nexit 0\n\n%end\n","snippet":false,"template_kind_id":6,"locked":true,"default":true,"vendor":"Katello","os_family":null,"job_category":"Miscellaneous","provider_type":null,"description_format":null,"execution_timeout_interval":null}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":5,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-13 16:07:24 UTC","id":376,"auditable_id":73,"auditable_name":"pxegrub2_discovery","auditable_type":"ProvisioningTemplate","action":"update","audited_changes":{"template":["<%#\nkind: snippet\nname: pxegrub2_discovery\n-%>\n<%#\ndiscovery image is based on CentOS/RHEL and therefor it is affected by https://bugzilla.redhat.com/show_bug.cgi?id=1259015.\nIn short, before RHEL 7.2 virtio driver didn't have the new persistent naming scheme, causing interfaces to be named eth0, eth1, etc..\nIf you want to enable the new persistent naming scheme and get inteface names like ens3, add net.ifnames=1 to the linuxefi line below.\n-%>\nmenuentry 'Foreman Discovery Image' {\n  linuxefi boot/fdi-image/vmlinuz0 rootflags=loop root=live:/fdi.iso rootfstype=auto ro rd.live.image acpi=force rd.luks=0 rd.md=0 rd.dm=0 rd.lvm=0 rd.bootif=0 rd.neednet=0 nomodeset proxy.url=<%= foreman_server_url %> proxy.type=foreman BOOTIF=01-$net_default_mac\n  initrdefi boot/fdi-image/initrd0.img\n}\n","<%#\nkind: snippet\nname: pxegrub2_discovery\n-%>\n<%#\nRHEL 7 virtio driver does not have persistent naming scheme, causing interfaces\nto be named eth0, eth1, etc.. If you want to enable the new persistent naming\nscheme and get inteface names like ens3, add net.ifnames=1 to the linuxefi line\nbelow. This will not be fixed until RHEL8 due to prevent breaking changes for\nexisting systems. See RHBZ#1259015 for more details.\n\nAnother bug in RHEL 7.4 is affecting $net_default_mac with a trailing slash, in\nthe global template we have a regexp module creating corrected variable $mac\nwhich is used here. See RHBZ#1487107 for more info.\n-%>\nmenuentry 'Foreman Discovery Image' {\n  linuxefi boot/fdi-image-rhel_7-vmlinuz rootflags=loop root=live:/fdi.iso rootfstype=auto ro rd.live.image acpi=force rd.luks=0 rd.md=0 rd.dm=0 rd.lvm=0 rd.bootif=0 rd.neednet=0 nomodeset proxy.url=<%= foreman_server_url %> proxy.type=foreman BOOTIF=01-$mac\n  initrdefi boot/fdi-image-rhel_7-img\n}\n"],"vendor":["Foreman","Satellite"]}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":5,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-13 16:07:24 UTC","id":375,"auditable_id":75,"auditable_name":"pxegrub_discovery","auditable_type":"ProvisioningTemplate","action":"update","audited_changes":{"template":["<%#\nkind: snippet\nname: pxegrub_discovery\n-%>\n<%#\ndiscovery image is based on CentOS/RHEL and therefor it is affected by https://bugzilla.redhat.com/show_bug.cgi?id=1259015.\nIn short, before RHEL 7.2 virtio driver didn't have the new persistent naming scheme, causing interfaces to be named eth0, eth1, etc..\nIf you want to enable the new persistent naming scheme and get inteface names like ens3, add net.ifnames=1 to the kernel line below.\n-%>\n# http://projects.theforeman.org/issues/15997\ntitle Foreman Discovery Image - not supported with Grub 1.x\n  kernel boot/fdi-image/vmlinuz0 rootflags=loop root=live:/fdi.iso rootfstype=auto ro rd.live.image acpi=force rd.luks=0 rd.md=0 rd.dm=0 rd.lvm=0 rd.bootif=0 rd.neednet=0 nomodeset proxy.url=<%= foreman_server_url %> proxy.type=foreman BOOTIF=01-$net_default_mac\n  initrd boot/fdi-image/initrd0.img\n","<%#\nkind: snippet\nname: pxegrub_discovery\n-%>\n<%#\ndiscovery image is based on CentOS/RHEL and therefor it is affected by https://bugzilla.redhat.com/show_bug.cgi?id=1259015.\nIn short, before RHEL 7.2 virtio driver didn't have the new persistent naming scheme, causing interfaces to be named eth0, eth1, etc..\nIf you want to enable the new persistent naming scheme and get inteface names like ens3, add net.ifnames=1 to the kernel line below.\n-%>\n# http://projects.theforeman.org/issues/15997\ntitle Foreman Discovery Image - not supported with Grub 1.x\n  kernel boot/fdi-image-rhel_7-vmlinuz rootflags=loop root=live:/fdi.iso rootfstype=auto ro rd.live.image acpi=force rd.luks=0 rd.md=0 rd.dm=0 rd.lvm=0 rd.bootif=0 rd.neednet=0 nomodeset proxy.url=<%= foreman_server_url %> proxy.type=foreman BOOTIF=01-$net_default_mac\n  initrd boot/fdi-image-rhel_7-img\n"],"vendor":["Foreman","Satellite"]}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":5,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-13 16:07:24 UTC","id":374,"auditable_id":77,"auditable_name":"pxelinux_discovery","auditable_type":"ProvisioningTemplate","action":"update","audited_changes":{"template":["<%#\nkind: snippet\nname: pxelinux_discovery\n-%>\n<%#\ndiscovery image is based on CentOS/RHEL and therefor it is affected by https://bugzilla.redhat.com/show_bug.cgi?id=1259015.\nIn short, before RHEL 7.2 virtio driver didn't have the new persistent naming scheme, causing interfaces to be named eth0, eth1, etc..\nIf you want to enable the new persistent naming scheme and get inteface names like ens3, add net.ifnames=1 to the APPEND line below.\n-%>\nLABEL discovery\n  MENU LABEL Foreman Discovery Image\n  KERNEL boot/fdi-image/vmlinuz0\n  APPEND initrd=boot/fdi-image/initrd0.img rootflags=loop root=live:/fdi.iso rootfstype=auto ro rd.live.image acpi=force rd.luks=0 rd.md=0 rd.dm=0 rd.lvm=0 rd.bootif=0 rd.neednet=0 nomodeset proxy.url=<%= foreman_server_url %> proxy.type=foreman\n  IPAPPEND 2\n","<%#\nkind: snippet\nname: pxelinux_discovery\n-%>\n<%#\ndiscovery image is based on CentOS/RHEL and therefor it is affected by https://bugzilla.redhat.com/show_bug.cgi?id=1259015.\nIn short, before RHEL 7.2 virtio driver didn't have the new persistent naming scheme, causing interfaces to be named eth0, eth1, etc..\nIf you want to enable the new persistent naming scheme and get inteface names like ens3, add net.ifnames=1 to the APPEND line below.\n-%>\nLABEL discovery\n  MENU LABEL Foreman Discovery Image\n  KERNEL boot/fdi-image-rhel_7-vmlinuz\n  APPEND initrd=boot/fdi-image-rhel_7-img rootflags=loop root=live:/fdi.iso rootfstype=auto ro rd.live.image acpi=force rd.luks=0 rd.md=0 rd.dm=0 rd.lvm=0 rd.bootif=0 rd.neednet=0 nomodeset proxy.url=<%= foreman_server_url %> proxy.type=foreman\n  IPAPPEND 2\n"],"vendor":["Foreman","Satellite"]}},{"user_id":null,"user_type":null,"user_name":null,"version":1,"comment":null,"associated_id":20,"associated_type":"Role","remote_address":null,"associated_name":"Access Insights Viewer","created_at":"2018-04-13 16:07:23 UTC","id":373,"auditable_id":276,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":20,"taxonomy_search":null,"override":false}},{"user_id":null,"user_type":null,"user_name":null,"version":1,"comment":null,"associated_id":21,"associated_type":"Role","remote_address":null,"associated_name":"Access Insights Admin","created_at":"2018-04-13 16:07:23 UTC","id":372,"auditable_id":275,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":21,"taxonomy_search":null,"override":false}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-13 16:07:21 UTC","id":371,"auditable_id":138,"auditable_name":null,"auditable_type":"ProvisioningTemplate","action":"create","audited_changes":{"name":"Katello Atomic Kickstart Default","template":"<%#\nkind: provision\nname: Katello Atomic Kickstart default\n%>\n\nlang <%= @host.params['lang'] || 'en_US.UTF-8' %>\nkeyboard <%= @host.params['keyboard'] || 'us' %>\ntimezone --utc <%= @host.params['time-zone'] || 'UTC' %>\n\n<% subnet = @host.subnet -%>\n<% if subnet.respond_to?(:dhcp_boot_mode?) -%>\n<% dhcp = subnet.dhcp_boot_mode? && !@static -%>\n<% else -%>\n<% dhcp = !@static -%>\n<% end -%>\n\nnetwork --bootproto <%= dhcp ? 'dhcp' : \"static --ip=#{@host.ip} --netmask=#{subnet.mask} --gateway=#{subnet.gateway} --nameserver=#{[subnet.dns_primary, subnet.dns_secondary].select{ |item| item.present? }.join(',')}\" %> --hostname <%= @host %><%= \" --device=#{@host.mac}\" -%>\n\n# Partition table should create /boot and a volume atomicos\n<% if @dynamic -%>\n%include /tmp/diskpart.cfg\n<% else -%>\n<%= @host.diskLayout %>\n<% end -%>\n\nbootloader --timeout=3\ntext\n\n<% if @host.os.name.match /.*fedora.*/i -%>\nostreesetup --nogpg --osname=fedora-atomic --remote=fedora-atomic --url=<%= @host.param_true?('atomic-upstream') ? \"https://dl.fedoraproject.org/pub/fedora/linux/atomic/#{@host.os.major}/\" : \"#{@host.operatingsystem.medium_uri(@host)}/content/repo/\" %> --ref=fedora-atomic/f<%= @host.os.major %>/<%= @host.architecture %>/docker-host\n<% elsif @host.os.name.match /.*centos.*/i -%>\nostreesetup --nogpg --osname=centos-atomic-host --remote=centos-atomic-host --url=<%= @host.param_true?('atomic-upstream') ? \"http://mirror.centos.org/centos/#{@host.os.major}/atomic/#{@host.architecture}/repo/\" : @host.operatingsystem.medium_uri(@host) %> --ref=centos-atomic-host/<%= @host.os.major %>/<%= @host.architecture %>/standard\n<% else -%>\nostreesetup --nogpg --osname=rhel-atomic-host --remote=rhel-atomic-host --url=file:///install/ostree --ref=rhel-atomic-host/<%= @host.os.major %>/<%= @host.architecture %>/standard\n<% end -%>\nservices --disabled cloud-init,cloud-config,cloud-final,cloud-init-local\nrootpw --iscrypted <%= root_pass %>\n\nreboot\n\n%post\n<%= snippet \"subscription_manager_registration\" %>\n<%= snippet('remote_execution_ssh_keys') %>\n(\n# Report success back to Foreman\ncurl -s -o /dev/null --insecure <%= foreman_url('built') %>\n) 2>&1 | tee /mnt/sysimage/root/install.post.log\n\nexit 0\n\n%end\n","snippet":false,"template_kind_id":6,"locked":true,"default":true,"vendor":"Katello","os_family":null,"job_category":"Miscellaneous","provider_type":null,"description_format":null,"execution_timeout_interval":null}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-13 16:07:21 UTC","id":370,"auditable_id":137,"auditable_name":null,"auditable_type":"ProvisioningTemplate","action":"create","audited_changes":{"name":"Katello Kickstart Default Finish","template":"<%#\nkind: finish\nname: Katello Kickstart default finish\noses:\n- CentOS 5\n- CentOS 6\n- CentOS 7\n- RedHat 5\n- RedHat 6\n- RedHat 7\n- Fedora 19\n- Fedora 20\n%>\n<% if @host.subnet.respond_to?(:dhcp_boot_mode?) -%>\n<%= snippet 'kickstart_networking_setup' %>\nservice network restart\n<% end -%>\n\n<%\n  rhel_compatible = @host.operatingsystem.family == 'Redhat' && @host.operatingsystem.name != 'Fedora'\n  os_major = @host.operatingsystem.major.to_i\n  pm_set = @host.puppetmaster.empty? ? false : true\n  puppet_enabled = pm_set || @host.params['force-puppet']\n  salt_enabled = @host.params['salt_master'] ? true : false\n  chef_enabled = @host.respond_to?(:chef_proxy) && @host.chef_proxy\n%>\n\n<%= snippet \"subscription_manager_registration\" %>\n\n<% if @host.respond_to?(:realm) && @host.otp && @host.realm && @host.realm.realm_type == \"FreeIPA\" -%>\n<%= snippet \"freeipa_register\" %>\n<% end -%>\n\n# update local time\necho \"updating system time\"\n/usr/sbin/ntpdate -sub <%= @host.params['ntp-server'] || '0.fedora.pool.ntp.org' %>\n/usr/sbin/hwclock --systohc\n\n<% if @host.info['parameters']['realm'] && @host.realm && @host.realm.realm_type == 'FreeIPA' -%>\n<%= snippet \"freeipa_register\" %>\n<% end -%>\n\n# update all the base packages from the updates repository\nyum -t -y -e 0 update\n\n<%= snippet('remote_execution_ssh_keys') %>\n\n<% if chef_enabled %>\n<%= snippet 'chef_client' %>\n<% end -%>\n\n<% if puppet_enabled %>\n<%= snippet 'puppet_setup' %>\n<% end -%>\n\n<% if salt_enabled %>\n<%= snippet 'saltstack_setup' %>\n<% end -%>\n\nexit 0\n","snippet":false,"template_kind_id":7,"locked":true,"default":true,"vendor":"Katello","os_family":null,"job_category":"Miscellaneous","provider_type":null,"description_format":null,"execution_timeout_interval":null}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-13 16:07:21 UTC","id":369,"auditable_id":136,"auditable_name":null,"auditable_type":"ProvisioningTemplate","action":"create","audited_changes":{"name":"Katello Kickstart Default User Data","template":"<%#\nkind: user_data\nname: Katello Kickstart default user data\noses:\n- CentOS 6\n- CentOS 7\n- Fedora 19\n- Fedora 20\n- Fedora 21\n- Fedora 22\n- Fedora 23\n-%>\n#cloud-config\nhostname: <%= @host.shortname %>\nfqdn: <%= @host %>\nmanage_etc_hosts: true\n\ngroups:\n - admin\n\nusers:\n - default\n - name: admin\n   primary-group: admin\n   groups: users\n   shell: /bin/bash\n   sudo: ['ALL=(ALL) ALL']\n   lock-passwd: false\n   passwd: <%= @host.root_pass %>\n\n<%# Allow user to specify additional SSH key as host paramter -%>\n<% if @host.params['sshkey'].present? || @host.params['remote_execution_ssh_keys'].present? -%>\nssh_authorized_keys:\n<% if @host.params['sshkey'].present? -%>\n  - <%= @host.params['sshkey'] %>\n<% end -%>\n<% if @host.params['remote_execution_ssh_keys'].present? -%>\n<% @host.params['remote_execution_ssh_keys'].each do |key| -%>\n  - <%= key %>\n<% end -%>\n<% end -%>\n<% end -%>\nwrite_files:\n- path: /tmp/foreman-userdata.sh\n  permissions: '0755'\n  content: |\n    #!/bin/bash\n<%= indent 4 do\n      snippet 'subscription_manager_registration'\n    end %>\n<% if @host.info['parameters']['realm'] && @host.realm && @host.realm.realm_type == 'FreeIPA' -%>\n<%= indent 4 do\n      snippet 'freeipa_register'\n    end %>\n<% end -%>\n  <% unless @host.operatingsystem.atomic? -%>\n    # update all the base packages from the updates repository\n    yum -t -y -e 0 update\n  <% end -%>\n<%\n  # safemode renderer does not support unary negation\n  non_atomic = @host.operatingsystem.atomic? ? false : true\n  pm_set = @host.puppetmaster.empty? ? false : true\n  puppet_enabled = non_atomic && (pm_set || @host.params['force-puppet'])\n  salt_enabled = non_atomic && (@host.params['salt_master'] ? true : false)\n  chef_enabled = @host.respond_to?(:chef_proxy) && @host.chef_proxy\n%>\n<% if chef_enabled %>\n<%= indent 4 do\n      snippet 'chef_client'\n    end  %>\n<% end -%>\n\n<% if puppet_enabled %>\n<%= indent 4 do\n      snippet 'puppet_setup'\n    end %>\n<% end -%>\n\n<% if salt_enabled %>\n<%= indent 4 do\n      snippet 'saltstack_setup'\n    end %>\n<% end -%>\nphone_home:\n url: <%= foreman_url('built') %>\n post: []\n tries: 10\nruncmd:\n - [ cloud-init-per, once, foreman-userdata, /tmp/foreman-userdata.sh ]\noutput: {all: '| tee -a /root/install.userdata.log'}\n\n","snippet":false,"template_kind_id":9,"locked":true,"default":true,"vendor":"Katello","os_family":null,"job_category":"Miscellaneous","provider_type":null,"description_format":null,"execution_timeout_interval":null}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-13 16:07:21 UTC","id":368,"auditable_id":135,"auditable_name":null,"auditable_type":"ProvisioningTemplate","action":"create","audited_changes":{"name":"Katello Kickstart Default","template":"<%#\nkind: provision\nname: Katello Kickstart default\noses:\n- CentOS 5\n- CentOS 6\n- CentOS 7\n- RedHat 5\n- RedHat 6\n- RedHat 7\n- Fedora 19\n- Fedora 20\n%>\n<%\n  rhel_compatible = @host.operatingsystem.family == 'Redhat' && @host.operatingsystem.name != 'Fedora'\n  os_major = @host.operatingsystem.major.to_i\n  # safemode renderer does not support unary negation\n  pm_set = @host.puppetmaster.empty? ? false : true\n  puppet_enabled = pm_set || @host.params['force-puppet']\n  salt_enabled = @host.params['salt_master'] ? true : false\n  chef_enabled = @host.respond_to?(:chef_proxy) && @host.chef_proxy\n  section_end = (rhel_compatible && os_major <= 5) ? '' : '%end'\n%>\ninstall\n<%= @mediapath %>\nlang en_US.UTF-8\nselinux --enforcing\nkeyboard us\nskipx\n\n<% subnet = @host.subnet -%>\n<% if subnet.respond_to?(:dhcp_boot_mode?) -%>\n<% dhcp = subnet.dhcp_boot_mode? && !@static -%>\n<% else -%>\n<% dhcp = !@static -%>\n<% end -%>\n\nnetwork --bootproto <%= dhcp ? 'dhcp' : \"static --ip=#{@host.ip} --netmask=#{subnet.mask} --gateway=#{subnet.gateway} --nameserver=#{[subnet.dns_primary, subnet.dns_secondary].select{ |item| item.present? }.join(',')}\" %> --hostname <%= @host %><%= os_major >= 6 ? \" --device=#{@host.mac}\" : '' -%>\n\nrootpw --iscrypted <%= root_pass %>\nfirewall --<%= os_major >= 6 ? 'service=' : '' %>ssh\nauthconfig --useshadow --passalgo=<%= @host.operatingsystem.password_hash || 'sha256' %> --kickstart\ntimezone --utc <%= @host.params['time-zone'] || 'UTC' %>\n\n<% if @host.operatingsystem.name == 'Fedora' and os_major <= 16 -%>\n# Bootloader exception for Fedora 16:\nbootloader --append=\"nofb quiet splash=quiet <%=ks_console%>\" <%= grub_pass %>\npart biosboot --fstype=biosboot --size=1\n<% else -%>\nbootloader --location=mbr --append=\"nofb quiet splash=quiet\" <%= grub_pass %>\n<% end -%>\n\n<% if os_major == 5 -%>\nkey --skip\n<% end -%>\n\n<% if @dynamic -%>\n%include /tmp/diskpart.cfg\n<% else -%>\n<%= @host.diskLayout %>\n<% end -%>\n\ntext\nreboot\n\n%packages --ignoremissing\nyum\ndhclient\nntp\nwget\n@Core\n<%= section_end -%>\n\n<% if @dynamic -%>\n%pre\n<%= @host.diskLayout %>\n<%= section_end -%>\n<% end -%>\n\n%post --nochroot\nexec < /dev/tty3 > /dev/tty3\n#changing to VT 3 so that we can see whats going on....\n/usr/bin/chvt 3\n(\ncp -va /etc/resolv.conf /mnt/sysimage/etc/resolv.conf\n/usr/bin/chvt 1\n) 2>&1 | tee /mnt/sysimage/root/install.postnochroot.log\n<%= section_end -%>\n\n\n%post\nlogger \"Starting anaconda <%= @host %> postinstall\"\nexec < /dev/tty3 > /dev/tty3\n#changing to VT 3 so that we can see whats going on....\n/usr/bin/chvt 3\n(\n<% if subnet.respond_to?(:dhcp_boot_mode?) -%>\n<%= snippet 'kickstart_networking_setup' %>\n<% end -%>\n\n#update local time\necho \"updating system time\"\n/usr/sbin/ntpdate -sub <%= @host.params['ntp-server'] || '0.fedora.pool.ntp.org' %>\n/usr/sbin/hwclock --systohc\n\n<%= snippet \"subscription_manager_registration\" %>\n\n<% if @host.info['parameters']['realm'] && @host.realm && @host.realm.realm_type == 'FreeIPA' -%>\n<%= snippet \"freeipa_register\" %>\n<% end -%>\n\n# update all the base packages from the updates repository\nyum -t -y -e 0 update\n\n<%= snippet('remote_execution_ssh_keys') %>\n\n<% if chef_enabled %>\n<%= snippet 'chef_client' %>\n<% end -%>\n\n<% if puppet_enabled %>\n<%= snippet 'puppet_setup' %>\n<% end -%>\n\n<% if salt_enabled %>\n<%= snippet 'saltstack_setup' %>\n<% end -%>\n\nsync\n\n<% if @provisioning_type == nil || @provisioning_type == 'host' -%>\n# Inform the build system that we are done.\necho \"Informing Foreman that we are built\"\nwget -q -O /dev/null --no-check-certificate <%= foreman_url('built') %>\n<% end -%>\n) 2>&1 | tee /root/install.post.log\nexit 0\n\n<%= section_end -%>\n","snippet":false,"template_kind_id":6,"locked":true,"default":true,"vendor":"Katello","os_family":null,"job_category":"Miscellaneous","provider_type":null,"description_format":null,"execution_timeout_interval":null}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":2,"comment":null,"associated_id":21,"associated_type":"Role","remote_address":null,"associated_name":"Access Insights Admin","created_at":"2018-04-13 16:03:35 UTC","id":367,"auditable_id":273,"auditable_name":"view_hosts","auditable_type":"Filter","action":"destroy","audited_changes":{"search":null,"role_id":21,"taxonomy_search":null,"override":false}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":2,"comment":null,"associated_id":20,"associated_type":"Role","remote_address":null,"associated_name":"Access Insights Viewer","created_at":"2018-04-13 16:03:35 UTC","id":366,"auditable_id":274,"auditable_name":"view_hosts","auditable_type":"Filter","action":"destroy","audited_changes":{"search":null,"role_id":20,"taxonomy_search":null,"override":false}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":2,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-13 16:03:12 UTC","id":365,"auditable_id":132,"auditable_name":"Katello Kickstart Default User Data","auditable_type":"ProvisioningTemplate","action":"destroy","audited_changes":{"name":"Katello Kickstart Default User Data","template":"<%#\nkind: user_data\nname: Katello Kickstart default user data\noses:\n- CentOS 6\n- CentOS 7\n- Fedora 19\n- Fedora 20\n- Fedora 21\n- Fedora 22\n- Fedora 23\n-%>\n#cloud-config\nhostname: <%= @host.shortname %>\nfqdn: <%= @host %>\nmanage_etc_hosts: true\n\ngroups:\n - admin\n\nusers:\n - default\n - name: admin\n   primary-group: admin\n   groups: users\n   shell: /bin/bash\n   sudo: ['ALL=(ALL) ALL']\n   lock-passwd: false\n   passwd: <%= @host.root_pass %>\n\n<%# Allow user to specify additional SSH key as host paramter -%>\n<% if @host.params['sshkey'].present? || @host.params['remote_execution_ssh_keys'].present? -%>\nssh_authorized_keys:\n<% if @host.params['sshkey'].present? -%>\n  - <%= @host.params['sshkey'] %>\n<% end -%>\n<% if @host.params['remote_execution_ssh_keys'].present? -%>\n<% @host.params['remote_execution_ssh_keys'].each do |key| -%>\n  - <%= key %>\n<% end -%>\n<% end -%>\n<% end -%>\nwrite_files:\n- path: /tmp/foreman-userdata.sh\n  permissions: '0755'\n  content: |\n    #!/bin/bash\n<%= indent 4 do\n      snippet 'subscription_manager_registration'\n    end %>\n<% if @host.info['parameters']['realm'] && @host.realm && @host.realm.realm_type == 'FreeIPA' -%>\n<%= indent 4 do\n      snippet 'freeipa_register'\n    end %>\n<% end -%>\n  <% unless @host.operatingsystem.atomic? -%>\n    # update all the base packages from the updates repository\n    yum -t -y -e 0 update\n  <% end -%>\n<%\n  # safemode renderer does not support unary negation\n  non_atomic = @host.operatingsystem.atomic? ? false : true\n  pm_set = @host.puppetmaster.empty? ? false : true\n  puppet_enabled = non_atomic && (pm_set || @host.params['force-puppet'])\n  salt_enabled = non_atomic && (@host.params['salt_master'] ? true : false)\n  chef_enabled = @host.respond_to?(:chef_proxy) && @host.chef_proxy\n%>\n<% if chef_enabled %>\n<%= indent 4 do\n      snippet 'chef_client'\n    end  %>\n<% end -%>\n\n<% if puppet_enabled %>\n<%= indent 4 do\n      snippet 'puppet_setup'\n    end %>\n<% end -%>\n\n<% if salt_enabled %>\n<%= indent 4 do\n      snippet 'saltstack_setup'\n    end %>\n<% end -%>\nphone_home:\n url: <%= foreman_url('built') %>\n post: []\n tries: 10\nruncmd:\n - [ cloud-init-per, once, foreman-userdata, /tmp/foreman-userdata.sh ]\noutput: {all: '| tee -a /root/install.userdata.log'}\n\n","snippet":false,"template_kind_id":9,"locked":true,"default":true,"vendor":"Katello","os_family":null,"job_category":"Miscellaneous","provider_type":null,"description_format":null,"execution_timeout_interval":null}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":2,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-13 16:03:12 UTC","id":364,"auditable_id":133,"auditable_name":"Katello Kickstart Default Finish","auditable_type":"ProvisioningTemplate","action":"destroy","audited_changes":{"name":"Katello Kickstart Default Finish","template":"<%#\nkind: finish\nname: Katello Kickstart default finish\noses:\n- CentOS 5\n- CentOS 6\n- CentOS 7\n- RedHat 5\n- RedHat 6\n- RedHat 7\n- Fedora 19\n- Fedora 20\n%>\n<% if @host.subnet.respond_to?(:dhcp_boot_mode?) -%>\n<%= snippet 'kickstart_networking_setup' %>\nservice network restart\n<% end -%>\n\n<%\n  rhel_compatible = @host.operatingsystem.family == 'Redhat' && @host.operatingsystem.name != 'Fedora'\n  os_major = @host.operatingsystem.major.to_i\n  pm_set = @host.puppetmaster.empty? ? false : true\n  puppet_enabled = pm_set || @host.params['force-puppet']\n  salt_enabled = @host.params['salt_master'] ? true : false\n  chef_enabled = @host.respond_to?(:chef_proxy) && @host.chef_proxy\n%>\n\n<%= snippet \"subscription_manager_registration\" %>\n\n<% if @host.respond_to?(:realm) && @host.otp && @host.realm && @host.realm.realm_type == \"FreeIPA\" -%>\n<%= snippet \"freeipa_register\" %>\n<% end -%>\n\n# update local time\necho \"updating system time\"\n/usr/sbin/ntpdate -sub <%= @host.params['ntp-server'] || '0.fedora.pool.ntp.org' %>\n/usr/sbin/hwclock --systohc\n\n<% if @host.info['parameters']['realm'] && @host.realm && @host.realm.realm_type == 'FreeIPA' -%>\n<%= snippet \"freeipa_register\" %>\n<% end -%>\n\n# update all the base packages from the updates repository\nyum -t -y -e 0 update\n\n<%= snippet('remote_execution_ssh_keys') %>\n\n<% if chef_enabled %>\n<%= snippet 'chef_client' %>\n<% end -%>\n\n<% if puppet_enabled %>\n<%= snippet 'puppet_setup' %>\n<% end -%>\n\n<% if salt_enabled %>\n<%= snippet 'saltstack_setup' %>\n<% end -%>\n\nexit 0\n","snippet":false,"template_kind_id":7,"locked":true,"default":true,"vendor":"Katello","os_family":null,"job_category":"Miscellaneous","provider_type":null,"description_format":null,"execution_timeout_interval":null}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":2,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-13 16:03:12 UTC","id":363,"auditable_id":131,"auditable_name":"Katello Kickstart Default","auditable_type":"ProvisioningTemplate","action":"destroy","audited_changes":{"name":"Katello Kickstart Default","template":"<%#\nkind: provision\nname: Katello Kickstart default\noses:\n- CentOS 5\n- CentOS 6\n- CentOS 7\n- RedHat 5\n- RedHat 6\n- RedHat 7\n- Fedora 19\n- Fedora 20\n%>\n<%\n  rhel_compatible = @host.operatingsystem.family == 'Redhat' && @host.operatingsystem.name != 'Fedora'\n  os_major = @host.operatingsystem.major.to_i\n  # safemode renderer does not support unary negation\n  pm_set = @host.puppetmaster.empty? ? false : true\n  puppet_enabled = pm_set || @host.params['force-puppet']\n  salt_enabled = @host.params['salt_master'] ? true : false\n  chef_enabled = @host.respond_to?(:chef_proxy) && @host.chef_proxy\n  section_end = (rhel_compatible && os_major <= 5) ? '' : '%end'\n%>\ninstall\n<%= @mediapath %>\nlang en_US.UTF-8\nselinux --enforcing\nkeyboard us\nskipx\n\n<% subnet = @host.subnet -%>\n<% if subnet.respond_to?(:dhcp_boot_mode?) -%>\n<% dhcp = subnet.dhcp_boot_mode? && !@static -%>\n<% else -%>\n<% dhcp = !@static -%>\n<% end -%>\n\nnetwork --bootproto <%= dhcp ? 'dhcp' : \"static --ip=#{@host.ip} --netmask=#{subnet.mask} --gateway=#{subnet.gateway} --nameserver=#{[subnet.dns_primary, subnet.dns_secondary].select{ |item| item.present? }.join(',')}\" %> --hostname <%= @host %><%= os_major >= 6 ? \" --device=#{@host.mac}\" : '' -%>\n\nrootpw --iscrypted <%= root_pass %>\nfirewall --<%= os_major >= 6 ? 'service=' : '' %>ssh\nauthconfig --useshadow --passalgo=<%= @host.operatingsystem.password_hash || 'sha256' %> --kickstart\ntimezone --utc <%= @host.params['time-zone'] || 'UTC' %>\n\n<% if @host.operatingsystem.name == 'Fedora' and os_major <= 16 -%>\n# Bootloader exception for Fedora 16:\nbootloader --append=\"nofb quiet splash=quiet <%=ks_console%>\" <%= grub_pass %>\npart biosboot --fstype=biosboot --size=1\n<% else -%>\nbootloader --location=mbr --append=\"nofb quiet splash=quiet\" <%= grub_pass %>\n<% end -%>\n\n<% if os_major == 5 -%>\nkey --skip\n<% end -%>\n\n<% if @dynamic -%>\n%include /tmp/diskpart.cfg\n<% else -%>\n<%= @host.diskLayout %>\n<% end -%>\n\ntext\nreboot\n\n%packages --ignoremissing\nyum\ndhclient\nntp\nwget\n@Core\n<%= section_end -%>\n\n<% if @dynamic -%>\n%pre\n<%= @host.diskLayout %>\n<%= section_end -%>\n<% end -%>\n\n%post --nochroot\nexec < /dev/tty3 > /dev/tty3\n#changing to VT 3 so that we can see whats going on....\n/usr/bin/chvt 3\n(\ncp -va /etc/resolv.conf /mnt/sysimage/etc/resolv.conf\n/usr/bin/chvt 1\n) 2>&1 | tee /mnt/sysimage/root/install.postnochroot.log\n<%= section_end -%>\n\n\n%post\nlogger \"Starting anaconda <%= @host %> postinstall\"\nexec < /dev/tty3 > /dev/tty3\n#changing to VT 3 so that we can see whats going on....\n/usr/bin/chvt 3\n(\n<% if subnet.respond_to?(:dhcp_boot_mode?) -%>\n<%= snippet 'kickstart_networking_setup' %>\n<% end -%>\n\n#update local time\necho \"updating system time\"\n/usr/sbin/ntpdate -sub <%= @host.params['ntp-server'] || '0.fedora.pool.ntp.org' %>\n/usr/sbin/hwclock --systohc\n\n<%= snippet \"subscription_manager_registration\" %>\n\n<% if @host.info['parameters']['realm'] && @host.realm && @host.realm.realm_type == 'FreeIPA' -%>\n<%= snippet \"freeipa_register\" %>\n<% end -%>\n\n# update all the base packages from the updates repository\nyum -t -y -e 0 update\n\n<%= snippet('remote_execution_ssh_keys') %>\n\n<% if chef_enabled %>\n<%= snippet 'chef_client' %>\n<% end -%>\n\n<% if puppet_enabled %>\n<%= snippet 'puppet_setup' %>\n<% end -%>\n\n<% if salt_enabled %>\n<%= snippet 'saltstack_setup' %>\n<% end -%>\n\nsync\n\n<% if @provisioning_type == nil || @provisioning_type == 'host' -%>\n# Inform the build system that we are done.\necho \"Informing Foreman that we are built\"\nwget -q -O /dev/null --no-check-certificate <%= foreman_url('built') %>\n<% end -%>\n) 2>&1 | tee /root/install.post.log\nexit 0\n\n<%= section_end -%>\n","snippet":false,"template_kind_id":6,"locked":true,"default":true,"vendor":"Katello","os_family":null,"job_category":"Miscellaneous","provider_type":null,"description_format":null,"execution_timeout_interval":null}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":2,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-13 16:03:11 UTC","id":362,"auditable_id":134,"auditable_name":"Katello Atomic Kickstart Default","auditable_type":"ProvisioningTemplate","action":"destroy","audited_changes":{"name":"Katello Atomic Kickstart Default","template":"<%#\nkind: provision\nname: Katello Atomic Kickstart default\n%>\n\nlang <%= @host.params['lang'] || 'en_US.UTF-8' %>\nkeyboard <%= @host.params['keyboard'] || 'us' %>\ntimezone --utc <%= @host.params['time-zone'] || 'UTC' %>\n\n<% subnet = @host.subnet -%>\n<% if subnet.respond_to?(:dhcp_boot_mode?) -%>\n<% dhcp = subnet.dhcp_boot_mode? && !@static -%>\n<% else -%>\n<% dhcp = !@static -%>\n<% end -%>\n\nnetwork --bootproto <%= dhcp ? 'dhcp' : \"static --ip=#{@host.ip} --netmask=#{subnet.mask} --gateway=#{subnet.gateway} --nameserver=#{[subnet.dns_primary, subnet.dns_secondary].select{ |item| item.present? }.join(',')}\" %> --hostname <%= @host %><%= \" --device=#{@host.mac}\" -%>\n\n# Partition table should create /boot and a volume atomicos\n<% if @dynamic -%>\n%include /tmp/diskpart.cfg\n<% else -%>\n<%= @host.diskLayout %>\n<% end -%>\n\nbootloader --timeout=3\ntext\n\n<% if @host.os.name.match /.*fedora.*/i -%>\nostreesetup --nogpg --osname=fedora-atomic --remote=fedora-atomic --url=<%= @host.param_true?('atomic-upstream') ? \"https://dl.fedoraproject.org/pub/fedora/linux/atomic/#{@host.os.major}/\" : \"#{@host.operatingsystem.medium_uri(@host)}/content/repo/\" %> --ref=fedora-atomic/f<%= @host.os.major %>/<%= @host.architecture %>/docker-host\n<% elsif @host.os.name.match /.*centos.*/i -%>\nostreesetup --nogpg --osname=centos-atomic-host --remote=centos-atomic-host --url=<%= @host.param_true?('atomic-upstream') ? \"http://mirror.centos.org/centos/#{@host.os.major}/atomic/#{@host.architecture}/repo/\" : @host.operatingsystem.medium_uri(@host) %> --ref=centos-atomic-host/<%= @host.os.major %>/<%= @host.architecture %>/standard\n<% else -%>\nostreesetup --nogpg --osname=rhel-atomic-host --remote=rhel-atomic-host --url=file:///install/ostree --ref=rhel-atomic-host/<%= @host.os.major %>/<%= @host.architecture %>/standard\n<% end -%>\nservices --disabled cloud-init,cloud-config,cloud-final,cloud-init-local\nrootpw --iscrypted <%= root_pass %>\n\nreboot\n\n%post\n<%= snippet \"subscription_manager_registration\" %>\n<%= snippet('remote_execution_ssh_keys') %>\n(\n# Report success back to Foreman\ncurl -s -o /dev/null --insecure <%= foreman_url('built') %>\n) 2>&1 | tee /mnt/sysimage/root/install.post.log\n\nexit 0\n\n%end\n","snippet":false,"template_kind_id":6,"locked":true,"default":true,"vendor":"Katello","os_family":null,"job_category":"Miscellaneous","provider_type":null,"description_format":null,"execution_timeout_interval":null}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":4,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-13 16:03:10 UTC","id":361,"auditable_id":73,"auditable_name":"pxegrub2_discovery","auditable_type":"ProvisioningTemplate","action":"update","audited_changes":{"template":["<%#\nkind: snippet\nname: pxegrub2_discovery\n-%>\n<%#\ndiscovery image is based on CentOS/RHEL and therefor it is affected by https://bugzilla.redhat.com/show_bug.cgi?id=1259015.\nIn short, before RHEL 7.2 virtio driver didn't have the new persistent naming scheme, causing interfaces to be named eth0, eth1, etc..\nIf you want to enable the new persistent naming scheme and get inteface names like ens3, add net.ifnames=1 to the linuxefi line below.\n-%>\nmenuentry 'Foreman Discovery Image' {\n  linuxefi boot/fdi-image/vmlinuz0 rootflags=loop root=live:/fdi.iso rootfstype=auto ro rd.live.image acpi=force rd.luks=0 rd.md=0 rd.dm=0 rd.lvm=0 rd.bootif=0 rd.neednet=0 nomodeset proxy.url=<%= foreman_server_url %> proxy.type=foreman BOOTIF=01-$net_default_mac\n  initrdefi boot/fdi-image/initrd0.img\n}\n","<%#\nkind: snippet\nname: pxegrub2_discovery\n-%>\n<%#\nRHEL 7 virtio driver does not have persistent naming scheme, causing interfaces\nto be named eth0, eth1, etc.. If you want to enable the new persistent naming\nscheme and get inteface names like ens3, add net.ifnames=1 to the linuxefi line\nbelow. This will not be fixed until RHEL8 due to prevent breaking changes for\nexisting systems. See RHBZ#1259015 for more details.\n\nAnother bug in RHEL 7.4 is affecting $net_default_mac with a trailing slash, in\nthe global template we have a regexp module creating corrected variable $mac\nwhich is used here. See RHBZ#1487107 for more info.\n-%>\nmenuentry 'Foreman Discovery Image' {\n  linuxefi boot/fdi-image-rhel_7-vmlinuz rootflags=loop root=live:/fdi.iso rootfstype=auto ro rd.live.image acpi=force rd.luks=0 rd.md=0 rd.dm=0 rd.lvm=0 rd.bootif=0 rd.neednet=0 nomodeset proxy.url=<%= foreman_server_url %> proxy.type=foreman BOOTIF=01-$mac\n  initrdefi boot/fdi-image-rhel_7-img\n}\n"],"vendor":["Foreman","Satellite"]}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":4,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-13 16:03:10 UTC","id":360,"auditable_id":75,"auditable_name":"pxegrub_discovery","auditable_type":"ProvisioningTemplate","action":"update","audited_changes":{"template":["<%#\nkind: snippet\nname: pxegrub_discovery\n-%>\n<%#\ndiscovery image is based on CentOS/RHEL and therefor it is affected by https://bugzilla.redhat.com/show_bug.cgi?id=1259015.\nIn short, before RHEL 7.2 virtio driver didn't have the new persistent naming scheme, causing interfaces to be named eth0, eth1, etc..\nIf you want to enable the new persistent naming scheme and get inteface names like ens3, add net.ifnames=1 to the kernel line below.\n-%>\n# http://projects.theforeman.org/issues/15997\ntitle Foreman Discovery Image - not supported with Grub 1.x\n  kernel boot/fdi-image/vmlinuz0 rootflags=loop root=live:/fdi.iso rootfstype=auto ro rd.live.image acpi=force rd.luks=0 rd.md=0 rd.dm=0 rd.lvm=0 rd.bootif=0 rd.neednet=0 nomodeset proxy.url=<%= foreman_server_url %> proxy.type=foreman BOOTIF=01-$net_default_mac\n  initrd boot/fdi-image/initrd0.img\n","<%#\nkind: snippet\nname: pxegrub_discovery\n-%>\n<%#\ndiscovery image is based on CentOS/RHEL and therefor it is affected by https://bugzilla.redhat.com/show_bug.cgi?id=1259015.\nIn short, before RHEL 7.2 virtio driver didn't have the new persistent naming scheme, causing interfaces to be named eth0, eth1, etc..\nIf you want to enable the new persistent naming scheme and get inteface names like ens3, add net.ifnames=1 to the kernel line below.\n-%>\n# http://projects.theforeman.org/issues/15997\ntitle Foreman Discovery Image - not supported with Grub 1.x\n  kernel boot/fdi-image-rhel_7-vmlinuz rootflags=loop root=live:/fdi.iso rootfstype=auto ro rd.live.image acpi=force rd.luks=0 rd.md=0 rd.dm=0 rd.lvm=0 rd.bootif=0 rd.neednet=0 nomodeset proxy.url=<%= foreman_server_url %> proxy.type=foreman BOOTIF=01-$net_default_mac\n  initrd boot/fdi-image-rhel_7-img\n"],"vendor":["Foreman","Satellite"]}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":4,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-13 16:03:10 UTC","id":359,"auditable_id":77,"auditable_name":"pxelinux_discovery","auditable_type":"ProvisioningTemplate","action":"update","audited_changes":{"template":["<%#\nkind: snippet\nname: pxelinux_discovery\n-%>\n<%#\ndiscovery image is based on CentOS/RHEL and therefor it is affected by https://bugzilla.redhat.com/show_bug.cgi?id=1259015.\nIn short, before RHEL 7.2 virtio driver didn't have the new persistent naming scheme, causing interfaces to be named eth0, eth1, etc..\nIf you want to enable the new persistent naming scheme and get inteface names like ens3, add net.ifnames=1 to the APPEND line below.\n-%>\nLABEL discovery\n  MENU LABEL Foreman Discovery Image\n  KERNEL boot/fdi-image/vmlinuz0\n  APPEND initrd=boot/fdi-image/initrd0.img rootflags=loop root=live:/fdi.iso rootfstype=auto ro rd.live.image acpi=force rd.luks=0 rd.md=0 rd.dm=0 rd.lvm=0 rd.bootif=0 rd.neednet=0 nomodeset proxy.url=<%= foreman_server_url %> proxy.type=foreman\n  IPAPPEND 2\n","<%#\nkind: snippet\nname: pxelinux_discovery\n-%>\n<%#\ndiscovery image is based on CentOS/RHEL and therefor it is affected by https://bugzilla.redhat.com/show_bug.cgi?id=1259015.\nIn short, before RHEL 7.2 virtio driver didn't have the new persistent naming scheme, causing interfaces to be named eth0, eth1, etc..\nIf you want to enable the new persistent naming scheme and get inteface names like ens3, add net.ifnames=1 to the APPEND line below.\n-%>\nLABEL discovery\n  MENU LABEL Foreman Discovery Image\n  KERNEL boot/fdi-image-rhel_7-vmlinuz\n  APPEND initrd=boot/fdi-image-rhel_7-img rootflags=loop root=live:/fdi.iso rootfstype=auto ro rd.live.image acpi=force rd.luks=0 rd.md=0 rd.dm=0 rd.lvm=0 rd.bootif=0 rd.neednet=0 nomodeset proxy.url=<%= foreman_server_url %> proxy.type=foreman\n  IPAPPEND 2\n"],"vendor":["Foreman","Satellite"]}},{"user_id":null,"user_type":null,"user_name":null,"version":1,"comment":null,"associated_id":20,"associated_type":"Role","remote_address":null,"associated_name":"Access Insights Viewer","created_at":"2018-04-13 16:03:09 UTC","id":358,"auditable_id":274,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":20,"taxonomy_search":null,"override":false}},{"user_id":null,"user_type":null,"user_name":null,"version":1,"comment":null,"associated_id":21,"associated_type":"Role","remote_address":null,"associated_name":"Access Insights Admin","created_at":"2018-04-13 16:03:09 UTC","id":357,"auditable_id":273,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":21,"taxonomy_search":null,"override":false}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-13 16:03:07 UTC","id":356,"auditable_id":134,"auditable_name":null,"auditable_type":"ProvisioningTemplate","action":"create","audited_changes":{"name":"Katello Atomic Kickstart Default","template":"<%#\nkind: provision\nname: Katello Atomic Kickstart default\n%>\n\nlang <%= @host.params['lang'] || 'en_US.UTF-8' %>\nkeyboard <%= @host.params['keyboard'] || 'us' %>\ntimezone --utc <%= @host.params['time-zone'] || 'UTC' %>\n\n<% subnet = @host.subnet -%>\n<% if subnet.respond_to?(:dhcp_boot_mode?) -%>\n<% dhcp = subnet.dhcp_boot_mode? && !@static -%>\n<% else -%>\n<% dhcp = !@static -%>\n<% end -%>\n\nnetwork --bootproto <%= dhcp ? 'dhcp' : \"static --ip=#{@host.ip} --netmask=#{subnet.mask} --gateway=#{subnet.gateway} --nameserver=#{[subnet.dns_primary, subnet.dns_secondary].select{ |item| item.present? }.join(',')}\" %> --hostname <%= @host %><%= \" --device=#{@host.mac}\" -%>\n\n# Partition table should create /boot and a volume atomicos\n<% if @dynamic -%>\n%include /tmp/diskpart.cfg\n<% else -%>\n<%= @host.diskLayout %>\n<% end -%>\n\nbootloader --timeout=3\ntext\n\n<% if @host.os.name.match /.*fedora.*/i -%>\nostreesetup --nogpg --osname=fedora-atomic --remote=fedora-atomic --url=<%= @host.param_true?('atomic-upstream') ? \"https://dl.fedoraproject.org/pub/fedora/linux/atomic/#{@host.os.major}/\" : \"#{@host.operatingsystem.medium_uri(@host)}/content/repo/\" %> --ref=fedora-atomic/f<%= @host.os.major %>/<%= @host.architecture %>/docker-host\n<% elsif @host.os.name.match /.*centos.*/i -%>\nostreesetup --nogpg --osname=centos-atomic-host --remote=centos-atomic-host --url=<%= @host.param_true?('atomic-upstream') ? \"http://mirror.centos.org/centos/#{@host.os.major}/atomic/#{@host.architecture}/repo/\" : @host.operatingsystem.medium_uri(@host) %> --ref=centos-atomic-host/<%= @host.os.major %>/<%= @host.architecture %>/standard\n<% else -%>\nostreesetup --nogpg --osname=rhel-atomic-host --remote=rhel-atomic-host --url=file:///install/ostree --ref=rhel-atomic-host/<%= @host.os.major %>/<%= @host.architecture %>/standard\n<% end -%>\nservices --disabled cloud-init,cloud-config,cloud-final,cloud-init-local\nrootpw --iscrypted <%= root_pass %>\n\nreboot\n\n%post\n<%= snippet \"subscription_manager_registration\" %>\n<%= snippet('remote_execution_ssh_keys') %>\n(\n# Report success back to Foreman\ncurl -s -o /dev/null --insecure <%= foreman_url('built') %>\n) 2>&1 | tee /mnt/sysimage/root/install.post.log\n\nexit 0\n\n%end\n","snippet":false,"template_kind_id":6,"locked":true,"default":true,"vendor":"Katello","os_family":null,"job_category":"Miscellaneous","provider_type":null,"description_format":null,"execution_timeout_interval":null}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-13 16:03:07 UTC","id":355,"auditable_id":133,"auditable_name":null,"auditable_type":"ProvisioningTemplate","action":"create","audited_changes":{"name":"Katello Kickstart Default Finish","template":"<%#\nkind: finish\nname: Katello Kickstart default finish\noses:\n- CentOS 5\n- CentOS 6\n- CentOS 7\n- RedHat 5\n- RedHat 6\n- RedHat 7\n- Fedora 19\n- Fedora 20\n%>\n<% if @host.subnet.respond_to?(:dhcp_boot_mode?) -%>\n<%= snippet 'kickstart_networking_setup' %>\nservice network restart\n<% end -%>\n\n<%\n  rhel_compatible = @host.operatingsystem.family == 'Redhat' && @host.operatingsystem.name != 'Fedora'\n  os_major = @host.operatingsystem.major.to_i\n  pm_set = @host.puppetmaster.empty? ? false : true\n  puppet_enabled = pm_set || @host.params['force-puppet']\n  salt_enabled = @host.params['salt_master'] ? true : false\n  chef_enabled = @host.respond_to?(:chef_proxy) && @host.chef_proxy\n%>\n\n<%= snippet \"subscription_manager_registration\" %>\n\n<% if @host.respond_to?(:realm) && @host.otp && @host.realm && @host.realm.realm_type == \"FreeIPA\" -%>\n<%= snippet \"freeipa_register\" %>\n<% end -%>\n\n# update local time\necho \"updating system time\"\n/usr/sbin/ntpdate -sub <%= @host.params['ntp-server'] || '0.fedora.pool.ntp.org' %>\n/usr/sbin/hwclock --systohc\n\n<% if @host.info['parameters']['realm'] && @host.realm && @host.realm.realm_type == 'FreeIPA' -%>\n<%= snippet \"freeipa_register\" %>\n<% end -%>\n\n# update all the base packages from the updates repository\nyum -t -y -e 0 update\n\n<%= snippet('remote_execution_ssh_keys') %>\n\n<% if chef_enabled %>\n<%= snippet 'chef_client' %>\n<% end -%>\n\n<% if puppet_enabled %>\n<%= snippet 'puppet_setup' %>\n<% end -%>\n\n<% if salt_enabled %>\n<%= snippet 'saltstack_setup' %>\n<% end -%>\n\nexit 0\n","snippet":false,"template_kind_id":7,"locked":true,"default":true,"vendor":"Katello","os_family":null,"job_category":"Miscellaneous","provider_type":null,"description_format":null,"execution_timeout_interval":null}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-13 16:03:07 UTC","id":354,"auditable_id":132,"auditable_name":null,"auditable_type":"ProvisioningTemplate","action":"create","audited_changes":{"name":"Katello Kickstart Default User Data","template":"<%#\nkind: user_data\nname: Katello Kickstart default user data\noses:\n- CentOS 6\n- CentOS 7\n- Fedora 19\n- Fedora 20\n- Fedora 21\n- Fedora 22\n- Fedora 23\n-%>\n#cloud-config\nhostname: <%= @host.shortname %>\nfqdn: <%= @host %>\nmanage_etc_hosts: true\n\ngroups:\n - admin\n\nusers:\n - default\n - name: admin\n   primary-group: admin\n   groups: users\n   shell: /bin/bash\n   sudo: ['ALL=(ALL) ALL']\n   lock-passwd: false\n   passwd: <%= @host.root_pass %>\n\n<%# Allow user to specify additional SSH key as host paramter -%>\n<% if @host.params['sshkey'].present? || @host.params['remote_execution_ssh_keys'].present? -%>\nssh_authorized_keys:\n<% if @host.params['sshkey'].present? -%>\n  - <%= @host.params['sshkey'] %>\n<% end -%>\n<% if @host.params['remote_execution_ssh_keys'].present? -%>\n<% @host.params['remote_execution_ssh_keys'].each do |key| -%>\n  - <%= key %>\n<% end -%>\n<% end -%>\n<% end -%>\nwrite_files:\n- path: /tmp/foreman-userdata.sh\n  permissions: '0755'\n  content: |\n    #!/bin/bash\n<%= indent 4 do\n      snippet 'subscription_manager_registration'\n    end %>\n<% if @host.info['parameters']['realm'] && @host.realm && @host.realm.realm_type == 'FreeIPA' -%>\n<%= indent 4 do\n      snippet 'freeipa_register'\n    end %>\n<% end -%>\n  <% unless @host.operatingsystem.atomic? -%>\n    # update all the base packages from the updates repository\n    yum -t -y -e 0 update\n  <% end -%>\n<%\n  # safemode renderer does not support unary negation\n  non_atomic = @host.operatingsystem.atomic? ? false : true\n  pm_set = @host.puppetmaster.empty? ? false : true\n  puppet_enabled = non_atomic && (pm_set || @host.params['force-puppet'])\n  salt_enabled = non_atomic && (@host.params['salt_master'] ? true : false)\n  chef_enabled = @host.respond_to?(:chef_proxy) && @host.chef_proxy\n%>\n<% if chef_enabled %>\n<%= indent 4 do\n      snippet 'chef_client'\n    end  %>\n<% end -%>\n\n<% if puppet_enabled %>\n<%= indent 4 do\n      snippet 'puppet_setup'\n    end %>\n<% end -%>\n\n<% if salt_enabled %>\n<%= indent 4 do\n      snippet 'saltstack_setup'\n    end %>\n<% end -%>\nphone_home:\n url: <%= foreman_url('built') %>\n post: []\n tries: 10\nruncmd:\n - [ cloud-init-per, once, foreman-userdata, /tmp/foreman-userdata.sh ]\noutput: {all: '| tee -a /root/install.userdata.log'}\n\n","snippet":false,"template_kind_id":9,"locked":true,"default":true,"vendor":"Katello","os_family":null,"job_category":"Miscellaneous","provider_type":null,"description_format":null,"execution_timeout_interval":null}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-13 16:03:07 UTC","id":353,"auditable_id":131,"auditable_name":null,"auditable_type":"ProvisioningTemplate","action":"create","audited_changes":{"name":"Katello Kickstart Default","template":"<%#\nkind: provision\nname: Katello Kickstart default\noses:\n- CentOS 5\n- CentOS 6\n- CentOS 7\n- RedHat 5\n- RedHat 6\n- RedHat 7\n- Fedora 19\n- Fedora 20\n%>\n<%\n  rhel_compatible = @host.operatingsystem.family == 'Redhat' && @host.operatingsystem.name != 'Fedora'\n  os_major = @host.operatingsystem.major.to_i\n  # safemode renderer does not support unary negation\n  pm_set = @host.puppetmaster.empty? ? false : true\n  puppet_enabled = pm_set || @host.params['force-puppet']\n  salt_enabled = @host.params['salt_master'] ? true : false\n  chef_enabled = @host.respond_to?(:chef_proxy) && @host.chef_proxy\n  section_end = (rhel_compatible && os_major <= 5) ? '' : '%end'\n%>\ninstall\n<%= @mediapath %>\nlang en_US.UTF-8\nselinux --enforcing\nkeyboard us\nskipx\n\n<% subnet = @host.subnet -%>\n<% if subnet.respond_to?(:dhcp_boot_mode?) -%>\n<% dhcp = subnet.dhcp_boot_mode? && !@static -%>\n<% else -%>\n<% dhcp = !@static -%>\n<% end -%>\n\nnetwork --bootproto <%= dhcp ? 'dhcp' : \"static --ip=#{@host.ip} --netmask=#{subnet.mask} --gateway=#{subnet.gateway} --nameserver=#{[subnet.dns_primary, subnet.dns_secondary].select{ |item| item.present? }.join(',')}\" %> --hostname <%= @host %><%= os_major >= 6 ? \" --device=#{@host.mac}\" : '' -%>\n\nrootpw --iscrypted <%= root_pass %>\nfirewall --<%= os_major >= 6 ? 'service=' : '' %>ssh\nauthconfig --useshadow --passalgo=<%= @host.operatingsystem.password_hash || 'sha256' %> --kickstart\ntimezone --utc <%= @host.params['time-zone'] || 'UTC' %>\n\n<% if @host.operatingsystem.name == 'Fedora' and os_major <= 16 -%>\n# Bootloader exception for Fedora 16:\nbootloader --append=\"nofb quiet splash=quiet <%=ks_console%>\" <%= grub_pass %>\npart biosboot --fstype=biosboot --size=1\n<% else -%>\nbootloader --location=mbr --append=\"nofb quiet splash=quiet\" <%= grub_pass %>\n<% end -%>\n\n<% if os_major == 5 -%>\nkey --skip\n<% end -%>\n\n<% if @dynamic -%>\n%include /tmp/diskpart.cfg\n<% else -%>\n<%= @host.diskLayout %>\n<% end -%>\n\ntext\nreboot\n\n%packages --ignoremissing\nyum\ndhclient\nntp\nwget\n@Core\n<%= section_end -%>\n\n<% if @dynamic -%>\n%pre\n<%= @host.diskLayout %>\n<%= section_end -%>\n<% end -%>\n\n%post --nochroot\nexec < /dev/tty3 > /dev/tty3\n#changing to VT 3 so that we can see whats going on....\n/usr/bin/chvt 3\n(\ncp -va /etc/resolv.conf /mnt/sysimage/etc/resolv.conf\n/usr/bin/chvt 1\n) 2>&1 | tee /mnt/sysimage/root/install.postnochroot.log\n<%= section_end -%>\n\n\n%post\nlogger \"Starting anaconda <%= @host %> postinstall\"\nexec < /dev/tty3 > /dev/tty3\n#changing to VT 3 so that we can see whats going on....\n/usr/bin/chvt 3\n(\n<% if subnet.respond_to?(:dhcp_boot_mode?) -%>\n<%= snippet 'kickstart_networking_setup' %>\n<% end -%>\n\n#update local time\necho \"updating system time\"\n/usr/sbin/ntpdate -sub <%= @host.params['ntp-server'] || '0.fedora.pool.ntp.org' %>\n/usr/sbin/hwclock --systohc\n\n<%= snippet \"subscription_manager_registration\" %>\n\n<% if @host.info['parameters']['realm'] && @host.realm && @host.realm.realm_type == 'FreeIPA' -%>\n<%= snippet \"freeipa_register\" %>\n<% end -%>\n\n# update all the base packages from the updates repository\nyum -t -y -e 0 update\n\n<%= snippet('remote_execution_ssh_keys') %>\n\n<% if chef_enabled %>\n<%= snippet 'chef_client' %>\n<% end -%>\n\n<% if puppet_enabled %>\n<%= snippet 'puppet_setup' %>\n<% end -%>\n\n<% if salt_enabled %>\n<%= snippet 'saltstack_setup' %>\n<% end -%>\n\nsync\n\n<% if @provisioning_type == nil || @provisioning_type == 'host' -%>\n# Inform the build system that we are done.\necho \"Informing Foreman that we are built\"\nwget -q -O /dev/null --no-check-certificate <%= foreman_url('built') %>\n<% end -%>\n) 2>&1 | tee /root/install.post.log\nexit 0\n\n<%= section_end -%>\n","snippet":false,"template_kind_id":6,"locked":true,"default":true,"vendor":"Katello","os_family":null,"job_category":"Miscellaneous","provider_type":null,"description_format":null,"execution_timeout_interval":null}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":10,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-13 15:49:11 UTC","id":352,"auditable_id":9,"auditable_name":"drone69.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"global_status":[1,2]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":9,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-13 15:48:29 UTC","id":351,"auditable_id":9,"auditable_name":"drone69.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"global_status":[2,1]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":10,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-13 15:25:12 UTC","id":350,"auditable_id":12,"auditable_name":"drone72.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"global_status":[1,2]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":9,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-13 15:25:09 UTC","id":349,"auditable_id":12,"auditable_name":"drone72.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"global_status":[2,1]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":7,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-13 15:25:08 UTC","id":348,"auditable_id":6,"auditable_name":"virt-who-battalionbox.usersys.redhat.com-1","auditable_type":"Host","action":"update","audited_changes":{"global_status":[1,0]}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.228","associated_name":null,"created_at":"2018-04-12 21:07:16 UTC","id":347,"auditable_id":4,"auditable_name":"BAE","auditable_type":"Organization","action":"create","audited_changes":{"name":"BAE","ignore_types":[],"description":"","label":"BAE","ancestry":null}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":2,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-12 21:06:45 UTC","id":346,"auditable_id":3,"auditable_name":"BAE SYSTEMS","auditable_type":"Organization","action":"destroy","audited_changes":{"name":"BAE SYSTEMS","ignore_types":[],"description":"","label":"bae_systems","ancestry":null}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":6,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-12 21:04:03 UTC","id":345,"auditable_id":15,"auditable_name":"joker.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"global_status":[1,2]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":7,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-12 21:04:03 UTC","id":344,"auditable_id":3,"auditable_name":"virt-who-nasasysmgmt2.usersys.redhat.com-1","auditable_type":"Host","action":"update","audited_changes":{"global_status":[0,1]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":6,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-12 21:04:02 UTC","id":343,"auditable_id":4,"auditable_name":"virt-who-nasasysmgmt.usersys.redhat.com-1","auditable_type":"Host","action":"update","audited_changes":{"global_status":[0,1]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":6,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-12 21:04:02 UTC","id":342,"auditable_id":6,"auditable_name":"virt-who-battalionbox.usersys.redhat.com-1","auditable_type":"Host","action":"update","audited_changes":{"global_status":[0,1]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":6,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-12 21:04:00 UTC","id":341,"auditable_id":16,"auditable_name":"splinter.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"global_status":[1,2]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":6,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-12 21:03:58 UTC","id":340,"auditable_id":7,"auditable_name":"virt-who-brigadebox.usersys.redhat.com-1","auditable_type":"Host","action":"update","audited_changes":{"global_status":[0,1]}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.228","associated_name":null,"created_at":"2018-04-12 20:43:36 UTC","id":339,"auditable_id":3,"auditable_name":"BAE SYSTEMS","auditable_type":"Organization","action":"create","audited_changes":{"name":"BAE SYSTEMS","ignore_types":[],"description":"","label":"bae_systems","ancestry":null}},{"user_id":3,"user_type":null,"user_name":"admin","version":14,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.228","associated_name":null,"created_at":"2018-04-03 21:27:48 UTC","id":338,"auditable_id":5,"auditable_name":"drone74.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"environment_id":[2,3]}},{"user_id":3,"user_type":null,"user_name":"admin","version":13,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.228","associated_name":null,"created_at":"2018-04-03 21:25:14 UTC","id":337,"auditable_id":5,"auditable_name":"drone74.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"comment":[null,""],"environment_id":[1,2]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-03 18:57:25 UTC","id":336,"auditable_id":31,"auditable_name":"::upload_schedule","auditable_type":"LookupKey","action":"create","audited_changes":{"key":"upload_schedule","puppetclass_id":null,"default_value":"","path":null,"description":null,"validator_type":null,"validator_rule":null,"key_type":"string","override":false,"required":false,"merge_overrides":false,"avoid_duplicates":false,"omit":null,"merge_default":false,"hidden_value":false}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-03 18:57:25 UTC","id":335,"auditable_id":30,"auditable_name":"::obfuscate_hostname","auditable_type":"LookupKey","action":"create","audited_changes":{"key":"obfuscate_hostname","puppetclass_id":null,"default_value":"","path":null,"description":null,"validator_type":null,"validator_rule":null,"key_type":"string","override":false,"required":false,"merge_overrides":false,"avoid_duplicates":false,"omit":null,"merge_default":false,"hidden_value":false}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-03 18:57:25 UTC","id":334,"auditable_id":29,"auditable_name":"::obfuscate","auditable_type":"LookupKey","action":"create","audited_changes":{"key":"obfuscate","puppetclass_id":null,"default_value":"","path":null,"description":null,"validator_type":null,"validator_rule":null,"key_type":"string","override":false,"required":false,"merge_overrides":false,"avoid_duplicates":false,"omit":null,"merge_default":false,"hidden_value":false}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-03 18:57:25 UTC","id":333,"auditable_id":28,"auditable_name":"::auto_update","auditable_type":"LookupKey","action":"create","audited_changes":{"key":"auto_update","puppetclass_id":null,"default_value":"","path":null,"description":null,"validator_type":null,"validator_rule":null,"key_type":"string","override":false,"required":false,"merge_overrides":false,"avoid_duplicates":false,"omit":null,"merge_default":false,"hidden_value":false}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-03 18:57:25 UTC","id":332,"auditable_id":27,"auditable_name":"::gpg","auditable_type":"LookupKey","action":"create","audited_changes":{"key":"gpg","puppetclass_id":null,"default_value":"","path":null,"description":null,"validator_type":null,"validator_rule":null,"key_type":"string","override":false,"required":false,"merge_overrides":false,"avoid_duplicates":false,"omit":null,"merge_default":false,"hidden_value":false}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-03 18:57:25 UTC","id":331,"auditable_id":26,"auditable_name":"::cert_verify","auditable_type":"LookupKey","action":"create","audited_changes":{"key":"cert_verify","puppetclass_id":null,"default_value":"","path":null,"description":null,"validator_type":null,"validator_rule":null,"key_type":"string","override":false,"required":false,"merge_overrides":false,"avoid_duplicates":false,"omit":null,"merge_default":false,"hidden_value":false}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-03 18:57:25 UTC","id":330,"auditable_id":25,"auditable_name":"::proxy","auditable_type":"LookupKey","action":"create","audited_changes":{"key":"proxy","puppetclass_id":null,"default_value":"","path":null,"description":null,"validator_type":null,"validator_rule":null,"key_type":"string","override":false,"required":false,"merge_overrides":false,"avoid_duplicates":false,"omit":null,"merge_default":false,"hidden_value":false}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-03 18:57:25 UTC","id":329,"auditable_id":24,"auditable_name":"::base_url","auditable_type":"LookupKey","action":"create","audited_changes":{"key":"base_url","puppetclass_id":null,"default_value":"","path":null,"description":null,"validator_type":null,"validator_rule":null,"key_type":"string","override":false,"required":false,"merge_overrides":false,"avoid_duplicates":false,"omit":null,"merge_default":false,"hidden_value":false}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-03 18:57:25 UTC","id":328,"auditable_id":23,"auditable_name":"::password","auditable_type":"LookupKey","action":"create","audited_changes":{"key":"password","puppetclass_id":null,"default_value":"","path":null,"description":null,"validator_type":null,"validator_rule":null,"key_type":"string","override":false,"required":false,"merge_overrides":false,"avoid_duplicates":false,"omit":null,"merge_default":false,"hidden_value":false}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-03 18:57:25 UTC","id":327,"auditable_id":22,"auditable_name":"::username","auditable_type":"LookupKey","action":"create","audited_changes":{"key":"username","puppetclass_id":null,"default_value":"","path":null,"description":null,"validator_type":null,"validator_rule":null,"key_type":"string","override":false,"required":false,"merge_overrides":false,"avoid_duplicates":false,"omit":null,"merge_default":false,"hidden_value":false}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-03 18:57:25 UTC","id":326,"auditable_id":21,"auditable_name":"::authmethod","auditable_type":"LookupKey","action":"create","audited_changes":{"key":"authmethod","puppetclass_id":null,"default_value":"","path":null,"description":null,"validator_type":null,"validator_rule":null,"key_type":"string","override":false,"required":false,"merge_overrides":false,"avoid_duplicates":false,"omit":null,"merge_default":false,"hidden_value":false}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-03 18:57:25 UTC","id":325,"auditable_id":20,"auditable_name":"::auto_config","auditable_type":"LookupKey","action":"create","audited_changes":{"key":"auto_config","puppetclass_id":null,"default_value":"True","path":null,"description":null,"validator_type":null,"validator_rule":null,"key_type":"string","override":false,"required":false,"merge_overrides":false,"avoid_duplicates":false,"omit":null,"merge_default":false,"hidden_value":false}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-03 18:57:25 UTC","id":324,"auditable_id":19,"auditable_name":"::log_level","auditable_type":"LookupKey","action":"create","audited_changes":{"key":"log_level","puppetclass_id":null,"default_value":"","path":null,"description":null,"validator_type":null,"validator_rule":null,"key_type":"string","override":false,"required":false,"merge_overrides":false,"avoid_duplicates":false,"omit":null,"merge_default":false,"hidden_value":false}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-03 18:57:25 UTC","id":323,"auditable_id":18,"auditable_name":"::foreman_repo_gpg_chk","auditable_type":"LookupKey","action":"create","audited_changes":{"key":"foreman_repo_gpg_chk","puppetclass_id":null,"default_value":false,"path":null,"description":null,"validator_type":null,"validator_rule":null,"key_type":"boolean","override":false,"required":false,"merge_overrides":false,"avoid_duplicates":false,"omit":null,"merge_default":false,"hidden_value":false}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-03 18:57:25 UTC","id":322,"auditable_id":17,"auditable_name":"::foreman_repo_src","auditable_type":"LookupKey","action":"create","audited_changes":{"key":"foreman_repo_src","puppetclass_id":null,"default_value":"","path":null,"description":null,"validator_type":null,"validator_rule":null,"key_type":"string","override":false,"required":false,"merge_overrides":false,"avoid_duplicates":false,"omit":null,"merge_default":false,"hidden_value":false}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-03 18:57:25 UTC","id":321,"auditable_id":16,"auditable_name":"::foreman_repo_key","auditable_type":"LookupKey","action":"create","audited_changes":{"key":"foreman_repo_key","puppetclass_id":null,"default_value":"https://yum.theforeman.org/RPM-GPG-KEY-foreman","path":null,"description":null,"validator_type":null,"validator_rule":null,"key_type":"string","override":false,"required":false,"merge_overrides":false,"avoid_duplicates":false,"omit":null,"merge_default":false,"hidden_value":false}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-03 18:57:25 UTC","id":320,"auditable_id":15,"auditable_name":"::foreman_repo_rel","auditable_type":"LookupKey","action":"create","audited_changes":{"key":"foreman_repo_rel","puppetclass_id":null,"default_value":"","path":null,"description":null,"validator_type":null,"validator_rule":null,"key_type":"string","override":false,"required":false,"merge_overrides":false,"avoid_duplicates":false,"omit":null,"merge_default":false,"hidden_value":false}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-03 18:57:24 UTC","id":319,"auditable_id":14,"auditable_name":"::host_private_key","auditable_type":"LookupKey","action":"create","audited_changes":{"key":"host_private_key","puppetclass_id":null,"default_value":"${$::foreman_scap_client::params::host_private_key}","path":null,"description":null,"validator_type":null,"validator_rule":null,"key_type":"string","override":false,"required":false,"merge_overrides":false,"avoid_duplicates":false,"omit":null,"merge_default":false,"hidden_value":false}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-03 18:57:24 UTC","id":318,"auditable_id":13,"auditable_name":"::host_certificate","auditable_type":"LookupKey","action":"create","audited_changes":{"key":"host_certificate","puppetclass_id":null,"default_value":"${$::foreman_scap_client::params::host_certificate}","path":null,"description":null,"validator_type":null,"validator_rule":null,"key_type":"string","override":false,"required":false,"merge_overrides":false,"avoid_duplicates":false,"omit":null,"merge_default":false,"hidden_value":false}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-03 18:57:24 UTC","id":317,"auditable_id":12,"auditable_name":"::ca_file","auditable_type":"LookupKey","action":"create","audited_changes":{"key":"ca_file","puppetclass_id":null,"default_value":"${$::foreman_scap_client::params::ca_file}","path":null,"description":null,"validator_type":null,"validator_rule":null,"key_type":"string","override":false,"required":false,"merge_overrides":false,"avoid_duplicates":false,"omit":null,"merge_default":false,"hidden_value":false}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-03 18:57:23 UTC","id":316,"auditable_id":11,"auditable_name":"::ensure","auditable_type":"LookupKey","action":"create","audited_changes":{"key":"ensure","puppetclass_id":null,"default_value":"present","path":null,"description":null,"validator_type":null,"validator_rule":null,"key_type":"string","override":false,"required":false,"merge_overrides":false,"avoid_duplicates":false,"omit":null,"merge_default":false,"hidden_value":false}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-03 18:57:23 UTC","id":315,"auditable_id":10,"auditable_name":"::policies","auditable_type":"LookupKey","action":"create","audited_changes":{"key":"policies","puppetclass_id":null,"default_value":null,"path":null,"description":null,"validator_type":null,"validator_rule":null,"key_type":null,"override":true,"required":true,"merge_overrides":false,"avoid_duplicates":false,"omit":null,"merge_default":false,"hidden_value":false}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-03 18:57:23 UTC","id":314,"auditable_id":9,"auditable_name":"::port","auditable_type":"LookupKey","action":"create","audited_changes":{"key":"port","puppetclass_id":null,"default_value":null,"path":null,"description":null,"validator_type":null,"validator_rule":null,"key_type":null,"override":true,"required":true,"merge_overrides":false,"avoid_duplicates":false,"omit":null,"merge_default":false,"hidden_value":false}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-03 18:57:23 UTC","id":313,"auditable_id":8,"auditable_name":"::server","auditable_type":"LookupKey","action":"create","audited_changes":{"key":"server","puppetclass_id":null,"default_value":null,"path":null,"description":null,"validator_type":null,"validator_rule":null,"key_type":null,"override":true,"required":true,"merge_overrides":false,"avoid_duplicates":false,"omit":null,"merge_default":false,"hidden_value":false}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-03 18:57:23 UTC","id":312,"auditable_id":7,"auditable_name":"::issue_net_content","auditable_type":"LookupKey","action":"create","audited_changes":{"key":"issue_net_content","puppetclass_id":null,"default_value":"","path":null,"description":null,"validator_type":null,"validator_rule":null,"key_type":"string","override":false,"required":false,"merge_overrides":false,"avoid_duplicates":false,"omit":null,"merge_default":false,"hidden_value":false}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-03 18:57:23 UTC","id":311,"auditable_id":6,"auditable_name":"::issue_net_template","auditable_type":"LookupKey","action":"create","audited_changes":{"key":"issue_net_template","puppetclass_id":null,"default_value":"","path":null,"description":null,"validator_type":null,"validator_rule":null,"key_type":"string","override":false,"required":false,"merge_overrides":false,"avoid_duplicates":false,"omit":null,"merge_default":false,"hidden_value":false}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-03 18:57:23 UTC","id":310,"auditable_id":5,"auditable_name":"::issue_content","auditable_type":"LookupKey","action":"create","audited_changes":{"key":"issue_content","puppetclass_id":null,"default_value":"","path":null,"description":null,"validator_type":null,"validator_rule":null,"key_type":"string","override":false,"required":false,"merge_overrides":false,"avoid_duplicates":false,"omit":null,"merge_default":false,"hidden_value":false}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-03 18:57:23 UTC","id":309,"auditable_id":4,"auditable_name":"::issue_template","auditable_type":"LookupKey","action":"create","audited_changes":{"key":"issue_template","puppetclass_id":null,"default_value":"","path":null,"description":null,"validator_type":null,"validator_rule":null,"key_type":"string","override":false,"required":false,"merge_overrides":false,"avoid_duplicates":false,"omit":null,"merge_default":false,"hidden_value":false}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-03 18:57:23 UTC","id":308,"auditable_id":3,"auditable_name":"::content","auditable_type":"LookupKey","action":"create","audited_changes":{"key":"content","puppetclass_id":null,"default_value":"","path":null,"description":null,"validator_type":null,"validator_rule":null,"key_type":"string","override":false,"required":false,"merge_overrides":false,"avoid_duplicates":false,"omit":null,"merge_default":false,"hidden_value":false}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-03 18:57:23 UTC","id":307,"auditable_id":2,"auditable_name":"::template","auditable_type":"LookupKey","action":"create","audited_changes":{"key":"template","puppetclass_id":null,"default_value":"","path":null,"description":null,"validator_type":null,"validator_rule":null,"key_type":"string","override":false,"required":false,"merge_overrides":false,"avoid_duplicates":false,"omit":null,"merge_default":false,"hidden_value":false}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-03 18:57:23 UTC","id":306,"auditable_id":1,"auditable_name":"::dynamic_motd","auditable_type":"LookupKey","action":"create","audited_changes":{"key":"dynamic_motd","puppetclass_id":null,"default_value":true,"path":null,"description":null,"validator_type":null,"validator_rule":null,"key_type":"boolean","override":false,"required":false,"merge_overrides":false,"avoid_duplicates":false,"omit":null,"merge_default":false,"hidden_value":false}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-03 18:57:23 UTC","id":305,"auditable_id":6,"auditable_name":"access_insights_client","auditable_type":"Puppetclass","action":"create","audited_changes":{"name":"access_insights_client"}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-03 18:57:23 UTC","id":304,"auditable_id":5,"auditable_name":"foreman_scap_client::params","auditable_type":"Puppetclass","action":"create","audited_changes":{"name":"foreman_scap_client::params"}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-03 18:57:23 UTC","id":303,"auditable_id":4,"auditable_name":"foreman_scap_client","auditable_type":"Puppetclass","action":"create","audited_changes":{"name":"foreman_scap_client"}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-03 18:57:23 UTC","id":302,"auditable_id":3,"auditable_name":"stdlib::stages","auditable_type":"Puppetclass","action":"create","audited_changes":{"name":"stdlib::stages"}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-03 18:57:23 UTC","id":301,"auditable_id":2,"auditable_name":"stdlib","auditable_type":"Puppetclass","action":"create","audited_changes":{"name":"stdlib"}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-04-03 18:57:22 UTC","id":300,"auditable_id":1,"auditable_name":"motd","auditable_type":"Puppetclass","action":"create","audited_changes":{"name":"motd"}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":2,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.133","associated_name":null,"created_at":"2018-03-26 14:21:47 UTC","id":299,"auditable_id":2,"auditable_name":"joker.usersys.redhat.com","auditable_type":"SmartProxy","action":"update","audited_changes":{"puppet_path":[null,"/etc/puppet/environments"]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":2,"comment":null,"associated_id":21,"associated_type":"Role","remote_address":null,"associated_name":"Access Insights Admin","created_at":"2018-03-26 14:09:32 UTC","id":298,"auditable_id":271,"auditable_name":"view_hosts","auditable_type":"Filter","action":"destroy","audited_changes":{"search":null,"role_id":21,"taxonomy_search":null,"override":false}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":2,"comment":null,"associated_id":20,"associated_type":"Role","remote_address":null,"associated_name":"Access Insights Viewer","created_at":"2018-03-26 14:09:32 UTC","id":297,"auditable_id":272,"auditable_name":"view_hosts","auditable_type":"Filter","action":"destroy","audited_changes":{"search":null,"role_id":20,"taxonomy_search":null,"override":false}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":2,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-26 14:09:08 UTC","id":296,"auditable_id":128,"auditable_name":"Katello Kickstart Default User Data","auditable_type":"ProvisioningTemplate","action":"destroy","audited_changes":{"name":"Katello Kickstart Default User Data","template":"<%#\nkind: user_data\nname: Katello Kickstart default user data\noses:\n- CentOS 6\n- CentOS 7\n- Fedora 19\n- Fedora 20\n- Fedora 21\n- Fedora 22\n- Fedora 23\n-%>\n#cloud-config\nhostname: <%= @host.shortname %>\nfqdn: <%= @host %>\nmanage_etc_hosts: true\n\ngroups:\n - admin\n\nusers:\n - default\n - name: admin\n   primary-group: admin\n   groups: users\n   shell: /bin/bash\n   sudo: ['ALL=(ALL) ALL']\n   lock-passwd: false\n   passwd: <%= @host.root_pass %>\n\n<%# Allow user to specify additional SSH key as host paramter -%>\n<% if @host.params['sshkey'].present? || @host.params['remote_execution_ssh_keys'].present? -%>\nssh_authorized_keys:\n<% if @host.params['sshkey'].present? -%>\n  - <%= @host.params['sshkey'] %>\n<% end -%>\n<% if @host.params['remote_execution_ssh_keys'].present? -%>\n<% @host.params['remote_execution_ssh_keys'].each do |key| -%>\n  - <%= key %>\n<% end -%>\n<% end -%>\n<% end -%>\nwrite_files:\n- path: /tmp/foreman-userdata.sh\n  permissions: '0755'\n  content: |\n    #!/bin/bash\n<%= indent 4 do\n      snippet 'subscription_manager_registration'\n    end %>\n<% if @host.info['parameters']['realm'] && @host.realm && @host.realm.realm_type == 'FreeIPA' -%>\n<%= indent 4 do\n      snippet 'freeipa_register'\n    end %>\n<% end -%>\n  <% unless @host.operatingsystem.atomic? -%>\n    # update all the base packages from the updates repository\n    yum -t -y -e 0 update\n  <% end -%>\n<%\n  # safemode renderer does not support unary negation\n  non_atomic = @host.operatingsystem.atomic? ? false : true\n  pm_set = @host.puppetmaster.empty? ? false : true\n  puppet_enabled = non_atomic && (pm_set || @host.params['force-puppet'])\n  salt_enabled = non_atomic && (@host.params['salt_master'] ? true : false)\n  chef_enabled = @host.respond_to?(:chef_proxy) && @host.chef_proxy\n%>\n<% if chef_enabled %>\n<%= indent 4 do\n      snippet 'chef_client'\n    end  %>\n<% end -%>\n\n<% if puppet_enabled %>\n<%= indent 4 do\n      snippet 'puppet_setup'\n    end %>\n<% end -%>\n\n<% if salt_enabled %>\n<%= indent 4 do\n      snippet 'saltstack_setup'\n    end %>\n<% end -%>\nphone_home:\n url: <%= foreman_url('built') %>\n post: []\n tries: 10\nruncmd:\n - [ cloud-init-per, once, foreman-userdata, /tmp/foreman-userdata.sh ]\noutput: {all: '| tee -a /root/install.userdata.log'}\n\n","snippet":false,"template_kind_id":9,"locked":true,"default":true,"vendor":"Katello","os_family":null,"job_category":"Miscellaneous","provider_type":null,"description_format":null,"execution_timeout_interval":null}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":2,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-26 14:09:08 UTC","id":295,"auditable_id":129,"auditable_name":"Katello Kickstart Default Finish","auditable_type":"ProvisioningTemplate","action":"destroy","audited_changes":{"name":"Katello Kickstart Default Finish","template":"<%#\nkind: finish\nname: Katello Kickstart default finish\noses:\n- CentOS 5\n- CentOS 6\n- CentOS 7\n- RedHat 5\n- RedHat 6\n- RedHat 7\n- Fedora 19\n- Fedora 20\n%>\n<% if @host.subnet.respond_to?(:dhcp_boot_mode?) -%>\n<%= snippet 'kickstart_networking_setup' %>\nservice network restart\n<% end -%>\n\n<%\n  rhel_compatible = @host.operatingsystem.family == 'Redhat' && @host.operatingsystem.name != 'Fedora'\n  os_major = @host.operatingsystem.major.to_i\n  pm_set = @host.puppetmaster.empty? ? false : true\n  puppet_enabled = pm_set || @host.params['force-puppet']\n  salt_enabled = @host.params['salt_master'] ? true : false\n  chef_enabled = @host.respond_to?(:chef_proxy) && @host.chef_proxy\n%>\n\n<%= snippet \"subscription_manager_registration\" %>\n\n<% if @host.respond_to?(:realm) && @host.otp && @host.realm && @host.realm.realm_type == \"FreeIPA\" -%>\n<%= snippet \"freeipa_register\" %>\n<% end -%>\n\n# update local time\necho \"updating system time\"\n/usr/sbin/ntpdate -sub <%= @host.params['ntp-server'] || '0.fedora.pool.ntp.org' %>\n/usr/sbin/hwclock --systohc\n\n<% if @host.info['parameters']['realm'] && @host.realm && @host.realm.realm_type == 'FreeIPA' -%>\n<%= snippet \"freeipa_register\" %>\n<% end -%>\n\n# update all the base packages from the updates repository\nyum -t -y -e 0 update\n\n<%= snippet('remote_execution_ssh_keys') %>\n\n<% if chef_enabled %>\n<%= snippet 'chef_client' %>\n<% end -%>\n\n<% if puppet_enabled %>\n<%= snippet 'puppet_setup' %>\n<% end -%>\n\n<% if salt_enabled %>\n<%= snippet 'saltstack_setup' %>\n<% end -%>\n\nexit 0\n","snippet":false,"template_kind_id":7,"locked":true,"default":true,"vendor":"Katello","os_family":null,"job_category":"Miscellaneous","provider_type":null,"description_format":null,"execution_timeout_interval":null}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":2,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-26 14:09:08 UTC","id":294,"auditable_id":127,"auditable_name":"Katello Kickstart Default","auditable_type":"ProvisioningTemplate","action":"destroy","audited_changes":{"name":"Katello Kickstart Default","template":"<%#\nkind: provision\nname: Katello Kickstart default\noses:\n- CentOS 5\n- CentOS 6\n- CentOS 7\n- RedHat 5\n- RedHat 6\n- RedHat 7\n- Fedora 19\n- Fedora 20\n%>\n<%\n  rhel_compatible = @host.operatingsystem.family == 'Redhat' && @host.operatingsystem.name != 'Fedora'\n  os_major = @host.operatingsystem.major.to_i\n  # safemode renderer does not support unary negation\n  pm_set = @host.puppetmaster.empty? ? false : true\n  puppet_enabled = pm_set || @host.params['force-puppet']\n  salt_enabled = @host.params['salt_master'] ? true : false\n  chef_enabled = @host.respond_to?(:chef_proxy) && @host.chef_proxy\n  section_end = (rhel_compatible && os_major <= 5) ? '' : '%end'\n%>\ninstall\n<%= @mediapath %>\nlang en_US.UTF-8\nselinux --enforcing\nkeyboard us\nskipx\n\n<% subnet = @host.subnet -%>\n<% if subnet.respond_to?(:dhcp_boot_mode?) -%>\n<% dhcp = subnet.dhcp_boot_mode? && !@static -%>\n<% else -%>\n<% dhcp = !@static -%>\n<% end -%>\n\nnetwork --bootproto <%= dhcp ? 'dhcp' : \"static --ip=#{@host.ip} --netmask=#{subnet.mask} --gateway=#{subnet.gateway} --nameserver=#{[subnet.dns_primary, subnet.dns_secondary].select{ |item| item.present? }.join(',')}\" %> --hostname <%= @host %><%= os_major >= 6 ? \" --device=#{@host.mac}\" : '' -%>\n\nrootpw --iscrypted <%= root_pass %>\nfirewall --<%= os_major >= 6 ? 'service=' : '' %>ssh\nauthconfig --useshadow --passalgo=<%= @host.operatingsystem.password_hash || 'sha256' %> --kickstart\ntimezone --utc <%= @host.params['time-zone'] || 'UTC' %>\n\n<% if @host.operatingsystem.name == 'Fedora' and os_major <= 16 -%>\n# Bootloader exception for Fedora 16:\nbootloader --append=\"nofb quiet splash=quiet <%=ks_console%>\" <%= grub_pass %>\npart biosboot --fstype=biosboot --size=1\n<% else -%>\nbootloader --location=mbr --append=\"nofb quiet splash=quiet\" <%= grub_pass %>\n<% end -%>\n\n<% if os_major == 5 -%>\nkey --skip\n<% end -%>\n\n<% if @dynamic -%>\n%include /tmp/diskpart.cfg\n<% else -%>\n<%= @host.diskLayout %>\n<% end -%>\n\ntext\nreboot\n\n%packages --ignoremissing\nyum\ndhclient\nntp\nwget\n@Core\n<%= section_end -%>\n\n<% if @dynamic -%>\n%pre\n<%= @host.diskLayout %>\n<%= section_end -%>\n<% end -%>\n\n%post --nochroot\nexec < /dev/tty3 > /dev/tty3\n#changing to VT 3 so that we can see whats going on....\n/usr/bin/chvt 3\n(\ncp -va /etc/resolv.conf /mnt/sysimage/etc/resolv.conf\n/usr/bin/chvt 1\n) 2>&1 | tee /mnt/sysimage/root/install.postnochroot.log\n<%= section_end -%>\n\n\n%post\nlogger \"Starting anaconda <%= @host %> postinstall\"\nexec < /dev/tty3 > /dev/tty3\n#changing to VT 3 so that we can see whats going on....\n/usr/bin/chvt 3\n(\n<% if subnet.respond_to?(:dhcp_boot_mode?) -%>\n<%= snippet 'kickstart_networking_setup' %>\n<% end -%>\n\n#update local time\necho \"updating system time\"\n/usr/sbin/ntpdate -sub <%= @host.params['ntp-server'] || '0.fedora.pool.ntp.org' %>\n/usr/sbin/hwclock --systohc\n\n<%= snippet \"subscription_manager_registration\" %>\n\n<% if @host.info['parameters']['realm'] && @host.realm && @host.realm.realm_type == 'FreeIPA' -%>\n<%= snippet \"freeipa_register\" %>\n<% end -%>\n\n# update all the base packages from the updates repository\nyum -t -y -e 0 update\n\n<%= snippet('remote_execution_ssh_keys') %>\n\n<% if chef_enabled %>\n<%= snippet 'chef_client' %>\n<% end -%>\n\n<% if puppet_enabled %>\n<%= snippet 'puppet_setup' %>\n<% end -%>\n\n<% if salt_enabled %>\n<%= snippet 'saltstack_setup' %>\n<% end -%>\n\nsync\n\n<% if @provisioning_type == nil || @provisioning_type == 'host' -%>\n# Inform the build system that we are done.\necho \"Informing Foreman that we are built\"\nwget -q -O /dev/null --no-check-certificate <%= foreman_url('built') %>\n<% end -%>\n) 2>&1 | tee /root/install.post.log\nexit 0\n\n<%= section_end -%>\n","snippet":false,"template_kind_id":6,"locked":true,"default":true,"vendor":"Katello","os_family":null,"job_category":"Miscellaneous","provider_type":null,"description_format":null,"execution_timeout_interval":null}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":2,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-26 14:09:08 UTC","id":293,"auditable_id":130,"auditable_name":"Katello Atomic Kickstart Default","auditable_type":"ProvisioningTemplate","action":"destroy","audited_changes":{"name":"Katello Atomic Kickstart Default","template":"<%#\nkind: provision\nname: Katello Atomic Kickstart default\n%>\n\nlang <%= @host.params['lang'] || 'en_US.UTF-8' %>\nkeyboard <%= @host.params['keyboard'] || 'us' %>\ntimezone --utc <%= @host.params['time-zone'] || 'UTC' %>\n\n<% subnet = @host.subnet -%>\n<% if subnet.respond_to?(:dhcp_boot_mode?) -%>\n<% dhcp = subnet.dhcp_boot_mode? && !@static -%>\n<% else -%>\n<% dhcp = !@static -%>\n<% end -%>\n\nnetwork --bootproto <%= dhcp ? 'dhcp' : \"static --ip=#{@host.ip} --netmask=#{subnet.mask} --gateway=#{subnet.gateway} --nameserver=#{[subnet.dns_primary, subnet.dns_secondary].select{ |item| item.present? }.join(',')}\" %> --hostname <%= @host %><%= \" --device=#{@host.mac}\" -%>\n\n# Partition table should create /boot and a volume atomicos\n<% if @dynamic -%>\n%include /tmp/diskpart.cfg\n<% else -%>\n<%= @host.diskLayout %>\n<% end -%>\n\nbootloader --timeout=3\ntext\n\n<% if @host.os.name.match /.*fedora.*/i -%>\nostreesetup --nogpg --osname=fedora-atomic --remote=fedora-atomic --url=<%= @host.param_true?('atomic-upstream') ? \"https://dl.fedoraproject.org/pub/fedora/linux/atomic/#{@host.os.major}/\" : \"#{@host.operatingsystem.medium_uri(@host)}/content/repo/\" %> --ref=fedora-atomic/f<%= @host.os.major %>/<%= @host.architecture %>/docker-host\n<% elsif @host.os.name.match /.*centos.*/i -%>\nostreesetup --nogpg --osname=centos-atomic-host --remote=centos-atomic-host --url=<%= @host.param_true?('atomic-upstream') ? \"http://mirror.centos.org/centos/#{@host.os.major}/atomic/#{@host.architecture}/repo/\" : @host.operatingsystem.medium_uri(@host) %> --ref=centos-atomic-host/<%= @host.os.major %>/<%= @host.architecture %>/standard\n<% else -%>\nostreesetup --nogpg --osname=rhel-atomic-host --remote=rhel-atomic-host --url=file:///install/ostree --ref=rhel-atomic-host/<%= @host.os.major %>/<%= @host.architecture %>/standard\n<% end -%>\nservices --disabled cloud-init,cloud-config,cloud-final,cloud-init-local\nrootpw --iscrypted <%= root_pass %>\n\nreboot\n\n%post\n<%= snippet \"subscription_manager_registration\" %>\n<%= snippet('remote_execution_ssh_keys') %>\n(\n# Report success back to Foreman\ncurl -s -o /dev/null --insecure <%= foreman_url('built') %>\n) 2>&1 | tee /mnt/sysimage/root/install.post.log\n\nexit 0\n\n%end\n","snippet":false,"template_kind_id":6,"locked":true,"default":true,"vendor":"Katello","os_family":null,"job_category":"Miscellaneous","provider_type":null,"description_format":null,"execution_timeout_interval":null}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":3,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-26 14:09:06 UTC","id":292,"auditable_id":73,"auditable_name":"pxegrub2_discovery","auditable_type":"ProvisioningTemplate","action":"update","audited_changes":{"template":["<%#\nkind: snippet\nname: pxegrub2_discovery\n-%>\n<%#\ndiscovery image is based on CentOS/RHEL and therefor it is affected by https://bugzilla.redhat.com/show_bug.cgi?id=1259015.\nIn short, before RHEL 7.2 virtio driver didn't have the new persistent naming scheme, causing interfaces to be named eth0, eth1, etc..\nIf you want to enable the new persistent naming scheme and get inteface names like ens3, add net.ifnames=1 to the linuxefi line below.\n-%>\nmenuentry 'Foreman Discovery Image' {\n  linuxefi boot/fdi-image/vmlinuz0 rootflags=loop root=live:/fdi.iso rootfstype=auto ro rd.live.image acpi=force rd.luks=0 rd.md=0 rd.dm=0 rd.lvm=0 rd.bootif=0 rd.neednet=0 nomodeset proxy.url=<%= foreman_server_url %> proxy.type=foreman BOOTIF=01-$net_default_mac\n  initrdefi boot/fdi-image/initrd0.img\n}\n","<%#\nkind: snippet\nname: pxegrub2_discovery\n-%>\n<%#\nRHEL 7 virtio driver does not have persistent naming scheme, causing interfaces\nto be named eth0, eth1, etc.. If you want to enable the new persistent naming\nscheme and get inteface names like ens3, add net.ifnames=1 to the linuxefi line\nbelow. This will not be fixed until RHEL8 due to prevent breaking changes for\nexisting systems. See RHBZ#1259015 for more details.\n\nAnother bug in RHEL 7.4 is affecting $net_default_mac with a trailing slash, in\nthe global template we have a regexp module creating corrected variable $mac\nwhich is used here. See RHBZ#1487107 for more info.\n-%>\nmenuentry 'Foreman Discovery Image' {\n  linuxefi boot/fdi-image-rhel_7-vmlinuz rootflags=loop root=live:/fdi.iso rootfstype=auto ro rd.live.image acpi=force rd.luks=0 rd.md=0 rd.dm=0 rd.lvm=0 rd.bootif=0 rd.neednet=0 nomodeset proxy.url=<%= foreman_server_url %> proxy.type=foreman BOOTIF=01-$mac\n  initrdefi boot/fdi-image-rhel_7-img\n}\n"],"vendor":["Foreman","Satellite"]}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":3,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-26 14:09:05 UTC","id":291,"auditable_id":75,"auditable_name":"pxegrub_discovery","auditable_type":"ProvisioningTemplate","action":"update","audited_changes":{"template":["<%#\nkind: snippet\nname: pxegrub_discovery\n-%>\n<%#\ndiscovery image is based on CentOS/RHEL and therefor it is affected by https://bugzilla.redhat.com/show_bug.cgi?id=1259015.\nIn short, before RHEL 7.2 virtio driver didn't have the new persistent naming scheme, causing interfaces to be named eth0, eth1, etc..\nIf you want to enable the new persistent naming scheme and get inteface names like ens3, add net.ifnames=1 to the kernel line below.\n-%>\n# http://projects.theforeman.org/issues/15997\ntitle Foreman Discovery Image - not supported with Grub 1.x\n  kernel boot/fdi-image/vmlinuz0 rootflags=loop root=live:/fdi.iso rootfstype=auto ro rd.live.image acpi=force rd.luks=0 rd.md=0 rd.dm=0 rd.lvm=0 rd.bootif=0 rd.neednet=0 nomodeset proxy.url=<%= foreman_server_url %> proxy.type=foreman BOOTIF=01-$net_default_mac\n  initrd boot/fdi-image/initrd0.img\n","<%#\nkind: snippet\nname: pxegrub_discovery\n-%>\n<%#\ndiscovery image is based on CentOS/RHEL and therefor it is affected by https://bugzilla.redhat.com/show_bug.cgi?id=1259015.\nIn short, before RHEL 7.2 virtio driver didn't have the new persistent naming scheme, causing interfaces to be named eth0, eth1, etc..\nIf you want to enable the new persistent naming scheme and get inteface names like ens3, add net.ifnames=1 to the kernel line below.\n-%>\n# http://projects.theforeman.org/issues/15997\ntitle Foreman Discovery Image - not supported with Grub 1.x\n  kernel boot/fdi-image-rhel_7-vmlinuz rootflags=loop root=live:/fdi.iso rootfstype=auto ro rd.live.image acpi=force rd.luks=0 rd.md=0 rd.dm=0 rd.lvm=0 rd.bootif=0 rd.neednet=0 nomodeset proxy.url=<%= foreman_server_url %> proxy.type=foreman BOOTIF=01-$net_default_mac\n  initrd boot/fdi-image-rhel_7-img\n"],"vendor":["Foreman","Satellite"]}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":3,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-26 14:09:05 UTC","id":290,"auditable_id":77,"auditable_name":"pxelinux_discovery","auditable_type":"ProvisioningTemplate","action":"update","audited_changes":{"template":["<%#\nkind: snippet\nname: pxelinux_discovery\n-%>\n<%#\ndiscovery image is based on CentOS/RHEL and therefor it is affected by https://bugzilla.redhat.com/show_bug.cgi?id=1259015.\nIn short, before RHEL 7.2 virtio driver didn't have the new persistent naming scheme, causing interfaces to be named eth0, eth1, etc..\nIf you want to enable the new persistent naming scheme and get inteface names like ens3, add net.ifnames=1 to the APPEND line below.\n-%>\nLABEL discovery\n  MENU LABEL Foreman Discovery Image\n  KERNEL boot/fdi-image/vmlinuz0\n  APPEND initrd=boot/fdi-image/initrd0.img rootflags=loop root=live:/fdi.iso rootfstype=auto ro rd.live.image acpi=force rd.luks=0 rd.md=0 rd.dm=0 rd.lvm=0 rd.bootif=0 rd.neednet=0 nomodeset proxy.url=<%= foreman_server_url %> proxy.type=foreman\n  IPAPPEND 2\n","<%#\nkind: snippet\nname: pxelinux_discovery\n-%>\n<%#\ndiscovery image is based on CentOS/RHEL and therefor it is affected by https://bugzilla.redhat.com/show_bug.cgi?id=1259015.\nIn short, before RHEL 7.2 virtio driver didn't have the new persistent naming scheme, causing interfaces to be named eth0, eth1, etc..\nIf you want to enable the new persistent naming scheme and get inteface names like ens3, add net.ifnames=1 to the APPEND line below.\n-%>\nLABEL discovery\n  MENU LABEL Foreman Discovery Image\n  KERNEL boot/fdi-image-rhel_7-vmlinuz\n  APPEND initrd=boot/fdi-image-rhel_7-img rootflags=loop root=live:/fdi.iso rootfstype=auto ro rd.live.image acpi=force rd.luks=0 rd.md=0 rd.dm=0 rd.lvm=0 rd.bootif=0 rd.neednet=0 nomodeset proxy.url=<%= foreman_server_url %> proxy.type=foreman\n  IPAPPEND 2\n"],"vendor":["Foreman","Satellite"]}},{"user_id":null,"user_type":null,"user_name":null,"version":1,"comment":null,"associated_id":20,"associated_type":"Role","remote_address":null,"associated_name":"Access Insights Viewer","created_at":"2018-03-26 14:09:04 UTC","id":289,"auditable_id":272,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":20,"taxonomy_search":null,"override":false}},{"user_id":null,"user_type":null,"user_name":null,"version":1,"comment":null,"associated_id":21,"associated_type":"Role","remote_address":null,"associated_name":"Access Insights Admin","created_at":"2018-03-26 14:09:04 UTC","id":288,"auditable_id":271,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":21,"taxonomy_search":null,"override":false}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-26 14:09:03 UTC","id":287,"auditable_id":130,"auditable_name":null,"auditable_type":"ProvisioningTemplate","action":"create","audited_changes":{"name":"Katello Atomic Kickstart Default","template":"<%#\nkind: provision\nname: Katello Atomic Kickstart default\n%>\n\nlang <%= @host.params['lang'] || 'en_US.UTF-8' %>\nkeyboard <%= @host.params['keyboard'] || 'us' %>\ntimezone --utc <%= @host.params['time-zone'] || 'UTC' %>\n\n<% subnet = @host.subnet -%>\n<% if subnet.respond_to?(:dhcp_boot_mode?) -%>\n<% dhcp = subnet.dhcp_boot_mode? && !@static -%>\n<% else -%>\n<% dhcp = !@static -%>\n<% end -%>\n\nnetwork --bootproto <%= dhcp ? 'dhcp' : \"static --ip=#{@host.ip} --netmask=#{subnet.mask} --gateway=#{subnet.gateway} --nameserver=#{[subnet.dns_primary, subnet.dns_secondary].select{ |item| item.present? }.join(',')}\" %> --hostname <%= @host %><%= \" --device=#{@host.mac}\" -%>\n\n# Partition table should create /boot and a volume atomicos\n<% if @dynamic -%>\n%include /tmp/diskpart.cfg\n<% else -%>\n<%= @host.diskLayout %>\n<% end -%>\n\nbootloader --timeout=3\ntext\n\n<% if @host.os.name.match /.*fedora.*/i -%>\nostreesetup --nogpg --osname=fedora-atomic --remote=fedora-atomic --url=<%= @host.param_true?('atomic-upstream') ? \"https://dl.fedoraproject.org/pub/fedora/linux/atomic/#{@host.os.major}/\" : \"#{@host.operatingsystem.medium_uri(@host)}/content/repo/\" %> --ref=fedora-atomic/f<%= @host.os.major %>/<%= @host.architecture %>/docker-host\n<% elsif @host.os.name.match /.*centos.*/i -%>\nostreesetup --nogpg --osname=centos-atomic-host --remote=centos-atomic-host --url=<%= @host.param_true?('atomic-upstream') ? \"http://mirror.centos.org/centos/#{@host.os.major}/atomic/#{@host.architecture}/repo/\" : @host.operatingsystem.medium_uri(@host) %> --ref=centos-atomic-host/<%= @host.os.major %>/<%= @host.architecture %>/standard\n<% else -%>\nostreesetup --nogpg --osname=rhel-atomic-host --remote=rhel-atomic-host --url=file:///install/ostree --ref=rhel-atomic-host/<%= @host.os.major %>/<%= @host.architecture %>/standard\n<% end -%>\nservices --disabled cloud-init,cloud-config,cloud-final,cloud-init-local\nrootpw --iscrypted <%= root_pass %>\n\nreboot\n\n%post\n<%= snippet \"subscription_manager_registration\" %>\n<%= snippet('remote_execution_ssh_keys') %>\n(\n# Report success back to Foreman\ncurl -s -o /dev/null --insecure <%= foreman_url('built') %>\n) 2>&1 | tee /mnt/sysimage/root/install.post.log\n\nexit 0\n\n%end\n","snippet":false,"template_kind_id":6,"locked":true,"default":true,"vendor":"Katello","os_family":null,"job_category":"Miscellaneous","provider_type":null,"description_format":null,"execution_timeout_interval":null}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-26 14:09:03 UTC","id":286,"auditable_id":129,"auditable_name":null,"auditable_type":"ProvisioningTemplate","action":"create","audited_changes":{"name":"Katello Kickstart Default Finish","template":"<%#\nkind: finish\nname: Katello Kickstart default finish\noses:\n- CentOS 5\n- CentOS 6\n- CentOS 7\n- RedHat 5\n- RedHat 6\n- RedHat 7\n- Fedora 19\n- Fedora 20\n%>\n<% if @host.subnet.respond_to?(:dhcp_boot_mode?) -%>\n<%= snippet 'kickstart_networking_setup' %>\nservice network restart\n<% end -%>\n\n<%\n  rhel_compatible = @host.operatingsystem.family == 'Redhat' && @host.operatingsystem.name != 'Fedora'\n  os_major = @host.operatingsystem.major.to_i\n  pm_set = @host.puppetmaster.empty? ? false : true\n  puppet_enabled = pm_set || @host.params['force-puppet']\n  salt_enabled = @host.params['salt_master'] ? true : false\n  chef_enabled = @host.respond_to?(:chef_proxy) && @host.chef_proxy\n%>\n\n<%= snippet \"subscription_manager_registration\" %>\n\n<% if @host.respond_to?(:realm) && @host.otp && @host.realm && @host.realm.realm_type == \"FreeIPA\" -%>\n<%= snippet \"freeipa_register\" %>\n<% end -%>\n\n# update local time\necho \"updating system time\"\n/usr/sbin/ntpdate -sub <%= @host.params['ntp-server'] || '0.fedora.pool.ntp.org' %>\n/usr/sbin/hwclock --systohc\n\n<% if @host.info['parameters']['realm'] && @host.realm && @host.realm.realm_type == 'FreeIPA' -%>\n<%= snippet \"freeipa_register\" %>\n<% end -%>\n\n# update all the base packages from the updates repository\nyum -t -y -e 0 update\n\n<%= snippet('remote_execution_ssh_keys') %>\n\n<% if chef_enabled %>\n<%= snippet 'chef_client' %>\n<% end -%>\n\n<% if puppet_enabled %>\n<%= snippet 'puppet_setup' %>\n<% end -%>\n\n<% if salt_enabled %>\n<%= snippet 'saltstack_setup' %>\n<% end -%>\n\nexit 0\n","snippet":false,"template_kind_id":7,"locked":true,"default":true,"vendor":"Katello","os_family":null,"job_category":"Miscellaneous","provider_type":null,"description_format":null,"execution_timeout_interval":null}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-26 14:09:02 UTC","id":285,"auditable_id":128,"auditable_name":null,"auditable_type":"ProvisioningTemplate","action":"create","audited_changes":{"name":"Katello Kickstart Default User Data","template":"<%#\nkind: user_data\nname: Katello Kickstart default user data\noses:\n- CentOS 6\n- CentOS 7\n- Fedora 19\n- Fedora 20\n- Fedora 21\n- Fedora 22\n- Fedora 23\n-%>\n#cloud-config\nhostname: <%= @host.shortname %>\nfqdn: <%= @host %>\nmanage_etc_hosts: true\n\ngroups:\n - admin\n\nusers:\n - default\n - name: admin\n   primary-group: admin\n   groups: users\n   shell: /bin/bash\n   sudo: ['ALL=(ALL) ALL']\n   lock-passwd: false\n   passwd: <%= @host.root_pass %>\n\n<%# Allow user to specify additional SSH key as host paramter -%>\n<% if @host.params['sshkey'].present? || @host.params['remote_execution_ssh_keys'].present? -%>\nssh_authorized_keys:\n<% if @host.params['sshkey'].present? -%>\n  - <%= @host.params['sshkey'] %>\n<% end -%>\n<% if @host.params['remote_execution_ssh_keys'].present? -%>\n<% @host.params['remote_execution_ssh_keys'].each do |key| -%>\n  - <%= key %>\n<% end -%>\n<% end -%>\n<% end -%>\nwrite_files:\n- path: /tmp/foreman-userdata.sh\n  permissions: '0755'\n  content: |\n    #!/bin/bash\n<%= indent 4 do\n      snippet 'subscription_manager_registration'\n    end %>\n<% if @host.info['parameters']['realm'] && @host.realm && @host.realm.realm_type == 'FreeIPA' -%>\n<%= indent 4 do\n      snippet 'freeipa_register'\n    end %>\n<% end -%>\n  <% unless @host.operatingsystem.atomic? -%>\n    # update all the base packages from the updates repository\n    yum -t -y -e 0 update\n  <% end -%>\n<%\n  # safemode renderer does not support unary negation\n  non_atomic = @host.operatingsystem.atomic? ? false : true\n  pm_set = @host.puppetmaster.empty? ? false : true\n  puppet_enabled = non_atomic && (pm_set || @host.params['force-puppet'])\n  salt_enabled = non_atomic && (@host.params['salt_master'] ? true : false)\n  chef_enabled = @host.respond_to?(:chef_proxy) && @host.chef_proxy\n%>\n<% if chef_enabled %>\n<%= indent 4 do\n      snippet 'chef_client'\n    end  %>\n<% end -%>\n\n<% if puppet_enabled %>\n<%= indent 4 do\n      snippet 'puppet_setup'\n    end %>\n<% end -%>\n\n<% if salt_enabled %>\n<%= indent 4 do\n      snippet 'saltstack_setup'\n    end %>\n<% end -%>\nphone_home:\n url: <%= foreman_url('built') %>\n post: []\n tries: 10\nruncmd:\n - [ cloud-init-per, once, foreman-userdata, /tmp/foreman-userdata.sh ]\noutput: {all: '| tee -a /root/install.userdata.log'}\n\n","snippet":false,"template_kind_id":9,"locked":true,"default":true,"vendor":"Katello","os_family":null,"job_category":"Miscellaneous","provider_type":null,"description_format":null,"execution_timeout_interval":null}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-26 14:09:02 UTC","id":284,"auditable_id":127,"auditable_name":null,"auditable_type":"ProvisioningTemplate","action":"create","audited_changes":{"name":"Katello Kickstart Default","template":"<%#\nkind: provision\nname: Katello Kickstart default\noses:\n- CentOS 5\n- CentOS 6\n- CentOS 7\n- RedHat 5\n- RedHat 6\n- RedHat 7\n- Fedora 19\n- Fedora 20\n%>\n<%\n  rhel_compatible = @host.operatingsystem.family == 'Redhat' && @host.operatingsystem.name != 'Fedora'\n  os_major = @host.operatingsystem.major.to_i\n  # safemode renderer does not support unary negation\n  pm_set = @host.puppetmaster.empty? ? false : true\n  puppet_enabled = pm_set || @host.params['force-puppet']\n  salt_enabled = @host.params['salt_master'] ? true : false\n  chef_enabled = @host.respond_to?(:chef_proxy) && @host.chef_proxy\n  section_end = (rhel_compatible && os_major <= 5) ? '' : '%end'\n%>\ninstall\n<%= @mediapath %>\nlang en_US.UTF-8\nselinux --enforcing\nkeyboard us\nskipx\n\n<% subnet = @host.subnet -%>\n<% if subnet.respond_to?(:dhcp_boot_mode?) -%>\n<% dhcp = subnet.dhcp_boot_mode? && !@static -%>\n<% else -%>\n<% dhcp = !@static -%>\n<% end -%>\n\nnetwork --bootproto <%= dhcp ? 'dhcp' : \"static --ip=#{@host.ip} --netmask=#{subnet.mask} --gateway=#{subnet.gateway} --nameserver=#{[subnet.dns_primary, subnet.dns_secondary].select{ |item| item.present? }.join(',')}\" %> --hostname <%= @host %><%= os_major >= 6 ? \" --device=#{@host.mac}\" : '' -%>\n\nrootpw --iscrypted <%= root_pass %>\nfirewall --<%= os_major >= 6 ? 'service=' : '' %>ssh\nauthconfig --useshadow --passalgo=<%= @host.operatingsystem.password_hash || 'sha256' %> --kickstart\ntimezone --utc <%= @host.params['time-zone'] || 'UTC' %>\n\n<% if @host.operatingsystem.name == 'Fedora' and os_major <= 16 -%>\n# Bootloader exception for Fedora 16:\nbootloader --append=\"nofb quiet splash=quiet <%=ks_console%>\" <%= grub_pass %>\npart biosboot --fstype=biosboot --size=1\n<% else -%>\nbootloader --location=mbr --append=\"nofb quiet splash=quiet\" <%= grub_pass %>\n<% end -%>\n\n<% if os_major == 5 -%>\nkey --skip\n<% end -%>\n\n<% if @dynamic -%>\n%include /tmp/diskpart.cfg\n<% else -%>\n<%= @host.diskLayout %>\n<% end -%>\n\ntext\nreboot\n\n%packages --ignoremissing\nyum\ndhclient\nntp\nwget\n@Core\n<%= section_end -%>\n\n<% if @dynamic -%>\n%pre\n<%= @host.diskLayout %>\n<%= section_end -%>\n<% end -%>\n\n%post --nochroot\nexec < /dev/tty3 > /dev/tty3\n#changing to VT 3 so that we can see whats going on....\n/usr/bin/chvt 3\n(\ncp -va /etc/resolv.conf /mnt/sysimage/etc/resolv.conf\n/usr/bin/chvt 1\n) 2>&1 | tee /mnt/sysimage/root/install.postnochroot.log\n<%= section_end -%>\n\n\n%post\nlogger \"Starting anaconda <%= @host %> postinstall\"\nexec < /dev/tty3 > /dev/tty3\n#changing to VT 3 so that we can see whats going on....\n/usr/bin/chvt 3\n(\n<% if subnet.respond_to?(:dhcp_boot_mode?) -%>\n<%= snippet 'kickstart_networking_setup' %>\n<% end -%>\n\n#update local time\necho \"updating system time\"\n/usr/sbin/ntpdate -sub <%= @host.params['ntp-server'] || '0.fedora.pool.ntp.org' %>\n/usr/sbin/hwclock --systohc\n\n<%= snippet \"subscription_manager_registration\" %>\n\n<% if @host.info['parameters']['realm'] && @host.realm && @host.realm.realm_type == 'FreeIPA' -%>\n<%= snippet \"freeipa_register\" %>\n<% end -%>\n\n# update all the base packages from the updates repository\nyum -t -y -e 0 update\n\n<%= snippet('remote_execution_ssh_keys') %>\n\n<% if chef_enabled %>\n<%= snippet 'chef_client' %>\n<% end -%>\n\n<% if puppet_enabled %>\n<%= snippet 'puppet_setup' %>\n<% end -%>\n\n<% if salt_enabled %>\n<%= snippet 'saltstack_setup' %>\n<% end -%>\n\nsync\n\n<% if @provisioning_type == nil || @provisioning_type == 'host' -%>\n# Inform the build system that we are done.\necho \"Informing Foreman that we are built\"\nwget -q -O /dev/null --no-check-certificate <%= foreman_url('built') %>\n<% end -%>\n) 2>&1 | tee /root/install.post.log\nexit 0\n\n<%= section_end -%>\n","snippet":false,"template_kind_id":6,"locked":true,"default":true,"vendor":"Katello","os_family":null,"job_category":"Miscellaneous","provider_type":null,"description_format":null,"execution_timeout_interval":null}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":8,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.218","associated_name":null,"created_at":"2018-03-23 15:18:04 UTC","id":283,"auditable_id":11,"auditable_name":"drone68.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"environment_id":[null,1]}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":2,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.218","associated_name":null,"created_at":"2018-03-23 15:18:04 UTC","id":282,"auditable_id":4,"auditable_name":"RedHat 6.8","auditable_type":"Operatingsystem","action":"update","audited_changes":{"description":[null,"RHEL Server 6.8"],"title":["RedHat 6.8","RHEL Server 6.8"]}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":7,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.218","associated_name":null,"created_at":"2018-03-23 15:18:04 UTC","id":281,"auditable_id":11,"auditable_name":"drone68.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"certname":[null,"drone68.usersys.redhat.com"],"puppet_proxy_id":[null,1],"puppet_ca_proxy_id":[null,1]}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":8,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.218","associated_name":null,"created_at":"2018-03-23 15:18:03 UTC","id":280,"auditable_id":9,"auditable_name":"drone69.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"environment_id":[null,1]}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":7,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.218","associated_name":null,"created_at":"2018-03-23 15:18:03 UTC","id":279,"auditable_id":9,"auditable_name":"drone69.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"certname":[null,"drone69.usersys.redhat.com"],"puppet_proxy_id":[null,1],"puppet_ca_proxy_id":[null,1]}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":8,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.218","associated_name":null,"created_at":"2018-03-23 15:17:36 UTC","id":278,"auditable_id":13,"auditable_name":"drone73.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"environment_id":[null,1]}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":7,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.218","associated_name":null,"created_at":"2018-03-23 15:17:35 UTC","id":277,"auditable_id":13,"auditable_name":"drone73.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"certname":[null,"drone73.usersys.redhat.com"],"puppet_proxy_id":[null,1],"puppet_ca_proxy_id":[null,1]}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":8,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.218","associated_name":null,"created_at":"2018-03-23 15:17:35 UTC","id":276,"auditable_id":12,"auditable_name":"drone72.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"environment_id":[null,1]}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":7,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.218","associated_name":null,"created_at":"2018-03-23 15:17:35 UTC","id":275,"auditable_id":12,"auditable_name":"drone72.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"certname":[null,"drone72.usersys.redhat.com"],"puppet_proxy_id":[null,1],"puppet_ca_proxy_id":[null,1]}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":12,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.218","associated_name":null,"created_at":"2018-03-23 15:16:25 UTC","id":274,"auditable_id":5,"auditable_name":"drone74.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"environment_id":[null,1]}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":11,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.218","associated_name":null,"created_at":"2018-03-23 15:16:25 UTC","id":273,"auditable_id":5,"auditable_name":"drone74.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"certname":[null,"drone74.usersys.redhat.com"],"puppet_proxy_id":[null,1],"puppet_ca_proxy_id":[null,1]}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":8,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.218","associated_name":null,"created_at":"2018-03-23 15:10:37 UTC","id":272,"auditable_id":10,"auditable_name":"drone67.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"environment_id":[null,1]}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":2,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.218","associated_name":null,"created_at":"2018-03-23 15:10:37 UTC","id":271,"auditable_id":3,"auditable_name":"RedHat 6.7","auditable_type":"Operatingsystem","action":"update","audited_changes":{"description":[null,"RHEL Server 6.7"],"title":["RedHat 6.7","RHEL Server 6.7"]}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":7,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.218","associated_name":null,"created_at":"2018-03-23 15:10:37 UTC","id":270,"auditable_id":10,"auditable_name":"drone67.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"certname":[null,"drone67.usersys.redhat.com"],"puppet_proxy_id":[null,1],"puppet_ca_proxy_id":[null,1]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":5,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-22 16:37:39 UTC","id":269,"auditable_id":15,"auditable_name":"joker.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"global_status":[2,1]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":4,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-22 16:37:32 UTC","id":268,"auditable_id":15,"auditable_name":"joker.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"global_status":[0,2]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":5,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-22 16:36:10 UTC","id":267,"auditable_id":16,"auditable_name":"splinter.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"global_status":[2,1]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":4,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-22 16:36:02 UTC","id":266,"auditable_id":16,"auditable_name":"splinter.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"model_id":[null,1],"architecture_id":[null,1],"operatingsystem_id":[null,1]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":3,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-22 16:36:01 UTC","id":265,"auditable_id":16,"auditable_name":"splinter.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"global_status":[0,2]}},{"user_id":3,"user_type":null,"user_name":"admin","version":2,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.85","associated_name":null,"created_at":"2018-03-22 16:35:59 UTC","id":264,"auditable_id":16,"auditable_name":"splinter.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"grub_pass":["$1$ZHPygo7B$vXv5Bc00mJPFzLivzdDN5/","$5$xxh0u+I3$oPC.xT8TUXN1jgMeilFdVc.Md6gR7h7mqTKjrir5vy0"]}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.85","associated_name":null,"created_at":"2018-03-22 16:35:59 UTC","id":263,"auditable_id":16,"auditable_name":"splinter.usersys.redhat.com","auditable_type":"Host","action":"create","audited_changes":{"name":"splinter.usersys.redhat.com","root_pass":"$5$xxh0u+I3$oPC.xT8TUXN1jgMeilFdVc.Md6gR7h7mqTKjrir5vy0","architecture_id":null,"operatingsystem_id":null,"environment_id":null,"ptable_id":null,"medium_id":null,"build":false,"comment":null,"disk":null,"installed_at":null,"model_id":null,"hostgroup_id":null,"owner_id":3,"owner_type":"User","enabled":true,"puppet_ca_proxy_id":null,"managed":false,"use_image":null,"image_file":null,"uuid":null,"compute_resource_id":null,"puppet_proxy_id":null,"certname":null,"image_id":null,"organization_id":1,"location_id":2,"otp":null,"realm_id":null,"compute_profile_id":null,"provision_method":null,"grub_pass":"$1$ZHPygo7B$vXv5Bc00mJPFzLivzdDN5/","discovery_rule_id":null,"content_view_id":null,"lifecycle_environment_id":null,"global_status":0,"pxe_loader":null,"openscap_proxy_id":null}},{"user_id":3,"user_type":null,"user_name":"admin","version":3,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.228","associated_name":null,"created_at":"2018-03-22 16:34:47 UTC","id":262,"auditable_id":14,"auditable_name":"batman.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"comment":[null,""],"owner_id":[null,3],"owner_type":[null,"User"]}},{"user_id":3,"user_type":null,"user_name":"admin","version":3,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.228","associated_name":null,"created_at":"2018-03-22 16:34:19 UTC","id":261,"auditable_id":15,"auditable_name":"joker.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"comment":[null,""],"owner_id":[null,3],"owner_type":[null,"User"]}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":2,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.133","associated_name":null,"created_at":"2018-03-22 15:10:08 UTC","id":260,"auditable_id":15,"auditable_name":"joker.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"organization_id":[null,1],"model_id":[null,1],"architecture_id":[null,1],"operatingsystem_id":[null,1],"environment_id":[null,1],"grub_pass":["$1$V+rTQv5e$Eu/O7ZfzRTfMIzHBn6bOW0","$5$GuMVpPvh$/d5J7XtULmXEm5bSwJhW93utjb5JgsY2FYWV1FnHCND"]}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.133","associated_name":null,"created_at":"2018-03-22 15:10:08 UTC","id":259,"auditable_id":15,"auditable_name":"joker.usersys.redhat.com","auditable_type":"Host","action":"create","audited_changes":{"name":"joker.usersys.redhat.com","root_pass":"$5$GuMVpPvh$/d5J7XtULmXEm5bSwJhW93utjb5JgsY2FYWV1FnHCND","architecture_id":null,"operatingsystem_id":null,"environment_id":null,"ptable_id":null,"medium_id":null,"build":false,"comment":null,"disk":null,"installed_at":null,"model_id":null,"hostgroup_id":null,"owner_id":null,"owner_type":null,"enabled":true,"puppet_ca_proxy_id":2,"managed":false,"use_image":null,"image_file":null,"uuid":null,"compute_resource_id":null,"puppet_proxy_id":2,"certname":"joker.usersys.redhat.com","image_id":null,"organization_id":null,"location_id":null,"otp":null,"realm_id":null,"compute_profile_id":null,"provision_method":null,"grub_pass":"$1$V+rTQv5e$Eu/O7ZfzRTfMIzHBn6bOW0","discovery_rule_id":null,"content_view_id":null,"lifecycle_environment_id":null,"global_status":0,"pxe_loader":null,"openscap_proxy_id":null}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":2,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.218","associated_name":null,"created_at":"2018-03-22 15:09:45 UTC","id":258,"auditable_id":14,"auditable_name":"batman.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"organization_id":[null,1],"model_id":[null,1],"architecture_id":[null,1],"operatingsystem_id":[null,1],"environment_id":[null,1],"grub_pass":["$1$p+6txY9G$0moz6pV9wxIIfNWX9nClY.","$5$mxzS4ooZ$4aLinMa62lC79PP9PvCNltGGwwZIChcUoYrsJv0ufa8"]}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.218","associated_name":null,"created_at":"2018-03-22 15:09:45 UTC","id":257,"auditable_id":14,"auditable_name":"batman.usersys.redhat.com","auditable_type":"Host","action":"create","audited_changes":{"name":"batman.usersys.redhat.com","root_pass":"$5$mxzS4ooZ$4aLinMa62lC79PP9PvCNltGGwwZIChcUoYrsJv0ufa8","architecture_id":null,"operatingsystem_id":null,"environment_id":null,"ptable_id":null,"medium_id":null,"build":false,"comment":null,"disk":null,"installed_at":null,"model_id":null,"hostgroup_id":null,"owner_id":null,"owner_type":null,"enabled":true,"puppet_ca_proxy_id":1,"managed":false,"use_image":null,"image_file":null,"uuid":null,"compute_resource_id":null,"puppet_proxy_id":1,"certname":"batman.usersys.redhat.com","image_id":null,"organization_id":null,"location_id":null,"otp":null,"realm_id":null,"compute_profile_id":null,"provision_method":null,"grub_pass":"$1$p+6txY9G$0moz6pV9wxIIfNWX9nClY.","discovery_rule_id":null,"content_view_id":null,"lifecycle_environment_id":null,"global_status":0,"pxe_loader":null,"openscap_proxy_id":null}},{"user_id":3,"user_type":null,"user_name":"admin","version":5,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-22 14:48:54 UTC","id":256,"auditable_id":4,"auditable_name":"virt-who-nasasysmgmt.usersys.redhat.com-1","auditable_type":"Host","action":"update","audited_changes":{"grub_pass":["$1$1bjZ/kC8$PUMr2PlAU5MFJcLdm7GLt1","$5$/aT3eyMb$KEoEHo.Ed9x35jcRuKsG3alR/J/Mp9iFyXqnBI0pcA2"]}},{"user_id":3,"user_type":null,"user_name":"admin","version":6,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-22 14:48:46 UTC","id":255,"auditable_id":3,"auditable_name":"virt-who-nasasysmgmt2.usersys.redhat.com-1","auditable_type":"Host","action":"update","audited_changes":{"grub_pass":["$1$TeGE9isK$n7H5eJmlwHLCG8vNAmMSs.","$5$jE7pyT98$WV./P0a3OFJbBZiMJgW/plsTSb1geW8yLJIcm7DayT0"]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":5,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-22 14:48:46 UTC","id":254,"auditable_id":3,"auditable_name":"virt-who-nasasysmgmt2.usersys.redhat.com-1","auditable_type":"Host","action":"update","audited_changes":{"grub_pass":["$1$TeGE9isK$n7H5eJmlwHLCG8vNAmMSs.","$5$jE7pyT98$WV./P0a3OFJbBZiMJgW/plsTSb1geW8yLJIcm7DayT0"]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":5,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-22 14:48:24 UTC","id":253,"auditable_id":7,"auditable_name":"virt-who-brigadebox.usersys.redhat.com-1","auditable_type":"Host","action":"update","audited_changes":{"global_status":[1,0],"grub_pass":["$1$7mdF5IbP$6KGeFAvHm4QM9tCI.L/ui.","$5$nGOs0M2h$GDZfkJHJTJrzx/G2mDDoiD0oKQoKYYzSEaN8AnFexO4"]}},{"user_id":3,"user_type":null,"user_name":"admin","version":4,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-22 14:48:23 UTC","id":252,"auditable_id":7,"auditable_name":"virt-who-brigadebox.usersys.redhat.com-1","auditable_type":"Host","action":"update","audited_changes":{"global_status":[1,0],"grub_pass":["$1$7mdF5IbP$6KGeFAvHm4QM9tCI.L/ui.","$5$nGOs0M2h$GDZfkJHJTJrzx/G2mDDoiD0oKQoKYYzSEaN8AnFexO4"]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":4,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-22 14:48:11 UTC","id":251,"auditable_id":4,"auditable_name":"virt-who-nasasysmgmt.usersys.redhat.com-1","auditable_type":"Host","action":"update","audited_changes":{"root_pass":[null,"$5$/aT3eyMb$KEoEHo.Ed9x35jcRuKsG3alR/J/Mp9iFyXqnBI0pcA2"],"grub_pass":["","$1$1bjZ/kC8$PUMr2PlAU5MFJcLdm7GLt1"]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":4,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-22 14:48:11 UTC","id":250,"auditable_id":3,"auditable_name":"virt-who-nasasysmgmt2.usersys.redhat.com-1","auditable_type":"Host","action":"update","audited_changes":{"root_pass":[null,"$5$jE7pyT98$WV./P0a3OFJbBZiMJgW/plsTSb1geW8yLJIcm7DayT0"],"grub_pass":["","$1$TeGE9isK$n7H5eJmlwHLCG8vNAmMSs."]}},{"user_id":3,"user_type":null,"user_name":"admin","version":5,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-22 14:47:39 UTC","id":249,"auditable_id":6,"auditable_name":"virt-who-battalionbox.usersys.redhat.com-1","auditable_type":"Host","action":"update","audited_changes":{"grub_pass":["$1$WGeQyKFP$hR2Reznb28DFtwHTbrRgG0","$5$mumuDJgG$ub7Auh0JYEYebC9rYCZ/7W3lkIRiS8EQzmTCDkOvA21"]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":4,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-22 14:47:16 UTC","id":248,"auditable_id":6,"auditable_name":"virt-who-battalionbox.usersys.redhat.com-1","auditable_type":"Host","action":"update","audited_changes":{"root_pass":[null,"$5$mumuDJgG$ub7Auh0JYEYebC9rYCZ/7W3lkIRiS8EQzmTCDkOvA21"],"grub_pass":["","$1$WGeQyKFP$hR2Reznb28DFtwHTbrRgG0"]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":3,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-22 14:45:51 UTC","id":247,"auditable_id":7,"auditable_name":"virt-who-brigadebox.usersys.redhat.com-1","auditable_type":"Host","action":"update","audited_changes":{"root_pass":[null,"$5$nGOs0M2h$GDZfkJHJTJrzx/G2mDDoiD0oKQoKYYzSEaN8AnFexO4"],"grub_pass":["","$1$7mdF5IbP$6KGeFAvHm4QM9tCI.L/ui."]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":10,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-22 14:45:21 UTC","id":246,"auditable_id":5,"auditable_name":"drone74.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"global_status":[1,2]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":6,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-22 14:45:21 UTC","id":245,"auditable_id":13,"auditable_name":"drone73.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"global_status":[1,2]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":6,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-22 14:45:03 UTC","id":244,"auditable_id":12,"auditable_name":"drone72.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"global_status":[1,2]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":6,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-22 14:44:39 UTC","id":243,"auditable_id":11,"auditable_name":"drone68.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"global_status":[1,2]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":9,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-22 14:44:27 UTC","id":242,"auditable_id":5,"auditable_name":"drone74.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"global_status":[2,1]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":8,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-22 14:44:18 UTC","id":241,"auditable_id":5,"auditable_name":"drone74.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"grub_pass":["$1$qtKR9R6I$a9boP4ang1gQRypwTrLv01","$5$AfKc/yH6$lQoyhbmqeTMe.lEUnlNxNj70Gy10gbXMAKnzQ6c5cC1"]}},{"user_id":3,"user_type":null,"user_name":"admin","version":7,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.58","associated_name":null,"created_at":"2018-03-22 14:44:17 UTC","id":240,"auditable_id":5,"auditable_name":"drone74.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"grub_pass":["$1$4lH6N3iY$khG.KcB6c2sngAWXvjJpJ.","$5$GSMSlsgr$oZ4Z8znsobbb25dDHqaqm7Q1BadVdmLeo8h9J9SX8g6"]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":6,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-22 14:44:16 UTC","id":239,"auditable_id":5,"auditable_name":"drone74.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"root_pass":[null,"$5$AfKc/yH6$lQoyhbmqeTMe.lEUnlNxNj70Gy10gbXMAKnzQ6c5cC1"],"grub_pass":["","$1$qtKR9R6I$a9boP4ang1gQRypwTrLv01"]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":5,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-22 14:44:16 UTC","id":238,"auditable_id":13,"auditable_name":"drone73.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"global_status":[2,1]}},{"user_id":3,"user_type":null,"user_name":"admin","version":6,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.58","associated_name":null,"created_at":"2018-03-22 14:44:15 UTC","id":237,"auditable_id":5,"auditable_name":"drone74.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"root_pass":[null,"$5$GSMSlsgr$oZ4Z8znsobbb25dDHqaqm7Q1BadVdmLeo8h9J9SX8g6"],"grub_pass":["","$1$4lH6N3iY$khG.KcB6c2sngAWXvjJpJ."]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":4,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-22 14:44:07 UTC","id":236,"auditable_id":13,"auditable_name":"drone73.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"model_id":[null,1],"architecture_id":[null,1],"operatingsystem_id":[null,6]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-22 14:44:07 UTC","id":235,"auditable_id":6,"auditable_name":"RedHat 7.3","auditable_type":"Operatingsystem","action":"create","audited_changes":{"major":"7","name":"RedHat","minor":"3","nameindicator":null,"release_name":null,"description":null,"password_hash":"SHA256","title":"RedHat 7.3"}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":3,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-22 14:44:07 UTC","id":234,"auditable_id":13,"auditable_name":"drone73.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"global_status":[0,2]}},{"user_id":3,"user_type":null,"user_name":"admin","version":2,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.39","associated_name":null,"created_at":"2018-03-22 14:44:04 UTC","id":233,"auditable_id":13,"auditable_name":"drone73.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"grub_pass":["$1$vNpkQmyq$A8JDm0WwIo/YiAHpoFQ0Y.","$5$EyE0wsiB$4rv/46.Hs2Q7BmEzUsPtvXeX2QLh0RDQ7311PGuF9s/"]}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.39","associated_name":null,"created_at":"2018-03-22 14:44:04 UTC","id":232,"auditable_id":13,"auditable_name":"drone73.usersys.redhat.com","auditable_type":"Host","action":"create","audited_changes":{"name":"drone73.usersys.redhat.com","root_pass":"$5$EyE0wsiB$4rv/46.Hs2Q7BmEzUsPtvXeX2QLh0RDQ7311PGuF9s/","architecture_id":null,"operatingsystem_id":null,"environment_id":null,"ptable_id":null,"medium_id":null,"build":false,"comment":null,"disk":null,"installed_at":null,"model_id":null,"hostgroup_id":null,"owner_id":3,"owner_type":"User","enabled":true,"puppet_ca_proxy_id":null,"managed":false,"use_image":null,"image_file":null,"uuid":null,"compute_resource_id":null,"puppet_proxy_id":null,"certname":null,"image_id":null,"organization_id":1,"location_id":2,"otp":null,"realm_id":null,"compute_profile_id":null,"provision_method":null,"grub_pass":"$1$vNpkQmyq$A8JDm0WwIo/YiAHpoFQ0Y.","discovery_rule_id":null,"content_view_id":null,"lifecycle_environment_id":null,"global_status":0,"pxe_loader":null,"openscap_proxy_id":null}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":5,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-22 14:44:01 UTC","id":231,"auditable_id":12,"auditable_name":"drone72.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"global_status":[2,1]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":6,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-22 14:43:54 UTC","id":230,"auditable_id":10,"auditable_name":"drone67.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"global_status":[1,2]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":4,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-22 14:43:53 UTC","id":229,"auditable_id":12,"auditable_name":"drone72.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"model_id":[null,1],"architecture_id":[null,1],"operatingsystem_id":[null,5]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-22 14:43:53 UTC","id":228,"auditable_id":5,"auditable_name":"RedHat 7.2","auditable_type":"Operatingsystem","action":"create","audited_changes":{"major":"7","name":"RedHat","minor":"2","nameindicator":null,"release_name":null,"description":null,"password_hash":"SHA256","title":"RedHat 7.2"}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":3,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-22 14:43:52 UTC","id":227,"auditable_id":12,"auditable_name":"drone72.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"global_status":[0,2]}},{"user_id":3,"user_type":null,"user_name":"admin","version":2,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.138","associated_name":null,"created_at":"2018-03-22 14:43:50 UTC","id":226,"auditable_id":12,"auditable_name":"drone72.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"grub_pass":["$1$ndJQzJXM$.QlVriHFJDiBZ//FCkdqj0","$5$25t7xED+$41DfW54xZKwhNKcdSf17r.FgQN2BDyBzgduDf9raOIB"]}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.138","associated_name":null,"created_at":"2018-03-22 14:43:50 UTC","id":225,"auditable_id":12,"auditable_name":"drone72.usersys.redhat.com","auditable_type":"Host","action":"create","audited_changes":{"name":"drone72.usersys.redhat.com","root_pass":"$5$25t7xED+$41DfW54xZKwhNKcdSf17r.FgQN2BDyBzgduDf9raOIB","architecture_id":null,"operatingsystem_id":null,"environment_id":null,"ptable_id":null,"medium_id":null,"build":false,"comment":null,"disk":null,"installed_at":null,"model_id":null,"hostgroup_id":null,"owner_id":3,"owner_type":"User","enabled":true,"puppet_ca_proxy_id":null,"managed":false,"use_image":null,"image_file":null,"uuid":null,"compute_resource_id":null,"puppet_proxy_id":null,"certname":null,"image_id":null,"organization_id":1,"location_id":2,"otp":null,"realm_id":null,"compute_profile_id":null,"provision_method":null,"grub_pass":"$1$ndJQzJXM$.QlVriHFJDiBZ//FCkdqj0","discovery_rule_id":null,"content_view_id":null,"lifecycle_environment_id":null,"global_status":0,"pxe_loader":null,"openscap_proxy_id":null}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":5,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-22 14:43:32 UTC","id":224,"auditable_id":11,"auditable_name":"drone68.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"global_status":[2,1]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":4,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-22 14:43:23 UTC","id":223,"auditable_id":11,"auditable_name":"drone68.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"model_id":[null,1],"architecture_id":[null,1],"operatingsystem_id":[null,4]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-22 14:43:23 UTC","id":222,"auditable_id":4,"auditable_name":"RedHat 6.8","auditable_type":"Operatingsystem","action":"create","audited_changes":{"major":"6","name":"RedHat","minor":"8","nameindicator":null,"release_name":null,"description":null,"password_hash":"SHA256","title":"RedHat 6.8"}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":3,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-22 14:43:22 UTC","id":221,"auditable_id":11,"auditable_name":"drone68.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"global_status":[0,2]}},{"user_id":3,"user_type":null,"user_name":"admin","version":2,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.187","associated_name":null,"created_at":"2018-03-22 14:43:20 UTC","id":220,"auditable_id":11,"auditable_name":"drone68.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"grub_pass":["$1$olwPpX8U$0t6VPNyd9AR2Z6gDw1XZv0","$5$TWyAvyUf$sHDgu9yaTWo7//81vIrnJrBoXBwxPvGz7hpro2zECl6"]}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.187","associated_name":null,"created_at":"2018-03-22 14:43:20 UTC","id":219,"auditable_id":11,"auditable_name":"drone68.usersys.redhat.com","auditable_type":"Host","action":"create","audited_changes":{"name":"drone68.usersys.redhat.com","root_pass":"$5$TWyAvyUf$sHDgu9yaTWo7//81vIrnJrBoXBwxPvGz7hpro2zECl6","architecture_id":null,"operatingsystem_id":null,"environment_id":null,"ptable_id":null,"medium_id":null,"build":false,"comment":null,"disk":null,"installed_at":null,"model_id":null,"hostgroup_id":null,"owner_id":3,"owner_type":"User","enabled":true,"puppet_ca_proxy_id":null,"managed":false,"use_image":null,"image_file":null,"uuid":null,"compute_resource_id":null,"puppet_proxy_id":null,"certname":null,"image_id":null,"organization_id":1,"location_id":2,"otp":null,"realm_id":null,"compute_profile_id":null,"provision_method":null,"grub_pass":"$1$olwPpX8U$0t6VPNyd9AR2Z6gDw1XZv0","discovery_rule_id":null,"content_view_id":null,"lifecycle_environment_id":null,"global_status":0,"pxe_loader":null,"openscap_proxy_id":null}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":5,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-22 14:42:48 UTC","id":218,"auditable_id":10,"auditable_name":"drone67.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"global_status":[2,1]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":4,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-22 14:42:37 UTC","id":217,"auditable_id":10,"auditable_name":"drone67.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"model_id":[null,1],"architecture_id":[null,1],"operatingsystem_id":[null,3]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-22 14:42:37 UTC","id":216,"auditable_id":3,"auditable_name":"RedHat 6.7","auditable_type":"Operatingsystem","action":"create","audited_changes":{"major":"6","name":"RedHat","minor":"7","nameindicator":null,"release_name":null,"description":null,"password_hash":"SHA256","title":"RedHat 6.7"}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":3,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-22 14:42:36 UTC","id":215,"auditable_id":10,"auditable_name":"drone67.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"global_status":[0,2]}},{"user_id":3,"user_type":null,"user_name":"admin","version":2,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.106","associated_name":null,"created_at":"2018-03-22 14:42:34 UTC","id":214,"auditable_id":10,"auditable_name":"drone67.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"grub_pass":["$1$t/OvfGKA$JgFI0CQgGce6unzcnlwnZ0","$5$ODrub2Xc$8FMtScUKmPed/9zCsjpv/g/6X9vlwNpOHDyqfh5cUW9"]}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.106","associated_name":null,"created_at":"2018-03-22 14:42:34 UTC","id":213,"auditable_id":10,"auditable_name":"drone67.usersys.redhat.com","auditable_type":"Host","action":"create","audited_changes":{"name":"drone67.usersys.redhat.com","root_pass":"$5$ODrub2Xc$8FMtScUKmPed/9zCsjpv/g/6X9vlwNpOHDyqfh5cUW9","architecture_id":null,"operatingsystem_id":null,"environment_id":null,"ptable_id":null,"medium_id":null,"build":false,"comment":null,"disk":null,"installed_at":null,"model_id":null,"hostgroup_id":null,"owner_id":3,"owner_type":"User","enabled":true,"puppet_ca_proxy_id":null,"managed":false,"use_image":null,"image_file":null,"uuid":null,"compute_resource_id":null,"puppet_proxy_id":null,"certname":null,"image_id":null,"organization_id":1,"location_id":2,"otp":null,"realm_id":null,"compute_profile_id":null,"provision_method":null,"grub_pass":"$1$t/OvfGKA$JgFI0CQgGce6unzcnlwnZ0","discovery_rule_id":null,"content_view_id":null,"lifecycle_environment_id":null,"global_status":0,"pxe_loader":null,"openscap_proxy_id":null}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":6,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-22 14:41:42 UTC","id":212,"auditable_id":9,"auditable_name":"drone69.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"global_status":[1,2]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":5,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-22 14:41:40 UTC","id":211,"auditable_id":9,"auditable_name":"drone69.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"global_status":[2,1]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":4,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-22 14:41:32 UTC","id":210,"auditable_id":9,"auditable_name":"drone69.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"model_id":[null,1],"architecture_id":[null,1],"operatingsystem_id":[null,2]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":3,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-22 14:41:32 UTC","id":209,"auditable_id":9,"auditable_name":"drone69.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"global_status":[0,2]}},{"user_id":3,"user_type":null,"user_name":"admin","version":2,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.127","associated_name":null,"created_at":"2018-03-22 14:41:30 UTC","id":208,"auditable_id":9,"auditable_name":"drone69.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"grub_pass":["$1$w6ZyPGsM$lmmNifYxPyr695q2sHiiA1","$5$EGk1j1kP$URrylC9yXfpgg3awuvl8vKrzzaJItWkgGy6u4F4BUAC"]}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.127","associated_name":null,"created_at":"2018-03-22 14:41:29 UTC","id":207,"auditable_id":9,"auditable_name":"drone69.usersys.redhat.com","auditable_type":"Host","action":"create","audited_changes":{"name":"drone69.usersys.redhat.com","root_pass":"$5$EGk1j1kP$URrylC9yXfpgg3awuvl8vKrzzaJItWkgGy6u4F4BUAC","architecture_id":null,"operatingsystem_id":null,"environment_id":null,"ptable_id":null,"medium_id":null,"build":false,"comment":null,"disk":null,"installed_at":null,"model_id":null,"hostgroup_id":null,"owner_id":3,"owner_type":"User","enabled":true,"puppet_ca_proxy_id":null,"managed":false,"use_image":null,"image_file":null,"uuid":null,"compute_resource_id":null,"puppet_proxy_id":null,"certname":null,"image_id":null,"organization_id":1,"location_id":2,"otp":null,"realm_id":null,"compute_profile_id":null,"provision_method":null,"grub_pass":"$1$w6ZyPGsM$lmmNifYxPyr695q2sHiiA1","discovery_rule_id":null,"content_view_id":null,"lifecycle_environment_id":null,"global_status":0,"pxe_loader":null,"openscap_proxy_id":null}},{"user_id":3,"user_type":null,"user_name":"admin","version":5,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.228","associated_name":null,"created_at":"2018-03-22 14:41:16 UTC","id":206,"auditable_id":2,"auditable_name":"joker.usersys.redhat.com","auditable_type":"Host","action":"destroy","audited_changes":{"name":"joker.usersys.redhat.com","root_pass":"$5$NDUmSi8X$/X3xbcs.AgcSkEPwdKt.hBKWNEfK5f1h0MFk/XmDLj5","architecture_id":1,"operatingsystem_id":1,"environment_id":1,"ptable_id":null,"medium_id":null,"build":false,"comment":null,"disk":null,"installed_at":null,"model_id":1,"hostgroup_id":null,"owner_id":null,"owner_type":null,"enabled":true,"puppet_ca_proxy_id":2,"managed":false,"use_image":null,"image_file":null,"uuid":null,"compute_resource_id":null,"puppet_proxy_id":2,"certname":"joker.usersys.redhat.com","image_id":null,"organization_id":1,"location_id":null,"otp":null,"realm_id":null,"compute_profile_id":null,"provision_method":null,"grub_pass":"$5$NDUmSi8X$/X3xbcs.AgcSkEPwdKt.hBKWNEfK5f1h0MFk/XmDLj5","discovery_rule_id":null,"content_view_id":null,"lifecycle_environment_id":null,"global_status":0,"pxe_loader":null,"openscap_proxy_id":null}},{"user_id":3,"user_type":null,"user_name":"admin","version":5,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.228","associated_name":null,"created_at":"2018-03-22 14:41:01 UTC","id":205,"auditable_id":1,"auditable_name":"batman.usersys.redhat.com","auditable_type":"Host","action":"destroy","audited_changes":{"name":"batman.usersys.redhat.com","root_pass":"$5$pOei/waB$F404a6LvlEDoQR7nssqhtTVddfGTeOHAbsapvc4n7u5","architecture_id":1,"operatingsystem_id":1,"environment_id":1,"ptable_id":null,"medium_id":null,"build":false,"comment":null,"disk":null,"installed_at":null,"model_id":1,"hostgroup_id":null,"owner_id":null,"owner_type":null,"enabled":true,"puppet_ca_proxy_id":1,"managed":false,"use_image":null,"image_file":null,"uuid":null,"compute_resource_id":null,"puppet_proxy_id":1,"certname":"batman.usersys.redhat.com","image_id":null,"organization_id":1,"location_id":null,"otp":null,"realm_id":null,"compute_profile_id":null,"provision_method":null,"grub_pass":"$5$pOei/waB$F404a6LvlEDoQR7nssqhtTVddfGTeOHAbsapvc4n7u5","discovery_rule_id":null,"content_view_id":null,"lifecycle_environment_id":null,"global_status":0,"pxe_loader":null,"openscap_proxy_id":null}},{"user_id":3,"user_type":null,"user_name":"admin","version":10,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.228","associated_name":null,"created_at":"2018-03-22 14:40:23 UTC","id":204,"auditable_id":8,"auditable_name":"dhcp153-127.rdu.redhat.com","auditable_type":"Host","action":"destroy","audited_changes":{"name":"dhcp153-127.rdu.redhat.com","root_pass":"$5$2yjaYv3s$9C1Y1PPzqiWIg3O7YHE0931uWqxXK.gRw4/W6rjbyR0","architecture_id":1,"operatingsystem_id":2,"environment_id":null,"ptable_id":null,"medium_id":null,"build":false,"comment":null,"disk":null,"installed_at":null,"model_id":1,"hostgroup_id":null,"owner_id":3,"owner_type":"User","enabled":true,"puppet_ca_proxy_id":null,"managed":false,"use_image":null,"image_file":null,"uuid":null,"compute_resource_id":null,"puppet_proxy_id":null,"certname":null,"image_id":null,"organization_id":1,"location_id":2,"otp":null,"realm_id":null,"compute_profile_id":null,"provision_method":null,"grub_pass":"$5$2yjaYv3s$9C1Y1PPzqiWIg3O7YHE0931uWqxXK.gRw4/W6rjbyR0","discovery_rule_id":null,"content_view_id":null,"lifecycle_environment_id":null,"global_status":2,"pxe_loader":null,"openscap_proxy_id":null,"content_facet_attributes":{"id":2,"host_id":8,"uuid":null,"content_view_id":1,"lifecycle_environment_id":1,"kickstart_repository_id":null,"content_source_id":null,"installable_security_errata_count":9,"installable_enhancement_errata_count":2,"installable_bugfix_errata_count":12,"applicable_rpm_count":46,"upgradable_rpm_count":46}}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":4,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.133","associated_name":null,"created_at":"2018-03-22 14:40:08 UTC","id":203,"auditable_id":2,"auditable_name":"joker.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"organization_id":[null,1],"grub_pass":["$1$V6VcDj3q$JfpVarOhFGZ5qwGdCOtd31","$5$NDUmSi8X$/X3xbcs.AgcSkEPwdKt.hBKWNEfK5f1h0MFk/XmDLj5"]}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":3,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.133","associated_name":null,"created_at":"2018-03-22 14:40:08 UTC","id":202,"auditable_id":2,"auditable_name":"joker.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"root_pass":[null,"$5$NDUmSi8X$/X3xbcs.AgcSkEPwdKt.hBKWNEfK5f1h0MFk/XmDLj5"],"grub_pass":["","$1$V6VcDj3q$JfpVarOhFGZ5qwGdCOtd31"]}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":4,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.218","associated_name":null,"created_at":"2018-03-22 14:39:45 UTC","id":201,"auditable_id":1,"auditable_name":"batman.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"organization_id":[null,1],"grub_pass":["$1$enQXuvCD$bzVkgo9pup9ARYB/URxAJ.","$5$pOei/waB$F404a6LvlEDoQR7nssqhtTVddfGTeOHAbsapvc4n7u5"]}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":3,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.218","associated_name":null,"created_at":"2018-03-22 14:39:45 UTC","id":200,"auditable_id":1,"auditable_name":"batman.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"root_pass":[null,"$5$pOei/waB$F404a6LvlEDoQR7nssqhtTVddfGTeOHAbsapvc4n7u5"],"grub_pass":["","$1$enQXuvCD$bzVkgo9pup9ARYB/URxAJ."]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":9,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-22 14:39:10 UTC","id":199,"auditable_id":8,"auditable_name":"dhcp153-127.rdu.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"global_status":[1,2]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":8,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-22 14:39:10 UTC","id":198,"auditable_id":8,"auditable_name":"dhcp153-127.rdu.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"global_status":[2,1]}},{"user_id":3,"user_type":null,"user_name":"admin","version":7,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.127","associated_name":null,"created_at":"2018-03-22 14:38:59 UTC","id":197,"auditable_id":8,"auditable_name":"dhcp153-127.rdu.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"grub_pass":["$1$Dl1vgMak$fq60Td4HNLNShPgZ5N1vN0","$5$2yjaYv3s$9C1Y1PPzqiWIg3O7YHE0931uWqxXK.gRw4/W6rjbyR0"]}},{"user_id":3,"user_type":null,"user_name":"admin","version":6,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.127","associated_name":null,"created_at":"2018-03-22 14:38:59 UTC","id":196,"auditable_id":8,"auditable_name":"dhcp153-127.rdu.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"root_pass":[null,"$5$2yjaYv3s$9C1Y1PPzqiWIg3O7YHE0931uWqxXK.gRw4/W6rjbyR0"],"grub_pass":["","$1$Dl1vgMak$fq60Td4HNLNShPgZ5N1vN0"]}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.228","associated_name":null,"created_at":"2018-03-22 14:37:56 UTC","id":195,"auditable_id":68,"auditable_name":"register_hostname_fact","auditable_type":"Setting","action":"update","audited_changes":{"value":[null,"--- network.hostname-override\n..."]}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.228","associated_name":null,"created_at":"2018-03-22 14:36:24 UTC","id":194,"auditable_id":164,"auditable_name":"default_organization","auditable_type":"Setting","action":"update","audited_changes":{"value":[null,"--- Default Organization\n..."]}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.228","associated_name":null,"created_at":"2018-03-22 14:35:36 UTC","id":193,"auditable_id":119,"auditable_name":"root_pass","auditable_type":"Setting","action":"update","audited_changes":{"value":[null,"--- redhat\n..."]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":5,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-22 14:31:19 UTC","id":192,"auditable_id":8,"auditable_name":"dhcp153-127.rdu.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"global_status":[1,2]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":4,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-22 14:31:01 UTC","id":191,"auditable_id":8,"auditable_name":"dhcp153-127.rdu.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"global_status":[2,1]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":3,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-22 14:30:53 UTC","id":190,"auditable_id":8,"auditable_name":"dhcp153-127.rdu.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"model_id":[null,1],"architecture_id":[null,1],"operatingsystem_id":[null,2]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-22 14:30:53 UTC","id":189,"auditable_id":2,"auditable_name":"RedHat 6.9","auditable_type":"Operatingsystem","action":"create","audited_changes":{"major":"6","name":"RedHat","minor":"9","nameindicator":null,"release_name":null,"description":null,"password_hash":"SHA256","title":"RedHat 6.9"}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":2,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-22 14:30:52 UTC","id":188,"auditable_id":8,"auditable_name":"dhcp153-127.rdu.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"global_status":[0,2]}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.127","associated_name":null,"created_at":"2018-03-22 14:30:49 UTC","id":187,"auditable_id":8,"auditable_name":"dhcp153-127.rdu.redhat.com","auditable_type":"Host","action":"create","audited_changes":{"name":"dhcp153-127.rdu.redhat.com","root_pass":null,"architecture_id":null,"operatingsystem_id":null,"environment_id":null,"ptable_id":null,"medium_id":null,"build":false,"comment":null,"disk":null,"installed_at":null,"model_id":null,"hostgroup_id":null,"owner_id":3,"owner_type":"User","enabled":true,"puppet_ca_proxy_id":null,"managed":false,"use_image":null,"image_file":null,"uuid":null,"compute_resource_id":null,"puppet_proxy_id":null,"certname":null,"image_id":null,"organization_id":1,"location_id":2,"otp":null,"realm_id":null,"compute_profile_id":null,"provision_method":null,"grub_pass":"","discovery_rule_id":null,"content_view_id":null,"lifecycle_environment_id":null,"global_status":0,"pxe_loader":null,"openscap_proxy_id":null}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":3,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-09 19:19:32 UTC","id":186,"auditable_id":6,"auditable_name":"virt-who-battalionbox.usersys.redhat.com-1","auditable_type":"Host","action":"update","audited_changes":{"global_status":[1,0]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":2,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-09 19:16:30 UTC","id":185,"auditable_id":7,"auditable_name":"virt-who-brigadebox.usersys.redhat.com-1","auditable_type":"Host","action":"update","audited_changes":{"global_status":[0,1]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-09 19:16:29 UTC","id":184,"auditable_id":7,"auditable_name":"virt-who-brigadebox.usersys.redhat.com-1","auditable_type":"Host","action":"create","audited_changes":{"name":"virt-who-brigadebox.usersys.redhat.com-1","root_pass":null,"architecture_id":null,"operatingsystem_id":null,"environment_id":null,"ptable_id":null,"medium_id":null,"build":false,"comment":null,"disk":null,"installed_at":null,"model_id":null,"hostgroup_id":null,"owner_id":1,"owner_type":"User","enabled":false,"puppet_ca_proxy_id":null,"managed":false,"use_image":null,"image_file":null,"uuid":null,"compute_resource_id":null,"puppet_proxy_id":null,"certname":null,"image_id":null,"organization_id":1,"location_id":2,"otp":null,"realm_id":null,"compute_profile_id":null,"provision_method":null,"grub_pass":"","discovery_rule_id":null,"content_view_id":null,"lifecycle_environment_id":null,"global_status":0,"pxe_loader":null,"openscap_proxy_id":null}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":2,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-09 19:16:28 UTC","id":183,"auditable_id":6,"auditable_name":"virt-who-battalionbox.usersys.redhat.com-1","auditable_type":"Host","action":"update","audited_changes":{"global_status":[0,1]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-09 19:16:28 UTC","id":182,"auditable_id":6,"auditable_name":"virt-who-battalionbox.usersys.redhat.com-1","auditable_type":"Host","action":"create","audited_changes":{"name":"virt-who-battalionbox.usersys.redhat.com-1","root_pass":null,"architecture_id":null,"operatingsystem_id":null,"environment_id":null,"ptable_id":null,"medium_id":null,"build":false,"comment":null,"disk":null,"installed_at":null,"model_id":null,"hostgroup_id":null,"owner_id":1,"owner_type":"User","enabled":false,"puppet_ca_proxy_id":null,"managed":false,"use_image":null,"image_file":null,"uuid":null,"compute_resource_id":null,"puppet_proxy_id":null,"certname":null,"image_id":null,"organization_id":1,"location_id":2,"otp":null,"realm_id":null,"compute_profile_id":null,"provision_method":null,"grub_pass":"","discovery_rule_id":null,"content_view_id":null,"lifecycle_environment_id":null,"global_status":0,"pxe_loader":null,"openscap_proxy_id":null}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":5,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-09 17:47:01 UTC","id":181,"auditable_id":5,"auditable_name":"drone74.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"global_status":[1,2]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":4,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-09 17:45:59 UTC","id":180,"auditable_id":5,"auditable_name":"drone74.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"global_status":[2,1]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":3,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-09 17:44:23 UTC","id":179,"auditable_id":5,"auditable_name":"drone74.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"model_id":[null,1],"architecture_id":[null,1],"operatingsystem_id":[null,1]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":2,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-09 17:44:19 UTC","id":178,"auditable_id":5,"auditable_name":"drone74.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"global_status":[0,2]}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.58","associated_name":null,"created_at":"2018-03-09 17:44:16 UTC","id":177,"auditable_id":5,"auditable_name":"drone74.usersys.redhat.com","auditable_type":"Host","action":"create","audited_changes":{"name":"drone74.usersys.redhat.com","root_pass":null,"architecture_id":null,"operatingsystem_id":null,"environment_id":null,"ptable_id":null,"medium_id":null,"build":false,"comment":null,"disk":null,"installed_at":null,"model_id":null,"hostgroup_id":null,"owner_id":3,"owner_type":"User","enabled":true,"puppet_ca_proxy_id":null,"managed":false,"use_image":null,"image_file":null,"uuid":null,"compute_resource_id":null,"puppet_proxy_id":null,"certname":null,"image_id":null,"organization_id":1,"location_id":2,"otp":null,"realm_id":null,"compute_profile_id":null,"provision_method":null,"grub_pass":"","discovery_rule_id":null,"content_view_id":null,"lifecycle_environment_id":null,"global_status":0,"pxe_loader":null,"openscap_proxy_id":null}},{"user_id":3,"user_type":null,"user_name":"admin","version":3,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-02 23:44:01 UTC","id":176,"auditable_id":4,"auditable_name":"virt-who-nasasysmgmt.usersys.redhat.com-1","auditable_type":"Host","action":"update","audited_changes":{"global_status":[1,0]}},{"user_id":3,"user_type":null,"user_name":"admin","version":3,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-02 23:43:09 UTC","id":175,"auditable_id":3,"auditable_name":"virt-who-nasasysmgmt2.usersys.redhat.com-1","auditable_type":"Host","action":"update","audited_changes":{"global_status":[1,0]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":3,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-02 23:43:09 UTC","id":174,"auditable_id":3,"auditable_name":"virt-who-nasasysmgmt2.usersys.redhat.com-1","auditable_type":"Host","action":"update","audited_changes":{"global_status":[1,0]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":2,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-02 23:30:51 UTC","id":173,"auditable_id":4,"auditable_name":"virt-who-nasasysmgmt.usersys.redhat.com-1","auditable_type":"Host","action":"update","audited_changes":{"global_status":[0,1]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-02 23:30:50 UTC","id":172,"auditable_id":4,"auditable_name":"virt-who-nasasysmgmt.usersys.redhat.com-1","auditable_type":"Host","action":"create","audited_changes":{"name":"virt-who-nasasysmgmt.usersys.redhat.com-1","root_pass":null,"architecture_id":null,"operatingsystem_id":null,"environment_id":null,"ptable_id":null,"medium_id":null,"build":false,"comment":null,"disk":null,"installed_at":null,"model_id":null,"hostgroup_id":null,"owner_id":1,"owner_type":"User","enabled":false,"puppet_ca_proxy_id":null,"managed":false,"use_image":null,"image_file":null,"uuid":null,"compute_resource_id":null,"puppet_proxy_id":null,"certname":null,"image_id":null,"organization_id":1,"location_id":2,"otp":null,"realm_id":null,"compute_profile_id":null,"provision_method":null,"grub_pass":"","discovery_rule_id":null,"content_view_id":null,"lifecycle_environment_id":null,"global_status":0,"pxe_loader":null,"openscap_proxy_id":null}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":2,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-02 23:30:49 UTC","id":171,"auditable_id":3,"auditable_name":"virt-who-nasasysmgmt2.usersys.redhat.com-1","auditable_type":"Host","action":"update","audited_changes":{"global_status":[0,1]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-02 23:30:49 UTC","id":170,"auditable_id":3,"auditable_name":"virt-who-nasasysmgmt2.usersys.redhat.com-1","auditable_type":"Host","action":"create","audited_changes":{"name":"virt-who-nasasysmgmt2.usersys.redhat.com-1","root_pass":null,"architecture_id":null,"operatingsystem_id":null,"environment_id":null,"ptable_id":null,"medium_id":null,"build":false,"comment":null,"disk":null,"installed_at":null,"model_id":null,"hostgroup_id":null,"owner_id":1,"owner_type":"User","enabled":false,"puppet_ca_proxy_id":null,"managed":false,"use_image":null,"image_file":null,"uuid":null,"compute_resource_id":null,"puppet_proxy_id":null,"certname":null,"image_id":null,"organization_id":1,"location_id":2,"otp":null,"realm_id":null,"compute_profile_id":null,"provision_method":null,"grub_pass":"","discovery_rule_id":null,"content_view_id":null,"lifecycle_environment_id":null,"global_status":0,"pxe_loader":null,"openscap_proxy_id":null}},{"user_id":3,"user_type":null,"user_name":"admin","version":4,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.10.121.101","associated_name":null,"created_at":"2018-03-02 23:30:19 UTC","id":169,"auditable_id":3,"auditable_name":"Admin User","auditable_type":"User","action":"update","audited_changes":{"password_changed":[true,null]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":3,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-02 23:29:50 UTC","id":168,"auditable_id":3,"auditable_name":"Admin User","auditable_type":"User","action":"update","audited_changes":{"password_changed":[true,null]}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":2,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.133","associated_name":null,"created_at":"2018-03-02 19:10:13 UTC","id":167,"auditable_id":2,"auditable_name":"joker.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"model_id":[null,1],"architecture_id":[null,1],"operatingsystem_id":[null,1],"environment_id":[null,1]}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.133","associated_name":null,"created_at":"2018-03-02 19:10:13 UTC","id":166,"auditable_id":2,"auditable_name":"joker.usersys.redhat.com","auditable_type":"Host","action":"create","audited_changes":{"name":"joker.usersys.redhat.com","root_pass":null,"architecture_id":null,"operatingsystem_id":null,"environment_id":null,"ptable_id":null,"medium_id":null,"build":false,"comment":null,"disk":null,"installed_at":null,"model_id":null,"hostgroup_id":null,"owner_id":null,"owner_type":null,"enabled":true,"puppet_ca_proxy_id":2,"managed":false,"use_image":null,"image_file":null,"uuid":null,"compute_resource_id":null,"puppet_proxy_id":2,"certname":"joker.usersys.redhat.com","image_id":null,"organization_id":null,"location_id":null,"otp":null,"realm_id":null,"compute_profile_id":null,"provision_method":null,"grub_pass":"","discovery_rule_id":null,"content_view_id":null,"lifecycle_environment_id":null,"global_status":0,"pxe_loader":null,"openscap_proxy_id":null}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.228","associated_name":null,"created_at":"2018-03-02 18:59:09 UTC","id":165,"auditable_id":102,"auditable_name":"idle_timeout","auditable_type":"Setting","action":"update","audited_changes":{"value":[null,"--- 999\n..."]}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.133","associated_name":null,"created_at":"2018-03-02 18:57:44 UTC","id":164,"auditable_id":2,"auditable_name":"joker.usersys.redhat.com","auditable_type":"SmartProxy","action":"create","audited_changes":{"name":"joker.usersys.redhat.com","url":"https://joker.usersys.redhat.com:9090","pubkey":null,"expired_logs":"0","puppet_path":null,"download_policy":"on_demand"}},{"user_id":3,"user_type":null,"user_name":"admin","version":2,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.228","associated_name":null,"created_at":"2018-03-02 18:31:20 UTC","id":163,"auditable_id":3,"auditable_name":"Admin User","auditable_type":"User","action":"update","audited_changes":{"default_organization_id":[null,1]}},{"user_id":3,"user_type":null,"user_name":"admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.228","associated_name":null,"created_at":"2018-03-02 18:24:19 UTC","id":162,"auditable_id":3,"auditable_name":"Admin User","auditable_type":"User","action":"update","audited_changes":{"description":[null,""],"timezone":[null,""]}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":2,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.218","associated_name":null,"created_at":"2018-03-02 18:14:48 UTC","id":161,"auditable_id":1,"auditable_name":"batman.usersys.redhat.com","auditable_type":"Host","action":"update","audited_changes":{"model_id":[null,1],"architecture_id":[null,1],"operatingsystem_id":[null,1],"environment_id":[null,1]}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.218","associated_name":null,"created_at":"2018-03-02 18:14:48 UTC","id":160,"auditable_id":1,"auditable_name":"usersys.redhat.com","auditable_type":"Domain","action":"create","audited_changes":{"name":"usersys.redhat.com","fullname":null,"dns_id":null}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.218","associated_name":null,"created_at":"2018-03-02 18:14:48 UTC","id":159,"auditable_id":1,"auditable_name":"RedHat 7.4","auditable_type":"Operatingsystem","action":"create","audited_changes":{"major":"7","name":"RedHat","minor":"4","nameindicator":null,"release_name":null,"description":null,"password_hash":"SHA256","title":"RedHat 7.4"}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.218","associated_name":null,"created_at":"2018-03-02 18:14:47 UTC","id":158,"auditable_id":1,"auditable_name":"batman.usersys.redhat.com","auditable_type":"Host","action":"create","audited_changes":{"name":"batman.usersys.redhat.com","root_pass":null,"architecture_id":null,"operatingsystem_id":null,"environment_id":null,"ptable_id":null,"medium_id":null,"build":false,"comment":null,"disk":null,"installed_at":null,"model_id":null,"hostgroup_id":null,"owner_id":null,"owner_type":null,"enabled":true,"puppet_ca_proxy_id":1,"managed":false,"use_image":null,"image_file":null,"uuid":null,"compute_resource_id":null,"puppet_proxy_id":1,"certname":"batman.usersys.redhat.com","image_id":null,"organization_id":null,"location_id":null,"otp":null,"realm_id":null,"compute_profile_id":null,"provision_method":null,"grub_pass":"","discovery_rule_id":null,"content_view_id":null,"lifecycle_environment_id":null,"global_status":0,"pxe_loader":null,"openscap_proxy_id":null}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":3,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.218","associated_name":null,"created_at":"2018-03-02 18:14:38 UTC","id":157,"auditable_id":1,"auditable_name":"batman.usersys.redhat.com","auditable_type":"SmartProxy","action":"update","audited_changes":{"puppet_path":[null,"/etc/puppet/environments"]}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":2,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.218","associated_name":null,"created_at":"2018-03-02 18:14:38 UTC","id":156,"auditable_id":1,"auditable_name":"batman.usersys.redhat.com","auditable_type":"SmartProxy","action":"update","audited_changes":{"pubkey":[null,"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDF7UBNrRsA5ZbgisZOtmMjyUJKG9OQpdwXzOjWs+CXh/xuFxBJt2u2mn5szl3G0fws45Kl0rqQr6FR3g6Gqf1XsGLdcou7rKTLWHlKWmssysj0sNoLzYKXAf0NZzkvXs9rZdKMByowlu93jhVz3YH8TcuCw8xVgy3PHTJ+a8pUdr+AtuLim9sQP7Naua5+QIgBVf4LZxFlZol3e9UhdWqW+MIlsVviMHsXtYR7P6eLHpzs3XJwOe4pc8KmayBLsJeXGasJ8568K8B3PQx04uqBGfKO47jzVcjiXrHne41UoyRAuQE8oXP+k+fNKMjkQkd7Vl88HX72deheKdzvty37 foreman-proxy@batman.usersys.redhat.com"]}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":"10.13.153.218","associated_name":null,"created_at":"2018-03-02 18:14:37 UTC","id":155,"auditable_id":1,"auditable_name":"batman.usersys.redhat.com","auditable_type":"SmartProxy","action":"create","audited_changes":{"name":"batman.usersys.redhat.com","url":"https://batman.usersys.redhat.com:9090","pubkey":null,"expired_logs":"0","puppet_path":null,"download_policy":"on_demand"}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":2,"comment":null,"associated_id":21,"associated_type":"Role","remote_address":null,"associated_name":"Access Insights Admin","created_at":"2018-03-02 18:10:12 UTC","id":154,"auditable_id":269,"auditable_name":"view_hosts","auditable_type":"Filter","action":"destroy","audited_changes":{"search":null,"role_id":21,"taxonomy_search":null,"override":false}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":2,"comment":null,"associated_id":20,"associated_type":"Role","remote_address":null,"associated_name":"Access Insights Viewer","created_at":"2018-03-02 18:10:12 UTC","id":153,"auditable_id":270,"auditable_name":"view_hosts","auditable_type":"Filter","action":"destroy","audited_changes":{"search":null,"role_id":20,"taxonomy_search":null,"override":false}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":2,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-02 18:09:52 UTC","id":152,"auditable_id":123,"auditable_name":"Katello Kickstart Default User Data","auditable_type":"ProvisioningTemplate","action":"destroy","audited_changes":{"name":"Katello Kickstart Default User Data","template":"<%#\nkind: user_data\nname: Katello Kickstart default user data\noses:\n- CentOS 6\n- CentOS 7\n- Fedora 19\n- Fedora 20\n- Fedora 21\n- Fedora 22\n- Fedora 23\n-%>\n#cloud-config\nhostname: <%= @host.shortname %>\nfqdn: <%= @host %>\nmanage_etc_hosts: true\n\ngroups:\n - admin\n\nusers:\n - default\n - name: admin\n   primary-group: admin\n   groups: users\n   shell: /bin/bash\n   sudo: ['ALL=(ALL) ALL']\n   lock-passwd: false\n   passwd: <%= @host.root_pass %>\n\n<%# Allow user to specify additional SSH key as host paramter -%>\n<% if @host.params['sshkey'].present? || @host.params['remote_execution_ssh_keys'].present? -%>\nssh_authorized_keys:\n<% if @host.params['sshkey'].present? -%>\n  - <%= @host.params['sshkey'] %>\n<% end -%>\n<% if @host.params['remote_execution_ssh_keys'].present? -%>\n<% @host.params['remote_execution_ssh_keys'].each do |key| -%>\n  - <%= key %>\n<% end -%>\n<% end -%>\n<% end -%>\nwrite_files:\n- path: /tmp/foreman-userdata.sh\n  permissions: '0755'\n  content: |\n    #!/bin/bash\n<%= indent 4 do\n      snippet 'subscription_manager_registration'\n    end %>\n<% if @host.info['parameters']['realm'] && @host.realm && @host.realm.realm_type == 'FreeIPA' -%>\n<%= indent 4 do\n      snippet 'freeipa_register'\n    end %>\n<% end -%>\n  <% unless @host.operatingsystem.atomic? -%>\n    # update all the base packages from the updates repository\n    yum -t -y -e 0 update\n  <% end -%>\n<%\n  # safemode renderer does not support unary negation\n  non_atomic = @host.operatingsystem.atomic? ? false : true\n  pm_set = @host.puppetmaster.empty? ? false : true\n  puppet_enabled = non_atomic && (pm_set || @host.params['force-puppet'])\n  salt_enabled = non_atomic && (@host.params['salt_master'] ? true : false)\n  chef_enabled = @host.respond_to?(:chef_proxy) && @host.chef_proxy\n%>\n<% if chef_enabled %>\n<%= indent 4 do\n      snippet 'chef_client'\n    end  %>\n<% end -%>\n\n<% if puppet_enabled %>\n<%= indent 4 do\n      snippet 'puppet_setup'\n    end %>\n<% end -%>\n\n<% if salt_enabled %>\n<%= indent 4 do\n      snippet 'saltstack_setup'\n    end %>\n<% end -%>\nphone_home:\n url: <%= foreman_url('built') %>\n post: []\n tries: 10\nruncmd:\n - [ cloud-init-per, once, foreman-userdata, /tmp/foreman-userdata.sh ]\noutput: {all: '| tee -a /root/install.userdata.log'}\n\n","snippet":false,"template_kind_id":9,"locked":true,"default":true,"vendor":"Katello","os_family":null,"job_category":"Miscellaneous","provider_type":null,"description_format":null,"execution_timeout_interval":null}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":2,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-02 18:09:52 UTC","id":151,"auditable_id":124,"auditable_name":"Katello Kickstart Default Finish","auditable_type":"ProvisioningTemplate","action":"destroy","audited_changes":{"name":"Katello Kickstart Default Finish","template":"<%#\nkind: finish\nname: Katello Kickstart default finish\noses:\n- CentOS 5\n- CentOS 6\n- CentOS 7\n- RedHat 5\n- RedHat 6\n- RedHat 7\n- Fedora 19\n- Fedora 20\n%>\n<% if @host.subnet.respond_to?(:dhcp_boot_mode?) -%>\n<%= snippet 'kickstart_networking_setup' %>\nservice network restart\n<% end -%>\n\n<%\n  rhel_compatible = @host.operatingsystem.family == 'Redhat' && @host.operatingsystem.name != 'Fedora'\n  os_major = @host.operatingsystem.major.to_i\n  pm_set = @host.puppetmaster.empty? ? false : true\n  puppet_enabled = pm_set || @host.params['force-puppet']\n  salt_enabled = @host.params['salt_master'] ? true : false\n  chef_enabled = @host.respond_to?(:chef_proxy) && @host.chef_proxy\n%>\n\n<%= snippet \"subscription_manager_registration\" %>\n\n<% if @host.respond_to?(:realm) && @host.otp && @host.realm && @host.realm.realm_type == \"FreeIPA\" -%>\n<%= snippet \"freeipa_register\" %>\n<% end -%>\n\n# update local time\necho \"updating system time\"\n/usr/sbin/ntpdate -sub <%= @host.params['ntp-server'] || '0.fedora.pool.ntp.org' %>\n/usr/sbin/hwclock --systohc\n\n<% if @host.info['parameters']['realm'] && @host.realm && @host.realm.realm_type == 'FreeIPA' -%>\n<%= snippet \"freeipa_register\" %>\n<% end -%>\n\n# update all the base packages from the updates repository\nyum -t -y -e 0 update\n\n<%= snippet('remote_execution_ssh_keys') %>\n\n<% if chef_enabled %>\n<%= snippet 'chef_client' %>\n<% end -%>\n\n<% if puppet_enabled %>\n<%= snippet 'puppet_setup' %>\n<% end -%>\n\n<% if salt_enabled %>\n<%= snippet 'saltstack_setup' %>\n<% end -%>\n\nexit 0\n","snippet":false,"template_kind_id":7,"locked":true,"default":true,"vendor":"Katello","os_family":null,"job_category":"Miscellaneous","provider_type":null,"description_format":null,"execution_timeout_interval":null}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":2,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-02 18:09:52 UTC","id":150,"auditable_id":122,"auditable_name":"Katello Kickstart Default","auditable_type":"ProvisioningTemplate","action":"destroy","audited_changes":{"name":"Katello Kickstart Default","template":"<%#\nkind: provision\nname: Katello Kickstart default\noses:\n- CentOS 5\n- CentOS 6\n- CentOS 7\n- RedHat 5\n- RedHat 6\n- RedHat 7\n- Fedora 19\n- Fedora 20\n%>\n<%\n  rhel_compatible = @host.operatingsystem.family == 'Redhat' && @host.operatingsystem.name != 'Fedora'\n  os_major = @host.operatingsystem.major.to_i\n  # safemode renderer does not support unary negation\n  pm_set = @host.puppetmaster.empty? ? false : true\n  puppet_enabled = pm_set || @host.params['force-puppet']\n  salt_enabled = @host.params['salt_master'] ? true : false\n  chef_enabled = @host.respond_to?(:chef_proxy) && @host.chef_proxy\n  section_end = (rhel_compatible && os_major <= 5) ? '' : '%end'\n%>\ninstall\n<%= @mediapath %>\nlang en_US.UTF-8\nselinux --enforcing\nkeyboard us\nskipx\n\n<% subnet = @host.subnet -%>\n<% if subnet.respond_to?(:dhcp_boot_mode?) -%>\n<% dhcp = subnet.dhcp_boot_mode? && !@static -%>\n<% else -%>\n<% dhcp = !@static -%>\n<% end -%>\n\nnetwork --bootproto <%= dhcp ? 'dhcp' : \"static --ip=#{@host.ip} --netmask=#{subnet.mask} --gateway=#{subnet.gateway} --nameserver=#{[subnet.dns_primary, subnet.dns_secondary].select{ |item| item.present? }.join(',')}\" %> --hostname <%= @host %><%= os_major >= 6 ? \" --device=#{@host.mac}\" : '' -%>\n\nrootpw --iscrypted <%= root_pass %>\nfirewall --<%= os_major >= 6 ? 'service=' : '' %>ssh\nauthconfig --useshadow --passalgo=<%= @host.operatingsystem.password_hash || 'sha256' %> --kickstart\ntimezone --utc <%= @host.params['time-zone'] || 'UTC' %>\n\n<% if @host.operatingsystem.name == 'Fedora' and os_major <= 16 -%>\n# Bootloader exception for Fedora 16:\nbootloader --append=\"nofb quiet splash=quiet <%=ks_console%>\" <%= grub_pass %>\npart biosboot --fstype=biosboot --size=1\n<% else -%>\nbootloader --location=mbr --append=\"nofb quiet splash=quiet\" <%= grub_pass %>\n<% end -%>\n\n<% if os_major == 5 -%>\nkey --skip\n<% end -%>\n\n<% if @dynamic -%>\n%include /tmp/diskpart.cfg\n<% else -%>\n<%= @host.diskLayout %>\n<% end -%>\n\ntext\nreboot\n\n%packages --ignoremissing\nyum\ndhclient\nntp\nwget\n@Core\n<%= section_end -%>\n\n<% if @dynamic -%>\n%pre\n<%= @host.diskLayout %>\n<%= section_end -%>\n<% end -%>\n\n%post --nochroot\nexec < /dev/tty3 > /dev/tty3\n#changing to VT 3 so that we can see whats going on....\n/usr/bin/chvt 3\n(\ncp -va /etc/resolv.conf /mnt/sysimage/etc/resolv.conf\n/usr/bin/chvt 1\n) 2>&1 | tee /mnt/sysimage/root/install.postnochroot.log\n<%= section_end -%>\n\n\n%post\nlogger \"Starting anaconda <%= @host %> postinstall\"\nexec < /dev/tty3 > /dev/tty3\n#changing to VT 3 so that we can see whats going on....\n/usr/bin/chvt 3\n(\n<% if subnet.respond_to?(:dhcp_boot_mode?) -%>\n<%= snippet 'kickstart_networking_setup' %>\n<% end -%>\n\n#update local time\necho \"updating system time\"\n/usr/sbin/ntpdate -sub <%= @host.params['ntp-server'] || '0.fedora.pool.ntp.org' %>\n/usr/sbin/hwclock --systohc\n\n<%= snippet \"subscription_manager_registration\" %>\n\n<% if @host.info['parameters']['realm'] && @host.realm && @host.realm.realm_type == 'FreeIPA' -%>\n<%= snippet \"freeipa_register\" %>\n<% end -%>\n\n# update all the base packages from the updates repository\nyum -t -y -e 0 update\n\n<%= snippet('remote_execution_ssh_keys') %>\n\n<% if chef_enabled %>\n<%= snippet 'chef_client' %>\n<% end -%>\n\n<% if puppet_enabled %>\n<%= snippet 'puppet_setup' %>\n<% end -%>\n\n<% if salt_enabled %>\n<%= snippet 'saltstack_setup' %>\n<% end -%>\n\nsync\n\n<% if @provisioning_type == nil || @provisioning_type == 'host' -%>\n# Inform the build system that we are done.\necho \"Informing Foreman that we are built\"\nwget -q -O /dev/null --no-check-certificate <%= foreman_url('built') %>\n<% end -%>\n) 2>&1 | tee /root/install.post.log\nexit 0\n\n<%= section_end -%>\n","snippet":false,"template_kind_id":6,"locked":true,"default":true,"vendor":"Katello","os_family":null,"job_category":"Miscellaneous","provider_type":null,"description_format":null,"execution_timeout_interval":null}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":2,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-02 18:09:51 UTC","id":149,"auditable_id":125,"auditable_name":"Katello Atomic Kickstart Default","auditable_type":"ProvisioningTemplate","action":"destroy","audited_changes":{"name":"Katello Atomic Kickstart Default","template":"<%#\nkind: provision\nname: Katello Atomic Kickstart default\n%>\n\nlang <%= @host.params['lang'] || 'en_US.UTF-8' %>\nkeyboard <%= @host.params['keyboard'] || 'us' %>\ntimezone --utc <%= @host.params['time-zone'] || 'UTC' %>\n\n<% subnet = @host.subnet -%>\n<% if subnet.respond_to?(:dhcp_boot_mode?) -%>\n<% dhcp = subnet.dhcp_boot_mode? && !@static -%>\n<% else -%>\n<% dhcp = !@static -%>\n<% end -%>\n\nnetwork --bootproto <%= dhcp ? 'dhcp' : \"static --ip=#{@host.ip} --netmask=#{subnet.mask} --gateway=#{subnet.gateway} --nameserver=#{[subnet.dns_primary, subnet.dns_secondary].select{ |item| item.present? }.join(',')}\" %> --hostname <%= @host %><%= \" --device=#{@host.mac}\" -%>\n\n# Partition table should create /boot and a volume atomicos\n<% if @dynamic -%>\n%include /tmp/diskpart.cfg\n<% else -%>\n<%= @host.diskLayout %>\n<% end -%>\n\nbootloader --timeout=3\ntext\n\n<% if @host.os.name.match /.*fedora.*/i -%>\nostreesetup --nogpg --osname=fedora-atomic --remote=fedora-atomic --url=<%= @host.param_true?('atomic-upstream') ? \"https://dl.fedoraproject.org/pub/fedora/linux/atomic/#{@host.os.major}/\" : \"#{@host.operatingsystem.medium_uri(@host)}/content/repo/\" %> --ref=fedora-atomic/f<%= @host.os.major %>/<%= @host.architecture %>/docker-host\n<% elsif @host.os.name.match /.*centos.*/i -%>\nostreesetup --nogpg --osname=centos-atomic-host --remote=centos-atomic-host --url=<%= @host.param_true?('atomic-upstream') ? \"http://mirror.centos.org/centos/#{@host.os.major}/atomic/#{@host.architecture}/repo/\" : @host.operatingsystem.medium_uri(@host) %> --ref=centos-atomic-host/<%= @host.os.major %>/<%= @host.architecture %>/standard\n<% else -%>\nostreesetup --nogpg --osname=rhel-atomic-host --remote=rhel-atomic-host --url=file:///install/ostree --ref=rhel-atomic-host/<%= @host.os.major %>/<%= @host.architecture %>/standard\n<% end -%>\nservices --disabled cloud-init,cloud-config,cloud-final,cloud-init-local\nrootpw --iscrypted <%= root_pass %>\n\nreboot\n\n%post\n<%= snippet \"subscription_manager_registration\" %>\n<%= snippet('remote_execution_ssh_keys') %>\n(\n# Report success back to Foreman\ncurl -s -o /dev/null --insecure <%= foreman_url('built') %>\n) 2>&1 | tee /mnt/sysimage/root/install.post.log\n\nexit 0\n\n%end\n","snippet":false,"template_kind_id":6,"locked":true,"default":true,"vendor":"Katello","os_family":null,"job_category":"Miscellaneous","provider_type":null,"description_format":null,"execution_timeout_interval":null}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":2,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-02 18:09:51 UTC","id":148,"auditable_id":73,"auditable_name":"pxegrub2_discovery","auditable_type":"ProvisioningTemplate","action":"update","audited_changes":{"template":["<%#\nkind: snippet\nname: pxegrub2_discovery\n-%>\n<%#\ndiscovery image is based on CentOS/RHEL and therefor it is affected by https://bugzilla.redhat.com/show_bug.cgi?id=1259015.\nIn short, before RHEL 7.2 virtio driver didn't have the new persistent naming scheme, causing interfaces to be named eth0, eth1, etc..\nIf you want to enable the new persistent naming scheme and get inteface names like ens3, add net.ifnames=1 to the linuxefi line below.\n-%>\nmenuentry 'Foreman Discovery Image' {\n  linuxefi boot/fdi-image/vmlinuz0 rootflags=loop root=live:/fdi.iso rootfstype=auto ro rd.live.image acpi=force rd.luks=0 rd.md=0 rd.dm=0 rd.lvm=0 rd.bootif=0 rd.neednet=0 nomodeset proxy.url=<%= foreman_server_url %> proxy.type=foreman BOOTIF=01-$net_default_mac\n  initrdefi boot/fdi-image/initrd0.img\n}\n","<%#\nkind: snippet\nname: pxegrub2_discovery\n-%>\n<%#\nRHEL 7 virtio driver does not have persistent naming scheme, causing interfaces\nto be named eth0, eth1, etc.. If you want to enable the new persistent naming\nscheme and get inteface names like ens3, add net.ifnames=1 to the linuxefi line\nbelow. This will not be fixed until RHEL8 due to prevent breaking changes for\nexisting systems. See RHBZ#1259015 for more details.\n\nAnother bug in RHEL 7.4 is affecting $net_default_mac with a trailing slash, in\nthe global template we have a regexp module creating corrected variable $mac\nwhich is used here. See RHBZ#1487107 for more info.\n-%>\nmenuentry 'Foreman Discovery Image' {\n  linuxefi boot/fdi-image-rhel_7-vmlinuz rootflags=loop root=live:/fdi.iso rootfstype=auto ro rd.live.image acpi=force rd.luks=0 rd.md=0 rd.dm=0 rd.lvm=0 rd.bootif=0 rd.neednet=0 nomodeset proxy.url=<%= foreman_server_url %> proxy.type=foreman BOOTIF=01-$mac\n  initrdefi boot/fdi-image-rhel_7-img\n}\n"],"vendor":["Foreman","Satellite"]}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":2,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-02 18:09:50 UTC","id":147,"auditable_id":75,"auditable_name":"pxegrub_discovery","auditable_type":"ProvisioningTemplate","action":"update","audited_changes":{"template":["<%#\nkind: snippet\nname: pxegrub_discovery\n-%>\n<%#\ndiscovery image is based on CentOS/RHEL and therefor it is affected by https://bugzilla.redhat.com/show_bug.cgi?id=1259015.\nIn short, before RHEL 7.2 virtio driver didn't have the new persistent naming scheme, causing interfaces to be named eth0, eth1, etc..\nIf you want to enable the new persistent naming scheme and get inteface names like ens3, add net.ifnames=1 to the kernel line below.\n-%>\n# http://projects.theforeman.org/issues/15997\ntitle Foreman Discovery Image - not supported with Grub 1.x\n  kernel boot/fdi-image/vmlinuz0 rootflags=loop root=live:/fdi.iso rootfstype=auto ro rd.live.image acpi=force rd.luks=0 rd.md=0 rd.dm=0 rd.lvm=0 rd.bootif=0 rd.neednet=0 nomodeset proxy.url=<%= foreman_server_url %> proxy.type=foreman BOOTIF=01-$net_default_mac\n  initrd boot/fdi-image/initrd0.img\n","<%#\nkind: snippet\nname: pxegrub_discovery\n-%>\n<%#\ndiscovery image is based on CentOS/RHEL and therefor it is affected by https://bugzilla.redhat.com/show_bug.cgi?id=1259015.\nIn short, before RHEL 7.2 virtio driver didn't have the new persistent naming scheme, causing interfaces to be named eth0, eth1, etc..\nIf you want to enable the new persistent naming scheme and get inteface names like ens3, add net.ifnames=1 to the kernel line below.\n-%>\n# http://projects.theforeman.org/issues/15997\ntitle Foreman Discovery Image - not supported with Grub 1.x\n  kernel boot/fdi-image-rhel_7-vmlinuz rootflags=loop root=live:/fdi.iso rootfstype=auto ro rd.live.image acpi=force rd.luks=0 rd.md=0 rd.dm=0 rd.lvm=0 rd.bootif=0 rd.neednet=0 nomodeset proxy.url=<%= foreman_server_url %> proxy.type=foreman BOOTIF=01-$net_default_mac\n  initrd boot/fdi-image-rhel_7-img\n"],"vendor":["Foreman","Satellite"]}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":2,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-02 18:09:50 UTC","id":146,"auditable_id":77,"auditable_name":"pxelinux_discovery","auditable_type":"ProvisioningTemplate","action":"update","audited_changes":{"template":["<%#\nkind: snippet\nname: pxelinux_discovery\n-%>\n<%#\ndiscovery image is based on CentOS/RHEL and therefor it is affected by https://bugzilla.redhat.com/show_bug.cgi?id=1259015.\nIn short, before RHEL 7.2 virtio driver didn't have the new persistent naming scheme, causing interfaces to be named eth0, eth1, etc..\nIf you want to enable the new persistent naming scheme and get inteface names like ens3, add net.ifnames=1 to the APPEND line below.\n-%>\nLABEL discovery\n  MENU LABEL Foreman Discovery Image\n  KERNEL boot/fdi-image/vmlinuz0\n  APPEND initrd=boot/fdi-image/initrd0.img rootflags=loop root=live:/fdi.iso rootfstype=auto ro rd.live.image acpi=force rd.luks=0 rd.md=0 rd.dm=0 rd.lvm=0 rd.bootif=0 rd.neednet=0 nomodeset proxy.url=<%= foreman_server_url %> proxy.type=foreman\n  IPAPPEND 2\n","<%#\nkind: snippet\nname: pxelinux_discovery\n-%>\n<%#\ndiscovery image is based on CentOS/RHEL and therefor it is affected by https://bugzilla.redhat.com/show_bug.cgi?id=1259015.\nIn short, before RHEL 7.2 virtio driver didn't have the new persistent naming scheme, causing interfaces to be named eth0, eth1, etc..\nIf you want to enable the new persistent naming scheme and get inteface names like ens3, add net.ifnames=1 to the APPEND line below.\n-%>\nLABEL discovery\n  MENU LABEL Foreman Discovery Image\n  KERNEL boot/fdi-image-rhel_7-vmlinuz\n  APPEND initrd=boot/fdi-image-rhel_7-img rootflags=loop root=live:/fdi.iso rootfstype=auto ro rd.live.image acpi=force rd.luks=0 rd.md=0 rd.dm=0 rd.lvm=0 rd.bootif=0 rd.neednet=0 nomodeset proxy.url=<%= foreman_server_url %> proxy.type=foreman\n  IPAPPEND 2\n"],"vendor":["Foreman","Satellite"]}},{"user_id":null,"user_type":null,"user_name":null,"version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-02 18:09:50 UTC","id":145,"auditable_id":14,"auditable_name":"Discovery Manager","auditable_type":"Role","action":"update","audited_changes":{"origin":["foreman_discovery","discovery"],"description":[null,"Discovery plugin built-in role"]}},{"user_id":null,"user_type":null,"user_name":null,"version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-02 18:09:50 UTC","id":144,"auditable_id":13,"auditable_name":"Discovery Reader","auditable_type":"Role","action":"update","audited_changes":{"origin":["foreman_discovery","discovery"],"description":[null,"Discovery plugin built-in role"]}},{"user_id":null,"user_type":null,"user_name":null,"version":1,"comment":null,"associated_id":20,"associated_type":"Role","remote_address":null,"associated_name":"Access Insights Viewer","created_at":"2018-03-02 18:09:50 UTC","id":143,"auditable_id":270,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":20,"taxonomy_search":null,"override":false}},{"user_id":null,"user_type":null,"user_name":null,"version":1,"comment":null,"associated_id":21,"associated_type":"Role","remote_address":null,"associated_name":"Access Insights Admin","created_at":"2018-03-02 18:09:49 UTC","id":142,"auditable_id":269,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":21,"taxonomy_search":null,"override":false}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-02 18:09:48 UTC","id":141,"auditable_id":125,"auditable_name":null,"auditable_type":"ProvisioningTemplate","action":"create","audited_changes":{"name":"Katello Atomic Kickstart Default","template":"<%#\nkind: provision\nname: Katello Atomic Kickstart default\n%>\n\nlang <%= @host.params['lang'] || 'en_US.UTF-8' %>\nkeyboard <%= @host.params['keyboard'] || 'us' %>\ntimezone --utc <%= @host.params['time-zone'] || 'UTC' %>\n\n<% subnet = @host.subnet -%>\n<% if subnet.respond_to?(:dhcp_boot_mode?) -%>\n<% dhcp = subnet.dhcp_boot_mode? && !@static -%>\n<% else -%>\n<% dhcp = !@static -%>\n<% end -%>\n\nnetwork --bootproto <%= dhcp ? 'dhcp' : \"static --ip=#{@host.ip} --netmask=#{subnet.mask} --gateway=#{subnet.gateway} --nameserver=#{[subnet.dns_primary, subnet.dns_secondary].select{ |item| item.present? }.join(',')}\" %> --hostname <%= @host %><%= \" --device=#{@host.mac}\" -%>\n\n# Partition table should create /boot and a volume atomicos\n<% if @dynamic -%>\n%include /tmp/diskpart.cfg\n<% else -%>\n<%= @host.diskLayout %>\n<% end -%>\n\nbootloader --timeout=3\ntext\n\n<% if @host.os.name.match /.*fedora.*/i -%>\nostreesetup --nogpg --osname=fedora-atomic --remote=fedora-atomic --url=<%= @host.param_true?('atomic-upstream') ? \"https://dl.fedoraproject.org/pub/fedora/linux/atomic/#{@host.os.major}/\" : \"#{@host.operatingsystem.medium_uri(@host)}/content/repo/\" %> --ref=fedora-atomic/f<%= @host.os.major %>/<%= @host.architecture %>/docker-host\n<% elsif @host.os.name.match /.*centos.*/i -%>\nostreesetup --nogpg --osname=centos-atomic-host --remote=centos-atomic-host --url=<%= @host.param_true?('atomic-upstream') ? \"http://mirror.centos.org/centos/#{@host.os.major}/atomic/#{@host.architecture}/repo/\" : @host.operatingsystem.medium_uri(@host) %> --ref=centos-atomic-host/<%= @host.os.major %>/<%= @host.architecture %>/standard\n<% else -%>\nostreesetup --nogpg --osname=rhel-atomic-host --remote=rhel-atomic-host --url=file:///install/ostree --ref=rhel-atomic-host/<%= @host.os.major %>/<%= @host.architecture %>/standard\n<% end -%>\nservices --disabled cloud-init,cloud-config,cloud-final,cloud-init-local\nrootpw --iscrypted <%= root_pass %>\n\nreboot\n\n%post\n<%= snippet \"subscription_manager_registration\" %>\n<%= snippet('remote_execution_ssh_keys') %>\n(\n# Report success back to Foreman\ncurl -s -o /dev/null --insecure <%= foreman_url('built') %>\n) 2>&1 | tee /mnt/sysimage/root/install.post.log\n\nexit 0\n\n%end\n","snippet":false,"template_kind_id":6,"locked":true,"default":true,"vendor":"Katello","os_family":null,"job_category":"Miscellaneous","provider_type":null,"description_format":null,"execution_timeout_interval":null}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-02 18:09:48 UTC","id":140,"auditable_id":124,"auditable_name":null,"auditable_type":"ProvisioningTemplate","action":"create","audited_changes":{"name":"Katello Kickstart Default Finish","template":"<%#\nkind: finish\nname: Katello Kickstart default finish\noses:\n- CentOS 5\n- CentOS 6\n- CentOS 7\n- RedHat 5\n- RedHat 6\n- RedHat 7\n- Fedora 19\n- Fedora 20\n%>\n<% if @host.subnet.respond_to?(:dhcp_boot_mode?) -%>\n<%= snippet 'kickstart_networking_setup' %>\nservice network restart\n<% end -%>\n\n<%\n  rhel_compatible = @host.operatingsystem.family == 'Redhat' && @host.operatingsystem.name != 'Fedora'\n  os_major = @host.operatingsystem.major.to_i\n  pm_set = @host.puppetmaster.empty? ? false : true\n  puppet_enabled = pm_set || @host.params['force-puppet']\n  salt_enabled = @host.params['salt_master'] ? true : false\n  chef_enabled = @host.respond_to?(:chef_proxy) && @host.chef_proxy\n%>\n\n<%= snippet \"subscription_manager_registration\" %>\n\n<% if @host.respond_to?(:realm) && @host.otp && @host.realm && @host.realm.realm_type == \"FreeIPA\" -%>\n<%= snippet \"freeipa_register\" %>\n<% end -%>\n\n# update local time\necho \"updating system time\"\n/usr/sbin/ntpdate -sub <%= @host.params['ntp-server'] || '0.fedora.pool.ntp.org' %>\n/usr/sbin/hwclock --systohc\n\n<% if @host.info['parameters']['realm'] && @host.realm && @host.realm.realm_type == 'FreeIPA' -%>\n<%= snippet \"freeipa_register\" %>\n<% end -%>\n\n# update all the base packages from the updates repository\nyum -t -y -e 0 update\n\n<%= snippet('remote_execution_ssh_keys') %>\n\n<% if chef_enabled %>\n<%= snippet 'chef_client' %>\n<% end -%>\n\n<% if puppet_enabled %>\n<%= snippet 'puppet_setup' %>\n<% end -%>\n\n<% if salt_enabled %>\n<%= snippet 'saltstack_setup' %>\n<% end -%>\n\nexit 0\n","snippet":false,"template_kind_id":7,"locked":true,"default":true,"vendor":"Katello","os_family":null,"job_category":"Miscellaneous","provider_type":null,"description_format":null,"execution_timeout_interval":null}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-02 18:09:48 UTC","id":139,"auditable_id":123,"auditable_name":null,"auditable_type":"ProvisioningTemplate","action":"create","audited_changes":{"name":"Katello Kickstart Default User Data","template":"<%#\nkind: user_data\nname: Katello Kickstart default user data\noses:\n- CentOS 6\n- CentOS 7\n- Fedora 19\n- Fedora 20\n- Fedora 21\n- Fedora 22\n- Fedora 23\n-%>\n#cloud-config\nhostname: <%= @host.shortname %>\nfqdn: <%= @host %>\nmanage_etc_hosts: true\n\ngroups:\n - admin\n\nusers:\n - default\n - name: admin\n   primary-group: admin\n   groups: users\n   shell: /bin/bash\n   sudo: ['ALL=(ALL) ALL']\n   lock-passwd: false\n   passwd: <%= @host.root_pass %>\n\n<%# Allow user to specify additional SSH key as host paramter -%>\n<% if @host.params['sshkey'].present? || @host.params['remote_execution_ssh_keys'].present? -%>\nssh_authorized_keys:\n<% if @host.params['sshkey'].present? -%>\n  - <%= @host.params['sshkey'] %>\n<% end -%>\n<% if @host.params['remote_execution_ssh_keys'].present? -%>\n<% @host.params['remote_execution_ssh_keys'].each do |key| -%>\n  - <%= key %>\n<% end -%>\n<% end -%>\n<% end -%>\nwrite_files:\n- path: /tmp/foreman-userdata.sh\n  permissions: '0755'\n  content: |\n    #!/bin/bash\n<%= indent 4 do\n      snippet 'subscription_manager_registration'\n    end %>\n<% if @host.info['parameters']['realm'] && @host.realm && @host.realm.realm_type == 'FreeIPA' -%>\n<%= indent 4 do\n      snippet 'freeipa_register'\n    end %>\n<% end -%>\n  <% unless @host.operatingsystem.atomic? -%>\n    # update all the base packages from the updates repository\n    yum -t -y -e 0 update\n  <% end -%>\n<%\n  # safemode renderer does not support unary negation\n  non_atomic = @host.operatingsystem.atomic? ? false : true\n  pm_set = @host.puppetmaster.empty? ? false : true\n  puppet_enabled = non_atomic && (pm_set || @host.params['force-puppet'])\n  salt_enabled = non_atomic && (@host.params['salt_master'] ? true : false)\n  chef_enabled = @host.respond_to?(:chef_proxy) && @host.chef_proxy\n%>\n<% if chef_enabled %>\n<%= indent 4 do\n      snippet 'chef_client'\n    end  %>\n<% end -%>\n\n<% if puppet_enabled %>\n<%= indent 4 do\n      snippet 'puppet_setup'\n    end %>\n<% end -%>\n\n<% if salt_enabled %>\n<%= indent 4 do\n      snippet 'saltstack_setup'\n    end %>\n<% end -%>\nphone_home:\n url: <%= foreman_url('built') %>\n post: []\n tries: 10\nruncmd:\n - [ cloud-init-per, once, foreman-userdata, /tmp/foreman-userdata.sh ]\noutput: {all: '| tee -a /root/install.userdata.log'}\n\n","snippet":false,"template_kind_id":9,"locked":true,"default":true,"vendor":"Katello","os_family":null,"job_category":"Miscellaneous","provider_type":null,"description_format":null,"execution_timeout_interval":null}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-02 18:09:48 UTC","id":138,"auditable_id":122,"auditable_name":null,"auditable_type":"ProvisioningTemplate","action":"create","audited_changes":{"name":"Katello Kickstart Default","template":"<%#\nkind: provision\nname: Katello Kickstart default\noses:\n- CentOS 5\n- CentOS 6\n- CentOS 7\n- RedHat 5\n- RedHat 6\n- RedHat 7\n- Fedora 19\n- Fedora 20\n%>\n<%\n  rhel_compatible = @host.operatingsystem.family == 'Redhat' && @host.operatingsystem.name != 'Fedora'\n  os_major = @host.operatingsystem.major.to_i\n  # safemode renderer does not support unary negation\n  pm_set = @host.puppetmaster.empty? ? false : true\n  puppet_enabled = pm_set || @host.params['force-puppet']\n  salt_enabled = @host.params['salt_master'] ? true : false\n  chef_enabled = @host.respond_to?(:chef_proxy) && @host.chef_proxy\n  section_end = (rhel_compatible && os_major <= 5) ? '' : '%end'\n%>\ninstall\n<%= @mediapath %>\nlang en_US.UTF-8\nselinux --enforcing\nkeyboard us\nskipx\n\n<% subnet = @host.subnet -%>\n<% if subnet.respond_to?(:dhcp_boot_mode?) -%>\n<% dhcp = subnet.dhcp_boot_mode? && !@static -%>\n<% else -%>\n<% dhcp = !@static -%>\n<% end -%>\n\nnetwork --bootproto <%= dhcp ? 'dhcp' : \"static --ip=#{@host.ip} --netmask=#{subnet.mask} --gateway=#{subnet.gateway} --nameserver=#{[subnet.dns_primary, subnet.dns_secondary].select{ |item| item.present? }.join(',')}\" %> --hostname <%= @host %><%= os_major >= 6 ? \" --device=#{@host.mac}\" : '' -%>\n\nrootpw --iscrypted <%= root_pass %>\nfirewall --<%= os_major >= 6 ? 'service=' : '' %>ssh\nauthconfig --useshadow --passalgo=<%= @host.operatingsystem.password_hash || 'sha256' %> --kickstart\ntimezone --utc <%= @host.params['time-zone'] || 'UTC' %>\n\n<% if @host.operatingsystem.name == 'Fedora' and os_major <= 16 -%>\n# Bootloader exception for Fedora 16:\nbootloader --append=\"nofb quiet splash=quiet <%=ks_console%>\" <%= grub_pass %>\npart biosboot --fstype=biosboot --size=1\n<% else -%>\nbootloader --location=mbr --append=\"nofb quiet splash=quiet\" <%= grub_pass %>\n<% end -%>\n\n<% if os_major == 5 -%>\nkey --skip\n<% end -%>\n\n<% if @dynamic -%>\n%include /tmp/diskpart.cfg\n<% else -%>\n<%= @host.diskLayout %>\n<% end -%>\n\ntext\nreboot\n\n%packages --ignoremissing\nyum\ndhclient\nntp\nwget\n@Core\n<%= section_end -%>\n\n<% if @dynamic -%>\n%pre\n<%= @host.diskLayout %>\n<%= section_end -%>\n<% end -%>\n\n%post --nochroot\nexec < /dev/tty3 > /dev/tty3\n#changing to VT 3 so that we can see whats going on....\n/usr/bin/chvt 3\n(\ncp -va /etc/resolv.conf /mnt/sysimage/etc/resolv.conf\n/usr/bin/chvt 1\n) 2>&1 | tee /mnt/sysimage/root/install.postnochroot.log\n<%= section_end -%>\n\n\n%post\nlogger \"Starting anaconda <%= @host %> postinstall\"\nexec < /dev/tty3 > /dev/tty3\n#changing to VT 3 so that we can see whats going on....\n/usr/bin/chvt 3\n(\n<% if subnet.respond_to?(:dhcp_boot_mode?) -%>\n<%= snippet 'kickstart_networking_setup' %>\n<% end -%>\n\n#update local time\necho \"updating system time\"\n/usr/sbin/ntpdate -sub <%= @host.params['ntp-server'] || '0.fedora.pool.ntp.org' %>\n/usr/sbin/hwclock --systohc\n\n<%= snippet \"subscription_manager_registration\" %>\n\n<% if @host.info['parameters']['realm'] && @host.realm && @host.realm.realm_type == 'FreeIPA' -%>\n<%= snippet \"freeipa_register\" %>\n<% end -%>\n\n# update all the base packages from the updates repository\nyum -t -y -e 0 update\n\n<%= snippet('remote_execution_ssh_keys') %>\n\n<% if chef_enabled %>\n<%= snippet 'chef_client' %>\n<% end -%>\n\n<% if puppet_enabled %>\n<%= snippet 'puppet_setup' %>\n<% end -%>\n\n<% if salt_enabled %>\n<%= snippet 'saltstack_setup' %>\n<% end -%>\n\nsync\n\n<% if @provisioning_type == nil || @provisioning_type == 'host' -%>\n# Inform the build system that we are done.\necho \"Informing Foreman that we are built\"\nwget -q -O /dev/null --no-check-certificate <%= foreman_url('built') %>\n<% end -%>\n) 2>&1 | tee /root/install.post.log\nexit 0\n\n<%= section_end -%>\n","snippet":false,"template_kind_id":6,"locked":true,"default":true,"vendor":"Katello","os_family":null,"job_category":"Miscellaneous","provider_type":null,"description_format":null,"execution_timeout_interval":null}},{"user_id":null,"user_type":null,"user_name":null,"version":1,"comment":null,"associated_id":6,"associated_type":"Role","remote_address":null,"associated_name":"Viewer","created_at":"2018-03-02 18:09:40 UTC","id":137,"auditable_id":268,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":6,"taxonomy_search":null,"override":false}},{"user_id":null,"user_type":null,"user_name":null,"version":1,"comment":null,"associated_id":6,"associated_type":"Role","remote_address":null,"associated_name":"Viewer","created_at":"2018-03-02 18:09:40 UTC","id":136,"auditable_id":267,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":6,"taxonomy_search":null,"override":false}},{"user_id":null,"user_type":null,"user_name":null,"version":1,"comment":null,"associated_id":6,"associated_type":"Role","remote_address":null,"associated_name":"Viewer","created_at":"2018-03-02 18:09:39 UTC","id":135,"auditable_id":266,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":6,"taxonomy_search":null,"override":false}},{"user_id":null,"user_type":null,"user_name":null,"version":1,"comment":null,"associated_id":6,"associated_type":"Role","remote_address":null,"associated_name":"Viewer","created_at":"2018-03-02 18:09:39 UTC","id":134,"auditable_id":265,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":6,"taxonomy_search":null,"override":false}},{"user_id":null,"user_type":null,"user_name":null,"version":1,"comment":null,"associated_id":2,"associated_type":"Role","remote_address":null,"associated_name":"Organization admin","created_at":"2018-03-02 18:09:38 UTC","id":133,"auditable_id":264,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":2,"taxonomy_search":null,"override":false}},{"user_id":null,"user_type":null,"user_name":null,"version":1,"comment":null,"associated_id":2,"associated_type":"Role","remote_address":null,"associated_name":"Organization admin","created_at":"2018-03-02 18:09:38 UTC","id":132,"auditable_id":263,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":2,"taxonomy_search":null,"override":false}},{"user_id":null,"user_type":null,"user_name":null,"version":1,"comment":null,"associated_id":2,"associated_type":"Role","remote_address":null,"associated_name":"Organization admin","created_at":"2018-03-02 18:09:38 UTC","id":131,"auditable_id":262,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":2,"taxonomy_search":null,"override":false}},{"user_id":null,"user_type":null,"user_name":null,"version":1,"comment":null,"associated_id":2,"associated_type":"Role","remote_address":null,"associated_name":"Organization admin","created_at":"2018-03-02 18:09:38 UTC","id":130,"auditable_id":261,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":2,"taxonomy_search":null,"override":false}},{"user_id":null,"user_type":null,"user_name":null,"version":1,"comment":null,"associated_id":1,"associated_type":"Role","remote_address":null,"associated_name":"Manager","created_at":"2018-03-02 18:09:37 UTC","id":129,"auditable_id":260,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":1,"taxonomy_search":null,"override":false}},{"user_id":null,"user_type":null,"user_name":null,"version":1,"comment":null,"associated_id":1,"associated_type":"Role","remote_address":null,"associated_name":"Manager","created_at":"2018-03-02 18:09:37 UTC","id":128,"auditable_id":259,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":1,"taxonomy_search":null,"override":false}},{"user_id":null,"user_type":null,"user_name":null,"version":1,"comment":null,"associated_id":1,"associated_type":"Role","remote_address":null,"associated_name":"Manager","created_at":"2018-03-02 18:09:37 UTC","id":127,"auditable_id":258,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":1,"taxonomy_search":null,"override":false}},{"user_id":null,"user_type":null,"user_name":null,"version":1,"comment":null,"associated_id":1,"associated_type":"Role","remote_address":null,"associated_name":"Manager","created_at":"2018-03-02 18:09:36 UTC","id":126,"auditable_id":257,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":1,"taxonomy_search":null,"override":false}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":1,"comment":null,"associated_id":21,"associated_type":"Role","remote_address":null,"associated_name":"Access Insights Admin","created_at":"2018-03-02 18:05:18 UTC","id":125,"auditable_id":245,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":21,"taxonomy_search":null,"override":false}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":1,"comment":null,"associated_id":20,"associated_type":"Role","remote_address":null,"associated_name":"Access Insights Viewer","created_at":"2018-03-02 18:05:18 UTC","id":124,"auditable_id":244,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":20,"taxonomy_search":null,"override":false}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":1,"comment":null,"associated_id":19,"associated_type":"Role","remote_address":null,"associated_name":"Red Hat Access Logs","created_at":"2018-03-02 18:05:18 UTC","id":123,"auditable_id":243,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":19,"taxonomy_search":null,"override":false}},{"user_id":null,"user_type":null,"user_name":null,"version":1,"comment":null,"associated_id":6,"associated_type":"Role","remote_address":null,"associated_name":"Viewer","created_at":"2018-03-02 18:05:10 UTC","id":122,"auditable_id":242,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":6,"taxonomy_search":null,"override":false}},{"user_id":null,"user_type":null,"user_name":null,"version":1,"comment":null,"associated_id":2,"associated_type":"Role","remote_address":null,"associated_name":"Organization admin","created_at":"2018-03-02 18:05:09 UTC","id":121,"auditable_id":241,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":2,"taxonomy_search":null,"override":false}},{"user_id":null,"user_type":null,"user_name":null,"version":1,"comment":null,"associated_id":1,"associated_type":"Role","remote_address":null,"associated_name":"Manager","created_at":"2018-03-02 18:05:08 UTC","id":120,"auditable_id":240,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":1,"taxonomy_search":null,"override":false}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":1,"comment":null,"associated_id":18,"associated_type":"Role","remote_address":null,"associated_name":"Virt-who Viewer","created_at":"2018-03-02 18:05:08 UTC","id":119,"auditable_id":239,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":18,"taxonomy_search":null,"override":false}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":1,"comment":null,"associated_id":17,"associated_type":"Role","remote_address":null,"associated_name":"Virt-who Manager","created_at":"2018-03-02 18:05:08 UTC","id":118,"auditable_id":238,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":17,"taxonomy_search":null,"override":false}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":1,"comment":null,"associated_id":16,"associated_type":"Role","remote_address":null,"associated_name":"Virt-who Reporter","created_at":"2018-03-02 18:05:07 UTC","id":117,"auditable_id":237,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":16,"taxonomy_search":null,"override":false}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":1,"comment":null,"associated_id":16,"associated_type":"Role","remote_address":null,"associated_name":"Virt-who Reporter","created_at":"2018-03-02 18:05:07 UTC","id":116,"auditable_id":236,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":16,"taxonomy_search":null,"override":false}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":1,"comment":null,"associated_id":16,"associated_type":"Role","remote_address":null,"associated_name":"Virt-who Reporter","created_at":"2018-03-02 18:05:07 UTC","id":115,"auditable_id":235,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":16,"taxonomy_search":null,"override":false}},{"user_id":null,"user_type":null,"user_name":null,"version":1,"comment":null,"associated_id":6,"associated_type":"Role","remote_address":null,"associated_name":"Viewer","created_at":"2018-03-02 18:05:06 UTC","id":114,"auditable_id":234,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":6,"taxonomy_search":null,"override":false}},{"user_id":null,"user_type":null,"user_name":null,"version":1,"comment":null,"associated_id":6,"associated_type":"Role","remote_address":null,"associated_name":"Viewer","created_at":"2018-03-02 18:05:06 UTC","id":113,"auditable_id":233,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":6,"taxonomy_search":null,"override":false}},{"user_id":null,"user_type":null,"user_name":null,"version":1,"comment":null,"associated_id":6,"associated_type":"Role","remote_address":null,"associated_name":"Viewer","created_at":"2018-03-02 18:05:06 UTC","id":112,"auditable_id":232,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":6,"taxonomy_search":null,"override":false}},{"user_id":null,"user_type":null,"user_name":null,"version":1,"comment":null,"associated_id":6,"associated_type":"Role","remote_address":null,"associated_name":"Viewer","created_at":"2018-03-02 18:05:06 UTC","id":111,"auditable_id":231,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":6,"taxonomy_search":null,"override":false}},{"user_id":null,"user_type":null,"user_name":null,"version":1,"comment":null,"associated_id":6,"associated_type":"Role","remote_address":null,"associated_name":"Viewer","created_at":"2018-03-02 18:05:06 UTC","id":110,"auditable_id":230,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":6,"taxonomy_search":null,"override":false}},{"user_id":null,"user_type":null,"user_name":null,"version":1,"comment":null,"associated_id":6,"associated_type":"Role","remote_address":null,"associated_name":"Viewer","created_at":"2018-03-02 18:05:06 UTC","id":109,"auditable_id":229,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":6,"taxonomy_search":null,"override":false}},{"user_id":null,"user_type":null,"user_name":null,"version":1,"comment":null,"associated_id":6,"associated_type":"Role","remote_address":null,"associated_name":"Viewer","created_at":"2018-03-02 18:05:06 UTC","id":108,"auditable_id":228,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":6,"taxonomy_search":null,"override":false}},{"user_id":null,"user_type":null,"user_name":null,"version":1,"comment":null,"associated_id":6,"associated_type":"Role","remote_address":null,"associated_name":"Viewer","created_at":"2018-03-02 18:05:06 UTC","id":107,"auditable_id":227,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":6,"taxonomy_search":null,"override":false}},{"user_id":null,"user_type":null,"user_name":null,"version":1,"comment":null,"associated_id":2,"associated_type":"Role","remote_address":null,"associated_name":"Organization admin","created_at":"2018-03-02 18:05:05 UTC","id":106,"auditable_id":226,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":2,"taxonomy_search":null,"override":false}},{"user_id":null,"user_type":null,"user_name":null,"version":1,"comment":null,"associated_id":2,"associated_type":"Role","remote_address":null,"associated_name":"Organization admin","created_at":"2018-03-02 18:05:05 UTC","id":105,"auditable_id":225,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":2,"taxonomy_search":null,"override":false}},{"user_id":null,"user_type":null,"user_name":null,"version":1,"comment":null,"associated_id":2,"associated_type":"Role","remote_address":null,"associated_name":"Organization admin","created_at":"2018-03-02 18:05:05 UTC","id":104,"auditable_id":224,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":2,"taxonomy_search":null,"override":false}},{"user_id":null,"user_type":null,"user_name":null,"version":1,"comment":null,"associated_id":2,"associated_type":"Role","remote_address":null,"associated_name":"Organization admin","created_at":"2018-03-02 18:05:05 UTC","id":103,"auditable_id":223,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":2,"taxonomy_search":null,"override":false}},{"user_id":null,"user_type":null,"user_name":null,"version":1,"comment":null,"associated_id":2,"associated_type":"Role","remote_address":null,"associated_name":"Organization admin","created_at":"2018-03-02 18:05:05 UTC","id":102,"auditable_id":222,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":2,"taxonomy_search":null,"override":false}},{"user_id":null,"user_type":null,"user_name":null,"version":1,"comment":null,"associated_id":2,"associated_type":"Role","remote_address":null,"associated_name":"Organization admin","created_at":"2018-03-02 18:05:05 UTC","id":101,"auditable_id":221,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":2,"taxonomy_search":null,"override":false}},{"user_id":null,"user_type":null,"user_name":null,"version":1,"comment":null,"associated_id":2,"associated_type":"Role","remote_address":null,"associated_name":"Organization admin","created_at":"2018-03-02 18:05:05 UTC","id":100,"auditable_id":220,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":2,"taxonomy_search":null,"override":false}},{"user_id":null,"user_type":null,"user_name":null,"version":1,"comment":null,"associated_id":2,"associated_type":"Role","remote_address":null,"associated_name":"Organization admin","created_at":"2018-03-02 18:05:05 UTC","id":99,"auditable_id":219,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":2,"taxonomy_search":null,"override":false}},{"user_id":null,"user_type":null,"user_name":null,"version":1,"comment":null,"associated_id":1,"associated_type":"Role","remote_address":null,"associated_name":"Manager","created_at":"2018-03-02 18:05:04 UTC","id":98,"auditable_id":218,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":1,"taxonomy_search":null,"override":false}},{"user_id":null,"user_type":null,"user_name":null,"version":1,"comment":null,"associated_id":1,"associated_type":"Role","remote_address":null,"associated_name":"Manager","created_at":"2018-03-02 18:05:04 UTC","id":97,"auditable_id":217,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":1,"taxonomy_search":null,"override":false}},{"user_id":null,"user_type":null,"user_name":null,"version":1,"comment":null,"associated_id":1,"associated_type":"Role","remote_address":null,"associated_name":"Manager","created_at":"2018-03-02 18:05:04 UTC","id":96,"auditable_id":216,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":1,"taxonomy_search":null,"override":false}},{"user_id":null,"user_type":null,"user_name":null,"version":1,"comment":null,"associated_id":1,"associated_type":"Role","remote_address":null,"associated_name":"Manager","created_at":"2018-03-02 18:05:04 UTC","id":95,"auditable_id":215,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":1,"taxonomy_search":null,"override":false}},{"user_id":null,"user_type":null,"user_name":null,"version":1,"comment":null,"associated_id":1,"associated_type":"Role","remote_address":null,"associated_name":"Manager","created_at":"2018-03-02 18:05:04 UTC","id":94,"auditable_id":214,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":1,"taxonomy_search":null,"override":false}},{"user_id":null,"user_type":null,"user_name":null,"version":1,"comment":null,"associated_id":1,"associated_type":"Role","remote_address":null,"associated_name":"Manager","created_at":"2018-03-02 18:05:03 UTC","id":93,"auditable_id":213,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":1,"taxonomy_search":null,"override":false}},{"user_id":null,"user_type":null,"user_name":null,"version":1,"comment":null,"associated_id":1,"associated_type":"Role","remote_address":null,"associated_name":"Manager","created_at":"2018-03-02 18:05:03 UTC","id":92,"auditable_id":212,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":1,"taxonomy_search":null,"override":false}},{"user_id":null,"user_type":null,"user_name":null,"version":1,"comment":null,"associated_id":1,"associated_type":"Role","remote_address":null,"associated_name":"Manager","created_at":"2018-03-02 18:05:03 UTC","id":91,"auditable_id":211,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":1,"taxonomy_search":null,"override":false}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":1,"comment":null,"associated_id":15,"associated_type":"Role","remote_address":null,"associated_name":"Boot disk access","created_at":"2018-03-02 18:05:00 UTC","id":90,"auditable_id":210,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":15,"taxonomy_search":null,"override":false}},{"user_id":null,"user_type":null,"user_name":null,"version":1,"comment":null,"associated_id":6,"associated_type":"Role","remote_address":null,"associated_name":"Viewer","created_at":"2018-03-02 18:04:59 UTC","id":89,"auditable_id":209,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":6,"taxonomy_search":null,"override":false}},{"user_id":null,"user_type":null,"user_name":null,"version":1,"comment":null,"associated_id":2,"associated_type":"Role","remote_address":null,"associated_name":"Organization admin","created_at":"2018-03-02 18:04:58 UTC","id":88,"auditable_id":208,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":2,"taxonomy_search":null,"override":false}},{"user_id":null,"user_type":null,"user_name":null,"version":1,"comment":null,"associated_id":1,"associated_type":"Role","remote_address":null,"associated_name":"Manager","created_at":"2018-03-02 18:04:57 UTC","id":87,"auditable_id":207,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":1,"taxonomy_search":null,"override":false}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":1,"comment":null,"associated_id":14,"associated_type":"Role","remote_address":null,"associated_name":"Discovery Manager","created_at":"2018-03-02 18:04:56 UTC","id":86,"auditable_id":206,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":14,"taxonomy_search":null,"override":false}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":1,"comment":null,"associated_id":14,"associated_type":"Role","remote_address":null,"associated_name":"Discovery Manager","created_at":"2018-03-02 18:04:56 UTC","id":85,"auditable_id":205,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":14,"taxonomy_search":null,"override":false}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":1,"comment":null,"associated_id":14,"associated_type":"Role","remote_address":null,"associated_name":"Discovery Manager","created_at":"2018-03-02 18:04:56 UTC","id":84,"auditable_id":204,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":14,"taxonomy_search":null,"override":false}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":1,"comment":null,"associated_id":14,"associated_type":"Role","remote_address":null,"associated_name":"Discovery Manager","created_at":"2018-03-02 18:04:56 UTC","id":83,"auditable_id":203,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":14,"taxonomy_search":null,"override":false}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":1,"comment":null,"associated_id":14,"associated_type":"Role","remote_address":null,"associated_name":"Discovery Manager","created_at":"2018-03-02 18:04:56 UTC","id":82,"auditable_id":202,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":14,"taxonomy_search":null,"override":false}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":1,"comment":null,"associated_id":14,"associated_type":"Role","remote_address":null,"associated_name":"Discovery Manager","created_at":"2018-03-02 18:04:56 UTC","id":81,"auditable_id":201,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":14,"taxonomy_search":null,"override":false}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":1,"comment":null,"associated_id":14,"associated_type":"Role","remote_address":null,"associated_name":"Discovery Manager","created_at":"2018-03-02 18:04:56 UTC","id":80,"auditable_id":200,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":14,"taxonomy_search":null,"override":false}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":1,"comment":null,"associated_id":14,"associated_type":"Role","remote_address":null,"associated_name":"Discovery Manager","created_at":"2018-03-02 18:04:56 UTC","id":79,"auditable_id":199,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":14,"taxonomy_search":null,"override":false}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":1,"comment":null,"associated_id":14,"associated_type":"Role","remote_address":null,"associated_name":"Discovery Manager","created_at":"2018-03-02 18:04:56 UTC","id":78,"auditable_id":198,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":14,"taxonomy_search":null,"override":false}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":1,"comment":null,"associated_id":14,"associated_type":"Role","remote_address":null,"associated_name":"Discovery Manager","created_at":"2018-03-02 18:04:56 UTC","id":77,"auditable_id":197,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":14,"taxonomy_search":null,"override":false}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":1,"comment":null,"associated_id":14,"associated_type":"Role","remote_address":null,"associated_name":"Discovery Manager","created_at":"2018-03-02 18:04:56 UTC","id":76,"auditable_id":196,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":14,"taxonomy_search":null,"override":false}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":1,"comment":null,"associated_id":14,"associated_type":"Role","remote_address":null,"associated_name":"Discovery Manager","created_at":"2018-03-02 18:04:56 UTC","id":75,"auditable_id":195,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":14,"taxonomy_search":null,"override":false}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":1,"comment":null,"associated_id":14,"associated_type":"Role","remote_address":null,"associated_name":"Discovery Manager","created_at":"2018-03-02 18:04:56 UTC","id":74,"auditable_id":194,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":14,"taxonomy_search":null,"override":false}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":1,"comment":null,"associated_id":14,"associated_type":"Role","remote_address":null,"associated_name":"Discovery Manager","created_at":"2018-03-02 18:04:56 UTC","id":73,"auditable_id":193,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":14,"taxonomy_search":null,"override":false}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":1,"comment":null,"associated_id":14,"associated_type":"Role","remote_address":null,"associated_name":"Discovery Manager","created_at":"2018-03-02 18:04:56 UTC","id":72,"auditable_id":192,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":14,"taxonomy_search":null,"override":false}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":1,"comment":null,"associated_id":14,"associated_type":"Role","remote_address":null,"associated_name":"Discovery Manager","created_at":"2018-03-02 18:04:56 UTC","id":71,"auditable_id":191,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":14,"taxonomy_search":null,"override":false}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":1,"comment":null,"associated_id":14,"associated_type":"Role","remote_address":null,"associated_name":"Discovery Manager","created_at":"2018-03-02 18:04:56 UTC","id":70,"auditable_id":190,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":14,"taxonomy_search":null,"override":false}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":1,"comment":null,"associated_id":13,"associated_type":"Role","remote_address":null,"associated_name":"Discovery Reader","created_at":"2018-03-02 18:04:56 UTC","id":69,"auditable_id":189,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":13,"taxonomy_search":null,"override":false}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":1,"comment":null,"associated_id":13,"associated_type":"Role","remote_address":null,"associated_name":"Discovery Reader","created_at":"2018-03-02 18:04:56 UTC","id":68,"auditable_id":188,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":13,"taxonomy_search":null,"override":false}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":1,"comment":null,"associated_id":13,"associated_type":"Role","remote_address":null,"associated_name":"Discovery Reader","created_at":"2018-03-02 18:04:56 UTC","id":67,"auditable_id":187,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":13,"taxonomy_search":null,"override":false}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":1,"comment":null,"associated_id":13,"associated_type":"Role","remote_address":null,"associated_name":"Discovery Reader","created_at":"2018-03-02 18:04:56 UTC","id":66,"auditable_id":186,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":13,"taxonomy_search":null,"override":false}},{"user_id":null,"user_type":null,"user_name":null,"version":1,"comment":null,"associated_id":6,"associated_type":"Role","remote_address":null,"associated_name":"Viewer","created_at":"2018-03-02 18:04:54 UTC","id":65,"auditable_id":185,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":6,"taxonomy_search":null,"override":false}},{"user_id":null,"user_type":null,"user_name":null,"version":1,"comment":null,"associated_id":6,"associated_type":"Role","remote_address":null,"associated_name":"Viewer","created_at":"2018-03-02 18:04:54 UTC","id":64,"auditable_id":184,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":6,"taxonomy_search":null,"override":false}},{"user_id":null,"user_type":null,"user_name":null,"version":1,"comment":null,"associated_id":2,"associated_type":"Role","remote_address":null,"associated_name":"Organization admin","created_at":"2018-03-02 18:04:53 UTC","id":63,"auditable_id":183,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":2,"taxonomy_search":null,"override":false}},{"user_id":null,"user_type":null,"user_name":null,"version":1,"comment":null,"associated_id":2,"associated_type":"Role","remote_address":null,"associated_name":"Organization admin","created_at":"2018-03-02 18:04:53 UTC","id":62,"auditable_id":182,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":2,"taxonomy_search":null,"override":false}},{"user_id":null,"user_type":null,"user_name":null,"version":1,"comment":null,"associated_id":2,"associated_type":"Role","remote_address":null,"associated_name":"Organization admin","created_at":"2018-03-02 18:04:53 UTC","id":61,"auditable_id":181,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":2,"taxonomy_search":null,"override":false}},{"user_id":null,"user_type":null,"user_name":null,"version":1,"comment":null,"associated_id":2,"associated_type":"Role","remote_address":null,"associated_name":"Organization admin","created_at":"2018-03-02 18:04:53 UTC","id":60,"auditable_id":180,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":2,"taxonomy_search":null,"override":false}},{"user_id":null,"user_type":null,"user_name":null,"version":1,"comment":null,"associated_id":1,"associated_type":"Role","remote_address":null,"associated_name":"Manager","created_at":"2018-03-02 18:04:52 UTC","id":59,"auditable_id":179,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":1,"taxonomy_search":null,"override":false}},{"user_id":null,"user_type":null,"user_name":null,"version":1,"comment":null,"associated_id":1,"associated_type":"Role","remote_address":null,"associated_name":"Manager","created_at":"2018-03-02 18:04:52 UTC","id":58,"auditable_id":178,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":1,"taxonomy_search":null,"override":false}},{"user_id":null,"user_type":null,"user_name":null,"version":1,"comment":null,"associated_id":1,"associated_type":"Role","remote_address":null,"associated_name":"Manager","created_at":"2018-03-02 18:04:52 UTC","id":57,"auditable_id":177,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":1,"taxonomy_search":null,"override":false}},{"user_id":null,"user_type":null,"user_name":null,"version":1,"comment":null,"associated_id":1,"associated_type":"Role","remote_address":null,"associated_name":"Manager","created_at":"2018-03-02 18:04:52 UTC","id":56,"auditable_id":176,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":1,"taxonomy_search":null,"override":false}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":1,"comment":null,"associated_id":12,"associated_type":"Role","remote_address":null,"associated_name":"Remote Execution Manager","created_at":"2018-03-02 18:04:52 UTC","id":55,"auditable_id":175,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":12,"taxonomy_search":null,"override":false}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":1,"comment":null,"associated_id":12,"associated_type":"Role","remote_address":null,"associated_name":"Remote Execution Manager","created_at":"2018-03-02 18:04:52 UTC","id":54,"auditable_id":174,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":12,"taxonomy_search":null,"override":false}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":1,"comment":null,"associated_id":12,"associated_type":"Role","remote_address":null,"associated_name":"Remote Execution Manager","created_at":"2018-03-02 18:04:52 UTC","id":53,"auditable_id":173,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":12,"taxonomy_search":null,"override":false}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":1,"comment":null,"associated_id":12,"associated_type":"Role","remote_address":null,"associated_name":"Remote Execution Manager","created_at":"2018-03-02 18:04:52 UTC","id":52,"auditable_id":172,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":12,"taxonomy_search":null,"override":false}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":1,"comment":null,"associated_id":12,"associated_type":"Role","remote_address":null,"associated_name":"Remote Execution Manager","created_at":"2018-03-02 18:04:52 UTC","id":51,"auditable_id":171,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":12,"taxonomy_search":null,"override":false}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":1,"comment":null,"associated_id":12,"associated_type":"Role","remote_address":null,"associated_name":"Remote Execution Manager","created_at":"2018-03-02 18:04:52 UTC","id":50,"auditable_id":170,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":12,"taxonomy_search":null,"override":false}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":1,"comment":null,"associated_id":12,"associated_type":"Role","remote_address":null,"associated_name":"Remote Execution Manager","created_at":"2018-03-02 18:04:52 UTC","id":49,"auditable_id":169,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":12,"taxonomy_search":null,"override":false}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":1,"comment":null,"associated_id":11,"associated_type":"Role","remote_address":null,"associated_name":"Remote Execution User","created_at":"2018-03-02 18:04:52 UTC","id":48,"auditable_id":168,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":11,"taxonomy_search":null,"override":false}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":1,"comment":null,"associated_id":11,"associated_type":"Role","remote_address":null,"associated_name":"Remote Execution User","created_at":"2018-03-02 18:04:52 UTC","id":47,"auditable_id":167,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":11,"taxonomy_search":null,"override":false}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":1,"comment":null,"associated_id":11,"associated_type":"Role","remote_address":null,"associated_name":"Remote Execution User","created_at":"2018-03-02 18:04:52 UTC","id":46,"auditable_id":166,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":11,"taxonomy_search":null,"override":false}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":1,"comment":null,"associated_id":11,"associated_type":"Role","remote_address":null,"associated_name":"Remote Execution User","created_at":"2018-03-02 18:04:52 UTC","id":45,"auditable_id":165,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":11,"taxonomy_search":null,"override":false}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":1,"comment":null,"associated_id":11,"associated_type":"Role","remote_address":null,"associated_name":"Remote Execution User","created_at":"2018-03-02 18:04:52 UTC","id":44,"auditable_id":164,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":11,"taxonomy_search":null,"override":false}},{"user_id":null,"user_type":null,"user_name":null,"version":1,"comment":null,"associated_id":6,"associated_type":"Role","remote_address":null,"associated_name":"Viewer","created_at":"2018-03-02 18:04:51 UTC","id":43,"auditable_id":163,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":6,"taxonomy_search":null,"override":false}},{"user_id":null,"user_type":null,"user_name":null,"version":1,"comment":null,"associated_id":6,"associated_type":"Role","remote_address":null,"associated_name":"Viewer","created_at":"2018-03-02 18:04:51 UTC","id":42,"auditable_id":162,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":6,"taxonomy_search":null,"override":false}},{"user_id":null,"user_type":null,"user_name":null,"version":1,"comment":null,"associated_id":2,"associated_type":"Role","remote_address":null,"associated_name":"Organization admin","created_at":"2018-03-02 18:04:50 UTC","id":41,"auditable_id":161,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":2,"taxonomy_search":null,"override":false}},{"user_id":null,"user_type":null,"user_name":null,"version":1,"comment":null,"associated_id":2,"associated_type":"Role","remote_address":null,"associated_name":"Organization admin","created_at":"2018-03-02 18:04:50 UTC","id":40,"auditable_id":160,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":2,"taxonomy_search":null,"override":false}},{"user_id":null,"user_type":null,"user_name":null,"version":1,"comment":null,"associated_id":2,"associated_type":"Role","remote_address":null,"associated_name":"Organization admin","created_at":"2018-03-02 18:04:50 UTC","id":39,"auditable_id":159,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":2,"taxonomy_search":null,"override":false}},{"user_id":null,"user_type":null,"user_name":null,"version":1,"comment":null,"associated_id":1,"associated_type":"Role","remote_address":null,"associated_name":"Manager","created_at":"2018-03-02 18:04:49 UTC","id":38,"auditable_id":158,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":1,"taxonomy_search":null,"override":false}},{"user_id":null,"user_type":null,"user_name":null,"version":1,"comment":null,"associated_id":1,"associated_type":"Role","remote_address":null,"associated_name":"Manager","created_at":"2018-03-02 18:04:49 UTC","id":37,"auditable_id":157,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":1,"taxonomy_search":null,"override":false}},{"user_id":null,"user_type":null,"user_name":null,"version":1,"comment":null,"associated_id":1,"associated_type":"Role","remote_address":null,"associated_name":"Manager","created_at":"2018-03-02 18:04:49 UTC","id":36,"auditable_id":156,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":1,"taxonomy_search":null,"override":false}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":1,"comment":null,"associated_id":10,"associated_type":"Role","remote_address":null,"associated_name":"Tasks Reader","created_at":"2018-03-02 18:04:49 UTC","id":35,"auditable_id":155,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":10,"taxonomy_search":null,"override":false}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":1,"comment":null,"associated_id":9,"associated_type":"Role","remote_address":null,"associated_name":"Tasks Manager","created_at":"2018-03-02 18:04:49 UTC","id":34,"auditable_id":154,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":9,"taxonomy_search":null,"override":false}},{"user_id":null,"user_type":null,"user_name":null,"version":1,"comment":null,"associated_id":6,"associated_type":"Role","remote_address":null,"associated_name":"Viewer","created_at":"2018-03-02 18:04:48 UTC","id":33,"auditable_id":153,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":6,"taxonomy_search":null,"override":false}},{"user_id":null,"user_type":null,"user_name":null,"version":1,"comment":null,"associated_id":6,"associated_type":"Role","remote_address":null,"associated_name":"Viewer","created_at":"2018-03-02 18:04:48 UTC","id":32,"auditable_id":152,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":6,"taxonomy_search":null,"override":false}},{"user_id":null,"user_type":null,"user_name":null,"version":1,"comment":null,"associated_id":2,"associated_type":"Role","remote_address":null,"associated_name":"Organization admin","created_at":"2018-03-02 18:04:47 UTC","id":31,"auditable_id":151,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":2,"taxonomy_search":null,"override":false}},{"user_id":null,"user_type":null,"user_name":null,"version":1,"comment":null,"associated_id":2,"associated_type":"Role","remote_address":null,"associated_name":"Organization admin","created_at":"2018-03-02 18:04:47 UTC","id":30,"auditable_id":150,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":2,"taxonomy_search":null,"override":false}},{"user_id":null,"user_type":null,"user_name":null,"version":1,"comment":null,"associated_id":1,"associated_type":"Role","remote_address":null,"associated_name":"Manager","created_at":"2018-03-02 18:04:46 UTC","id":29,"auditable_id":149,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":1,"taxonomy_search":null,"override":false}},{"user_id":null,"user_type":null,"user_name":null,"version":1,"comment":null,"associated_id":1,"associated_type":"Role","remote_address":null,"associated_name":"Manager","created_at":"2018-03-02 18:04:46 UTC","id":28,"auditable_id":148,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":null,"role_id":1,"taxonomy_search":null,"override":false}},{"user_id":null,"user_type":null,"user_name":null,"version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-02 18:04:37 UTC","id":27,"auditable_id":78,"auditable_name":"db_pending_seed","auditable_type":"Setting","action":"update","audited_changes":{"value":[null,"--- false\n..."]}},{"user_id":null,"user_type":null,"user_name":null,"version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-02 18:04:37 UTC","id":26,"auditable_id":77,"auditable_name":"db_pending_migration","auditable_type":"Setting","action":"update","audited_changes":{"value":[null,"--- false\n..."]}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-02 18:04:37 UTC","id":25,"auditable_id":32,"auditable_name":"Kickstart RHEL default","auditable_type":"ProvisioningTemplate","action":"destroy","audited_changes":{"name":"Kickstart RHEL default","template":"<%#\nkind: provision\nname: Kickstart RHEL default\noses:\n- RedHat\n%>\n<%#\nThis template accepts the following parameters:\n- lang: string (default=\"en_US.UTF-8\")\n- selinux-mode: string (default=\"enforcing\")\n- keyboard: string (default=\"us\")\n- time-zone: string (default=\"UTC\")\n- http-proxy: string (default=\"\")\n- http-proxy-port: string (default=\"\")\n- force-puppet: boolean (default=false)\n- enable-epel: boolean (default=true)\n- enable-puppetlabs-repo: boolean (default=false)\n- enable-puppetlabs-pc1-repo: boolean (default=false)\n- salt_master: string (default=undef)\n- ntp-server: string (default=\"0.fedora.pool.ntp.org\")\n- bootloader-append: string (default=\"nofb quiet splash=quiet\")\n- disable-firewall: boolean (default=false)\n- package_upgrade: boolean (default=true)\n%>\n<%\n  os_major = @host.operatingsystem.major.to_i\n  realm_compatible = os_major >= 7 ? true : false\n  # safemode renderer does not support unary negation\n  pm_set = @host.puppetmaster.empty? ? false : true\n  proxy_uri = @host.params['http-proxy'] ? \"http://#{@host.params['http-proxy']}:#{@host.params['http-proxy-port']}\" : nil\n  proxy_string = proxy_uri ? \" --proxy=#{proxy_uri}\" : ''\n  puppet_enabled = pm_set || @host.param_true?('force-puppet')\n  salt_enabled = @host.params['salt_master'] ? true : false\n  chef_enabled = @host.respond_to?(:chef_proxy) && @host.chef_proxy\n  section_end = os_major <= 5 ? '' : '%end'\n%>\ninstall\n<%= @mediapath %><%= proxy_string %>\nlang <%= @host.params['lang'] || 'en_US.UTF-8' %>\nselinux --<%= @host.params['selinux-mode'] || @host.params['selinux'] || 'enforcing' %>\nkeyboard <%= @host.params['keyboard'] || 'us' %>\nskipx\n\n<% subnet = @host.subnet -%>\n<% if subnet.respond_to?(:dhcp_boot_mode?) -%>\n<% dhcp = subnet.dhcp_boot_mode? && !@static -%>\n<% else -%>\n<% dhcp = !@static -%>\n<% end -%>\nnetwork --bootproto <%= dhcp ? 'dhcp' : \"static --ip=#{@host.ip} --netmask=#{subnet.mask} --gateway=#{subnet.gateway} --nameserver=#{[subnet.dns_primary, subnet.dns_secondary].select{ |item| item.present? }.join(',')}\" %> --hostname <%= @host %><%= os_major >= 6 ? \" --device=#{@host.mac}\" : '' -%>\n\nrootpw --iscrypted <%= root_pass %>\n<% if @host.param_true?('disable-firewall') -%>\nfirewall --disable\n<% else -%>\nfirewall --<%= os_major >= 6 ? 'service=' : '' %>ssh\n<% end -%>\nauthconfig --useshadow --passalgo=<%= @host.operatingsystem.password_hash || 'sha256' %> --kickstart\ntimezone --utc <%= @host.params['time-zone'] || 'UTC' %>\nservices --disabled gpm,sendmail,cups,pcmcia,isdn,rawdevices,hpoj,bluetooth,openibd,avahi-daemon,avahi-dnsconfd,hidd,hplip,pcscd\n\n<% if realm_compatible && @host.info['parameters']['realm'] && @host.realm && @host.realm.realm_type == 'Active Directory' -%>\n# One-time password will be requested at install time. Otherwise, $HOST[OTP] is used as a placeholder value.\nrealm join --one-time-password='<%= @host.otp || \"$HOST[OTP]\" %>' <%= @host.realm %>\n<% end -%>\n\nbootloader --location=mbr --append=\"<%= @host.params['bootloader-append'] || 'nofb quiet splash=quiet' %>\" <%= grub_pass %>\n<% if os_major == 5 -%>\nkey --skip\n<% end -%>\n\n<% if @dynamic -%>\n%include /tmp/diskpart.cfg\n<% else -%>\n<%= @host.diskLayout %>\n<% end -%>\n\ntext\nreboot\n\n%packages\nyum\ndhclient\nntp\nwget\n@Core\n<% if os_major >= 6 -%>\nredhat-lsb-core\n<% end -%>\n<% if salt_enabled %>\nsalt-minion\n<% end -%>\n<%= section_end -%>\n\n<% if @dynamic -%>\n%pre\n<%= @host.diskLayout %>\n<%= section_end -%>\n<% end -%>\n\n%post --nochroot\nexec < /dev/tty3 > /dev/tty3\n#changing to VT 3 so that we can see whats going on....\n/usr/bin/chvt 3\n(\ncp -va /etc/resolv.conf /mnt/sysimage/etc/resolv.conf\n/usr/bin/chvt 1\n) 2>&1 | tee /mnt/sysimage/root/install.postnochroot.log\n<%= section_end -%>\n\n%post\nlogger \"Starting anaconda <%= @host %> postinstall\"\nexec < /dev/tty3 > /dev/tty3\n#changing to VT 3 so that we can see whats going on....\n/usr/bin/chvt 3\n(\n<% if subnet.respond_to?(:dhcp_boot_mode?) -%>\n<%= snippet 'kickstart_networking_setup' %>\n<% end -%>\n\n#update local time\necho \"updating system time\"\n/usr/sbin/ntpdate -sub <%= @host.params['ntp-server'] || '0.fedora.pool.ntp.org' %>\n/usr/sbin/hwclock --systohc\n\n<% if proxy_uri -%>\n# Yum proxy\necho 'proxy = <%= proxy_uri %>' >> /etc/yum.conf\n<% end -%>\n\n<% unless @host.param_false?('enable-epel') -%>\n<%= snippet 'epel' -%>\n<% end -%>\n\n<%= snippet 'redhat_register' %>\n\n<% if @host.info['parameters']['realm'] && @host.realm && @host.realm.realm_type == 'FreeIPA' -%>\n<%= snippet 'freeipa_register' %>\n<% end -%>\n\n<% unless @host.param_false?('package_upgrade') -%>\n# update all the base packages from the updates repository\nif [ -f /usr/bin/dnf ]; then\n  dnf -y update\nelse\n  yum -t -y update\nfi\n<% end -%>\n\n<%= snippet('remote_execution_ssh_keys') %>\n\n<% if chef_enabled %>\n<%= snippet 'chef_client' %>\n<% end -%>\n\n<% if puppet_enabled %>\n<% if @host.param_true?('enable-puppetlabs-pc1-repo') || @host.param_true?('enable-puppetlabs-repo') -%>\n<%= snippet 'puppetlabs_repo' %>\n<% end -%>\n<%= snippet 'puppet_setup' %>\n<% end -%>\n\n<% if salt_enabled %>\n<%= snippet 'saltstack_setup' %>\n<% end -%>\n\n<%= snippet('ansible_provisioning_callback') %>\n\n\nsync\n\n# Inform the build system that we are done.\necho \"Informing Foreman that we are built\"\nwget -q -O /dev/null --no-check-certificate <%= foreman_url('built') %>\n) 2>&1 | tee /root/install.post.log\nexit 0\n\n<%= section_end -%>\n","snippet":false,"template_kind_id":6,"locked":true,"default":true,"vendor":"Foreman","os_family":null,"job_category":"Miscellaneous","provider_type":null,"description_format":null,"execution_timeout_interval":null}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-02 18:04:37 UTC","id":24,"auditable_id":31,"auditable_name":"Kickstart default","auditable_type":"ProvisioningTemplate","action":"destroy","audited_changes":{"name":"Kickstart default","template":"<%#\nkind: provision\nname: Kickstart default\noses:\n- CentOS\n- Fedora\n%>\n<%#\nThis template accepts the following parameters:\n- lang: string (default=\"en_US.UTF-8\")\n- selinux-mode: string (default=\"enforcing\")\n- keyboard: string (default=\"us\")\n- time-zone: string (default=\"UTC\")\n- http-proxy: string (default=\"\")\n- http-proxy-port: string (default=\"\")\n- force-puppet: boolean (default=false)\n- enable-epel: boolean (default=true)\n- enable-puppetlabs-repo: boolean (default=false)\n- enable-puppetlabs-pc1-repo: boolean (default=false)\n- salt_master: string (default=undef)\n- ntp-server: string (default=\"0.fedora.pool.ntp.org\")\n- bootloader-append: string (default=\"nofb quiet splash=quiet\")\n- disable-firewall: boolean (default=false)\n- package_upgrade: boolean (default=true)\n- disable-uek: boolean (default=false)\n%>\n<%\n  rhel_compatible = @host.operatingsystem.family == 'Redhat' && @host.operatingsystem.name != 'Fedora'\n  os_major = @host.operatingsystem.major.to_i\n  realm_compatible = (@host.operatingsystem.name == 'Fedora' && os_major >= 20) || (rhel_compatible && os_major >= 7)\n  # safemode renderer does not support unary negation\n  pm_set = @host.puppetmaster.empty? ? false : true\n  proxy_uri = @host.params['http-proxy'] ? \"http://#{@host.params['http-proxy']}:#{@host.params['http-proxy-port']}\" : nil\n  proxy_string = proxy_uri ? \" --proxy=#{proxy_uri}\" : ''\n  puppet_enabled = pm_set || @host.param_true?('force-puppet')\n  salt_enabled = @host.params['salt_master'] ? true : false\n  chef_enabled = @host.respond_to?(:chef_proxy) && @host.chef_proxy\n  section_end = (rhel_compatible && os_major <= 5) ? '' : '%end'\n%>\ninstall\n<%= @mediapath %><%= proxy_string %>\nlang <%= @host.params['lang'] || 'en_US.UTF-8' %>\nselinux --<%= @host.params['selinux-mode'] || @host.params['selinux'] || 'enforcing' %>\nkeyboard <%= @host.params['keyboard'] || 'us' %>\nskipx\n\n<% subnet = @host.subnet -%>\n<% if subnet.respond_to?(:dhcp_boot_mode?) -%>\n<% dhcp = subnet.dhcp_boot_mode? && !@static -%>\n<% else -%>\n<% dhcp = !@static -%>\n<% end -%>\nnetwork --bootproto <%= dhcp ? 'dhcp' : \"static --ip=#{@host.ip} --netmask=#{subnet.mask} --gateway=#{subnet.gateway} --nameserver=#{[subnet.dns_primary, subnet.dns_secondary].select{ |item| item.present? }.join(',')}\" %> --hostname <%= @host %><%= os_major >= 6 ? \" --device=#{@host.mac}\" : '' -%>\n\nrootpw --iscrypted <%= root_pass %>\n<% if @host.param_true?('disable-firewall') -%>\nfirewall --disable\n<% else -%>\nfirewall --<%= os_major >= 6 ? 'service=' : '' %>ssh\n<% end -%>\nauthconfig --useshadow --passalgo=<%= @host.operatingsystem.password_hash || 'sha256' %> --kickstart\ntimezone --utc <%= @host.params['time-zone'] || 'UTC' %>\n<% if rhel_compatible -%>\nservices --disabled gpm,sendmail,cups,pcmcia,isdn,rawdevices,hpoj,bluetooth,openibd,avahi-daemon,avahi-dnsconfd,hidd,hplip,pcscd\n<% end -%>\n\n<% if realm_compatible && @host.info['parameters']['realm'] && @host.realm && @host.realm.realm_type == 'Active Directory' -%>\n# One-time password will be requested at install time. Otherwise, $HOST[OTP] is used as a placeholder value.\nrealm join --one-time-password='<%= @host.otp || \"$HOST[OTP]\" %>' <%= @host.realm %>\n<% end -%>\n\n<% if @host.operatingsystem.name == 'Fedora' -%>\nrepo --name=fedora-everything --mirrorlist=https://mirrors.fedoraproject.org/metalink?repo=fedora-<%= @host.operatingsystem.major %>&arch=<%= @host.architecture %><%= proxy_string %>\n<% end -%>\n\n<% if @host.operatingsystem.name == 'OracleLinux' && os_major == 7 -%>\nrepo --name=\"Server-Mysql\"\n<% end -%>\n\n<% if @host.operatingsystem.name == 'Fedora' and os_major <= 16 -%>\n# Bootloader exception for Fedora 16:\nbootloader --append=\"<%= @host.params['bootloader-append'] || 'nofb quiet splash=quiet' %> <%=ks_console%>\" <%= grub_pass %>\npart biosboot --fstype=biosboot --size=1\n<% else -%>\nbootloader --location=mbr --append=\"<%= @host.params['bootloader-append'] || 'nofb quiet splash=quiet' %>\" <%= grub_pass %>\n<% if os_major == 5 -%>\nkey --skip\n<% end -%>\n<% end -%>\n\n<% if @dynamic -%>\n%include /tmp/diskpart.cfg\n<% else -%>\n<%= @host.diskLayout %>\n<% end -%>\n\ntext\n<% if @host.respond_to?(:bootdisk_build?) && @host.bootdisk_build? %>\nreboot --eject\n<% else -%>\nreboot\n<% end -%>\n\n%packages\nyum\ndhclient\nntp\nwget\n@Core\n<% if os_major >= 6 -%>\nredhat-lsb-core\n<% end -%>\n<% if salt_enabled %>\nsalt-minion\n<% end -%>\n<%= section_end -%>\n\n<% if @dynamic -%>\n%pre\n<%= @host.diskLayout %>\n<%= section_end -%>\n<% end -%>\n\n%post --nochroot\nexec < /dev/tty3 > /dev/tty3\n#changing to VT 3 so that we can see whats going on....\n/usr/bin/chvt 3\n(\ncp -va /etc/resolv.conf /mnt/sysimage/etc/resolv.conf\n/usr/bin/chvt 1\n) 2>&1 | tee /mnt/sysimage/root/install.postnochroot.log\n<%= section_end -%>\n\n%post\nlogger \"Starting anaconda <%= @host %> postinstall\"\nexec < /dev/tty3 > /dev/tty3\n#changing to VT 3 so that we can see whats going on....\n/usr/bin/chvt 3\n(\n<% if subnet.respond_to?(:dhcp_boot_mode?) -%>\n<%= snippet 'kickstart_networking_setup' %>\n<% end -%>\n\n#update local time\necho \"updating system time\"\n/usr/sbin/ntpdate -sub <%= @host.params['ntp-server'] || '0.fedora.pool.ntp.org' %>\n/usr/sbin/hwclock --systohc\n\n<% if proxy_uri -%>\n# Yum proxy\necho 'proxy = <%= proxy_uri %>' >> /etc/yum.conf\n<% end -%>\n\n<% if rhel_compatible && !@host.param_false?('enable-epel') -%>\n<%= snippet 'epel' -%>\n<% end -%>\n\n<% if @host.info['parameters']['realm'] && @host.realm && @host.realm.realm_type == 'FreeIPA' -%>\n<%= snippet 'freeipa_register' %>\n<% end -%>\n\n<% unless @host.param_false?('package_upgrade') -%>\n# update all the base packages from the updates repository\nif [ -f /usr/bin/dnf ]; then\n  dnf -y update\nelse\n  yum -t -y update\nfi\n<% end -%>\n\n<%= snippet('remote_execution_ssh_keys') %>\n\n<% if chef_enabled %>\n<%= snippet 'chef_client' %>\n<% end -%>\n\n<% if puppet_enabled %>\n<% if @host.param_true?('enable-puppetlabs-pc1-repo') || @host.param_true?('enable-puppetlabs-repo') -%>\n<%= snippet 'puppetlabs_repo' %>\n<% end -%>\n<%= snippet 'puppet_setup' %>\n<% end -%>\n\n<% if salt_enabled %>\n<%= snippet 'saltstack_setup' %>\n<% end -%>\n\n<% if @host.operatingsystem.name == 'OracleLinux' && @host.param_true?('disable-uek') -%>\n# Uninstall the Oracle Unbreakable Kernel packages\nyum -t -y remove kernel-uek*\nsed -e 's/DEFAULTKERNEL=kernel-uek/DEFAULTKERNEL=kernel/g' -i /etc/sysconfig/kernel\n<% end -%>\n\n<%= snippet('ansible_provisioning_callback') %>\n\nsync\n\n# Inform the build system that we are done.\necho \"Informing Foreman that we are built\"\nwget -q -O /dev/null --no-check-certificate <%= foreman_url('built') %>\n) 2>&1 | tee /root/install.post.log\nexit 0\n\n<%= section_end -%>\n","snippet":false,"template_kind_id":6,"locked":true,"default":true,"vendor":"Foreman","os_family":null,"job_category":"Miscellaneous","provider_type":null,"description_format":null,"execution_timeout_interval":null}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":2,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-02 18:04:37 UTC","id":23,"auditable_id":96,"auditable_name":"Katello Kickstart Default User Data","auditable_type":"ProvisioningTemplate","action":"destroy","audited_changes":{"name":"Katello Kickstart Default User Data","template":"<%#\nkind: user_data\nname: Katello Kickstart default user data\noses:\n- CentOS 6\n- CentOS 7\n- Fedora 19\n- Fedora 20\n- Fedora 21\n- Fedora 22\n- Fedora 23\n-%>\n#cloud-config\nhostname: <%= @host.shortname %>\nfqdn: <%= @host %>\nmanage_etc_hosts: true\n\ngroups:\n - admin\n\nusers:\n - default\n - name: admin\n   primary-group: admin\n   groups: users\n   shell: /bin/bash\n   sudo: ['ALL=(ALL) ALL']\n   lock-passwd: false\n   passwd: <%= @host.root_pass %>\n\n<%# Allow user to specify additional SSH key as host paramter -%>\n<% if @host.params['sshkey'].present? || @host.params['remote_execution_ssh_keys'].present? -%>\nssh_authorized_keys:\n<% if @host.params['sshkey'].present? -%>\n  - <%= @host.params['sshkey'] %>\n<% end -%>\n<% if @host.params['remote_execution_ssh_keys'].present? -%>\n<% @host.params['remote_execution_ssh_keys'].each do |key| -%>\n  - <%= key %>\n<% end -%>\n<% end -%>\n<% end -%>\nwrite_files:\n- path: /tmp/foreman-userdata.sh\n  permissions: '0755'\n  content: |\n    #!/bin/bash\n<%= indent 4 do\n      snippet 'subscription_manager_registration'\n    end %>\n<% if @host.info['parameters']['realm'] && @host.realm && @host.realm.realm_type == 'FreeIPA' -%>\n<%= indent 4 do\n      snippet 'freeipa_register'\n    end %>\n<% end -%>\n  <% unless @host.operatingsystem.atomic? -%>\n    # update all the base packages from the updates repository\n    yum -t -y -e 0 update\n  <% end -%>\n<%\n  # safemode renderer does not support unary negation\n  non_atomic = @host.operatingsystem.atomic? ? false : true\n  pm_set = @host.puppetmaster.empty? ? false : true\n  puppet_enabled = non_atomic && (pm_set || @host.params['force-puppet'])\n  salt_enabled = non_atomic && (@host.params['salt_master'] ? true : false)\n  chef_enabled = @host.respond_to?(:chef_proxy) && @host.chef_proxy\n%>\n<% if chef_enabled %>\n<%= indent 4 do\n      snippet 'chef_client'\n    end  %>\n<% end -%>\n\n<% if puppet_enabled %>\n<%= indent 4 do\n      snippet 'puppet_setup'\n    end %>\n<% end -%>\n\n<% if salt_enabled %>\n<%= indent 4 do\n      snippet 'saltstack_setup'\n    end %>\n<% end -%>\nphone_home:\n url: <%= foreman_url('built') %>\n post: []\n tries: 10\nruncmd:\n - [ cloud-init-per, once, foreman-userdata, /tmp/foreman-userdata.sh ]\noutput: {all: '| tee -a /root/install.userdata.log'}\n\n","snippet":false,"template_kind_id":9,"locked":true,"default":true,"vendor":"Katello","os_family":null,"job_category":"Miscellaneous","provider_type":null,"description_format":null,"execution_timeout_interval":null}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":2,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-02 18:04:37 UTC","id":22,"auditable_id":97,"auditable_name":"Katello Kickstart Default Finish","auditable_type":"ProvisioningTemplate","action":"destroy","audited_changes":{"name":"Katello Kickstart Default Finish","template":"<%#\nkind: finish\nname: Katello Kickstart default finish\noses:\n- CentOS 5\n- CentOS 6\n- CentOS 7\n- RedHat 5\n- RedHat 6\n- RedHat 7\n- Fedora 19\n- Fedora 20\n%>\n<% if @host.subnet.respond_to?(:dhcp_boot_mode?) -%>\n<%= snippet 'kickstart_networking_setup' %>\nservice network restart\n<% end -%>\n\n<%\n  rhel_compatible = @host.operatingsystem.family == 'Redhat' && @host.operatingsystem.name != 'Fedora'\n  os_major = @host.operatingsystem.major.to_i\n  pm_set = @host.puppetmaster.empty? ? false : true\n  puppet_enabled = pm_set || @host.params['force-puppet']\n  salt_enabled = @host.params['salt_master'] ? true : false\n  chef_enabled = @host.respond_to?(:chef_proxy) && @host.chef_proxy\n%>\n\n<%= snippet \"subscription_manager_registration\" %>\n\n<% if @host.respond_to?(:realm) && @host.otp && @host.realm && @host.realm.realm_type == \"FreeIPA\" -%>\n<%= snippet \"freeipa_register\" %>\n<% end -%>\n\n# update local time\necho \"updating system time\"\n/usr/sbin/ntpdate -sub <%= @host.params['ntp-server'] || '0.fedora.pool.ntp.org' %>\n/usr/sbin/hwclock --systohc\n\n<% if @host.info['parameters']['realm'] && @host.realm && @host.realm.realm_type == 'FreeIPA' -%>\n<%= snippet \"freeipa_register\" %>\n<% end -%>\n\n# update all the base packages from the updates repository\nyum -t -y -e 0 update\n\n<%= snippet('remote_execution_ssh_keys') %>\n\n<% if chef_enabled %>\n<%= snippet 'chef_client' %>\n<% end -%>\n\n<% if puppet_enabled %>\n<%= snippet 'puppet_setup' %>\n<% end -%>\n\n<% if salt_enabled %>\n<%= snippet 'saltstack_setup' %>\n<% end -%>\n\nexit 0\n","snippet":false,"template_kind_id":7,"locked":true,"default":true,"vendor":"Katello","os_family":null,"job_category":"Miscellaneous","provider_type":null,"description_format":null,"execution_timeout_interval":null}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":2,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-02 18:04:37 UTC","id":21,"auditable_id":95,"auditable_name":"Katello Kickstart Default","auditable_type":"ProvisioningTemplate","action":"destroy","audited_changes":{"name":"Katello Kickstart Default","template":"<%#\nkind: provision\nname: Katello Kickstart default\noses:\n- CentOS 5\n- CentOS 6\n- CentOS 7\n- RedHat 5\n- RedHat 6\n- RedHat 7\n- Fedora 19\n- Fedora 20\n%>\n<%\n  rhel_compatible = @host.operatingsystem.family == 'Redhat' && @host.operatingsystem.name != 'Fedora'\n  os_major = @host.operatingsystem.major.to_i\n  # safemode renderer does not support unary negation\n  pm_set = @host.puppetmaster.empty? ? false : true\n  puppet_enabled = pm_set || @host.params['force-puppet']\n  salt_enabled = @host.params['salt_master'] ? true : false\n  chef_enabled = @host.respond_to?(:chef_proxy) && @host.chef_proxy\n  section_end = (rhel_compatible && os_major <= 5) ? '' : '%end'\n%>\ninstall\n<%= @mediapath %>\nlang en_US.UTF-8\nselinux --enforcing\nkeyboard us\nskipx\n\n<% subnet = @host.subnet -%>\n<% if subnet.respond_to?(:dhcp_boot_mode?) -%>\n<% dhcp = subnet.dhcp_boot_mode? && !@static -%>\n<% else -%>\n<% dhcp = !@static -%>\n<% end -%>\n\nnetwork --bootproto <%= dhcp ? 'dhcp' : \"static --ip=#{@host.ip} --netmask=#{subnet.mask} --gateway=#{subnet.gateway} --nameserver=#{[subnet.dns_primary, subnet.dns_secondary].select{ |item| item.present? }.join(',')}\" %> --hostname <%= @host %><%= os_major >= 6 ? \" --device=#{@host.mac}\" : '' -%>\n\nrootpw --iscrypted <%= root_pass %>\nfirewall --<%= os_major >= 6 ? 'service=' : '' %>ssh\nauthconfig --useshadow --passalgo=<%= @host.operatingsystem.password_hash || 'sha256' %> --kickstart\ntimezone --utc <%= @host.params['time-zone'] || 'UTC' %>\n\n<% if @host.operatingsystem.name == 'Fedora' and os_major <= 16 -%>\n# Bootloader exception for Fedora 16:\nbootloader --append=\"nofb quiet splash=quiet <%=ks_console%>\" <%= grub_pass %>\npart biosboot --fstype=biosboot --size=1\n<% else -%>\nbootloader --location=mbr --append=\"nofb quiet splash=quiet\" <%= grub_pass %>\n<% end -%>\n\n<% if os_major == 5 -%>\nkey --skip\n<% end -%>\n\n<% if @dynamic -%>\n%include /tmp/diskpart.cfg\n<% else -%>\n<%= @host.diskLayout %>\n<% end -%>\n\ntext\nreboot\n\n%packages --ignoremissing\nyum\ndhclient\nntp\nwget\n@Core\n<%= section_end -%>\n\n<% if @dynamic -%>\n%pre\n<%= @host.diskLayout %>\n<%= section_end -%>\n<% end -%>\n\n%post --nochroot\nexec < /dev/tty3 > /dev/tty3\n#changing to VT 3 so that we can see whats going on....\n/usr/bin/chvt 3\n(\ncp -va /etc/resolv.conf /mnt/sysimage/etc/resolv.conf\n/usr/bin/chvt 1\n) 2>&1 | tee /mnt/sysimage/root/install.postnochroot.log\n<%= section_end -%>\n\n\n%post\nlogger \"Starting anaconda <%= @host %> postinstall\"\nexec < /dev/tty3 > /dev/tty3\n#changing to VT 3 so that we can see whats going on....\n/usr/bin/chvt 3\n(\n<% if subnet.respond_to?(:dhcp_boot_mode?) -%>\n<%= snippet 'kickstart_networking_setup' %>\n<% end -%>\n\n#update local time\necho \"updating system time\"\n/usr/sbin/ntpdate -sub <%= @host.params['ntp-server'] || '0.fedora.pool.ntp.org' %>\n/usr/sbin/hwclock --systohc\n\n<%= snippet \"subscription_manager_registration\" %>\n\n<% if @host.info['parameters']['realm'] && @host.realm && @host.realm.realm_type == 'FreeIPA' -%>\n<%= snippet \"freeipa_register\" %>\n<% end -%>\n\n# update all the base packages from the updates repository\nyum -t -y -e 0 update\n\n<%= snippet('remote_execution_ssh_keys') %>\n\n<% if chef_enabled %>\n<%= snippet 'chef_client' %>\n<% end -%>\n\n<% if puppet_enabled %>\n<%= snippet 'puppet_setup' %>\n<% end -%>\n\n<% if salt_enabled %>\n<%= snippet 'saltstack_setup' %>\n<% end -%>\n\nsync\n\n<% if @provisioning_type == nil || @provisioning_type == 'host' -%>\n# Inform the build system that we are done.\necho \"Informing Foreman that we are built\"\nwget -q -O /dev/null --no-check-certificate <%= foreman_url('built') %>\n<% end -%>\n) 2>&1 | tee /root/install.post.log\nexit 0\n\n<%= section_end -%>\n","snippet":false,"template_kind_id":6,"locked":true,"default":true,"vendor":"Katello","os_family":null,"job_category":"Miscellaneous","provider_type":null,"description_format":null,"execution_timeout_interval":null}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":2,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-02 18:04:37 UTC","id":20,"auditable_id":99,"auditable_name":"Katello Atomic Kickstart Default","auditable_type":"ProvisioningTemplate","action":"destroy","audited_changes":{"name":"Katello Atomic Kickstart Default","template":"<%#\nkind: provision\nname: Katello Atomic Kickstart default\n%>\n\nlang <%= @host.params['lang'] || 'en_US.UTF-8' %>\nkeyboard <%= @host.params['keyboard'] || 'us' %>\ntimezone --utc <%= @host.params['time-zone'] || 'UTC' %>\n\n<% subnet = @host.subnet -%>\n<% if subnet.respond_to?(:dhcp_boot_mode?) -%>\n<% dhcp = subnet.dhcp_boot_mode? && !@static -%>\n<% else -%>\n<% dhcp = !@static -%>\n<% end -%>\n\nnetwork --bootproto <%= dhcp ? 'dhcp' : \"static --ip=#{@host.ip} --netmask=#{subnet.mask} --gateway=#{subnet.gateway} --nameserver=#{[subnet.dns_primary, subnet.dns_secondary].select{ |item| item.present? }.join(',')}\" %> --hostname <%= @host %><%= \" --device=#{@host.mac}\" -%>\n\n# Partition table should create /boot and a volume atomicos\n<% if @dynamic -%>\n%include /tmp/diskpart.cfg\n<% else -%>\n<%= @host.diskLayout %>\n<% end -%>\n\nbootloader --timeout=3\ntext\n\n<% if @host.os.name.match /.*fedora.*/i -%>\nostreesetup --nogpg --osname=fedora-atomic --remote=fedora-atomic --url=<%= @host.param_true?('atomic-upstream') ? \"https://dl.fedoraproject.org/pub/fedora/linux/atomic/#{@host.os.major}/\" : \"#{@host.operatingsystem.medium_uri(@host)}/content/repo/\" %> --ref=fedora-atomic/f<%= @host.os.major %>/<%= @host.architecture %>/docker-host\n<% elsif @host.os.name.match /.*centos.*/i -%>\nostreesetup --nogpg --osname=centos-atomic-host --remote=centos-atomic-host --url=<%= @host.param_true?('atomic-upstream') ? \"http://mirror.centos.org/centos/#{@host.os.major}/atomic/#{@host.architecture}/repo/\" : @host.operatingsystem.medium_uri(@host) %> --ref=centos-atomic-host/<%= @host.os.major %>/<%= @host.architecture %>/standard\n<% else -%>\nostreesetup --nogpg --osname=rhel-atomic-host --remote=rhel-atomic-host --url=file:///install/ostree --ref=rhel-atomic-host/<%= @host.os.major %>/<%= @host.architecture %>/standard\n<% end -%>\nservices --disabled cloud-init,cloud-config,cloud-final,cloud-init-local\nrootpw --iscrypted <%= root_pass %>\n\nreboot\n\n%post\n<%= snippet \"subscription_manager_registration\" %>\n<%= snippet('remote_execution_ssh_keys') %>\n(\n# Report success back to Foreman\ncurl -s -o /dev/null --insecure <%= foreman_url('built') %>\n) 2>&1 | tee /mnt/sysimage/root/install.post.log\n\nexit 0\n\n%end\n","snippet":false,"template_kind_id":6,"locked":true,"default":true,"vendor":"Katello","os_family":null,"job_category":"Miscellaneous","provider_type":null,"description_format":null,"execution_timeout_interval":null}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-02 18:04:36 UTC","id":19,"auditable_id":121,"auditable_name":null,"auditable_type":"ProvisioningTemplate","action":"create","audited_changes":{"name":"Satellite Atomic Kickstart Default","template":"<%#\nkind: provision\nname: Satellite Atomic Kickstart default\n%>\n\nlang <%= @host.params['lang'] || 'en_US.UTF-8' %>\nkeyboard <%= @host.params['keyboard'] || 'us' %>\ntimezone --utc <%= @host.params['time-zone'] || 'UTC' %>\n\n<% subnet = @host.subnet -%>\n<% if subnet.respond_to?(:dhcp_boot_mode?) -%>\n<% dhcp = subnet.dhcp_boot_mode? && !@static -%>\n<% else -%>\n<% dhcp = !@static -%>\n<% end -%>\n\nnetwork --bootproto <%= dhcp ? 'dhcp' : \"static --ip=#{@host.ip} --netmask=#{subnet.mask} --gateway=#{subnet.gateway} --nameserver=#{[subnet.dns_primary, subnet.dns_secondary].select{ |item| item.present? }.join(',')}\" %> --hostname <%= @host %><%= \" --device=#{@host.mac}\" -%>\n\n# Partition table should create /boot and a volume atomicos\n<% if @dynamic -%>\n%include /tmp/diskpart.cfg\n<% else -%>\n<%= @host.diskLayout %>\n<% end -%>\n\nbootloader --timeout=3\ntext\n\n<% if @host.os.name.match /.*fedora.*/i -%>\nostreesetup --nogpg --osname=fedora-atomic --remote=fedora-atomic --url=<%= @host.param_true?('atomic-upstream') ? \"https://dl.fedoraproject.org/pub/fedora/linux/atomic/#{@host.os.major}/\" : \"#{@host.operatingsystem.medium_uri(@host)}/content/repo/\" %> --ref=fedora-atomic/f<%= @host.os.major %>/<%= @host.architecture %>/docker-host\n<% elsif @host.os.name.match /.*centos.*/i -%>\nostreesetup --nogpg --osname=centos-atomic-host --remote=centos-atomic-host --url=<%= @host.param_true?('atomic-upstream') ? \"http://mirror.centos.org/centos/#{@host.os.major}/atomic/#{@host.architecture}/repo/\" : @host.operatingsystem.medium_uri(@host) %> --ref=centos-atomic-host/<%= @host.os.major %>/<%= @host.architecture %>/standard\n<% else -%>\nostreesetup --nogpg --osname=rhel-atomic-host --remote=rhel-atomic-host --url=file:///install/ostree --ref=rhel-atomic-host/<%= @host.os.major %>/<%= @host.architecture %>/standard\n<% end -%>\nservices --disabled cloud-init,cloud-config,cloud-final,cloud-init-local\nrootpw --iscrypted <%= root_pass %>\n\nreboot\n\n%post\n<%= snippet \"subscription_manager_registration\" %>\n<%= snippet('remote_execution_ssh_keys') %>\n(\n# Report success back to Foreman\ncurl -s -o /dev/null --insecure <%= foreman_url('built') %>\n) 2>&1 | tee /mnt/sysimage/root/install.post.log\n\nexit 0\n\n%end\n","snippet":false,"template_kind_id":6,"locked":true,"default":true,"vendor":"Satellite","os_family":null,"job_category":"Miscellaneous","provider_type":null,"description_format":null,"execution_timeout_interval":null}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-02 18:04:36 UTC","id":18,"auditable_id":120,"auditable_name":null,"auditable_type":"ProvisioningTemplate","action":"create","audited_changes":{"name":"idm_register","template":"<%#\nkind: snippet\nname: idm_register\n%>\n# Identity Management Registration Snippet\n#\n# Optional parameters:\n#\n#   idm_server              IdM server\n#\n#   idm_sudo                Enable sudoers\n#                           Default: true\n#\n#   idm_ssh                 Enable ssh integration\n#                           Default: true\n#\n#   idm_automount           Enable automounter\n#                           Default: false\n#\n#   idm_automount_location  Location for automounts\n#\n#   idm_mkhomedir           Enable automatically making home directories\n#                           Default: true\n#\n#   idm_opts                Additional options to pass directly to installer\n#\n#   idm_automount_server    Override automount server if idm_automount is true and the server differs from idm_server\n#\n\n<% if @host.operatingsystem.family == 'Redhat' -%>\n  <% if @host.operatingsystem.name == 'Fedora' -%>\n    idm_client=freeipa-client\n  <% else -%>\n    idm_client=ipa-client\n  <% end -%>\n  <% if @host.operatingsystem.major.to_i > 6 -%>\n    /usr/sbin/sshd-keygen\n  <% end -%>\n<% else -%>\n  idm_client=freeipa-client\n<% end -%>\n\n<%= @host.operatingsystem.family == 'Redhat' ? 'yum install -y libsss_sudo' : 'apt-get install -y libsss-sudo' %> $idm_client\n\n##\n## IDM Client Installation\n##\n<% if @host.params['idm_server'] -%>\n<% domain = @host.params['idm_domain'] || @host.realm.name.downcase -%>\n\nidm_server=\"--server <%= @host.params['idm_server'] %>\"\nidm_domain=\"--domain <%= domain %>\"\n<% end -%>\n\n<% unless @host.param_false? 'idm_mkhomedir' %>\nidm_mkhomedir=\"--mkhomedir\"\n<% end -%>\n\n<% if @host.param_false? 'idm_ssh' %>\nidm_ssh=\"--no-ssh\"\n<% end -%>\n\n<% if @host.params['idm_opts'] -%>\nidm_opts=\"<%= @host.params['idm_opts'] %>\"\n<% end -%>\n\n# One-time password will be requested at install time. Otherwise, $HOST[OTP] is used as a placeholder value.\n/usr/sbin/ipa-client-install -w '<%= @host.otp || \"$HOST[OTP]\" %>' --realm=<%= @host.realm %> -U $idm_mkhomedir $idm_opts $idm_server $idm_domain $idm_ssh\n\n##\n## Automounter\n##\n\n<% if @host.params['idm_automount_location'] -%>\nautomount_location=\"--location <%= @host.params['idm_automount_location'] %>\"\n<% end -%>\n\n<% if @host.param_true? 'idm_automount' -%>\nif [ -f /usr/sbin/ipa-client-automount ]\nthen\n  automount_server=$idm_server\n  <%- if automount_server = @host.params['idm_automount_server'] || @host.params['idm_server'] -%>\n  automount_server=\"--server <%= automount_server %>\"\n  <%- end -%>\n  /usr/sbin/ipa-client-automount $automount_server $automount_location --unattended\nfi\n<% end -%>\n\n##\n## Sudoers\n##\n\n<% unless @host.param_false? 'idm_enable_sudo' %>\n\nidm_client_version=$(ipa-client-install --version)\nidm_client_version_major=$(echo $idm_client_version | cut -f1 -d.)\nidm_client_version_minor=$(echo $idm_client_version | cut -f2 -d.)\nidm_realm=$(grep default_realm /etc/krb5.conf | cut -d\"=\" -f2 | tr -d ' ')\nidm_domain=$(grep -A 2 domain_realm /etc/krb5.conf | tail -n1 | awk '{print $1}')\nidm_dn=$(for word in $(echo $idm_domain | sed 's/\\./ /g'); do echo -n dc=$word,; done)\nsssd_version=$(sssd --version)\nsssd_major=$(echo $sssd_version | cut -f1 -d.)\nsssd_minor=$(echo $sssd_version | cut -f2 -d.)\nLDAP_CONFIG=$(mktemp)\n\n# >=ipa-client-4.1.0 automatically configures sssd for sudo\n# =<ipa-client-3 requires manual configuration which this snippet takes care of\n\nif [ $idm_client_version_major -lt 4 ]\nthen\n  # Modify sssd.conf\n  sed -i -e \"s/services = .*/\\0, sudo/\" /etc/sssd/sssd.conf\n\n  # Modify sssd.conf for sssd <1.11 (RHEL <6.6)\n  if [ $sssd_minor -lt 11 ] || [ $sssd_major -lt 1 ]\n  then\n    <% if @host.params['idm_server'] -%>\n    ldap_uri=\", ldap://<%= @host.params['idm_server'] %>\"\n    krb5_server=<%= @host.params['idm_server'] %>\n    <% else -%>\n    krb5_server=\"_srv_\"\n    <% end -%>\n\ncat <<EOF > $LDAP_CONFIG\nsudo_provider = ldap\nldap_uri = _srv_ $ldap_uri\nldap_sudo_search_base = ou=SUDOers,${idm_dn%?}\nldap_sasl_mech = GSSAPI\nldap_sasl_authid = host/$HOSTNAME\nldap_sasl_realm = $idm_realm\nkrb5_server = $krb5_server\nEOF\n  sed -i -e \"/\\[domain\\/.*\\]/ r $LDAP_CONFIG\" /etc/sssd/sssd.conf\n  fi\n\n  # Modify nsswitch.conf\n  grep -q sudoers /etc/nsswitch.conf\n  if [[ $? -eq 0 ]];\n  then\n    sed -i -e \"s/^sudoers.*/sudoers:    files sss/\" /etc/nsswitch.conf\n  else\n    echo \"sudoers:    files sss\" >> /etc/nsswitch.conf\n  fi\n\n  # Configure nisdomain\n  <% if @host.operatingsystem.family == 'Redhat' -%>\n    authconfig --nisdomain ${idm_domain} --update\n    chkconfig sssd on\n\n    if [[ $(rpm -qa systemd | wc -l) -gt 0 ]];\n    then\n      domain_service=/usr/lib/systemd/system/*-domainname.service\n\n      # Workaround for BZ1071969 on RHEL 7.0\n      grep -q \"DefaultDependencies=no\" $domain_service\n      if [[ $? -ne 0 ]]\n      then\n        sed -i -e \"s/\\[Unit\\]/\\[Unit\\]\\nDefaultDependencies=no/\" $domain_service\n      fi\n\n      systemctl start $(basename $domain_service)\n      systemctl enable $(basename $domain_service)\n    fi\n  <% else -%>\n  # OS is not RedHat\n  sed -i -e '/^exit /d' /etc/rc.local\n  echo \"nisdomainname ${idm_domain}\" >> /etc/rc.local\n  echo \"exit 0\" >> /etc/rc.local\n  nisdomainname ${idm_domain}\n  <% end -%>\nfi\n\n<% end -%>\n\n","snippet":true,"template_kind_id":null,"locked":true,"default":true,"vendor":"Satellite","os_family":null,"job_category":"Miscellaneous","provider_type":null,"description_format":null,"execution_timeout_interval":null}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-02 18:04:36 UTC","id":17,"auditable_id":73,"auditable_name":"pxegrub2_discovery","auditable_type":"ProvisioningTemplate","action":"update","audited_changes":{"template":["<%#\nkind: snippet\nname: pxegrub2_discovery\n-%>\n<%#\ndiscovery image is based on CentOS/RHEL and therefor it is affected by https://bugzilla.redhat.com/show_bug.cgi?id=1259015.\nIn short, before RHEL 7.2 virtio driver didn't have the new persistent naming scheme, causing interfaces to be named eth0, eth1, etc..\nIf you want to enable the new persistent naming scheme and get inteface names like ens3, add net.ifnames=1 to the linuxefi line below.\n-%>\nmenuentry 'Foreman Discovery Image' {\n  linuxefi boot/fdi-image/vmlinuz0 rootflags=loop root=live:/fdi.iso rootfstype=auto ro rd.live.image acpi=force rd.luks=0 rd.md=0 rd.dm=0 rd.lvm=0 rd.bootif=0 rd.neednet=0 nomodeset proxy.url=<%= foreman_server_url %> proxy.type=foreman BOOTIF=01-$net_default_mac\n  initrdefi boot/fdi-image/initrd0.img\n}\n","<%#\nkind: snippet\nname: pxegrub2_discovery\n-%>\n<%#\nRHEL 7 virtio driver does not have persistent naming scheme, causing interfaces\nto be named eth0, eth1, etc.. If you want to enable the new persistent naming\nscheme and get inteface names like ens3, add net.ifnames=1 to the linuxefi line\nbelow. This will not be fixed until RHEL8 due to prevent breaking changes for\nexisting systems. See RHBZ#1259015 for more details.\n\nAnother bug in RHEL 7.4 is affecting $net_default_mac with a trailing slash, in\nthe global template we have a regexp module creating corrected variable $mac\nwhich is used here. See RHBZ#1487107 for more info.\n-%>\nmenuentry 'Foreman Discovery Image' {\n  linuxefi boot/fdi-image-rhel_7-vmlinuz rootflags=loop root=live:/fdi.iso rootfstype=auto ro rd.live.image acpi=force rd.luks=0 rd.md=0 rd.dm=0 rd.lvm=0 rd.bootif=0 rd.neednet=0 nomodeset proxy.url=<%= foreman_server_url %> proxy.type=foreman BOOTIF=01-$mac\n  initrdefi boot/fdi-image-rhel_7-img\n}\n"],"vendor":["Foreman","Satellite"]}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-02 18:04:36 UTC","id":16,"auditable_id":75,"auditable_name":"pxegrub_discovery","auditable_type":"ProvisioningTemplate","action":"update","audited_changes":{"template":["<%#\nkind: snippet\nname: pxegrub_discovery\n-%>\n<%#\ndiscovery image is based on CentOS/RHEL and therefor it is affected by https://bugzilla.redhat.com/show_bug.cgi?id=1259015.\nIn short, before RHEL 7.2 virtio driver didn't have the new persistent naming scheme, causing interfaces to be named eth0, eth1, etc..\nIf you want to enable the new persistent naming scheme and get inteface names like ens3, add net.ifnames=1 to the kernel line below.\n-%>\n# http://projects.theforeman.org/issues/15997\ntitle Foreman Discovery Image - not supported with Grub 1.x\n  kernel boot/fdi-image/vmlinuz0 rootflags=loop root=live:/fdi.iso rootfstype=auto ro rd.live.image acpi=force rd.luks=0 rd.md=0 rd.dm=0 rd.lvm=0 rd.bootif=0 rd.neednet=0 nomodeset proxy.url=<%= foreman_server_url %> proxy.type=foreman BOOTIF=01-$net_default_mac\n  initrd boot/fdi-image/initrd0.img\n","<%#\nkind: snippet\nname: pxegrub_discovery\n-%>\n<%#\ndiscovery image is based on CentOS/RHEL and therefor it is affected by https://bugzilla.redhat.com/show_bug.cgi?id=1259015.\nIn short, before RHEL 7.2 virtio driver didn't have the new persistent naming scheme, causing interfaces to be named eth0, eth1, etc..\nIf you want to enable the new persistent naming scheme and get inteface names like ens3, add net.ifnames=1 to the kernel line below.\n-%>\n# http://projects.theforeman.org/issues/15997\ntitle Foreman Discovery Image - not supported with Grub 1.x\n  kernel boot/fdi-image-rhel_7-vmlinuz rootflags=loop root=live:/fdi.iso rootfstype=auto ro rd.live.image acpi=force rd.luks=0 rd.md=0 rd.dm=0 rd.lvm=0 rd.bootif=0 rd.neednet=0 nomodeset proxy.url=<%= foreman_server_url %> proxy.type=foreman BOOTIF=01-$net_default_mac\n  initrd boot/fdi-image-rhel_7-img\n"],"vendor":["Foreman","Satellite"]}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-02 18:04:36 UTC","id":15,"auditable_id":77,"auditable_name":"pxelinux_discovery","auditable_type":"ProvisioningTemplate","action":"update","audited_changes":{"template":["<%#\nkind: snippet\nname: pxelinux_discovery\n-%>\n<%#\ndiscovery image is based on CentOS/RHEL and therefor it is affected by https://bugzilla.redhat.com/show_bug.cgi?id=1259015.\nIn short, before RHEL 7.2 virtio driver didn't have the new persistent naming scheme, causing interfaces to be named eth0, eth1, etc..\nIf you want to enable the new persistent naming scheme and get inteface names like ens3, add net.ifnames=1 to the APPEND line below.\n-%>\nLABEL discovery\n  MENU LABEL Foreman Discovery Image\n  KERNEL boot/fdi-image/vmlinuz0\n  APPEND initrd=boot/fdi-image/initrd0.img rootflags=loop root=live:/fdi.iso rootfstype=auto ro rd.live.image acpi=force rd.luks=0 rd.md=0 rd.dm=0 rd.lvm=0 rd.bootif=0 rd.neednet=0 nomodeset proxy.url=<%= foreman_server_url %> proxy.type=foreman\n  IPAPPEND 2\n","<%#\nkind: snippet\nname: pxelinux_discovery\n-%>\n<%#\ndiscovery image is based on CentOS/RHEL and therefor it is affected by https://bugzilla.redhat.com/show_bug.cgi?id=1259015.\nIn short, before RHEL 7.2 virtio driver didn't have the new persistent naming scheme, causing interfaces to be named eth0, eth1, etc..\nIf you want to enable the new persistent naming scheme and get inteface names like ens3, add net.ifnames=1 to the APPEND line below.\n-%>\nLABEL discovery\n  MENU LABEL Foreman Discovery Image\n  KERNEL boot/fdi-image-rhel_7-vmlinuz\n  APPEND initrd=boot/fdi-image-rhel_7-img rootflags=loop root=live:/fdi.iso rootfstype=auto ro rd.live.image acpi=force rd.luks=0 rd.md=0 rd.dm=0 rd.lvm=0 rd.bootif=0 rd.neednet=0 nomodeset proxy.url=<%= foreman_server_url %> proxy.type=foreman\n  IPAPPEND 2\n"],"vendor":["Foreman","Satellite"]}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-02 18:04:36 UTC","id":14,"auditable_id":119,"auditable_name":null,"auditable_type":"ProvisioningTemplate","action":"create","audited_changes":{"name":"Satellite Kickstart Default Finish","template":"<%#\nkind: finish\nname: Satellite Kickstart default finish\noses:\n- CentOS 5\n- CentOS 6\n- CentOS 7\n- RedHat 5\n- RedHat 6\n- RedHat 7\n- Fedora 19\n- Fedora 20\n%>\n<% if @host.subnet.respond_to?(:dhcp_boot_mode?) -%>\n<%= snippet 'kickstart_networking_setup' %>\nservice network restart\n<% end -%>\n\n<%\n  rhel_compatible = @host.operatingsystem.family == 'Redhat' && @host.operatingsystem.name != 'Fedora'\n  os_major = @host.operatingsystem.major.to_i\n  pm_set = @host.puppetmaster.empty? ? false : true\n  puppet_enabled = pm_set || @host.params['force-puppet']\n  salt_enabled = @host.params['salt_master'] ? true : false\n  chef_enabled = @host.respond_to?(:chef_proxy) && @host.chef_proxy\n%>\n\n<%= snippet \"subscription_manager_registration\" %>\n\n<% if @host.respond_to?(:realm) && @host.otp && @host.realm && @host.realm.realm_type == \"Red Hat Identity Management\" -%>\n<%= snippet \"idm_register\" %>\n<% end -%>\n\n# update local time\necho \"updating system time\"\n/usr/sbin/ntpdate -sub <%= @host.params['ntp-server'] || '0.fedora.pool.ntp.org' %>\n/usr/sbin/hwclock --systohc\n\n<% if @host.info['parameters']['realm'] && @host.realm && @host.realm.realm_type == 'Red Hat Identity Management' -%>\n<%= snippet \"idm_register\" %>\n<% end -%>\n\n# update all the base packages from the updates repository\nyum -t -y -e 0 update\n\n<%= snippet('remote_execution_ssh_keys') %>\n\n<% if chef_enabled %>\n<%= snippet 'chef_client' %>\n<% end -%>\n\n<% if puppet_enabled %>\n<%= snippet 'puppet_setup' %>\n<% end -%>\n\n<% if salt_enabled %>\n<%= snippet 'saltstack_setup' %>\n<% end -%>\n\n<% if host_param_true?('ansible_tower_provisioning') -%>\n<%= save_to_file('/root/ansible_provisioning_call.sh', snippet('ansible_tower_callback_script')) %>\n/root/ansible_provisioning_call.sh\n<% end -%>\n\nexit 0\n","snippet":false,"template_kind_id":7,"locked":true,"default":true,"vendor":"Satellite","os_family":null,"job_category":"Miscellaneous","provider_type":null,"description_format":null,"execution_timeout_interval":null}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-02 18:04:36 UTC","id":13,"auditable_id":118,"auditable_name":null,"auditable_type":"ProvisioningTemplate","action":"create","audited_changes":{"name":"Satellite Kickstart Default User Data","template":"<%#\nkind: user_data\nname: Satellite Kickstart default user data\noses:\n- CentOS 6\n- CentOS 7\n- Fedora 19\n- Fedora 20\n- Fedora 21\n- Fedora 22\n- Fedora 23\n-%>\n#cloud-config\nhostname: <%= @host.shortname %>\nfqdn: <%= @host %>\nmanage_etc_hosts: true\n\ngroups:\n - admin\n\nusers:\n - default\n - name: admin\n   primary-group: admin\n   groups: users\n   shell: /bin/bash\n   sudo: ['ALL=(ALL) ALL']\n   lock-passwd: false\n   passwd: <%= @host.root_pass %>\n\n<%# Allow user to specify additional SSH key as host paramter -%>\n<% if @host.params['sshkey'].present? || @host.params['remote_execution_ssh_keys'].present? -%>\nssh_authorized_keys:\n<% if @host.params['sshkey'].present? -%>\n  - <%= @host.params['sshkey'] %>\n<% end -%>\n<% if @host.params['remote_execution_ssh_keys'].present? -%>\n<% @host.params['remote_execution_ssh_keys'].each do |key| -%>\n  - <%= key %>\n<% end -%>\n<% end -%>\n<% end -%>\nwrite_files:\n- path: /tmp/foreman-userdata.sh\n  permissions: '0755'\n  content: |\n    #!/bin/bash\n<%= indent 4 do\n      snippet 'subscription_manager_registration'\n    end %>\n<% if @host.info['parameters']['realm'] && @host.realm && @host.realm.realm_type == 'Red Hat Identity Management' -%>\n<%= indent 4 do\n      snippet 'idm_register'\n    end %>\n<% end -%>\n  <% unless @host.operatingsystem.atomic? -%>\n    # update all the base packages from the updates repository\n    yum -t -y -e 0 update\n  <% end -%>\n<%\n  # safemode renderer does not support unary negation\n  non_atomic = @host.operatingsystem.atomic? ? false : true\n  pm_set = @host.puppetmaster.empty? ? false : true\n  puppet_enabled = non_atomic && (pm_set || @host.params['force-puppet'])\n  salt_enabled = non_atomic && (@host.params['salt_master'] ? true : false)\n  chef_enabled = @host.respond_to?(:chef_proxy) && @host.chef_proxy\n%>\n<% if chef_enabled %>\n<%= indent 4 do\n      snippet 'chef_client'\n    end  %>\n<% end -%>\n\n<% if puppet_enabled %>\n<%= indent 4 do\n      snippet 'puppet_setup'\n    end %>\n<% end -%>\n\n<% if salt_enabled %>\n<%= indent 4 do\n      snippet 'saltstack_setup'\n    end %>\n<% end -%>\nphone_home:\n url: <%= foreman_url('built') %>\n post: []\n tries: 10\nruncmd:\n - [ cloud-init-per, once, foreman-userdata, /tmp/foreman-userdata.sh ]\noutput: {all: '| tee -a /root/install.userdata.log'}\n\n","snippet":false,"template_kind_id":9,"locked":true,"default":true,"vendor":"Satellite","os_family":null,"job_category":"Miscellaneous","provider_type":null,"description_format":null,"execution_timeout_interval":null}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-02 18:04:35 UTC","id":12,"auditable_id":117,"auditable_name":null,"auditable_type":"ProvisioningTemplate","action":"create","audited_changes":{"name":"Satellite Kickstart Default","template":"<%#\nkind: provision\nname: Satellite Kickstart default\noses:\n- CentOS 5\n- CentOS 6\n- CentOS 7\n- RedHat 5\n- RedHat 6\n- RedHat 7\n- Fedora 19\n- Fedora 20\n%>\n<%\n  rhel_compatible = @host.operatingsystem.family == 'Redhat' && @host.operatingsystem.name != 'Fedora'\n  os_major = @host.operatingsystem.major.to_i\n  # safemode renderer does not support unary negation\n  pm_set = @host.puppetmaster.empty? ? false : true\n  puppet_enabled = pm_set || @host.params['force-puppet']\n  salt_enabled = @host.params['salt_master'] ? true : false\n  chef_enabled = @host.respond_to?(:chef_proxy) && @host.chef_proxy\n  section_end = (rhel_compatible && os_major <= 5) ? '' : '%end'\n%>\ninstall\n<%= @mediapath %>\nlang en_US.UTF-8\nselinux --enforcing\nkeyboard us\nskipx\n\n<% subnet = @host.subnet -%>\n<% if subnet.respond_to?(:dhcp_boot_mode?) -%>\n<% dhcp = subnet.dhcp_boot_mode? && !@static -%>\n<% else -%>\n<% dhcp = !@static -%>\n<% end -%>\n\nnetwork --bootproto <%= dhcp ? 'dhcp' : \"static --ip=#{@host.ip} --netmask=#{subnet.mask} --gateway=#{subnet.gateway} --nameserver=#{[subnet.dns_primary, subnet.dns_secondary].select{ |item| item.present? }.join(',')}\" %> --hostname <%= @host %><%= os_major >= 6 ? \" --device=#{@host.mac}\" : '' -%>\n\nrootpw --iscrypted <%= root_pass %>\nfirewall --<%= os_major >= 6 ? 'service=' : '' %>ssh\nauthconfig --useshadow --passalgo=<%= @host.operatingsystem.password_hash || 'sha256' %> --kickstart\ntimezone --utc <%= @host.params['time-zone'] || 'UTC' %>\n\n<% if @host.operatingsystem.name == 'Fedora' and os_major <= 16 -%>\n# Bootloader exception for Fedora 16:\nbootloader --append=\"nofb quiet splash=quiet <%=ks_console%>\" <%= grub_pass %>\npart biosboot --fstype=biosboot --size=1\n<% else -%>\nbootloader --location=mbr --append=\"nofb quiet splash=quiet\" <%= grub_pass %>\n<% end -%>\n\n<% if os_major == 5 -%>\nkey --skip\n<% end -%>\n\n<% if @dynamic -%>\n%include /tmp/diskpart.cfg\n<% else -%>\n<%= @host.diskLayout %>\n<% end -%>\n\ntext\nreboot\n\n%packages --ignoremissing\nyum\ndhclient\nntp\nwget\n@Core\n<%= section_end -%>\n\n<% if @dynamic -%>\n%pre\n<%= @host.diskLayout %>\n<%= section_end -%>\n<% end -%>\n\n%post --nochroot\nexec < /dev/tty3 > /dev/tty3\n#changing to VT 3 so that we can see whats going on....\n/usr/bin/chvt 3\n(\ncp -va /etc/resolv.conf /mnt/sysimage/etc/resolv.conf\n/usr/bin/chvt 1\n) 2>&1 | tee /mnt/sysimage/root/install.postnochroot.log\n<%= section_end -%>\n\n\n%post\nlogger \"Starting anaconda <%= @host %> postinstall\"\nexec < /dev/tty3 > /dev/tty3\n#changing to VT 3 so that we can see whats going on....\n/usr/bin/chvt 3\n(\n<% if subnet.respond_to?(:dhcp_boot_mode?) -%>\n<%= snippet 'kickstart_networking_setup' %>\n<% end -%>\n\n#update local time\necho \"updating system time\"\n/usr/sbin/ntpdate -sub <%= @host.params['ntp-server'] || '0.fedora.pool.ntp.org' %>\n/usr/sbin/hwclock --systohc\n\n<%= snippet \"subscription_manager_registration\" %>\n\n<% if @host.info['parameters']['realm'] && @host.realm && @host.realm.realm_type == 'Red Hat Identity Management' -%>\n<%= snippet \"idm_register\" %>\n<% end -%>\n\n# update all the base packages from the updates repository\nyum -t -y -e 0 update\n\n<%= snippet('remote_execution_ssh_keys') %>\n\n<% if chef_enabled %>\n<%= snippet 'chef_client' %>\n<% end -%>\n\n<% if puppet_enabled %>\n<%= snippet 'puppet_setup' %>\n<% end -%>\n\n<% if salt_enabled %>\n<%= snippet 'saltstack_setup' %>\n<% end -%>\n\n<%= snippet('ansible_provisioning_callback') %>\n\nsync\n\n<% if @provisioning_type == nil || @provisioning_type == 'host' -%>\n# Inform the build system that we are done.\necho \"Informing Foreman that we are built\"\nwget -q -O /dev/null --no-check-certificate <%= foreman_url('built') %>\n<% end -%>\n) 2>&1 | tee /root/install.post.log\nexit 0\n\n<%= section_end -%>\n","snippet":false,"template_kind_id":6,"locked":true,"default":true,"vendor":"Satellite","os_family":null,"job_category":"Miscellaneous","provider_type":null,"description_format":null,"execution_timeout_interval":null}},{"user_id":null,"user_type":null,"user_name":null,"version":1,"comment":null,"associated_id":8,"associated_type":"Role","remote_address":null,"associated_name":"Default role","created_at":"2018-03-02 18:04:34 UTC","id":11,"auditable_id":147,"auditable_name":"","auditable_type":"Filter","action":"create","audited_changes":{"search":"owner.id = current_user","role_id":8,"taxonomy_search":null,"override":false}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-02 18:04:33 UTC","id":10,"auditable_id":99,"auditable_name":null,"auditable_type":"ProvisioningTemplate","action":"create","audited_changes":{"name":"Katello Atomic Kickstart Default","template":"<%#\nkind: provision\nname: Katello Atomic Kickstart default\n%>\n\nlang <%= @host.params['lang'] || 'en_US.UTF-8' %>\nkeyboard <%= @host.params['keyboard'] || 'us' %>\ntimezone --utc <%= @host.params['time-zone'] || 'UTC' %>\n\n<% subnet = @host.subnet -%>\n<% if subnet.respond_to?(:dhcp_boot_mode?) -%>\n<% dhcp = subnet.dhcp_boot_mode? && !@static -%>\n<% else -%>\n<% dhcp = !@static -%>\n<% end -%>\n\nnetwork --bootproto <%= dhcp ? 'dhcp' : \"static --ip=#{@host.ip} --netmask=#{subnet.mask} --gateway=#{subnet.gateway} --nameserver=#{[subnet.dns_primary, subnet.dns_secondary].select{ |item| item.present? }.join(',')}\" %> --hostname <%= @host %><%= \" --device=#{@host.mac}\" -%>\n\n# Partition table should create /boot and a volume atomicos\n<% if @dynamic -%>\n%include /tmp/diskpart.cfg\n<% else -%>\n<%= @host.diskLayout %>\n<% end -%>\n\nbootloader --timeout=3\ntext\n\n<% if @host.os.name.match /.*fedora.*/i -%>\nostreesetup --nogpg --osname=fedora-atomic --remote=fedora-atomic --url=<%= @host.param_true?('atomic-upstream') ? \"https://dl.fedoraproject.org/pub/fedora/linux/atomic/#{@host.os.major}/\" : \"#{@host.operatingsystem.medium_uri(@host)}/content/repo/\" %> --ref=fedora-atomic/f<%= @host.os.major %>/<%= @host.architecture %>/docker-host\n<% elsif @host.os.name.match /.*centos.*/i -%>\nostreesetup --nogpg --osname=centos-atomic-host --remote=centos-atomic-host --url=<%= @host.param_true?('atomic-upstream') ? \"http://mirror.centos.org/centos/#{@host.os.major}/atomic/#{@host.architecture}/repo/\" : @host.operatingsystem.medium_uri(@host) %> --ref=centos-atomic-host/<%= @host.os.major %>/<%= @host.architecture %>/standard\n<% else -%>\nostreesetup --nogpg --osname=rhel-atomic-host --remote=rhel-atomic-host --url=file:///install/ostree --ref=rhel-atomic-host/<%= @host.os.major %>/<%= @host.architecture %>/standard\n<% end -%>\nservices --disabled cloud-init,cloud-config,cloud-final,cloud-init-local\nrootpw --iscrypted <%= root_pass %>\n\nreboot\n\n%post\n<%= snippet \"subscription_manager_registration\" %>\n<%= snippet('remote_execution_ssh_keys') %>\n(\n# Report success back to Foreman\ncurl -s -o /dev/null --insecure <%= foreman_url('built') %>\n) 2>&1 | tee /mnt/sysimage/root/install.post.log\n\nexit 0\n\n%end\n","snippet":false,"template_kind_id":6,"locked":true,"default":true,"vendor":"Katello","os_family":null,"job_category":"Miscellaneous","provider_type":null,"description_format":null,"execution_timeout_interval":null}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-02 18:04:33 UTC","id":9,"auditable_id":98,"auditable_name":null,"auditable_type":"ProvisioningTemplate","action":"create","audited_changes":{"name":"subscription_manager_registration","template":"<% if @host.params['kt_activation_keys'] %>\n  # add subscription manager\n <% if @host.operatingsystem.atomic? %>\n  curl -s <%= subscription_manager_configuration_url(@host, false) %> | IS_ATOMIC=true bash\n <% else %>\n  yum -t -y -e 0 install subscription-manager\n  rpm -ivh <%= subscription_manager_configuration_url(@host) %>\n <% end %>\n\n  echo \"Registering the System\"\n  subscription-manager register --org=\"<%= @host.rhsm_organization_label %>\" --name=\"<%= @host.name %>\" --activationkey=\"<%= @host.params['kt_activation_keys'] %>\"\n\n  <% unless @host.operatingsystem.atomic? %>\n    echo \"Installing Katello Agent\"\n    yum -t -y -e 0 install katello-agent\n    chkconfig goferd on\n  <% end %>\n<% end %>","snippet":true,"template_kind_id":null,"locked":true,"default":true,"vendor":"Katello","os_family":null,"job_category":"Miscellaneous","provider_type":null,"description_format":null,"execution_timeout_interval":null}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-02 18:04:33 UTC","id":8,"auditable_id":97,"auditable_name":null,"auditable_type":"ProvisioningTemplate","action":"create","audited_changes":{"name":"Katello Kickstart Default Finish","template":"<%#\nkind: finish\nname: Katello Kickstart default finish\noses:\n- CentOS 5\n- CentOS 6\n- CentOS 7\n- RedHat 5\n- RedHat 6\n- RedHat 7\n- Fedora 19\n- Fedora 20\n%>\n<% if @host.subnet.respond_to?(:dhcp_boot_mode?) -%>\n<%= snippet 'kickstart_networking_setup' %>\nservice network restart\n<% end -%>\n\n<%\n  rhel_compatible = @host.operatingsystem.family == 'Redhat' && @host.operatingsystem.name != 'Fedora'\n  os_major = @host.operatingsystem.major.to_i\n  pm_set = @host.puppetmaster.empty? ? false : true\n  puppet_enabled = pm_set || @host.params['force-puppet']\n  salt_enabled = @host.params['salt_master'] ? true : false\n  chef_enabled = @host.respond_to?(:chef_proxy) && @host.chef_proxy\n%>\n\n<%= snippet \"subscription_manager_registration\" %>\n\n<% if @host.respond_to?(:realm) && @host.otp && @host.realm && @host.realm.realm_type == \"FreeIPA\" -%>\n<%= snippet \"freeipa_register\" %>\n<% end -%>\n\n# update local time\necho \"updating system time\"\n/usr/sbin/ntpdate -sub <%= @host.params['ntp-server'] || '0.fedora.pool.ntp.org' %>\n/usr/sbin/hwclock --systohc\n\n<% if @host.info['parameters']['realm'] && @host.realm && @host.realm.realm_type == 'FreeIPA' -%>\n<%= snippet \"freeipa_register\" %>\n<% end -%>\n\n# update all the base packages from the updates repository\nyum -t -y -e 0 update\n\n<%= snippet('remote_execution_ssh_keys') %>\n\n<% if chef_enabled %>\n<%= snippet 'chef_client' %>\n<% end -%>\n\n<% if puppet_enabled %>\n<%= snippet 'puppet_setup' %>\n<% end -%>\n\n<% if salt_enabled %>\n<%= snippet 'saltstack_setup' %>\n<% end -%>\n\nexit 0\n","snippet":false,"template_kind_id":7,"locked":true,"default":true,"vendor":"Katello","os_family":null,"job_category":"Miscellaneous","provider_type":null,"description_format":null,"execution_timeout_interval":null}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-02 18:04:33 UTC","id":7,"auditable_id":96,"auditable_name":null,"auditable_type":"ProvisioningTemplate","action":"create","audited_changes":{"name":"Katello Kickstart Default User Data","template":"<%#\nkind: user_data\nname: Katello Kickstart default user data\noses:\n- CentOS 6\n- CentOS 7\n- Fedora 19\n- Fedora 20\n- Fedora 21\n- Fedora 22\n- Fedora 23\n-%>\n#cloud-config\nhostname: <%= @host.shortname %>\nfqdn: <%= @host %>\nmanage_etc_hosts: true\n\ngroups:\n - admin\n\nusers:\n - default\n - name: admin\n   primary-group: admin\n   groups: users\n   shell: /bin/bash\n   sudo: ['ALL=(ALL) ALL']\n   lock-passwd: false\n   passwd: <%= @host.root_pass %>\n\n<%# Allow user to specify additional SSH key as host paramter -%>\n<% if @host.params['sshkey'].present? || @host.params['remote_execution_ssh_keys'].present? -%>\nssh_authorized_keys:\n<% if @host.params['sshkey'].present? -%>\n  - <%= @host.params['sshkey'] %>\n<% end -%>\n<% if @host.params['remote_execution_ssh_keys'].present? -%>\n<% @host.params['remote_execution_ssh_keys'].each do |key| -%>\n  - <%= key %>\n<% end -%>\n<% end -%>\n<% end -%>\nwrite_files:\n- path: /tmp/foreman-userdata.sh\n  permissions: '0755'\n  content: |\n    #!/bin/bash\n<%= indent 4 do\n      snippet 'subscription_manager_registration'\n    end %>\n<% if @host.info['parameters']['realm'] && @host.realm && @host.realm.realm_type == 'FreeIPA' -%>\n<%= indent 4 do\n      snippet 'freeipa_register'\n    end %>\n<% end -%>\n  <% unless @host.operatingsystem.atomic? -%>\n    # update all the base packages from the updates repository\n    yum -t -y -e 0 update\n  <% end -%>\n<%\n  # safemode renderer does not support unary negation\n  non_atomic = @host.operatingsystem.atomic? ? false : true\n  pm_set = @host.puppetmaster.empty? ? false : true\n  puppet_enabled = non_atomic && (pm_set || @host.params['force-puppet'])\n  salt_enabled = non_atomic && (@host.params['salt_master'] ? true : false)\n  chef_enabled = @host.respond_to?(:chef_proxy) && @host.chef_proxy\n%>\n<% if chef_enabled %>\n<%= indent 4 do\n      snippet 'chef_client'\n    end  %>\n<% end -%>\n\n<% if puppet_enabled %>\n<%= indent 4 do\n      snippet 'puppet_setup'\n    end %>\n<% end -%>\n\n<% if salt_enabled %>\n<%= indent 4 do\n      snippet 'saltstack_setup'\n    end %>\n<% end -%>\nphone_home:\n url: <%= foreman_url('built') %>\n post: []\n tries: 10\nruncmd:\n - [ cloud-init-per, once, foreman-userdata, /tmp/foreman-userdata.sh ]\noutput: {all: '| tee -a /root/install.userdata.log'}\n\n","snippet":false,"template_kind_id":9,"locked":true,"default":true,"vendor":"Katello","os_family":null,"job_category":"Miscellaneous","provider_type":null,"description_format":null,"execution_timeout_interval":null}},{"user_id":2,"user_type":null,"user_name":"foreman_api_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-02 18:04:33 UTC","id":6,"auditable_id":95,"auditable_name":null,"auditable_type":"ProvisioningTemplate","action":"create","audited_changes":{"name":"Katello Kickstart Default","template":"<%#\nkind: provision\nname: Katello Kickstart default\noses:\n- CentOS 5\n- CentOS 6\n- CentOS 7\n- RedHat 5\n- RedHat 6\n- RedHat 7\n- Fedora 19\n- Fedora 20\n%>\n<%\n  rhel_compatible = @host.operatingsystem.family == 'Redhat' && @host.operatingsystem.name != 'Fedora'\n  os_major = @host.operatingsystem.major.to_i\n  # safemode renderer does not support unary negation\n  pm_set = @host.puppetmaster.empty? ? false : true\n  puppet_enabled = pm_set || @host.params['force-puppet']\n  salt_enabled = @host.params['salt_master'] ? true : false\n  chef_enabled = @host.respond_to?(:chef_proxy) && @host.chef_proxy\n  section_end = (rhel_compatible && os_major <= 5) ? '' : '%end'\n%>\ninstall\n<%= @mediapath %>\nlang en_US.UTF-8\nselinux --enforcing\nkeyboard us\nskipx\n\n<% subnet = @host.subnet -%>\n<% if subnet.respond_to?(:dhcp_boot_mode?) -%>\n<% dhcp = subnet.dhcp_boot_mode? && !@static -%>\n<% else -%>\n<% dhcp = !@static -%>\n<% end -%>\n\nnetwork --bootproto <%= dhcp ? 'dhcp' : \"static --ip=#{@host.ip} --netmask=#{subnet.mask} --gateway=#{subnet.gateway} --nameserver=#{[subnet.dns_primary, subnet.dns_secondary].select{ |item| item.present? }.join(',')}\" %> --hostname <%= @host %><%= os_major >= 6 ? \" --device=#{@host.mac}\" : '' -%>\n\nrootpw --iscrypted <%= root_pass %>\nfirewall --<%= os_major >= 6 ? 'service=' : '' %>ssh\nauthconfig --useshadow --passalgo=<%= @host.operatingsystem.password_hash || 'sha256' %> --kickstart\ntimezone --utc <%= @host.params['time-zone'] || 'UTC' %>\n\n<% if @host.operatingsystem.name == 'Fedora' and os_major <= 16 -%>\n# Bootloader exception for Fedora 16:\nbootloader --append=\"nofb quiet splash=quiet <%=ks_console%>\" <%= grub_pass %>\npart biosboot --fstype=biosboot --size=1\n<% else -%>\nbootloader --location=mbr --append=\"nofb quiet splash=quiet\" <%= grub_pass %>\n<% end -%>\n\n<% if os_major == 5 -%>\nkey --skip\n<% end -%>\n\n<% if @dynamic -%>\n%include /tmp/diskpart.cfg\n<% else -%>\n<%= @host.diskLayout %>\n<% end -%>\n\ntext\nreboot\n\n%packages --ignoremissing\nyum\ndhclient\nntp\nwget\n@Core\n<%= section_end -%>\n\n<% if @dynamic -%>\n%pre\n<%= @host.diskLayout %>\n<%= section_end -%>\n<% end -%>\n\n%post --nochroot\nexec < /dev/tty3 > /dev/tty3\n#changing to VT 3 so that we can see whats going on....\n/usr/bin/chvt 3\n(\ncp -va /etc/resolv.conf /mnt/sysimage/etc/resolv.conf\n/usr/bin/chvt 1\n) 2>&1 | tee /mnt/sysimage/root/install.postnochroot.log\n<%= section_end -%>\n\n\n%post\nlogger \"Starting anaconda <%= @host %> postinstall\"\nexec < /dev/tty3 > /dev/tty3\n#changing to VT 3 so that we can see whats going on....\n/usr/bin/chvt 3\n(\n<% if subnet.respond_to?(:dhcp_boot_mode?) -%>\n<%= snippet 'kickstart_networking_setup' %>\n<% end -%>\n\n#update local time\necho \"updating system time\"\n/usr/sbin/ntpdate -sub <%= @host.params['ntp-server'] || '0.fedora.pool.ntp.org' %>\n/usr/sbin/hwclock --systohc\n\n<%= snippet \"subscription_manager_registration\" %>\n\n<% if @host.info['parameters']['realm'] && @host.realm && @host.realm.realm_type == 'FreeIPA' -%>\n<%= snippet \"freeipa_register\" %>\n<% end -%>\n\n# update all the base packages from the updates repository\nyum -t -y -e 0 update\n\n<%= snippet('remote_execution_ssh_keys') %>\n\n<% if chef_enabled %>\n<%= snippet 'chef_client' %>\n<% end -%>\n\n<% if puppet_enabled %>\n<%= snippet 'puppet_setup' %>\n<% end -%>\n\n<% if salt_enabled %>\n<%= snippet 'saltstack_setup' %>\n<% end -%>\n\nsync\n\n<% if @provisioning_type == nil || @provisioning_type == 'host' -%>\n# Inform the build system that we are done.\necho \"Informing Foreman that we are built\"\nwget -q -O /dev/null --no-check-certificate <%= foreman_url('built') %>\n<% end -%>\n) 2>&1 | tee /root/install.post.log\nexit 0\n\n<%= section_end -%>\n","snippet":false,"template_kind_id":6,"locked":true,"default":true,"vendor":"Katello","os_family":null,"job_category":"Miscellaneous","provider_type":null,"description_format":null,"execution_timeout_interval":null}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-02 18:04:26 UTC","id":5,"auditable_id":71,"auditable_name":"default_location_puppet_content","auditable_type":"Setting","action":"update","audited_changes":{"value":[null,"--- Default Location\n..."]}},{"user_id":1,"user_type":null,"user_name":"foreman_admin","version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-02 18:04:26 UTC","id":4,"auditable_id":70,"auditable_name":"default_location_subscribed_hosts","auditable_type":"Setting","action":"update","audited_changes":{"value":[null,"--- Default Location\n..."]}},{"user_id":null,"user_type":null,"user_name":null,"version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-02 18:04:11 UTC","id":3,"auditable_id":85,"auditable_name":"oauth_map_users","auditable_type":"Setting","action":"update","audited_changes":{"value":[null,"--- false\n..."]}},{"user_id":null,"user_type":null,"user_name":null,"version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-02 18:04:11 UTC","id":2,"auditable_id":84,"auditable_name":"oauth_consumer_secret","auditable_type":"Setting","action":"update","audited_changes":{"value":["--- K29ZccrKRJhkKWyu2cD9fjM6go25dgw8\n...","[encrypted]"]}},{"user_id":null,"user_type":null,"user_name":null,"version":1,"comment":null,"associated_id":null,"associated_type":null,"remote_address":null,"associated_name":null,"created_at":"2018-03-02 18:04:11 UTC","id":1,"auditable_id":83,"auditable_name":"oauth_consumer_key","auditable_type":"Setting","action":"update","audited_changes":{"value":["--- WXRsSBDZmHaqp43gU6Ex7YKTWTv8ofQH\n...","[encrypted]"]}}]
}
